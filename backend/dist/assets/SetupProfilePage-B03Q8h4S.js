import{u as P,a as S,r as n,j as e,C as k,U as C,L,_ as m,b as F}from"./index-BZ0hST_k.js";import{F as I}from"./file-text-CC6clf42.js";const A=()=>{const{authUser:t,setAuthUser:f}=P(),b=S(),[d,u]=n.useState(!1),[r,h]=n.useState((t==null?void 0:t.nickname)||(t==null?void 0:t.fullName)||""),[c,j]=n.useState((t==null?void 0:t.bio)||""),[N,g]=n.useState(null),[p,v]=n.useState((t==null?void 0:t.profilePic)||null),o=n.useRef(null),y=s=>{const a=s.target.files[0];if(a){g(a);const l=new FileReader;l.onloadend=()=>{v(l.result)},l.readAsDataURL(a)}},w=async s=>{var l,x;if(s.preventDefault(),!r.trim())return m.error("Nickname is required.");u(!0);let a=null;N&&(a=p);try{const i=await F.post("/auth/setup-profile",{nickname:r,bio:c,profilePic:a});f(i.data),localStorage.setItem("authUser",JSON.stringify(i.data)),m.success("Profile setup complete!"),b("/")}catch(i){console.error("Profile setup error:",i),m.error(((x=(l=i.response)==null?void 0:l.data)==null?void 0:x.message)||"Failed to set up profile.")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-base-200 px-3 sm:px-4 py-16 sm:py-20",children:e.jsxs("div",{className:"w-full max-w-md p-4 sm:p-6 md:p-8 space-y-4 sm:space-y-6 bg-base-100 rounded-lg sm:rounded-xl shadow-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Welcome!"}),e.jsx("p",{className:"text-sm sm:text-base text-base-content/70",children:"Let's set up your profile."})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"avatar relative w-28 h-28 sm:w-32 sm:h-32 rounded-full group",children:[e.jsx("img",{src:p||"/avatar.png",alt:"Profile Preview",className:"w-full h-full rounded-full object-cover ring-4 ring-base-300"}),e.jsx("button",{type:"button",onClick:()=>{var s;return(s=o.current)==null?void 0:s.click()},className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity","aria-label":"Change profile picture",children:e.jsx(k,{className:"w-6 h-6 sm:w-8 sm:h-8 text-white"})})]}),e.jsx("input",{type:"file",ref:o,onChange:y,accept:"image/png, image/jpeg, image/jpg",className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>{var s;return(s=o.current)==null?void 0:s.click()},className:"btn btn-link btn-xs sm:btn-sm mt-2",children:"Upload Photo"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Nickname (Display Name)"})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(C,{className:"w-5 h-5 text-base-content/40"})}),e.jsx("input",{type:"text",placeholder:"Your display name",className:"input input-bordered w-full pl-10",value:r,onChange:s=>h(s.target.value),required:!0})]})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Bio (Optional)"})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{className:"w-5 h-5 text-base-content/40"})}),e.jsx("textarea",{placeholder:"Tell everyone a little about yourself...",className:"textarea textarea-bordered w-full pl-10 h-24",value:c,onChange:s=>j(s.target.value),maxLength:150}),e.jsxs("span",{className:"absolute bottom-2 right-3 text-xs text-base-content/50",children:[c.length," / 150"]})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-full btn-sm sm:btn-md",disabled:d,children:d?e.jsx(L,{className:"w-5 h-5 sm:w-6 sm:h-6 animate-spin"}):e.jsx("span",{className:"text-sm sm:text-base",children:"Save and Continue"})})]})]})})};export{A as default};
