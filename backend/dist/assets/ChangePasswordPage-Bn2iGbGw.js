import{a as T,r as t,j as s,A as I,f as j,g as b,E as w,h as g,b as N,_ as a}from"./index-BZ0hST_k.js";import{S as R}from"./shield-CbzpJd-G.js";const D=()=>{const f=T(),[m,y]=t.useState(1),[n,i]=t.useState(!1),[C,P]=t.useState(""),[_,S]=t.useState(!1),[d,k]=t.useState(""),[c,E]=t.useState(""),[o,z]=t.useState(""),[x,F]=t.useState(""),[h,O]=t.useState(!1),[p,L]=t.useState(!1),[u,V]=t.useState(!1),v=async()=>{var e,l;i(!0);try{const r=await N.post("/auth/send-password-change-otp");P(r.data.email),S(!0),y(2),a.success("OTP sent to your email!")}catch(r){a.error(((l=(e=r.response)==null?void 0:e.data)==null?void 0:l.message)||"Failed to send OTP")}finally{i(!1)}},A=async e=>{var l,r;if(e.preventDefault(),!d||!c||!o||!x){a.error("All fields are required");return}if(o.length<6){a.error("New password must be at least 6 characters");return}if(o!==x){a.error("New passwords do not match");return}i(!0);try{await N.post("/auth/change-password",{otp:d,currentPassword:c,newPassword:o}),a.success("Password changed successfully!"),f("/")}catch(M){a.error(((r=(l=M.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to change password")}finally{i(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-base-200 via-base-100 to-base-200 flex items-center justify-center p-3 sm:p-4",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("button",{onClick:()=>f(-1),className:"btn btn-ghost btn-xs sm:btn-sm gap-1 sm:gap-2 mb-3 sm:mb-4",children:[s.jsx(I,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s.jsx("span",{className:"text-xs sm:text-sm",children:"Back"})]}),s.jsxs("div",{className:"bg-base-100 rounded-xl shadow-lg p-4 sm:p-6 border border-base-300",children:[s.jsxs("div",{className:"text-center mb-4 sm:mb-6",children:[s.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-2 sm:mb-3",children:s.jsx(j,{className:"w-6 h-6 sm:w-8 sm:h-8 text-primary"})}),s.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:"Change Password"}),s.jsx("p",{className:"text-xs sm:text-sm text-base-content/60 mt-1",children:m===1?"Verify your identity":"Enter new password"})]}),m===1&&s.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-2 p-2 sm:p-3 bg-info/10 rounded-lg border border-info/20",children:[s.jsx(R,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-info mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"text-[11px] sm:text-xs text-base-content/70",children:"For security, we'll send a verification code to your email"})]}),s.jsxs("button",{onClick:v,disabled:n,className:`group relative w-full btn btn-sm sm:btn-md gap-2 h-10 sm:h-12 overflow-hidden\r
                           bg-gradient-to-r from-primary via-primary to-secondary\r
                           hover:from-secondary hover:via-primary hover:to-primary\r
                           border-0 shadow-lg hover:shadow-xl\r
                           transition-all duration-300 ease-in-out\r
                           hover:scale-[1.02] active:scale-95\r
                           disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent \r
                              translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700`}),n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"loading loading-spinner loading-sm relative z-10"}),s.jsx("span",{className:"text-xs sm:text-sm font-semibold relative z-10 text-primary-content",children:"Sending..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(b,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 relative z-10 group-hover:rotate-12 transition-transform duration-300"}),s.jsx("span",{className:"text-xs sm:text-sm font-semibold relative z-10 text-primary-content",children:"Send Verification Code"})]})]})]}),m===2&&s.jsxs("form",{onSubmit:A,className:"space-y-3 sm:space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-2 p-2 sm:p-3 bg-success/10 rounded-lg border border-success/20",children:[s.jsx(b,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-success mt-0.5 flex-shrink-0"}),s.jsxs("p",{className:"text-[11px] sm:text-xs text-base-content/70",children:["Verification code sent to ",C]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"label py-1 sm:py-2",children:s.jsx("span",{className:"label-text text-xs sm:text-sm font-medium",children:"Verification Code"})}),s.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full text-sm",value:d,onChange:e=>k(e.target.value),placeholder:"Enter 6-digit code",maxLength:6})]}),s.jsxs("div",{children:[s.jsx("label",{className:"label py-1 sm:py-2",children:s.jsx("span",{className:"label-text text-xs sm:text-sm font-medium",children:"Current Password"})}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:h?"text":"password",className:"input input-bordered input-sm sm:input-md w-full pr-10 text-sm",value:c,onChange:e=>E(e.target.value),placeholder:"Enter current password"}),s.jsx("button",{type:"button",className:"absolute right-2 sm:right-3 top-1/2 -translate-y-1/2",onClick:()=>O(!h),children:h?s.jsx(w,{className:"w-4 h-4 sm:w-5 sm:h-5 text-base-content/60"}):s.jsx(g,{className:"w-4 h-4 sm:w-5 sm:h-5 text-base-content/60"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"label py-1 sm:py-2",children:s.jsx("span",{className:"label-text text-xs sm:text-sm font-medium",children:"New Password"})}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:p?"text":"password",className:"input input-bordered input-sm sm:input-md w-full pr-10 text-sm",value:o,onChange:e=>z(e.target.value),placeholder:"Min 6 characters"}),s.jsx("button",{type:"button",className:"absolute right-2 sm:right-3 top-1/2 -translate-y-1/2",onClick:()=>L(!p),children:p?s.jsx(w,{className:"w-4 h-4 sm:w-5 sm:h-5 text-base-content/60"}):s.jsx(g,{className:"w-4 h-4 sm:w-5 sm:h-5 text-base-content/60"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"label py-1 sm:py-2",children:s.jsx("span",{className:"label-text text-xs sm:text-sm font-medium",children:"Confirm New Password"})}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:u?"text":"password",className:"input input-bordered input-sm sm:input-md w-full pr-10 text-sm",value:x,onChange:e=>F(e.target.value),placeholder:"Confirm new password"}),s.jsx("button",{type:"button",className:"absolute right-2 sm:right-3 top-1/2 -translate-y-1/2",onClick:()=>V(!u),children:u?s.jsx(w,{className:"w-4 h-4 sm:w-5 sm:h-5 text-base-content/60"}):s.jsx(g,{className:"w-4 h-4 sm:w-5 sm:h-5 text-base-content/60"})})]})]}),s.jsxs("button",{type:"submit",disabled:n,className:`group relative w-full btn btn-sm sm:btn-md gap-2 h-10 sm:h-12 mt-2 overflow-hidden\r
                           bg-gradient-to-r from-success via-success to-primary\r
                           hover:from-primary hover:via-success hover:to-success\r
                           border-0 shadow-lg hover:shadow-xl\r
                           transition-all duration-300 ease-in-out\r
                           hover:scale-[1.02] active:scale-95\r
                           disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100`,children:[s.jsx("div",{className:`absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent \r
                              translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700`}),n?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"loading loading-spinner loading-sm relative z-10"}),s.jsx("span",{className:"text-xs sm:text-sm font-semibold relative z-10 text-primary-content",children:"Changing..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(j,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 relative z-10 group-hover:rotate-12 transition-transform duration-300"}),s.jsx("span",{className:"text-xs sm:text-sm font-semibold relative z-10 text-primary-content",children:"Change Password"})]})]}),s.jsxs("button",{type:"button",onClick:v,disabled:n,className:`group w-full btn btn-ghost btn-xs sm:btn-sm text-xs sm:text-sm\r
                           hover:bg-primary/10 hover:text-primary\r
                           transition-all duration-200\r
                           disabled:opacity-50`,children:[s.jsx(b,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5 group-hover:rotate-12 transition-transform duration-300"}),"Resend Code"]})]})]})]})})};export{D as default};
