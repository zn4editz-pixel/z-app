const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SetupProfilePage-B03Q8h4S.js","assets/file-text-CC6clf42.js","assets/SettingsPage-DpqDgbfE.js","assets/shield-CbzpJd-G.js","assets/check-Uol-saN6.js","assets/ChangePasswordPage-Bn2iGbGw.js","assets/ProfilePage-C0xgFaob.js","assets/clock-CcEyUotB.js","assets/PublicProfilePage-Das_6U-f.js","assets/user-check-BHj-mZXU.js","assets/user-plus-D_28Q8fX.js","assets/StrangerChatPage-DjKAFyi4.js","assets/triangle-alert-BIdojJ6r.js","assets/AdminDashboard-M4gMXi8B.js","assets/circle-x-kkvPsnd5.js","assets/AdminDashboard-dQu2VLKM.css","assets/DiscoverPage-yrmb0oUe.js","assets/ForgotPassword-D3CTJaW_.js","assets/responsive-CSu2AbHQ.css","assets/mobile-C_KLYaDR.css","assets/smooth-transitions-8DmLDBoW.css"])))=>i.map(i=>d[i]);
function aD(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const bU="modulepreload",vU=function(t){return"/"+t},a$={},qt=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(l=>{if(l=vU(l),l in a$)return;a$[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":bU,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};var Bl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function SU(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var cD={exports:{}},g0={},uD={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ef=Symbol.for("react.element"),kU=Symbol.for("react.portal"),CU=Symbol.for("react.fragment"),NU=Symbol.for("react.strict_mode"),TU=Symbol.for("react.profiler"),IU=Symbol.for("react.provider"),$U=Symbol.for("react.context"),EU=Symbol.for("react.forward_ref"),RU=Symbol.for("react.suspense"),AU=Symbol.for("react.memo"),_U=Symbol.for("react.lazy"),l$=Symbol.iterator;function DU(t){return t===null||typeof t!="object"?null:(t=l$&&t[l$]||t["@@iterator"],typeof t=="function"?t:null)}var dD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hD=Object.assign,fD={};function fu(t,e,n){this.props=t,this.context=e,this.refs=fD,this.updater=n||dD}fu.prototype.isReactComponent={};fu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function pD(){}pD.prototype=fu.prototype;function ek(t,e,n){this.props=t,this.context=e,this.refs=fD,this.updater=n||dD}var tk=ek.prototype=new pD;tk.constructor=ek;hD(tk,fu.prototype);tk.isPureReactComponent=!0;var c$=Array.isArray,mD=Object.prototype.hasOwnProperty,nk={current:null},gD={key:!0,ref:!0,__self:!0,__source:!0};function yD(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)mD.call(e,s)&&!gD.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:Ef,type:t,key:i,ref:o,props:r,_owner:nk.current}}function OU(t,e){return{$$typeof:Ef,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sk(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ef}function FU(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var u$=/\/+/g;function gb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?FU(""+t.key):e.toString(36)}function Sg(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ef:case kU:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+gb(o,0):s,c$(r)?(n="",t!=null&&(n=t.replace(u$,"$&/")+"/"),Sg(r,e,n,"",function(c){return c})):r!=null&&(sk(r)&&(r=OU(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(u$,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",c$(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+gb(i,a);o+=Sg(i,e,n,l,r)}else if(l=DU(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+gb(i,a++),o+=Sg(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Om(t,e,n){if(t==null)return t;var s=[],r=0;return Sg(t,s,"","",function(i){return e.call(n,i,r++)}),s}function PU(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ss={current:null},kg={transition:null},LU={ReactCurrentDispatcher:Ss,ReactCurrentBatchConfig:kg,ReactCurrentOwner:nk};function xD(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:Om,forEach:function(t,e,n){Om(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Om(t,function(){e++}),e},toArray:function(t){return Om(t,function(e){return e})||[]},only:function(t){if(!sk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=fu;qe.Fragment=CU;qe.Profiler=TU;qe.PureComponent=ek;qe.StrictMode=NU;qe.Suspense=RU;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LU;qe.act=xD;qe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=hD({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=nk.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)mD.call(e,l)&&!gD.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:Ef,type:t.type,key:r,ref:i,props:s,_owner:o}};qe.createContext=function(t){return t={$$typeof:$U,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:IU,_context:t},t.Consumer=t};qe.createElement=yD;qe.createFactory=function(t){var e=yD.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:EU,render:t}};qe.isValidElement=sk;qe.lazy=function(t){return{$$typeof:_U,_payload:{_status:-1,_result:t},_init:PU}};qe.memo=function(t,e){return{$$typeof:AU,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=kg.transition;kg.transition={};try{t()}finally{kg.transition=e}};qe.unstable_act=xD;qe.useCallback=function(t,e){return Ss.current.useCallback(t,e)};qe.useContext=function(t){return Ss.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return Ss.current.useDeferredValue(t)};qe.useEffect=function(t,e){return Ss.current.useEffect(t,e)};qe.useId=function(){return Ss.current.useId()};qe.useImperativeHandle=function(t,e,n){return Ss.current.useImperativeHandle(t,e,n)};qe.useInsertionEffect=function(t,e){return Ss.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return Ss.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return Ss.current.useMemo(t,e)};qe.useReducer=function(t,e,n){return Ss.current.useReducer(t,e,n)};qe.useRef=function(t){return Ss.current.useRef(t)};qe.useState=function(t){return Ss.current.useState(t)};qe.useSyncExternalStore=function(t,e,n){return Ss.current.useSyncExternalStore(t,e,n)};qe.useTransition=function(){return Ss.current.useTransition()};qe.version="18.3.1";uD.exports=qe;var F=uD.exports;const T1=lD(F),MU=aD({__proto__:null,default:T1},[F]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BU=F,zU=Symbol.for("react.element"),VU=Symbol.for("react.fragment"),jU=Object.prototype.hasOwnProperty,UU=BU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WU={key:!0,ref:!0,__self:!0,__source:!0};function wD(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)jU.call(e,s)&&!WU.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:zU,type:t,key:i,ref:o,props:r,_owner:UU.current}}g0.Fragment=VU;g0.jsx=wD;g0.jsxs=wD;cD.exports=g0;var v=cD.exports,bD={exports:{}},lr={},vD={exports:{}},SD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,q){var te=M.length;M.push(q);e:for(;0<te;){var Z=te-1>>>1,le=M[Z];if(0<r(le,q))M[Z]=q,M[te]=le,te=Z;else break e}}function n(M){return M.length===0?null:M[0]}function s(M){if(M.length===0)return null;var q=M[0],te=M.pop();if(te!==q){M[0]=te;e:for(var Z=0,le=M.length,de=le>>>1;Z<de;){var fe=2*(Z+1)-1,ne=M[fe],U=fe+1,ae=M[U];if(0>r(ne,te))U<le&&0>r(ae,ne)?(M[Z]=ae,M[U]=te,Z=U):(M[Z]=ne,M[fe]=te,Z=fe);else if(U<le&&0>r(ae,te))M[Z]=ae,M[U]=te,Z=U;else break e}}return q}function r(M,q){var te=M.sortIndex-q.sortIndex;return te!==0?te:M.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(M){for(var q=n(c);q!==null;){if(q.callback===null)s(c);else if(q.startTime<=M)s(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=n(c)}}function b(M){if(m=!1,w(M),!p)if(n(l)!==null)p=!0,Q(S);else{var q=n(c);q!==null&&ee(b,q.startTime-M)}}function S(M,q){p=!1,m&&(m=!1,y($),$=-1),f=!0;var te=h;try{for(w(q),d=n(l);d!==null&&(!(d.expirationTime>q)||M&&!z());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,h=d.priorityLevel;var le=Z(d.expirationTime<=q);q=t.unstable_now(),typeof le=="function"?d.callback=le:d===n(l)&&s(l),w(q)}else s(l);d=n(l)}if(d!==null)var de=!0;else{var fe=n(c);fe!==null&&ee(b,fe.startTime-q),de=!1}return de}finally{d=null,h=te,f=!1}}var T=!1,I=null,$=-1,_=5,D=-1;function z(){return!(t.unstable_now()-D<_)}function H(){if(I!==null){var M=t.unstable_now();D=M;var q=!0;try{q=I(!0,M)}finally{q?X():(T=!1,I=null)}}else T=!1}var X;if(typeof x=="function")X=function(){x(H)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,J=Y.port2;Y.port1.onmessage=H,X=function(){J.postMessage(null)}}else X=function(){g(H,0)};function Q(M){I=M,T||(T=!0,X())}function ee(M,q){$=g(function(){M(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Q(S))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(M){switch(h){case 1:case 2:case 3:var q=3;break;default:q=h}var te=h;h=q;try{return M()}finally{h=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,q){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var te=h;h=M;try{return q()}finally{h=te}},t.unstable_scheduleCallback=function(M,q,te){var Z=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Z+te:Z):te=Z,M){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=te+le,M={id:u++,callback:q,priorityLevel:M,startTime:te,expirationTime:le,sortIndex:-1},te>Z?(M.sortIndex=te,e(c,M),n(l)===null&&M===n(c)&&(m?(y($),$=-1):m=!0,ee(b,te-Z))):(M.sortIndex=le,e(l,M),p||f||(p=!0,Q(S))),M},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(M){var q=h;return function(){var te=h;h=q;try{return M.apply(this,arguments)}finally{h=te}}}})(SD);vD.exports=SD;var GU=vD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HU=F,ir=GU;function pe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kD=new Set,Lh={};function zl(t,e){Vc(t,e),Vc(t+"Capture",e)}function Vc(t,e){for(Lh[t]=e,t=0;t<e.length;t++)kD.add(e[t])}var eo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),I1=Object.prototype.hasOwnProperty,qU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d$={},h$={};function KU(t){return I1.call(h$,t)?!0:I1.call(d$,t)?!1:qU.test(t)?h$[t]=!0:(d$[t]=!0,!1)}function XU(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function YU(t,e,n,s){if(e===null||typeof e>"u"||XU(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ks(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Hn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Hn[t]=new ks(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Hn[e]=new ks(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Hn[t]=new ks(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Hn[t]=new ks(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Hn[t]=new ks(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Hn[t]=new ks(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Hn[t]=new ks(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Hn[t]=new ks(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Hn[t]=new ks(t,5,!1,t.toLowerCase(),null,!1,!1)});var rk=/[\-:]([a-z])/g;function ik(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rk,ik);Hn[e]=new ks(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rk,ik);Hn[e]=new ks(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rk,ik);Hn[e]=new ks(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Hn[t]=new ks(t,1,!1,t.toLowerCase(),null,!1,!1)});Hn.xlinkHref=new ks("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Hn[t]=new ks(t,1,!1,t.toLowerCase(),null,!0,!0)});function ok(t,e,n,s){var r=Hn.hasOwnProperty(e)?Hn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(YU(e,n,r,s)&&(n=null),s||r===null?KU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var yo=HU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fm=Symbol.for("react.element"),hc=Symbol.for("react.portal"),fc=Symbol.for("react.fragment"),ak=Symbol.for("react.strict_mode"),$1=Symbol.for("react.profiler"),CD=Symbol.for("react.provider"),ND=Symbol.for("react.context"),lk=Symbol.for("react.forward_ref"),E1=Symbol.for("react.suspense"),R1=Symbol.for("react.suspense_list"),ck=Symbol.for("react.memo"),Ao=Symbol.for("react.lazy"),TD=Symbol.for("react.offscreen"),f$=Symbol.iterator;function Ud(t){return t===null||typeof t!="object"?null:(t=f$&&t[f$]||t["@@iterator"],typeof t=="function"?t:null)}var Vt=Object.assign,yb;function ah(t){if(yb===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);yb=e&&e[1]||""}return`
`+yb+t}var xb=!1;function wb(t,e){if(!t||xb)return"";xb=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{xb=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ah(t):""}function JU(t){switch(t.tag){case 5:return ah(t.type);case 16:return ah("Lazy");case 13:return ah("Suspense");case 19:return ah("SuspenseList");case 0:case 2:case 15:return t=wb(t.type,!1),t;case 11:return t=wb(t.type.render,!1),t;case 1:return t=wb(t.type,!0),t;default:return""}}function A1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case fc:return"Fragment";case hc:return"Portal";case $1:return"Profiler";case ak:return"StrictMode";case E1:return"Suspense";case R1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ND:return(t.displayName||"Context")+".Consumer";case CD:return(t._context.displayName||"Context")+".Provider";case lk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ck:return e=t.displayName||null,e!==null?e:A1(t.type)||"Memo";case Ao:e=t._payload,t=t._init;try{return A1(t(e))}catch{}}return null}function QU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A1(e);case 8:return e===ak?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ra(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ID(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ZU(t){var e=ID(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Pm(t){t._valueTracker||(t._valueTracker=ZU(t))}function $D(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=ID(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function sy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _1(t,e){var n=e.checked;return Vt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function p$(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=ra(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ED(t,e){e=e.checked,e!=null&&ok(t,"checked",e,!1)}function D1(t,e){ED(t,e);var n=ra(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?O1(t,e.type,n):e.hasOwnProperty("defaultValue")&&O1(t,e.type,ra(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function m$(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function O1(t,e,n){(e!=="number"||sy(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var lh=Array.isArray;function Rc(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+ra(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function F1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(pe(91));return Vt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function g$(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(pe(92));if(lh(n)){if(1<n.length)throw Error(pe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ra(n)}}function RD(t,e){var n=ra(e.value),s=ra(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function y$(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function AD(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function P1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?AD(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Lm,_D=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Lm=Lm||document.createElement("div"),Lm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Lm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Mh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Sh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eW=["Webkit","ms","Moz","O"];Object.keys(Sh).forEach(function(t){eW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Sh[e]=Sh[t]})});function DD(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Sh.hasOwnProperty(t)&&Sh[t]?(""+e).trim():e+"px"}function OD(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=DD(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var tW=Vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function L1(t,e){if(e){if(tW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(pe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(pe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(pe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(pe(62))}}function M1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var B1=null;function uk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var z1=null,Ac=null,_c=null;function x$(t){if(t=_f(t)){if(typeof z1!="function")throw Error(pe(280));var e=t.stateNode;e&&(e=v0(e),z1(t.stateNode,t.type,e))}}function FD(t){Ac?_c?_c.push(t):_c=[t]:Ac=t}function PD(){if(Ac){var t=Ac,e=_c;if(_c=Ac=null,x$(t),e)for(t=0;t<e.length;t++)x$(e[t])}}function LD(t,e){return t(e)}function MD(){}var bb=!1;function BD(t,e,n){if(bb)return t(e,n);bb=!0;try{return LD(t,e,n)}finally{bb=!1,(Ac!==null||_c!==null)&&(MD(),PD())}}function Bh(t,e){var n=t.stateNode;if(n===null)return null;var s=v0(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(pe(231,e,typeof n));return n}var V1=!1;if(eo)try{var Wd={};Object.defineProperty(Wd,"passive",{get:function(){V1=!0}}),window.addEventListener("test",Wd,Wd),window.removeEventListener("test",Wd,Wd)}catch{V1=!1}function nW(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var kh=!1,ry=null,iy=!1,j1=null,sW={onError:function(t){kh=!0,ry=t}};function rW(t,e,n,s,r,i,o,a,l){kh=!1,ry=null,nW.apply(sW,arguments)}function iW(t,e,n,s,r,i,o,a,l){if(rW.apply(this,arguments),kh){if(kh){var c=ry;kh=!1,ry=null}else throw Error(pe(198));iy||(iy=!0,j1=c)}}function Vl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function zD(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function w$(t){if(Vl(t)!==t)throw Error(pe(188))}function oW(t){var e=t.alternate;if(!e){if(e=Vl(t),e===null)throw Error(pe(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return w$(r),t;if(i===s)return w$(r),e;i=i.sibling}throw Error(pe(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(pe(189))}}if(n.alternate!==s)throw Error(pe(190))}if(n.tag!==3)throw Error(pe(188));return n.stateNode.current===n?t:e}function VD(t){return t=oW(t),t!==null?jD(t):null}function jD(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jD(t);if(e!==null)return e;t=t.sibling}return null}var UD=ir.unstable_scheduleCallback,b$=ir.unstable_cancelCallback,aW=ir.unstable_shouldYield,lW=ir.unstable_requestPaint,tn=ir.unstable_now,cW=ir.unstable_getCurrentPriorityLevel,dk=ir.unstable_ImmediatePriority,WD=ir.unstable_UserBlockingPriority,oy=ir.unstable_NormalPriority,uW=ir.unstable_LowPriority,GD=ir.unstable_IdlePriority,y0=null,ki=null;function dW(t){if(ki&&typeof ki.onCommitFiberRoot=="function")try{ki.onCommitFiberRoot(y0,t,void 0,(t.current.flags&128)===128)}catch{}}var Kr=Math.clz32?Math.clz32:pW,hW=Math.log,fW=Math.LN2;function pW(t){return t>>>=0,t===0?32:31-(hW(t)/fW|0)|0}var Mm=64,Bm=4194304;function ch(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ay(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=ch(a):(i&=o,i!==0&&(s=ch(i)))}else o=n&~r,o!==0?s=ch(o):i!==0&&(s=ch(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Kr(e),r=1<<n,s|=t[n],e&=~r;return s}function mW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gW(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Kr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=mW(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function U1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function HD(){var t=Mm;return Mm<<=1,!(Mm&4194240)&&(Mm=64),t}function vb(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Rf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kr(e),t[e]=n}function yW(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Kr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function hk(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Kr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var lt=0;function qD(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var KD,fk,XD,YD,JD,W1=!1,zm=[],Wo=null,Go=null,Ho=null,zh=new Map,Vh=new Map,Oo=[],xW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function v$(t,e){switch(t){case"focusin":case"focusout":Wo=null;break;case"dragenter":case"dragleave":Go=null;break;case"mouseover":case"mouseout":Ho=null;break;case"pointerover":case"pointerout":zh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vh.delete(e.pointerId)}}function Gd(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=_f(e),e!==null&&fk(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function wW(t,e,n,s,r){switch(e){case"focusin":return Wo=Gd(Wo,t,e,n,s,r),!0;case"dragenter":return Go=Gd(Go,t,e,n,s,r),!0;case"mouseover":return Ho=Gd(Ho,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return zh.set(i,Gd(zh.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Vh.set(i,Gd(Vh.get(i)||null,t,e,n,s,r)),!0}return!1}function QD(t){var e=Xa(t.target);if(e!==null){var n=Vl(e);if(n!==null){if(e=n.tag,e===13){if(e=zD(n),e!==null){t.blockedOn=e,JD(t.priority,function(){XD(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Cg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=G1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);B1=s,n.target.dispatchEvent(s),B1=null}else return e=_f(n),e!==null&&fk(e),t.blockedOn=n,!1;e.shift()}return!0}function S$(t,e,n){Cg(t)&&n.delete(e)}function bW(){W1=!1,Wo!==null&&Cg(Wo)&&(Wo=null),Go!==null&&Cg(Go)&&(Go=null),Ho!==null&&Cg(Ho)&&(Ho=null),zh.forEach(S$),Vh.forEach(S$)}function Hd(t,e){t.blockedOn===e&&(t.blockedOn=null,W1||(W1=!0,ir.unstable_scheduleCallback(ir.unstable_NormalPriority,bW)))}function jh(t){function e(r){return Hd(r,t)}if(0<zm.length){Hd(zm[0],t);for(var n=1;n<zm.length;n++){var s=zm[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Wo!==null&&Hd(Wo,t),Go!==null&&Hd(Go,t),Ho!==null&&Hd(Ho,t),zh.forEach(e),Vh.forEach(e),n=0;n<Oo.length;n++)s=Oo[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Oo.length&&(n=Oo[0],n.blockedOn===null);)QD(n),n.blockedOn===null&&Oo.shift()}var Dc=yo.ReactCurrentBatchConfig,ly=!0;function vW(t,e,n,s){var r=lt,i=Dc.transition;Dc.transition=null;try{lt=1,pk(t,e,n,s)}finally{lt=r,Dc.transition=i}}function SW(t,e,n,s){var r=lt,i=Dc.transition;Dc.transition=null;try{lt=4,pk(t,e,n,s)}finally{lt=r,Dc.transition=i}}function pk(t,e,n,s){if(ly){var r=G1(t,e,n,s);if(r===null)Ab(t,e,s,cy,n),v$(t,s);else if(wW(r,t,e,n,s))s.stopPropagation();else if(v$(t,s),e&4&&-1<xW.indexOf(t)){for(;r!==null;){var i=_f(r);if(i!==null&&KD(i),i=G1(t,e,n,s),i===null&&Ab(t,e,s,cy,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Ab(t,e,s,null,n)}}var cy=null;function G1(t,e,n,s){if(cy=null,t=uk(s),t=Xa(t),t!==null)if(e=Vl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=zD(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cy=t,null}function ZD(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cW()){case dk:return 1;case WD:return 4;case oy:case uW:return 16;case GD:return 536870912;default:return 16}default:return 16}}var Lo=null,mk=null,Ng=null;function eO(){if(Ng)return Ng;var t,e=mk,n=e.length,s,r="value"in Lo?Lo.value:Lo.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return Ng=r.slice(t,1<s?1-s:void 0)}function Tg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Vm(){return!0}function k$(){return!1}function cr(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Vm:k$,this.isPropagationStopped=k$,this}return Vt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vm)},persist:function(){},isPersistent:Vm}),e}var pu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gk=cr(pu),Af=Vt({},pu,{view:0,detail:0}),kW=cr(Af),Sb,kb,qd,x0=Vt({},Af,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yk,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==qd&&(qd&&t.type==="mousemove"?(Sb=t.screenX-qd.screenX,kb=t.screenY-qd.screenY):kb=Sb=0,qd=t),Sb)},movementY:function(t){return"movementY"in t?t.movementY:kb}}),C$=cr(x0),CW=Vt({},x0,{dataTransfer:0}),NW=cr(CW),TW=Vt({},Af,{relatedTarget:0}),Cb=cr(TW),IW=Vt({},pu,{animationName:0,elapsedTime:0,pseudoElement:0}),$W=cr(IW),EW=Vt({},pu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RW=cr(EW),AW=Vt({},pu,{data:0}),N$=cr(AW),_W={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=OW[t])?!!e[t]:!1}function yk(){return FW}var PW=Vt({},Af,{key:function(t){if(t.key){var e=_W[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Tg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?DW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yk,charCode:function(t){return t.type==="keypress"?Tg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Tg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),LW=cr(PW),MW=Vt({},x0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T$=cr(MW),BW=Vt({},Af,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yk}),zW=cr(BW),VW=Vt({},pu,{propertyName:0,elapsedTime:0,pseudoElement:0}),jW=cr(VW),UW=Vt({},x0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),WW=cr(UW),GW=[9,13,27,32],xk=eo&&"CompositionEvent"in window,Ch=null;eo&&"documentMode"in document&&(Ch=document.documentMode);var HW=eo&&"TextEvent"in window&&!Ch,tO=eo&&(!xk||Ch&&8<Ch&&11>=Ch),I$=" ",$$=!1;function nO(t,e){switch(t){case"keyup":return GW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var pc=!1;function qW(t,e){switch(t){case"compositionend":return sO(e);case"keypress":return e.which!==32?null:($$=!0,I$);case"textInput":return t=e.data,t===I$&&$$?null:t;default:return null}}function KW(t,e){if(pc)return t==="compositionend"||!xk&&nO(t,e)?(t=eO(),Ng=mk=Lo=null,pc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tO&&e.locale!=="ko"?null:e.data;default:return null}}var XW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function E$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!XW[t.type]:e==="textarea"}function rO(t,e,n,s){FD(s),e=uy(e,"onChange"),0<e.length&&(n=new gk("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Nh=null,Uh=null;function YW(t){mO(t,0)}function w0(t){var e=yc(t);if($D(e))return t}function JW(t,e){if(t==="change")return e}var iO=!1;if(eo){var Nb;if(eo){var Tb="oninput"in document;if(!Tb){var R$=document.createElement("div");R$.setAttribute("oninput","return;"),Tb=typeof R$.oninput=="function"}Nb=Tb}else Nb=!1;iO=Nb&&(!document.documentMode||9<document.documentMode)}function A$(){Nh&&(Nh.detachEvent("onpropertychange",oO),Uh=Nh=null)}function oO(t){if(t.propertyName==="value"&&w0(Uh)){var e=[];rO(e,Uh,t,uk(t)),BD(YW,e)}}function QW(t,e,n){t==="focusin"?(A$(),Nh=e,Uh=n,Nh.attachEvent("onpropertychange",oO)):t==="focusout"&&A$()}function ZW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return w0(Uh)}function eG(t,e){if(t==="click")return w0(e)}function tG(t,e){if(t==="input"||t==="change")return w0(e)}function nG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ei=typeof Object.is=="function"?Object.is:nG;function Wh(t,e){if(ei(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!I1.call(e,r)||!ei(t[r],e[r]))return!1}return!0}function _$(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function D$(t,e){var n=_$(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_$(n)}}function aO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?aO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function lO(){for(var t=window,e=sy();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sy(t.document)}return e}function wk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sG(t){var e=lO(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&aO(n.ownerDocument.documentElement,n)){if(s!==null&&wk(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=D$(n,i);var o=D$(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var rG=eo&&"documentMode"in document&&11>=document.documentMode,mc=null,H1=null,Th=null,q1=!1;function O$(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;q1||mc==null||mc!==sy(s)||(s=mc,"selectionStart"in s&&wk(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Th&&Wh(Th,s)||(Th=s,s=uy(H1,"onSelect"),0<s.length&&(e=new gk("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=mc)))}function jm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var gc={animationend:jm("Animation","AnimationEnd"),animationiteration:jm("Animation","AnimationIteration"),animationstart:jm("Animation","AnimationStart"),transitionend:jm("Transition","TransitionEnd")},Ib={},cO={};eo&&(cO=document.createElement("div").style,"AnimationEvent"in window||(delete gc.animationend.animation,delete gc.animationiteration.animation,delete gc.animationstart.animation),"TransitionEvent"in window||delete gc.transitionend.transition);function b0(t){if(Ib[t])return Ib[t];if(!gc[t])return t;var e=gc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in cO)return Ib[t]=e[n];return t}var uO=b0("animationend"),dO=b0("animationiteration"),hO=b0("animationstart"),fO=b0("transitionend"),pO=new Map,F$="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wa(t,e){pO.set(t,e),zl(e,[t])}for(var $b=0;$b<F$.length;$b++){var Eb=F$[$b],iG=Eb.toLowerCase(),oG=Eb[0].toUpperCase()+Eb.slice(1);wa(iG,"on"+oG)}wa(uO,"onAnimationEnd");wa(dO,"onAnimationIteration");wa(hO,"onAnimationStart");wa("dblclick","onDoubleClick");wa("focusin","onFocus");wa("focusout","onBlur");wa(fO,"onTransitionEnd");Vc("onMouseEnter",["mouseout","mouseover"]);Vc("onMouseLeave",["mouseout","mouseover"]);Vc("onPointerEnter",["pointerout","pointerover"]);Vc("onPointerLeave",["pointerout","pointerover"]);zl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zl("onBeforeInput",["compositionend","keypress","textInput","paste"]);zl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aG=new Set("cancel close invalid load scroll toggle".split(" ").concat(uh));function P$(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,iW(s,e,void 0,t),t.currentTarget=null}function mO(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;P$(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;P$(r,a,c),i=l}}}if(iy)throw t=j1,iy=!1,j1=null,t}function vt(t,e){var n=e[Q1];n===void 0&&(n=e[Q1]=new Set);var s=t+"__bubble";n.has(s)||(gO(e,t,2,!1),n.add(s))}function Rb(t,e,n){var s=0;e&&(s|=4),gO(n,t,s,e)}var Um="_reactListening"+Math.random().toString(36).slice(2);function Gh(t){if(!t[Um]){t[Um]=!0,kD.forEach(function(n){n!=="selectionchange"&&(aG.has(n)||Rb(n,!1,t),Rb(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Um]||(e[Um]=!0,Rb("selectionchange",!1,e))}}function gO(t,e,n,s){switch(ZD(e)){case 1:var r=vW;break;case 4:r=SW;break;default:r=pk}n=r.bind(null,e,n,t),r=void 0,!V1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Ab(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Xa(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}BD(function(){var c=i,u=uk(n),d=[];e:{var h=pO.get(t);if(h!==void 0){var f=gk,p=t;switch(t){case"keypress":if(Tg(n)===0)break e;case"keydown":case"keyup":f=LW;break;case"focusin":p="focus",f=Cb;break;case"focusout":p="blur",f=Cb;break;case"beforeblur":case"afterblur":f=Cb;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=C$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=NW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=zW;break;case uO:case dO:case hO:f=$W;break;case fO:f=jW;break;case"scroll":f=kW;break;case"wheel":f=WW;break;case"copy":case"cut":case"paste":f=RW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=T$}var m=(e&4)!==0,g=!m&&t==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var x=c,w;x!==null;){w=x;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,y!==null&&(b=Bh(x,y),b!=null&&m.push(Hh(x,b,w)))),g)break;x=x.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==B1&&(p=n.relatedTarget||n.fromElement)&&(Xa(p)||p[to]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Xa(p):null,p!==null&&(g=Vl(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=C$,b="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(m=T$,b="onPointerLeave",y="onPointerEnter",x="pointer"),g=f==null?h:yc(f),w=p==null?h:yc(p),h=new m(b,x+"leave",f,n,u),h.target=g,h.relatedTarget=w,b=null,Xa(u)===c&&(m=new m(y,x+"enter",p,n,u),m.target=w,m.relatedTarget=g,b=m),g=b,f&&p)t:{for(m=f,y=p,x=0,w=m;w;w=oc(w))x++;for(w=0,b=y;b;b=oc(b))w++;for(;0<x-w;)m=oc(m),x--;for(;0<w-x;)y=oc(y),w--;for(;x--;){if(m===y||y!==null&&m===y.alternate)break t;m=oc(m),y=oc(y)}m=null}else m=null;f!==null&&L$(d,h,f,m,!1),p!==null&&g!==null&&L$(d,g,p,m,!0)}}e:{if(h=c?yc(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var S=JW;else if(E$(h))if(iO)S=tG;else{S=ZW;var T=QW}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=eG);if(S&&(S=S(t,c))){rO(d,S,n,u);break e}T&&T(t,h,c),t==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&O1(h,"number",h.value)}switch(T=c?yc(c):window,t){case"focusin":(E$(T)||T.contentEditable==="true")&&(mc=T,H1=c,Th=null);break;case"focusout":Th=H1=mc=null;break;case"mousedown":q1=!0;break;case"contextmenu":case"mouseup":case"dragend":q1=!1,O$(d,n,u);break;case"selectionchange":if(rG)break;case"keydown":case"keyup":O$(d,n,u)}var I;if(xk)e:{switch(t){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else pc?nO(t,n)&&($="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&($="onCompositionStart");$&&(tO&&n.locale!=="ko"&&(pc||$!=="onCompositionStart"?$==="onCompositionEnd"&&pc&&(I=eO()):(Lo=u,mk="value"in Lo?Lo.value:Lo.textContent,pc=!0)),T=uy(c,$),0<T.length&&($=new N$($,t,null,n,u),d.push({event:$,listeners:T}),I?$.data=I:(I=sO(n),I!==null&&($.data=I)))),(I=HW?qW(t,n):KW(t,n))&&(c=uy(c,"onBeforeInput"),0<c.length&&(u=new N$("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=I))}mO(d,e)})}function Hh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function uy(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Bh(t,n),i!=null&&s.unshift(Hh(t,i,r)),i=Bh(t,e),i!=null&&s.push(Hh(t,i,r))),t=t.return}return s}function oc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function L$(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=Bh(n,i),l!=null&&o.unshift(Hh(n,l,a))):r||(l=Bh(n,i),l!=null&&o.push(Hh(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var lG=/\r\n?/g,cG=/\u0000|\uFFFD/g;function M$(t){return(typeof t=="string"?t:""+t).replace(lG,`
`).replace(cG,"")}function Wm(t,e,n){if(e=M$(e),M$(t)!==e&&n)throw Error(pe(425))}function dy(){}var K1=null,X1=null;function Y1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var J1=typeof setTimeout=="function"?setTimeout:void 0,uG=typeof clearTimeout=="function"?clearTimeout:void 0,B$=typeof Promise=="function"?Promise:void 0,dG=typeof queueMicrotask=="function"?queueMicrotask:typeof B$<"u"?function(t){return B$.resolve(null).then(t).catch(hG)}:J1;function hG(t){setTimeout(function(){throw t})}function _b(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),jh(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);jh(e)}function qo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function z$(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var mu=Math.random().toString(36).slice(2),xi="__reactFiber$"+mu,qh="__reactProps$"+mu,to="__reactContainer$"+mu,Q1="__reactEvents$"+mu,fG="__reactListeners$"+mu,pG="__reactHandles$"+mu;function Xa(t){var e=t[xi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[to]||n[xi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=z$(t);t!==null;){if(n=t[xi])return n;t=z$(t)}return e}t=n,n=t.parentNode}return null}function _f(t){return t=t[xi]||t[to],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function yc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(pe(33))}function v0(t){return t[qh]||null}var Z1=[],xc=-1;function ba(t){return{current:t}}function kt(t){0>xc||(t.current=Z1[xc],Z1[xc]=null,xc--)}function xt(t,e){xc++,Z1[xc]=t.current,t.current=e}var ia={},rs=ba(ia),Ds=ba(!1),pl=ia;function jc(t,e){var n=t.type.contextTypes;if(!n)return ia;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Os(t){return t=t.childContextTypes,t!=null}function hy(){kt(Ds),kt(rs)}function V$(t,e,n){if(rs.current!==ia)throw Error(pe(168));xt(rs,e),xt(Ds,n)}function yO(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(pe(108,QU(t)||"Unknown",r));return Vt({},n,s)}function fy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ia,pl=rs.current,xt(rs,t),xt(Ds,Ds.current),!0}function j$(t,e,n){var s=t.stateNode;if(!s)throw Error(pe(169));n?(t=yO(t,e,pl),s.__reactInternalMemoizedMergedChildContext=t,kt(Ds),kt(rs),xt(rs,t)):kt(Ds),xt(Ds,n)}var Wi=null,S0=!1,Db=!1;function xO(t){Wi===null?Wi=[t]:Wi.push(t)}function mG(t){S0=!0,xO(t)}function va(){if(!Db&&Wi!==null){Db=!0;var t=0,e=lt;try{var n=Wi;for(lt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Wi=null,S0=!1}catch(r){throw Wi!==null&&(Wi=Wi.slice(t+1)),UD(dk,va),r}finally{lt=e,Db=!1}}return null}var wc=[],bc=0,py=null,my=0,gr=[],yr=0,ml=null,Yi=1,Ji="";function Ba(t,e){wc[bc++]=my,wc[bc++]=py,py=t,my=e}function wO(t,e,n){gr[yr++]=Yi,gr[yr++]=Ji,gr[yr++]=ml,ml=t;var s=Yi;t=Ji;var r=32-Kr(s)-1;s&=~(1<<r),n+=1;var i=32-Kr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Yi=1<<32-Kr(e)+r|n<<r|s,Ji=i+t}else Yi=1<<i|n<<r|s,Ji=t}function bk(t){t.return!==null&&(Ba(t,1),wO(t,1,0))}function vk(t){for(;t===py;)py=wc[--bc],wc[bc]=null,my=wc[--bc],wc[bc]=null;for(;t===ml;)ml=gr[--yr],gr[yr]=null,Ji=gr[--yr],gr[yr]=null,Yi=gr[--yr],gr[yr]=null}var nr=null,Js=null,Rt=!1,Wr=null;function bO(t,e){var n=wr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function U$(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,nr=t,Js=qo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,nr=t,Js=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ml!==null?{id:Yi,overflow:Ji}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,nr=t,Js=null,!0):!1;default:return!1}}function ev(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tv(t){if(Rt){var e=Js;if(e){var n=e;if(!U$(t,e)){if(ev(t))throw Error(pe(418));e=qo(n.nextSibling);var s=nr;e&&U$(t,e)?bO(s,n):(t.flags=t.flags&-4097|2,Rt=!1,nr=t)}}else{if(ev(t))throw Error(pe(418));t.flags=t.flags&-4097|2,Rt=!1,nr=t}}}function W$(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;nr=t}function Gm(t){if(t!==nr)return!1;if(!Rt)return W$(t),Rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Y1(t.type,t.memoizedProps)),e&&(e=Js)){if(ev(t))throw vO(),Error(pe(418));for(;e;)bO(t,e),e=qo(e.nextSibling)}if(W$(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(pe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Js=qo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Js=null}}else Js=nr?qo(t.stateNode.nextSibling):null;return!0}function vO(){for(var t=Js;t;)t=qo(t.nextSibling)}function Uc(){Js=nr=null,Rt=!1}function Sk(t){Wr===null?Wr=[t]:Wr.push(t)}var gG=yo.ReactCurrentBatchConfig;function Kd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(pe(309));var s=n.stateNode}if(!s)throw Error(pe(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(pe(284));if(!n._owner)throw Error(pe(290,t))}return t}function Hm(t,e){throw t=Object.prototype.toString.call(e),Error(pe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function G$(t){var e=t._init;return e(t._payload)}function SO(t){function e(y,x){if(t){var w=y.deletions;w===null?(y.deletions=[x],y.flags|=16):w.push(x)}}function n(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function s(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function r(y,x){return y=Jo(y,x),y.index=0,y.sibling=null,y}function i(y,x,w){return y.index=w,t?(w=y.alternate,w!==null?(w=w.index,w<x?(y.flags|=2,x):w):(y.flags|=2,x)):(y.flags|=1048576,x)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,x,w,b){return x===null||x.tag!==6?(x=zb(w,y.mode,b),x.return=y,x):(x=r(x,w),x.return=y,x)}function l(y,x,w,b){var S=w.type;return S===fc?u(y,x,w.props.children,b,w.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ao&&G$(S)===x.type)?(b=r(x,w.props),b.ref=Kd(y,x,w),b.return=y,b):(b=Dg(w.type,w.key,w.props,null,y.mode,b),b.ref=Kd(y,x,w),b.return=y,b)}function c(y,x,w,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=Vb(w,y.mode,b),x.return=y,x):(x=r(x,w.children||[]),x.return=y,x)}function u(y,x,w,b,S){return x===null||x.tag!==7?(x=il(w,y.mode,b,S),x.return=y,x):(x=r(x,w),x.return=y,x)}function d(y,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=zb(""+x,y.mode,w),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Fm:return w=Dg(x.type,x.key,x.props,null,y.mode,w),w.ref=Kd(y,null,x),w.return=y,w;case hc:return x=Vb(x,y.mode,w),x.return=y,x;case Ao:var b=x._init;return d(y,b(x._payload),w)}if(lh(x)||Ud(x))return x=il(x,y.mode,w,null),x.return=y,x;Hm(y,x)}return null}function h(y,x,w,b){var S=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:a(y,x,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fm:return w.key===S?l(y,x,w,b):null;case hc:return w.key===S?c(y,x,w,b):null;case Ao:return S=w._init,h(y,x,S(w._payload),b)}if(lh(w)||Ud(w))return S!==null?null:u(y,x,w,b,null);Hm(y,w)}return null}function f(y,x,w,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(w)||null,a(x,y,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Fm:return y=y.get(b.key===null?w:b.key)||null,l(x,y,b,S);case hc:return y=y.get(b.key===null?w:b.key)||null,c(x,y,b,S);case Ao:var T=b._init;return f(y,x,w,T(b._payload),S)}if(lh(b)||Ud(b))return y=y.get(w)||null,u(x,y,b,S,null);Hm(x,b)}return null}function p(y,x,w,b){for(var S=null,T=null,I=x,$=x=0,_=null;I!==null&&$<w.length;$++){I.index>$?(_=I,I=null):_=I.sibling;var D=h(y,I,w[$],b);if(D===null){I===null&&(I=_);break}t&&I&&D.alternate===null&&e(y,I),x=i(D,x,$),T===null?S=D:T.sibling=D,T=D,I=_}if($===w.length)return n(y,I),Rt&&Ba(y,$),S;if(I===null){for(;$<w.length;$++)I=d(y,w[$],b),I!==null&&(x=i(I,x,$),T===null?S=I:T.sibling=I,T=I);return Rt&&Ba(y,$),S}for(I=s(y,I);$<w.length;$++)_=f(I,y,$,w[$],b),_!==null&&(t&&_.alternate!==null&&I.delete(_.key===null?$:_.key),x=i(_,x,$),T===null?S=_:T.sibling=_,T=_);return t&&I.forEach(function(z){return e(y,z)}),Rt&&Ba(y,$),S}function m(y,x,w,b){var S=Ud(w);if(typeof S!="function")throw Error(pe(150));if(w=S.call(w),w==null)throw Error(pe(151));for(var T=S=null,I=x,$=x=0,_=null,D=w.next();I!==null&&!D.done;$++,D=w.next()){I.index>$?(_=I,I=null):_=I.sibling;var z=h(y,I,D.value,b);if(z===null){I===null&&(I=_);break}t&&I&&z.alternate===null&&e(y,I),x=i(z,x,$),T===null?S=z:T.sibling=z,T=z,I=_}if(D.done)return n(y,I),Rt&&Ba(y,$),S;if(I===null){for(;!D.done;$++,D=w.next())D=d(y,D.value,b),D!==null&&(x=i(D,x,$),T===null?S=D:T.sibling=D,T=D);return Rt&&Ba(y,$),S}for(I=s(y,I);!D.done;$++,D=w.next())D=f(I,y,$,D.value,b),D!==null&&(t&&D.alternate!==null&&I.delete(D.key===null?$:D.key),x=i(D,x,$),T===null?S=D:T.sibling=D,T=D);return t&&I.forEach(function(H){return e(y,H)}),Rt&&Ba(y,$),S}function g(y,x,w,b){if(typeof w=="object"&&w!==null&&w.type===fc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Fm:e:{for(var S=w.key,T=x;T!==null;){if(T.key===S){if(S=w.type,S===fc){if(T.tag===7){n(y,T.sibling),x=r(T,w.props.children),x.return=y,y=x;break e}}else if(T.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ao&&G$(S)===T.type){n(y,T.sibling),x=r(T,w.props),x.ref=Kd(y,T,w),x.return=y,y=x;break e}n(y,T);break}else e(y,T);T=T.sibling}w.type===fc?(x=il(w.props.children,y.mode,b,w.key),x.return=y,y=x):(b=Dg(w.type,w.key,w.props,null,y.mode,b),b.ref=Kd(y,x,w),b.return=y,y=b)}return o(y);case hc:e:{for(T=w.key;x!==null;){if(x.key===T)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(y,x.sibling),x=r(x,w.children||[]),x.return=y,y=x;break e}else{n(y,x);break}else e(y,x);x=x.sibling}x=Vb(w,y.mode,b),x.return=y,y=x}return o(y);case Ao:return T=w._init,g(y,x,T(w._payload),b)}if(lh(w))return p(y,x,w,b);if(Ud(w))return m(y,x,w,b);Hm(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(y,x.sibling),x=r(x,w),x.return=y,y=x):(n(y,x),x=zb(w,y.mode,b),x.return=y,y=x),o(y)):n(y,x)}return g}var Wc=SO(!0),kO=SO(!1),gy=ba(null),yy=null,vc=null,kk=null;function Ck(){kk=vc=yy=null}function Nk(t){var e=gy.current;kt(gy),t._currentValue=e}function nv(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Oc(t,e){yy=t,kk=vc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rs=!0),t.firstContext=null)}function Ir(t){var e=t._currentValue;if(kk!==t)if(t={context:t,memoizedValue:e,next:null},vc===null){if(yy===null)throw Error(pe(308));vc=t,yy.dependencies={lanes:0,firstContext:t}}else vc=vc.next=t;return e}var Ya=null;function Tk(t){Ya===null?Ya=[t]:Ya.push(t)}function CO(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,Tk(e)):(n.next=r.next,r.next=n),e.interleaved=n,no(t,s)}function no(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var _o=!1;function Ik(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function NO(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ko(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,tt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,no(t,n)}return r=s.interleaved,r===null?(e.next=e,Tk(s)):(e.next=r.next,r.next=e),s.interleaved=e,no(t,n)}function Ig(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,hk(t,n)}}function H$(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xy(t,e,n,s){var r=t.updateQueue;_o=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=r.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Vt({},d,h);break e;case 2:_o=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);yl|=o,t.lanes=o,t.memoizedState=d}}function q$(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(pe(191,r));r.call(s)}}}var Df={},Ci=ba(Df),Kh=ba(Df),Xh=ba(Df);function Ja(t){if(t===Df)throw Error(pe(174));return t}function $k(t,e){switch(xt(Xh,e),xt(Kh,t),xt(Ci,Df),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:P1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=P1(e,t)}kt(Ci),xt(Ci,e)}function Gc(){kt(Ci),kt(Kh),kt(Xh)}function TO(t){Ja(Xh.current);var e=Ja(Ci.current),n=P1(e,t.type);e!==n&&(xt(Kh,t),xt(Ci,n))}function Ek(t){Kh.current===t&&(kt(Ci),kt(Kh))}var Lt=ba(0);function wy(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ob=[];function Rk(){for(var t=0;t<Ob.length;t++)Ob[t]._workInProgressVersionPrimary=null;Ob.length=0}var $g=yo.ReactCurrentDispatcher,Fb=yo.ReactCurrentBatchConfig,gl=0,zt=null,xn=null,En=null,by=!1,Ih=!1,Yh=0,yG=0;function Xn(){throw Error(pe(321))}function Ak(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ei(t[n],e[n]))return!1;return!0}function _k(t,e,n,s,r,i){if(gl=i,zt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,$g.current=t===null||t.memoizedState===null?vG:SG,t=n(s,r),Ih){i=0;do{if(Ih=!1,Yh=0,25<=i)throw Error(pe(301));i+=1,En=xn=null,e.updateQueue=null,$g.current=kG,t=n(s,r)}while(Ih)}if($g.current=vy,e=xn!==null&&xn.next!==null,gl=0,En=xn=zt=null,by=!1,e)throw Error(pe(300));return t}function Dk(){var t=Yh!==0;return Yh=0,t}function pi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?zt.memoizedState=En=t:En=En.next=t,En}function $r(){if(xn===null){var t=zt.alternate;t=t!==null?t.memoizedState:null}else t=xn.next;var e=En===null?zt.memoizedState:En.next;if(e!==null)En=e,xn=t;else{if(t===null)throw Error(pe(310));xn=t,t={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},En===null?zt.memoizedState=En=t:En=En.next=t}return En}function Jh(t,e){return typeof e=="function"?e(t):e}function Pb(t){var e=$r(),n=e.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=t;var s=xn,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((gl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=s):l=l.next=d,zt.lanes|=u,yl|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,ei(s,e.memoizedState)||(Rs=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,zt.lanes|=i,yl|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Lb(t){var e=$r(),n=e.queue;if(n===null)throw Error(pe(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);ei(i,e.memoizedState)||(Rs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function IO(){}function $O(t,e){var n=zt,s=$r(),r=e(),i=!ei(s.memoizedState,r);if(i&&(s.memoizedState=r,Rs=!0),s=s.queue,Ok(AO.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||En!==null&&En.memoizedState.tag&1){if(n.flags|=2048,Qh(9,RO.bind(null,n,s,r,e),void 0,null),Fn===null)throw Error(pe(349));gl&30||EO(n,e,r)}return r}function EO(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=zt.updateQueue,e===null?(e={lastEffect:null,stores:null},zt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function RO(t,e,n,s){e.value=n,e.getSnapshot=s,_O(e)&&DO(t)}function AO(t,e,n){return n(function(){_O(e)&&DO(t)})}function _O(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ei(t,n)}catch{return!0}}function DO(t){var e=no(t,1);e!==null&&Xr(e,t,1,-1)}function K$(t){var e=pi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jh,lastRenderedState:t},e.queue=t,t=t.dispatch=bG.bind(null,zt,t),[e.memoizedState,t]}function Qh(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=zt.updateQueue,e===null?(e={lastEffect:null,stores:null},zt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function OO(){return $r().memoizedState}function Eg(t,e,n,s){var r=pi();zt.flags|=t,r.memoizedState=Qh(1|e,n,void 0,s===void 0?null:s)}function k0(t,e,n,s){var r=$r();s=s===void 0?null:s;var i=void 0;if(xn!==null){var o=xn.memoizedState;if(i=o.destroy,s!==null&&Ak(s,o.deps)){r.memoizedState=Qh(e,n,i,s);return}}zt.flags|=t,r.memoizedState=Qh(1|e,n,i,s)}function X$(t,e){return Eg(8390656,8,t,e)}function Ok(t,e){return k0(2048,8,t,e)}function FO(t,e){return k0(4,2,t,e)}function PO(t,e){return k0(4,4,t,e)}function LO(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function MO(t,e,n){return n=n!=null?n.concat([t]):null,k0(4,4,LO.bind(null,e,t),n)}function Fk(){}function BO(t,e){var n=$r();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Ak(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function zO(t,e){var n=$r();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Ak(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function VO(t,e,n){return gl&21?(ei(n,e)||(n=HD(),zt.lanes|=n,yl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rs=!0),t.memoizedState=n)}function xG(t,e){var n=lt;lt=n!==0&&4>n?n:4,t(!0);var s=Fb.transition;Fb.transition={};try{t(!1),e()}finally{lt=n,Fb.transition=s}}function jO(){return $r().memoizedState}function wG(t,e,n){var s=Yo(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},UO(t))WO(e,n);else if(n=CO(t,e,n,s),n!==null){var r=ps();Xr(n,t,s,r),GO(n,e,s)}}function bG(t,e,n){var s=Yo(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(UO(t))WO(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,ei(a,o)){var l=e.interleaved;l===null?(r.next=r,Tk(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=CO(t,e,r,s),n!==null&&(r=ps(),Xr(n,t,s,r),GO(n,e,s))}}function UO(t){var e=t.alternate;return t===zt||e!==null&&e===zt}function WO(t,e){Ih=by=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function GO(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,hk(t,n)}}var vy={readContext:Ir,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useInsertionEffect:Xn,useLayoutEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useMutableSource:Xn,useSyncExternalStore:Xn,useId:Xn,unstable_isNewReconciler:!1},vG={readContext:Ir,useCallback:function(t,e){return pi().memoizedState=[t,e===void 0?null:e],t},useContext:Ir,useEffect:X$,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Eg(4194308,4,LO.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Eg(4194308,4,t,e)},useInsertionEffect:function(t,e){return Eg(4,2,t,e)},useMemo:function(t,e){var n=pi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=pi();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=wG.bind(null,zt,t),[s.memoizedState,t]},useRef:function(t){var e=pi();return t={current:t},e.memoizedState=t},useState:K$,useDebugValue:Fk,useDeferredValue:function(t){return pi().memoizedState=t},useTransition:function(){var t=K$(!1),e=t[0];return t=xG.bind(null,t[1]),pi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=zt,r=pi();if(Rt){if(n===void 0)throw Error(pe(407));n=n()}else{if(n=e(),Fn===null)throw Error(pe(349));gl&30||EO(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,X$(AO.bind(null,s,i,t),[t]),s.flags|=2048,Qh(9,RO.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=pi(),e=Fn.identifierPrefix;if(Rt){var n=Ji,s=Yi;n=(s&~(1<<32-Kr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Yh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},SG={readContext:Ir,useCallback:BO,useContext:Ir,useEffect:Ok,useImperativeHandle:MO,useInsertionEffect:FO,useLayoutEffect:PO,useMemo:zO,useReducer:Pb,useRef:OO,useState:function(){return Pb(Jh)},useDebugValue:Fk,useDeferredValue:function(t){var e=$r();return VO(e,xn.memoizedState,t)},useTransition:function(){var t=Pb(Jh)[0],e=$r().memoizedState;return[t,e]},useMutableSource:IO,useSyncExternalStore:$O,useId:jO,unstable_isNewReconciler:!1},kG={readContext:Ir,useCallback:BO,useContext:Ir,useEffect:Ok,useImperativeHandle:MO,useInsertionEffect:FO,useLayoutEffect:PO,useMemo:zO,useReducer:Lb,useRef:OO,useState:function(){return Lb(Jh)},useDebugValue:Fk,useDeferredValue:function(t){var e=$r();return xn===null?e.memoizedState=t:VO(e,xn.memoizedState,t)},useTransition:function(){var t=Lb(Jh)[0],e=$r().memoizedState;return[t,e]},useMutableSource:IO,useSyncExternalStore:$O,useId:jO,unstable_isNewReconciler:!1};function zr(t,e){if(t&&t.defaultProps){e=Vt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sv(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Vt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var C0={isMounted:function(t){return(t=t._reactInternals)?Vl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=ps(),r=Yo(t),i=Qi(s,r);i.payload=e,n!=null&&(i.callback=n),e=Ko(t,i,r),e!==null&&(Xr(e,t,r,s),Ig(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=ps(),r=Yo(t),i=Qi(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ko(t,i,r),e!==null&&(Xr(e,t,r,s),Ig(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ps(),s=Yo(t),r=Qi(n,s);r.tag=2,e!=null&&(r.callback=e),e=Ko(t,r,s),e!==null&&(Xr(e,t,s,n),Ig(e,t,s))}};function Y$(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Wh(n,s)||!Wh(r,i):!0}function HO(t,e,n){var s=!1,r=ia,i=e.contextType;return typeof i=="object"&&i!==null?i=Ir(i):(r=Os(e)?pl:rs.current,s=e.contextTypes,i=(s=s!=null)?jc(t,r):ia),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=C0,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function J$(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&C0.enqueueReplaceState(e,e.state,null)}function rv(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Ik(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Ir(i):(i=Os(e)?pl:rs.current,r.context=jc(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(sv(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&C0.enqueueReplaceState(r,r.state,null),xy(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Hc(t,e){try{var n="",s=e;do n+=JU(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function Mb(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function iv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var CG=typeof WeakMap=="function"?WeakMap:Map;function qO(t,e,n){n=Qi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){ky||(ky=!0,mv=s),iv(t,e)},n}function KO(t,e,n){n=Qi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){iv(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){iv(t,e),typeof s!="function"&&(Xo===null?Xo=new Set([this]):Xo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Q$(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new CG;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=MG.bind(null,t,e,n),e.then(t,t))}function Z$(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function eE(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qi(-1,1),e.tag=2,Ko(n,e,1))),n.lanes|=1),t)}var NG=yo.ReactCurrentOwner,Rs=!1;function us(t,e,n,s){e.child=t===null?kO(e,null,n,s):Wc(e,t.child,n,s)}function tE(t,e,n,s,r){n=n.render;var i=e.ref;return Oc(e,r),s=_k(t,e,n,s,i,r),n=Dk(),t!==null&&!Rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,so(t,e,r)):(Rt&&n&&bk(e),e.flags|=1,us(t,e,s,r),e.child)}function nE(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Uk(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,XO(t,e,i,s,r)):(t=Dg(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Wh,n(o,s)&&t.ref===e.ref)return so(t,e,r)}return e.flags|=1,t=Jo(i,s),t.ref=e.ref,t.return=e,e.child=t}function XO(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Wh(i,s)&&t.ref===e.ref)if(Rs=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Rs=!0);else return e.lanes=t.lanes,so(t,e,r)}return ov(t,e,n,s,r)}function YO(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(kc,Ks),Ks|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xt(kc,Ks),Ks|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,xt(kc,Ks),Ks|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,xt(kc,Ks),Ks|=s;return us(t,e,r,n),e.child}function JO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ov(t,e,n,s,r){var i=Os(n)?pl:rs.current;return i=jc(e,i),Oc(e,r),n=_k(t,e,n,s,i,r),s=Dk(),t!==null&&!Rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,so(t,e,r)):(Rt&&s&&bk(e),e.flags|=1,us(t,e,n,r),e.child)}function sE(t,e,n,s,r){if(Os(n)){var i=!0;fy(e)}else i=!1;if(Oc(e,r),e.stateNode===null)Rg(t,e),HO(e,n,s),rv(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Ir(c):(c=Os(n)?pl:rs.current,c=jc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&J$(e,o,s,c),_o=!1;var h=e.memoizedState;o.state=h,xy(e,s,o,r),l=e.memoizedState,a!==s||h!==l||Ds.current||_o?(typeof u=="function"&&(sv(e,n,u,s),l=e.memoizedState),(a=_o||Y$(e,n,a,s,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,NO(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:zr(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ir(l):(l=Os(n)?pl:rs.current,l=jc(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&J$(e,o,s,l),_o=!1,h=e.memoizedState,o.state=h,xy(e,s,o,r);var p=e.memoizedState;a!==d||h!==p||Ds.current||_o?(typeof f=="function"&&(sv(e,n,f,s),p=e.memoizedState),(c=_o||Y$(e,n,c,s,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return av(t,e,n,s,i,r)}function av(t,e,n,s,r,i){JO(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&j$(e,n,!1),so(t,e,i);s=e.stateNode,NG.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Wc(e,t.child,null,i),e.child=Wc(e,null,a,i)):us(t,e,a,i),e.memoizedState=s.state,r&&j$(e,n,!0),e.child}function QO(t){var e=t.stateNode;e.pendingContext?V$(t,e.pendingContext,e.pendingContext!==e.context):e.context&&V$(t,e.context,!1),$k(t,e.containerInfo)}function rE(t,e,n,s,r){return Uc(),Sk(r),e.flags|=256,us(t,e,n,s),e.child}var lv={dehydrated:null,treeContext:null,retryLane:0};function cv(t){return{baseLanes:t,cachePool:null,transitions:null}}function ZO(t,e,n){var s=e.pendingProps,r=Lt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),xt(Lt,r&1),t===null)return tv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=I0(o,s,0,null),t=il(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=cv(n),e.memoizedState=lv,t):Pk(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return TG(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Jo(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=Jo(a,i):(i=il(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?cv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=lv,s}return i=t.child,t=i.sibling,s=Jo(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Pk(t,e){return e=I0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function qm(t,e,n,s){return s!==null&&Sk(s),Wc(e,t.child,null,n),t=Pk(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function TG(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Mb(Error(pe(422))),qm(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=I0({mode:"visible",children:s.children},r,0,null),i=il(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Wc(e,t.child,null,o),e.child.memoizedState=cv(o),e.memoizedState=lv,i);if(!(e.mode&1))return qm(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(pe(419)),s=Mb(i,s,void 0),qm(t,e,o,s)}if(a=(o&t.childLanes)!==0,Rs||a){if(s=Fn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,no(t,r),Xr(s,t,r,-1))}return jk(),s=Mb(Error(pe(421))),qm(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=BG.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,Js=qo(r.nextSibling),nr=e,Rt=!0,Wr=null,t!==null&&(gr[yr++]=Yi,gr[yr++]=Ji,gr[yr++]=ml,Yi=t.id,Ji=t.overflow,ml=e),e=Pk(e,s.children),e.flags|=4096,e)}function iE(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),nv(t.return,e,n)}function Bb(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function eF(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(us(t,e,s.children,n),s=Lt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&iE(t,n,e);else if(t.tag===19)iE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(xt(Lt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&wy(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Bb(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&wy(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Bb(e,!0,n,null,i);break;case"together":Bb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Rg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function so(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),yl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(pe(153));if(e.child!==null){for(t=e.child,n=Jo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Jo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function IG(t,e,n){switch(e.tag){case 3:QO(e),Uc();break;case 5:TO(e);break;case 1:Os(e.type)&&fy(e);break;case 4:$k(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;xt(gy,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(xt(Lt,Lt.current&1),e.flags|=128,null):n&e.child.childLanes?ZO(t,e,n):(xt(Lt,Lt.current&1),t=so(t,e,n),t!==null?t.sibling:null);xt(Lt,Lt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return eF(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),xt(Lt,Lt.current),s)break;return null;case 22:case 23:return e.lanes=0,YO(t,e,n)}return so(t,e,n)}var tF,uv,nF,sF;tF=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uv=function(){};nF=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Ja(Ci.current);var i=null;switch(n){case"input":r=_1(t,r),s=_1(t,s),i=[];break;case"select":r=Vt({},r,{value:void 0}),s=Vt({},s,{value:void 0}),i=[];break;case"textarea":r=F1(t,r),s=F1(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=dy)}L1(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Lh.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Lh.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&vt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};sF=function(t,e,n,s){n!==s&&(e.flags|=4)};function Xd(t,e){if(!Rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Yn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function $G(t,e,n){var s=e.pendingProps;switch(vk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(e),null;case 1:return Os(e.type)&&hy(),Yn(e),null;case 3:return s=e.stateNode,Gc(),kt(Ds),kt(rs),Rk(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Gm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wr!==null&&(xv(Wr),Wr=null))),uv(t,e),Yn(e),null;case 5:Ek(e);var r=Ja(Xh.current);if(n=e.type,t!==null&&e.stateNode!=null)nF(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(pe(166));return Yn(e),null}if(t=Ja(Ci.current),Gm(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[xi]=e,s[qh]=i,t=(e.mode&1)!==0,n){case"dialog":vt("cancel",s),vt("close",s);break;case"iframe":case"object":case"embed":vt("load",s);break;case"video":case"audio":for(r=0;r<uh.length;r++)vt(uh[r],s);break;case"source":vt("error",s);break;case"img":case"image":case"link":vt("error",s),vt("load",s);break;case"details":vt("toggle",s);break;case"input":p$(s,i),vt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},vt("invalid",s);break;case"textarea":g$(s,i),vt("invalid",s)}L1(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&Wm(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Wm(s.textContent,a,t),r=["children",""+a]):Lh.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&vt("scroll",s)}switch(n){case"input":Pm(s),m$(s,i,!0);break;case"textarea":Pm(s),y$(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=dy)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=AD(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[xi]=e,t[qh]=s,tF(t,e,!1,!1),e.stateNode=t;e:{switch(o=M1(n,s),n){case"dialog":vt("cancel",t),vt("close",t),r=s;break;case"iframe":case"object":case"embed":vt("load",t),r=s;break;case"video":case"audio":for(r=0;r<uh.length;r++)vt(uh[r],t);r=s;break;case"source":vt("error",t),r=s;break;case"img":case"image":case"link":vt("error",t),vt("load",t),r=s;break;case"details":vt("toggle",t),r=s;break;case"input":p$(t,s),r=_1(t,s),vt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Vt({},s,{value:void 0}),vt("invalid",t);break;case"textarea":g$(t,s),r=F1(t,s),vt("invalid",t);break;default:r=s}L1(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?OD(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&_D(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Mh(t,l):typeof l=="number"&&Mh(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Lh.hasOwnProperty(i)?l!=null&&i==="onScroll"&&vt("scroll",t):l!=null&&ok(t,i,l,o))}switch(n){case"input":Pm(t),m$(t,s,!1);break;case"textarea":Pm(t),y$(t);break;case"option":s.value!=null&&t.setAttribute("value",""+ra(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Rc(t,!!s.multiple,i,!1):s.defaultValue!=null&&Rc(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=dy)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yn(e),null;case 6:if(t&&e.stateNode!=null)sF(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(pe(166));if(n=Ja(Xh.current),Ja(Ci.current),Gm(e)){if(s=e.stateNode,n=e.memoizedProps,s[xi]=e,(i=s.nodeValue!==n)&&(t=nr,t!==null))switch(t.tag){case 3:Wm(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wm(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[xi]=e,e.stateNode=s}return Yn(e),null;case 13:if(kt(Lt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Rt&&Js!==null&&e.mode&1&&!(e.flags&128))vO(),Uc(),e.flags|=98560,i=!1;else if(i=Gm(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(pe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(pe(317));i[xi]=e}else Uc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yn(e),i=!1}else Wr!==null&&(xv(Wr),Wr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Lt.current&1?bn===0&&(bn=3):jk())),e.updateQueue!==null&&(e.flags|=4),Yn(e),null);case 4:return Gc(),uv(t,e),t===null&&Gh(e.stateNode.containerInfo),Yn(e),null;case 10:return Nk(e.type._context),Yn(e),null;case 17:return Os(e.type)&&hy(),Yn(e),null;case 19:if(kt(Lt),i=e.memoizedState,i===null)return Yn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)Xd(i,!1);else{if(bn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=wy(t),o!==null){for(e.flags|=128,Xd(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xt(Lt,Lt.current&1|2),e.child}t=t.sibling}i.tail!==null&&tn()>qc&&(e.flags|=128,s=!0,Xd(i,!1),e.lanes=4194304)}else{if(!s)if(t=wy(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Xd(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Rt)return Yn(e),null}else 2*tn()-i.renderingStartTime>qc&&n!==1073741824&&(e.flags|=128,s=!0,Xd(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=tn(),e.sibling=null,n=Lt.current,xt(Lt,s?n&1|2:n&1),e):(Yn(e),null);case 22:case 23:return Vk(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Ks&1073741824&&(Yn(e),e.subtreeFlags&6&&(e.flags|=8192)):Yn(e),null;case 24:return null;case 25:return null}throw Error(pe(156,e.tag))}function EG(t,e){switch(vk(e),e.tag){case 1:return Os(e.type)&&hy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Gc(),kt(Ds),kt(rs),Rk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ek(e),null;case 13:if(kt(Lt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(pe(340));Uc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return kt(Lt),null;case 4:return Gc(),null;case 10:return Nk(e.type._context),null;case 22:case 23:return Vk(),null;case 24:return null;default:return null}}var Km=!1,Qn=!1,RG=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Sc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Gt(t,e,s)}else n.current=null}function dv(t,e,n){try{n()}catch(s){Gt(t,e,s)}}var oE=!1;function AG(t,e){if(K1=ly,t=lO(),wk(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==i||s!==0&&d.nodeType!==3||(l=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=o),h===i&&++u===s&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(X1={focusedElem:t,selectionRange:n},ly=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:zr(e.type,m),g);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(b){Gt(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return p=oE,oE=!1,p}function $h(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&dv(e,n,i)}r=r.next}while(r!==s)}}function N0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function hv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rF(t){var e=t.alternate;e!==null&&(t.alternate=null,rF(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xi],delete e[qh],delete e[Q1],delete e[fG],delete e[pG])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function iF(t){return t.tag===5||t.tag===3||t.tag===4}function aE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||iF(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fv(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=dy));else if(s!==4&&(t=t.child,t!==null))for(fv(t,e,n),t=t.sibling;t!==null;)fv(t,e,n),t=t.sibling}function pv(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(pv(t,e,n),t=t.sibling;t!==null;)pv(t,e,n),t=t.sibling}var Un=null,jr=!1;function $o(t,e,n){for(n=n.child;n!==null;)oF(t,e,n),n=n.sibling}function oF(t,e,n){if(ki&&typeof ki.onCommitFiberUnmount=="function")try{ki.onCommitFiberUnmount(y0,n)}catch{}switch(n.tag){case 5:Qn||Sc(n,e);case 6:var s=Un,r=jr;Un=null,$o(t,e,n),Un=s,jr=r,Un!==null&&(jr?(t=Un,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Un.removeChild(n.stateNode));break;case 18:Un!==null&&(jr?(t=Un,n=n.stateNode,t.nodeType===8?_b(t.parentNode,n):t.nodeType===1&&_b(t,n),jh(t)):_b(Un,n.stateNode));break;case 4:s=Un,r=jr,Un=n.stateNode.containerInfo,jr=!0,$o(t,e,n),Un=s,jr=r;break;case 0:case 11:case 14:case 15:if(!Qn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&dv(n,e,o),r=r.next}while(r!==s)}$o(t,e,n);break;case 1:if(!Qn&&(Sc(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Gt(n,e,a)}$o(t,e,n);break;case 21:$o(t,e,n);break;case 22:n.mode&1?(Qn=(s=Qn)||n.memoizedState!==null,$o(t,e,n),Qn=s):$o(t,e,n);break;default:$o(t,e,n)}}function lE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RG),e.forEach(function(s){var r=zG.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Fr(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Un=a.stateNode,jr=!1;break e;case 3:Un=a.stateNode.containerInfo,jr=!0;break e;case 4:Un=a.stateNode.containerInfo,jr=!0;break e}a=a.return}if(Un===null)throw Error(pe(160));oF(i,o,r),Un=null,jr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Gt(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)aF(e,t),e=e.sibling}function aF(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Fr(e,t),hi(t),s&4){try{$h(3,t,t.return),N0(3,t)}catch(m){Gt(t,t.return,m)}try{$h(5,t,t.return)}catch(m){Gt(t,t.return,m)}}break;case 1:Fr(e,t),hi(t),s&512&&n!==null&&Sc(n,n.return);break;case 5:if(Fr(e,t),hi(t),s&512&&n!==null&&Sc(n,n.return),t.flags&32){var r=t.stateNode;try{Mh(r,"")}catch(m){Gt(t,t.return,m)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&ED(r,i),M1(a,o);var c=M1(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?OD(r,d):u==="dangerouslySetInnerHTML"?_D(r,d):u==="children"?Mh(r,d):ok(r,u,d,c)}switch(a){case"input":D1(r,i);break;case"textarea":RD(r,i);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Rc(r,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Rc(r,!!i.multiple,i.defaultValue,!0):Rc(r,!!i.multiple,i.multiple?[]:"",!1))}r[qh]=i}catch(m){Gt(t,t.return,m)}}break;case 6:if(Fr(e,t),hi(t),s&4){if(t.stateNode===null)throw Error(pe(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(m){Gt(t,t.return,m)}}break;case 3:if(Fr(e,t),hi(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{jh(e.containerInfo)}catch(m){Gt(t,t.return,m)}break;case 4:Fr(e,t),hi(t);break;case 13:Fr(e,t),hi(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Bk=tn())),s&4&&lE(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Qn=(c=Qn)||u,Fr(e,t),Qn=c):Fr(e,t),hi(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ce=t,u=t.child;u!==null;){for(d=Ce=u;Ce!==null;){switch(h=Ce,f=h.child,h.tag){case 0:case 11:case 14:case 15:$h(4,h,h.return);break;case 1:Sc(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Gt(s,n,m)}}break;case 5:Sc(h,h.return);break;case 22:if(h.memoizedState!==null){uE(d);continue}}f!==null?(f.return=h,Ce=f):uE(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=DD("display",o))}catch(m){Gt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Gt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Fr(e,t),hi(t),s&4&&lE(t);break;case 21:break;default:Fr(e,t),hi(t)}}function hi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(iF(n)){var s=n;break e}n=n.return}throw Error(pe(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Mh(r,""),s.flags&=-33);var i=aE(t);pv(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=aE(t);fv(t,a,o);break;default:throw Error(pe(161))}}catch(l){Gt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _G(t,e,n){Ce=t,lF(t)}function lF(t,e,n){for(var s=(t.mode&1)!==0;Ce!==null;){var r=Ce,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||Km;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Qn;a=Km;var c=Qn;if(Km=o,(Qn=l)&&!c)for(Ce=r;Ce!==null;)o=Ce,l=o.child,o.tag===22&&o.memoizedState!==null?dE(r):l!==null?(l.return=o,Ce=l):dE(r);for(;i!==null;)Ce=i,lF(i),i=i.sibling;Ce=r,Km=a,Qn=c}cE(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,Ce=i):cE(t)}}function cE(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qn||N0(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Qn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:zr(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&q$(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}q$(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&jh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}Qn||e.flags&512&&hv(e)}catch(h){Gt(e,e.return,h)}}if(e===t){Ce=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function uE(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function dE(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{N0(4,e)}catch(l){Gt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Gt(e,r,l)}}var i=e.return;try{hv(e)}catch(l){Gt(e,i,l)}break;case 5:var o=e.return;try{hv(e)}catch(l){Gt(e,o,l)}}}catch(l){Gt(e,e.return,l)}if(e===t){Ce=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ce=a;break}Ce=e.return}}var DG=Math.ceil,Sy=yo.ReactCurrentDispatcher,Lk=yo.ReactCurrentOwner,Nr=yo.ReactCurrentBatchConfig,tt=0,Fn=null,cn=null,Gn=0,Ks=0,kc=ba(0),bn=0,Zh=null,yl=0,T0=0,Mk=0,Eh=null,$s=null,Bk=0,qc=1/0,Ui=null,ky=!1,mv=null,Xo=null,Xm=!1,Mo=null,Cy=0,Rh=0,gv=null,Ag=-1,_g=0;function ps(){return tt&6?tn():Ag!==-1?Ag:Ag=tn()}function Yo(t){return t.mode&1?tt&2&&Gn!==0?Gn&-Gn:gG.transition!==null?(_g===0&&(_g=HD()),_g):(t=lt,t!==0||(t=window.event,t=t===void 0?16:ZD(t.type)),t):1}function Xr(t,e,n,s){if(50<Rh)throw Rh=0,gv=null,Error(pe(185));Rf(t,n,s),(!(tt&2)||t!==Fn)&&(t===Fn&&(!(tt&2)&&(T0|=n),bn===4&&Fo(t,Gn)),Fs(t,s),n===1&&tt===0&&!(e.mode&1)&&(qc=tn()+500,S0&&va()))}function Fs(t,e){var n=t.callbackNode;gW(t,e);var s=ay(t,t===Fn?Gn:0);if(s===0)n!==null&&b$(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&b$(n),e===1)t.tag===0?mG(hE.bind(null,t)):xO(hE.bind(null,t)),dG(function(){!(tt&6)&&va()}),n=null;else{switch(qD(s)){case 1:n=dk;break;case 4:n=WD;break;case 16:n=oy;break;case 536870912:n=GD;break;default:n=oy}n=gF(n,cF.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function cF(t,e){if(Ag=-1,_g=0,tt&6)throw Error(pe(327));var n=t.callbackNode;if(Fc()&&t.callbackNode!==n)return null;var s=ay(t,t===Fn?Gn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Ny(t,s);else{e=s;var r=tt;tt|=2;var i=dF();(Fn!==t||Gn!==e)&&(Ui=null,qc=tn()+500,rl(t,e));do try{PG();break}catch(a){uF(t,a)}while(!0);Ck(),Sy.current=i,tt=r,cn!==null?e=0:(Fn=null,Gn=0,e=bn)}if(e!==0){if(e===2&&(r=U1(t),r!==0&&(s=r,e=yv(t,r))),e===1)throw n=Zh,rl(t,0),Fo(t,s),Fs(t,tn()),n;if(e===6)Fo(t,s);else{if(r=t.current.alternate,!(s&30)&&!OG(r)&&(e=Ny(t,s),e===2&&(i=U1(t),i!==0&&(s=i,e=yv(t,i))),e===1))throw n=Zh,rl(t,0),Fo(t,s),Fs(t,tn()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(pe(345));case 2:za(t,$s,Ui);break;case 3:if(Fo(t,s),(s&130023424)===s&&(e=Bk+500-tn(),10<e)){if(ay(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){ps(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=J1(za.bind(null,t,$s,Ui),e);break}za(t,$s,Ui);break;case 4:if(Fo(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-Kr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=tn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*DG(s/1960))-s,10<s){t.timeoutHandle=J1(za.bind(null,t,$s,Ui),s);break}za(t,$s,Ui);break;case 5:za(t,$s,Ui);break;default:throw Error(pe(329))}}}return Fs(t,tn()),t.callbackNode===n?cF.bind(null,t):null}function yv(t,e){var n=Eh;return t.current.memoizedState.isDehydrated&&(rl(t,e).flags|=256),t=Ny(t,e),t!==2&&(e=$s,$s=n,e!==null&&xv(e)),t}function xv(t){$s===null?$s=t:$s.push.apply($s,t)}function OG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!ei(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fo(t,e){for(e&=~Mk,e&=~T0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Kr(e),s=1<<n;t[n]=-1,e&=~s}}function hE(t){if(tt&6)throw Error(pe(327));Fc();var e=ay(t,0);if(!(e&1))return Fs(t,tn()),null;var n=Ny(t,e);if(t.tag!==0&&n===2){var s=U1(t);s!==0&&(e=s,n=yv(t,s))}if(n===1)throw n=Zh,rl(t,0),Fo(t,e),Fs(t,tn()),n;if(n===6)throw Error(pe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,za(t,$s,Ui),Fs(t,tn()),null}function zk(t,e){var n=tt;tt|=1;try{return t(e)}finally{tt=n,tt===0&&(qc=tn()+500,S0&&va())}}function xl(t){Mo!==null&&Mo.tag===0&&!(tt&6)&&Fc();var e=tt;tt|=1;var n=Nr.transition,s=lt;try{if(Nr.transition=null,lt=1,t)return t()}finally{lt=s,Nr.transition=n,tt=e,!(tt&6)&&va()}}function Vk(){Ks=kc.current,kt(kc)}function rl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,uG(n)),cn!==null)for(n=cn.return;n!==null;){var s=n;switch(vk(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&hy();break;case 3:Gc(),kt(Ds),kt(rs),Rk();break;case 5:Ek(s);break;case 4:Gc();break;case 13:kt(Lt);break;case 19:kt(Lt);break;case 10:Nk(s.type._context);break;case 22:case 23:Vk()}n=n.return}if(Fn=t,cn=t=Jo(t.current,null),Gn=Ks=e,bn=0,Zh=null,Mk=T0=yl=0,$s=Eh=null,Ya!==null){for(e=0;e<Ya.length;e++)if(n=Ya[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Ya=null}return t}function uF(t,e){do{var n=cn;try{if(Ck(),$g.current=vy,by){for(var s=zt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}by=!1}if(gl=0,En=xn=zt=null,Ih=!1,Yh=0,Lk.current=null,n===null||n.return===null){bn=1,Zh=e,cn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Gn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Z$(o);if(f!==null){f.flags&=-257,eE(f,o,a,i,e),f.mode&1&&Q$(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){Q$(i,c,e),jk();break e}l=Error(pe(426))}}else if(Rt&&a.mode&1){var g=Z$(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),eE(g,o,a,i,e),Sk(Hc(l,a));break e}}i=l=Hc(l,a),bn!==4&&(bn=2),Eh===null?Eh=[i]:Eh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=qO(i,l,e);H$(i,y);break e;case 1:a=l;var x=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Xo===null||!Xo.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=KO(i,a,e);H$(i,b);break e}}i=i.return}while(i!==null)}fF(n)}catch(S){e=S,cn===n&&n!==null&&(cn=n=n.return);continue}break}while(!0)}function dF(){var t=Sy.current;return Sy.current=vy,t===null?vy:t}function jk(){(bn===0||bn===3||bn===2)&&(bn=4),Fn===null||!(yl&268435455)&&!(T0&268435455)||Fo(Fn,Gn)}function Ny(t,e){var n=tt;tt|=2;var s=dF();(Fn!==t||Gn!==e)&&(Ui=null,rl(t,e));do try{FG();break}catch(r){uF(t,r)}while(!0);if(Ck(),tt=n,Sy.current=s,cn!==null)throw Error(pe(261));return Fn=null,Gn=0,bn}function FG(){for(;cn!==null;)hF(cn)}function PG(){for(;cn!==null&&!aW();)hF(cn)}function hF(t){var e=mF(t.alternate,t,Ks);t.memoizedProps=t.pendingProps,e===null?fF(t):cn=e,Lk.current=null}function fF(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=EG(n,e),n!==null){n.flags&=32767,cn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bn=6,cn=null;return}}else if(n=$G(n,e,Ks),n!==null){cn=n;return}if(e=e.sibling,e!==null){cn=e;return}cn=e=t}while(e!==null);bn===0&&(bn=5)}function za(t,e,n){var s=lt,r=Nr.transition;try{Nr.transition=null,lt=1,LG(t,e,n,s)}finally{Nr.transition=r,lt=s}return null}function LG(t,e,n,s){do Fc();while(Mo!==null);if(tt&6)throw Error(pe(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(pe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(yW(t,i),t===Fn&&(cn=Fn=null,Gn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xm||(Xm=!0,gF(oy,function(){return Fc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Nr.transition,Nr.transition=null;var o=lt;lt=1;var a=tt;tt|=4,Lk.current=null,AG(t,n),aF(n,t),sG(X1),ly=!!K1,X1=K1=null,t.current=n,_G(n),lW(),tt=a,lt=o,Nr.transition=i}else t.current=n;if(Xm&&(Xm=!1,Mo=t,Cy=r),i=t.pendingLanes,i===0&&(Xo=null),dW(n.stateNode),Fs(t,tn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(ky)throw ky=!1,t=mv,mv=null,t;return Cy&1&&t.tag!==0&&Fc(),i=t.pendingLanes,i&1?t===gv?Rh++:(Rh=0,gv=t):Rh=0,va(),null}function Fc(){if(Mo!==null){var t=qD(Cy),e=Nr.transition,n=lt;try{if(Nr.transition=null,lt=16>t?16:t,Mo===null)var s=!1;else{if(t=Mo,Mo=null,Cy=0,tt&6)throw Error(pe(331));var r=tt;for(tt|=4,Ce=t.current;Ce!==null;){var i=Ce,o=i.child;if(Ce.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Ce=c;Ce!==null;){var u=Ce;switch(u.tag){case 0:case 11:case 15:$h(8,u,i)}var d=u.child;if(d!==null)d.return=u,Ce=d;else for(;Ce!==null;){u=Ce;var h=u.sibling,f=u.return;if(rF(u),u===c){Ce=null;break}if(h!==null){h.return=f,Ce=h;break}Ce=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ce=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ce=o;else e:for(;Ce!==null;){if(i=Ce,i.flags&2048)switch(i.tag){case 0:case 11:case 15:$h(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Ce=y;break e}Ce=i.return}}var x=t.current;for(Ce=x;Ce!==null;){o=Ce;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Ce=w;else e:for(o=x;Ce!==null;){if(a=Ce,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:N0(9,a)}}catch(S){Gt(a,a.return,S)}if(a===o){Ce=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,Ce=b;break e}Ce=a.return}}if(tt=r,va(),ki&&typeof ki.onPostCommitFiberRoot=="function")try{ki.onPostCommitFiberRoot(y0,t)}catch{}s=!0}return s}finally{lt=n,Nr.transition=e}}return!1}function fE(t,e,n){e=Hc(n,e),e=qO(t,e,1),t=Ko(t,e,1),e=ps(),t!==null&&(Rf(t,1,e),Fs(t,e))}function Gt(t,e,n){if(t.tag===3)fE(t,t,n);else for(;e!==null;){if(e.tag===3){fE(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Xo===null||!Xo.has(s))){t=Hc(n,t),t=KO(e,t,1),e=Ko(e,t,1),t=ps(),e!==null&&(Rf(e,1,t),Fs(e,t));break}}e=e.return}}function MG(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=ps(),t.pingedLanes|=t.suspendedLanes&n,Fn===t&&(Gn&n)===n&&(bn===4||bn===3&&(Gn&130023424)===Gn&&500>tn()-Bk?rl(t,0):Mk|=n),Fs(t,e)}function pF(t,e){e===0&&(t.mode&1?(e=Bm,Bm<<=1,!(Bm&130023424)&&(Bm=4194304)):e=1);var n=ps();t=no(t,e),t!==null&&(Rf(t,e,n),Fs(t,n))}function BG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),pF(t,n)}function zG(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(pe(314))}s!==null&&s.delete(e),pF(t,n)}var mF;mF=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ds.current)Rs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Rs=!1,IG(t,e,n);Rs=!!(t.flags&131072)}else Rs=!1,Rt&&e.flags&1048576&&wO(e,my,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Rg(t,e),t=e.pendingProps;var r=jc(e,rs.current);Oc(e,n),r=_k(null,e,s,t,r,n);var i=Dk();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Os(s)?(i=!0,fy(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Ik(e),r.updater=C0,e.stateNode=r,r._reactInternals=e,rv(e,s,t,n),e=av(null,e,s,!0,i,n)):(e.tag=0,Rt&&i&&bk(e),us(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Rg(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=jG(s),t=zr(s,t),r){case 0:e=ov(null,e,s,t,n);break e;case 1:e=sE(null,e,s,t,n);break e;case 11:e=tE(null,e,s,t,n);break e;case 14:e=nE(null,e,s,zr(s.type,t),n);break e}throw Error(pe(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:zr(s,r),ov(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:zr(s,r),sE(t,e,s,r,n);case 3:e:{if(QO(e),t===null)throw Error(pe(387));s=e.pendingProps,i=e.memoizedState,r=i.element,NO(t,e),xy(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Hc(Error(pe(423)),e),e=rE(t,e,s,n,r);break e}else if(s!==r){r=Hc(Error(pe(424)),e),e=rE(t,e,s,n,r);break e}else for(Js=qo(e.stateNode.containerInfo.firstChild),nr=e,Rt=!0,Wr=null,n=kO(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Uc(),s===r){e=so(t,e,n);break e}us(t,e,s,n)}e=e.child}return e;case 5:return TO(e),t===null&&tv(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,Y1(s,r)?o=null:i!==null&&Y1(s,i)&&(e.flags|=32),JO(t,e),us(t,e,o,n),e.child;case 6:return t===null&&tv(e),null;case 13:return ZO(t,e,n);case 4:return $k(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Wc(e,null,s,n):us(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:zr(s,r),tE(t,e,s,r,n);case 7:return us(t,e,e.pendingProps,n),e.child;case 8:return us(t,e,e.pendingProps.children,n),e.child;case 12:return us(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,xt(gy,s._currentValue),s._currentValue=o,i!==null)if(ei(i.value,o)){if(i.children===r.children&&!Ds.current){e=so(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=Qi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),nv(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(pe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),nv(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}us(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Oc(e,n),r=Ir(r),s=s(r),e.flags|=1,us(t,e,s,n),e.child;case 14:return s=e.type,r=zr(s,e.pendingProps),r=zr(s.type,r),nE(t,e,s,r,n);case 15:return XO(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:zr(s,r),Rg(t,e),e.tag=1,Os(s)?(t=!0,fy(e)):t=!1,Oc(e,n),HO(e,s,r),rv(e,s,r,n),av(null,e,s,!0,t,n);case 19:return eF(t,e,n);case 22:return YO(t,e,n)}throw Error(pe(156,e.tag))};function gF(t,e){return UD(t,e)}function VG(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(t,e,n,s){return new VG(t,e,n,s)}function Uk(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jG(t){if(typeof t=="function")return Uk(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lk)return 11;if(t===ck)return 14}return 2}function Jo(t,e){var n=t.alternate;return n===null?(n=wr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Dg(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")Uk(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case fc:return il(n.children,r,i,e);case ak:o=8,r|=8;break;case $1:return t=wr(12,n,e,r|2),t.elementType=$1,t.lanes=i,t;case E1:return t=wr(13,n,e,r),t.elementType=E1,t.lanes=i,t;case R1:return t=wr(19,n,e,r),t.elementType=R1,t.lanes=i,t;case TD:return I0(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CD:o=10;break e;case ND:o=9;break e;case lk:o=11;break e;case ck:o=14;break e;case Ao:o=16,s=null;break e}throw Error(pe(130,t==null?t:typeof t,""))}return e=wr(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function il(t,e,n,s){return t=wr(7,t,s,e),t.lanes=n,t}function I0(t,e,n,s){return t=wr(22,t,s,e),t.elementType=TD,t.lanes=n,t.stateNode={isHidden:!1},t}function zb(t,e,n){return t=wr(6,t,null,e),t.lanes=n,t}function Vb(t,e,n){return e=wr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function UG(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vb(0),this.expirationTimes=vb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vb(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Wk(t,e,n,s,r,i,o,a,l){return t=new UG(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=wr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ik(i),t}function WG(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hc,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function yF(t){if(!t)return ia;t=t._reactInternals;e:{if(Vl(t)!==t||t.tag!==1)throw Error(pe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Os(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(pe(171))}if(t.tag===1){var n=t.type;if(Os(n))return yO(t,n,e)}return e}function xF(t,e,n,s,r,i,o,a,l){return t=Wk(n,s,!0,t,r,i,o,a,l),t.context=yF(null),n=t.current,s=ps(),r=Yo(n),i=Qi(s,r),i.callback=e??null,Ko(n,i,r),t.current.lanes=r,Rf(t,r,s),Fs(t,s),t}function $0(t,e,n,s){var r=e.current,i=ps(),o=Yo(r);return n=yF(n),e.context===null?e.context=n:e.pendingContext=n,e=Qi(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Ko(r,e,o),t!==null&&(Xr(t,r,o,i),Ig(t,r,o)),o}function Ty(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function pE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Gk(t,e){pE(t,e),(t=t.alternate)&&pE(t,e)}function GG(){return null}var wF=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hk(t){this._internalRoot=t}E0.prototype.render=Hk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(pe(409));$0(t,e,null,null)};E0.prototype.unmount=Hk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xl(function(){$0(null,t,null,null)}),e[to]=null}};function E0(t){this._internalRoot=t}E0.prototype.unstable_scheduleHydration=function(t){if(t){var e=YD();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oo.length&&e!==0&&e<Oo[n].priority;n++);Oo.splice(n,0,t),n===0&&QD(t)}};function qk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function R0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mE(){}function HG(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=Ty(o);i.call(c)}}var o=xF(e,s,t,0,null,!1,!1,"",mE);return t._reactRootContainer=o,t[to]=o.current,Gh(t.nodeType===8?t.parentNode:t),xl(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=Ty(l);a.call(c)}}var l=Wk(t,0,!1,null,null,!1,!1,"",mE);return t._reactRootContainer=l,t[to]=l.current,Gh(t.nodeType===8?t.parentNode:t),xl(function(){$0(e,l,n,s)}),l}function A0(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=Ty(o);a.call(l)}}$0(e,o,t,r)}else o=HG(n,e,t,r,s);return Ty(o)}KD=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ch(e.pendingLanes);n!==0&&(hk(e,n|1),Fs(e,tn()),!(tt&6)&&(qc=tn()+500,va()))}break;case 13:xl(function(){var s=no(t,1);if(s!==null){var r=ps();Xr(s,t,1,r)}}),Gk(t,1)}};fk=function(t){if(t.tag===13){var e=no(t,134217728);if(e!==null){var n=ps();Xr(e,t,134217728,n)}Gk(t,134217728)}};XD=function(t){if(t.tag===13){var e=Yo(t),n=no(t,e);if(n!==null){var s=ps();Xr(n,t,e,s)}Gk(t,e)}};YD=function(){return lt};JD=function(t,e){var n=lt;try{return lt=t,e()}finally{lt=n}};z1=function(t,e,n){switch(e){case"input":if(D1(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=v0(s);if(!r)throw Error(pe(90));$D(s),D1(s,r)}}}break;case"textarea":RD(t,n);break;case"select":e=n.value,e!=null&&Rc(t,!!n.multiple,e,!1)}};LD=zk;MD=xl;var qG={usingClientEntryPoint:!1,Events:[_f,yc,v0,FD,PD,zk]},Yd={findFiberByHostInstance:Xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KG={bundleType:Yd.bundleType,version:Yd.version,rendererPackageName:Yd.rendererPackageName,rendererConfig:Yd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=VD(t),t===null?null:t.stateNode},findFiberByHostInstance:Yd.findFiberByHostInstance||GG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ym=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ym.isDisabled&&Ym.supportsFiber)try{y0=Ym.inject(KG),ki=Ym}catch{}}lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qG;lr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qk(e))throw Error(pe(200));return WG(t,e,null,n)};lr.createRoot=function(t,e){if(!qk(t))throw Error(pe(299));var n=!1,s="",r=wF;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Wk(t,1,!1,null,null,n,!1,s,r),t[to]=e.current,Gh(t.nodeType===8?t.parentNode:t),new Hk(e)};lr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(pe(188)):(t=Object.keys(t).join(","),Error(pe(268,t)));return t=VD(e),t=t===null?null:t.stateNode,t};lr.flushSync=function(t){return xl(t)};lr.hydrate=function(t,e,n){if(!R0(e))throw Error(pe(200));return A0(null,t,e,!0,n)};lr.hydrateRoot=function(t,e,n){if(!qk(t))throw Error(pe(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=wF;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=xF(e,null,t,1,n??null,r,!1,i,o),t[to]=e.current,Gh(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new E0(e)};lr.render=function(t,e,n){if(!R0(e))throw Error(pe(200));return A0(null,t,e,!1,n)};lr.unmountComponentAtNode=function(t){if(!R0(t))throw Error(pe(40));return t._reactRootContainer?(xl(function(){A0(null,null,t,!1,function(){t._reactRootContainer=null,t[to]=null})}),!0):!1};lr.unstable_batchedUpdates=zk;lr.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!R0(n))throw Error(pe(200));if(t==null||t._reactInternals===void 0)throw Error(pe(38));return A0(t,e,n,!1,s)};lr.version="18.3.1-next-f1338f8080-20240426";function bF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bF)}catch(t){console.error(t)}}bF(),bD.exports=lr;var XG=bD.exports,vF,gE=XG;vF=gE.createRoot,gE.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ef(){return ef=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},ef.apply(this,arguments)}var Bo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Bo||(Bo={}));const yE="popstate";function YG(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return wv("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Iy(r)}return QG(e,n,null,t)}function sn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function SF(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JG(){return Math.random().toString(36).substr(2,8)}function xE(t,e){return{usr:t.state,key:t.key,idx:e}}function wv(t,e,n,s){return n===void 0&&(n=null),ef({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?gu(e):e,{state:n,key:e&&e.key||s||JG()})}function Iy(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function gu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function QG(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=Bo.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(ef({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Bo.Pop;let g=u(),y=g==null?null:g-c;c=g,l&&l({action:a,location:m.location,delta:y})}function h(g,y){a=Bo.Push;let x=wv(m.location,g,y);c=u()+1;let w=xE(x,c),b=m.createHref(x);try{o.pushState(w,"",b)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;r.location.assign(b)}i&&l&&l({action:a,location:m.location,delta:1})}function f(g,y){a=Bo.Replace;let x=wv(m.location,g,y);c=u();let w=xE(x,c),b=m.createHref(x);o.replaceState(w,"",b),i&&l&&l({action:a,location:m.location,delta:0})}function p(g){let y=r.location.origin!=="null"?r.location.origin:r.location.href,x=typeof g=="string"?g:Iy(g);return x=x.replace(/ $/,"%20"),sn(y,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,y)}let m={get action(){return a},get location(){return t(r,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(yE,d),l=g,()=>{r.removeEventListener(yE,d),l=null}},createHref(g){return e(r,g)},createURL:p,encodeLocation(g){let y=p(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:f,go(g){return o.go(g)}};return m}var wE;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(wE||(wE={}));function ZG(t,e,n){return n===void 0&&(n="/"),e6(t,e,n,!1)}function e6(t,e,n,s){let r=typeof e=="string"?gu(e):e,i=Kk(r.pathname||"/",n);if(i==null)return null;let o=kF(t);t6(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=h6(i);a=u6(o[l],c,s)}return a}function kF(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(sn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=Qo([s,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(sn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),kF(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:l6(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of CF(i.path))r(i,o,l)}),e}function CF(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=CF(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function t6(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:c6(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const n6=/^:[\w-]+$/,s6=3,r6=2,i6=1,o6=10,a6=-2,bE=t=>t==="*";function l6(t,e){let n=t.split("/"),s=n.length;return n.some(bE)&&(s+=a6),e&&(s+=r6),n.filter(r=>!bE(r)).reduce((r,i)=>r+(n6.test(i)?s6:i===""?i6:o6),s)}function c6(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function u6(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=vE({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!s[s.length-1].route.index&&(d=vE({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:Qo([i,d.pathname]),pathnameBase:g6(Qo([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=Qo([i,d.pathnameBase]))}return o}function vE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=d6(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let m=a[d]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return f&&!p?c[h]=void 0:c[h]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function d6(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),SF(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function h6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return SF(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Kk(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function f6(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?gu(t):t;return{pathname:n?n.startsWith("/")?n:p6(n,e):e,search:y6(s),hash:x6(r)}}function p6(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function jb(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function m6(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Xk(t,e){let n=m6(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Yk(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=gu(t):(r=ef({},t),sn(!r.pathname||!r.pathname.includes("?"),jb("?","pathname","search",r)),sn(!r.pathname||!r.pathname.includes("#"),jb("#","pathname","hash",r)),sn(!r.search||!r.search.includes("#"),jb("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;r.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=f6(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Qo=t=>t.join("/").replace(/\/\/+/g,"/"),g6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),y6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,x6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function w6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const NF=["post","put","patch","delete"];new Set(NF);const b6=["get",...NF];new Set(b6);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tf(){return tf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},tf.apply(this,arguments)}const Jk=F.createContext(null),v6=F.createContext(null),Sa=F.createContext(null),_0=F.createContext(null),xo=F.createContext({outlet:null,matches:[],isDataRoute:!1}),TF=F.createContext(null);function S6(t,e){let{relative:n}=e===void 0?{}:e;yu()||sn(!1);let{basename:s,navigator:r}=F.useContext(Sa),{hash:i,pathname:o,search:a}=$F(t,{relative:n}),l=o;return s!=="/"&&(l=o==="/"?s:Qo([s,o])),r.createHref({pathname:l,search:a,hash:i})}function yu(){return F.useContext(_0)!=null}function xu(){return yu()||sn(!1),F.useContext(_0).location}function IF(t){F.useContext(Sa).static||F.useLayoutEffect(t)}function Of(){let{isDataRoute:t}=F.useContext(xo);return t?F6():k6()}function k6(){yu()||sn(!1);let t=F.useContext(Jk),{basename:e,future:n,navigator:s}=F.useContext(Sa),{matches:r}=F.useContext(xo),{pathname:i}=xu(),o=JSON.stringify(Xk(r,n.v7_relativeSplatPath)),a=F.useRef(!1);return IF(()=>{a.current=!0}),F.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let d=Yk(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Qo([e,d.pathname])),(u.replace?s.replace:s.push)(d,u.state,u)},[e,s,o,i,t])}function X$e(){let{matches:t}=F.useContext(xo),e=t[t.length-1];return e?e.params:{}}function $F(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=F.useContext(Sa),{matches:r}=F.useContext(xo),{pathname:i}=xu(),o=JSON.stringify(Xk(r,s.v7_relativeSplatPath));return F.useMemo(()=>Yk(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function C6(t,e){return N6(t,e)}function N6(t,e,n,s){yu()||sn(!1);let{navigator:r}=F.useContext(Sa),{matches:i}=F.useContext(xo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=xu(),u;if(e){var d;let g=typeof e=="string"?gu(e):e;l==="/"||(d=g.pathname)!=null&&d.startsWith(l)||sn(!1),u=g}else u=c;let h=u.pathname||"/",f=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=ZG(t,{pathname:f}),m=R6(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:Qo([l,r.encodeLocation?r.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:Qo([l,r.encodeLocation?r.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,s);return e&&m?F.createElement(_0.Provider,{value:{location:tf({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Bo.Pop}},m):m}function T6(){let t=O6(),e=w6(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),n?F.createElement("pre",{style:r},n):null,null)}const I6=F.createElement(T6,null);class $6 extends F.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?F.createElement(xo.Provider,{value:this.props.routeContext},F.createElement(TF.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function E6(t){let{routeContext:e,match:n,children:s}=t,r=F.useContext(Jk);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),F.createElement(xo.Provider,{value:e},s)}function R6(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||sn(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=n,p=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,h)=>{let f,p=!1,m=null,g=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||I6,l&&(c<0&&h===0?(p=!0,g=null):c===h&&(p=!0,g=d.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,h+1)),x=()=>{let w;return f?w=m:p?w=g:d.route.Component?w=F.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=u,F.createElement(E6,{match:d,routeContext:{outlet:u,matches:y,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?F.createElement($6,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}var EF=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(EF||{}),$y=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}($y||{});function A6(t){let e=F.useContext(Jk);return e||sn(!1),e}function _6(t){let e=F.useContext(v6);return e||sn(!1),e}function D6(t){let e=F.useContext(xo);return e||sn(!1),e}function RF(t){let e=D6(),n=e.matches[e.matches.length-1];return n.route.id||sn(!1),n.route.id}function O6(){var t;let e=F.useContext(TF),n=_6($y.UseRouteError),s=RF($y.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function F6(){let{router:t}=A6(EF.UseNavigateStable),e=RF($y.UseNavigateStable),n=F.useRef(!1);return IF(()=>{n.current=!0}),F.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,tf({fromRouteId:e},i)))},[t,e])}const SE={};function P6(t,e){SE[e]||(SE[e]=!0,console.warn(e))}const kE=(t,e,n)=>P6(t," React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function L6(t,e){t!=null&&t.v7_startTransition||kE("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(t!=null&&t.v7_relativeSplatPath)&&!e&&kE("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function Pt(t){let{to:e,replace:n,state:s,relative:r}=t;yu()||sn(!1);let{future:i,static:o}=F.useContext(Sa),{matches:a}=F.useContext(xo),{pathname:l}=xu(),c=Of(),u=Yk(e,Xk(a,i.v7_relativeSplatPath),l,r==="path"),d=JSON.stringify(u);return F.useEffect(()=>c(JSON.parse(d),{replace:n,state:s,relative:r}),[c,d,r,n,s]),null}function jn(t){sn(!1)}function M6(t){let{basename:e="/",children:n=null,location:s,navigationType:r=Bo.Pop,navigator:i,static:o=!1,future:a}=t;yu()&&sn(!1);let l=e.replace(/^\/*/,"/"),c=F.useMemo(()=>({basename:l,navigator:i,static:o,future:tf({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=gu(s));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=s,m=F.useMemo(()=>{let g=Kk(u,l);return g==null?null:{location:{pathname:g,search:d,hash:h,state:f,key:p},navigationType:r}},[l,u,d,h,f,p,r]);return m==null?null:F.createElement(Sa.Provider,{value:c},F.createElement(_0.Provider,{children:n,value:m}))}function B6(t){let{children:e,location:n}=t;return C6(bv(e),n)}new Promise(()=>{});function bv(t,e){e===void 0&&(e=[]);let n=[];return F.Children.forEach(t,(s,r)=>{if(!F.isValidElement(s))return;let i=[...e,r];if(s.type===F.Fragment){n.push.apply(n,bv(s.props.children,i));return}s.type!==jn&&sn(!1),!s.props.index||!s.props.children||sn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=bv(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vv(){return vv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vv.apply(this,arguments)}function z6(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function V6(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function j6(t,e){return t.button===0&&(!e||e==="_self")&&!V6(t)}const U6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],W6="6";try{window.__reactRouterVersion=W6}catch{}const G6="startTransition",CE=MU[G6];function H6(t){let{basename:e,children:n,future:s,window:r}=t,i=F.useRef();i.current==null&&(i.current=YG({window:r,v5Compat:!0}));let o=i.current,[a,l]=F.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=F.useCallback(d=>{c&&CE?CE(()=>l(d)):l(d)},[l,c]);return F.useLayoutEffect(()=>o.listen(u),[o,u]),F.useEffect(()=>L6(s),[s]),F.createElement(M6,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}const q6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",K6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wi=F.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=z6(e,U6),{basename:f}=F.useContext(Sa),p,m=!1;if(typeof c=="string"&&K6.test(c)&&(p=c,q6))try{let w=new URL(window.location.href),b=c.startsWith("//")?new URL(w.protocol+c):new URL(c),S=Kk(b.pathname,f);b.origin===w.origin&&S!=null?c=S+b.search+b.hash:m=!0}catch{}let g=S6(c,{relative:r}),y=X6(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,viewTransition:d});function x(w){s&&s(w),w.defaultPrevented||y(w)}return F.createElement("a",vv({},h,{href:p||g,onClick:m||i?s:x,ref:n,target:l}))});var NE;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(NE||(NE={}));var TE;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(TE||(TE={}));function X6(t,e){let{target:n,replace:s,state:r,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=Of(),c=xu(),u=$F(t,{relative:o});return F.useCallback(d=>{if(j6(d,n)){d.preventDefault();let h=s!==void 0?s:Iy(c)===Iy(u);l(t,{replace:h,state:r,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,s,r,n,t,i,o,a])}let Y6={data:""},J6=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||Y6,Q6=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Z6=/\/\*[^]*?\*\/|  +/g,IE=/\n+/g,Po=(t,e)=>{let n="",s="",r="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":s+=i[1]=="f"?Po(o,i):i+"{"+Po(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=Po(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Po.p?Po.p(i,o):i+":"+o+";")}return n+(e&&r?e+"{"+r+"}":r)+s},Vi={},AF=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+AF(t[n]);return e}return t},e5=(t,e,n,s,r)=>{let i=AF(t),o=Vi[i]||(Vi[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!Vi[o]){let l=i!==t?t:(c=>{let u,d,h=[{}];for(;u=Q6.exec(c.replace(Z6,""));)u[4]?h.shift():u[3]?(d=u[3].replace(IE," ").trim(),h.unshift(h[0][d]=h[0][d]||{})):h[0][u[1]]=u[2].replace(IE," ").trim();return h[0]})(t);Vi[o]=Po(r?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&Vi.g?Vi.g:null;return n&&(Vi.g=Vi[o]),((l,c,u,d)=>{d?c.data=c.data.replace(d,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(Vi[o],e,s,a),o},t5=(t,e,n)=>t.reduce((s,r,i)=>{let o=e[i];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Po(a,""):a===!1?"":a}return s+r+(o??"")},"");function D0(t){let e=this||{},n=t.call?t(e.p):t;return e5(n.unshift?n.raw?t5(n,[].slice.call(arguments,1),e.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):n,J6(e.target),e.g,e.o,e.k)}let _F,Sv,kv;D0.bind({g:1});let ro=D0.bind({k:1});function n5(t,e,n,s){Po.p=e,_F=t,Sv=n,kv=s}function ka(t,e){let n=this||{};return function(){let s=arguments;function r(i,o){let a=Object.assign({},i),l=a.className||r.className;n.p=Object.assign({theme:Sv&&Sv()},a),n.o=/ *go\d+/.test(l),a.className=D0.apply(n,s)+(l?" "+l:"");let c=t;return t[0]&&(c=a.as||t,delete a.as),kv&&c[0]&&kv(a),_F(c,a)}return r}}var s5=t=>typeof t=="function",Ey=(t,e)=>s5(t)?t(e):t,r5=(()=>{let t=0;return()=>(++t).toString()})(),DF=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),i5=20,Og=new Map,o5=1e3,$E=t=>{if(Og.has(t))return;let e=setTimeout(()=>{Og.delete(t),jl({type:4,toastId:t})},o5);Og.set(t,e)},a5=t=>{let e=Og.get(t);e&&clearTimeout(e)},Cv=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,i5)};case 1:return e.toast.id&&a5(e.toast.id),{...t,toasts:t.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:n}=e;return t.toasts.find(i=>i.id===n.id)?Cv(t,{type:1,toast:n}):Cv(t,{type:0,toast:n});case 3:let{toastId:s}=e;return s?$E(s):t.toasts.forEach(i=>{$E(i.id)}),{...t,toasts:t.toasts.map(i=>i.id===s||s===void 0?{...i,visible:!1}:i)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let r=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+r}))}}},Fg=[],Pg={toasts:[],pausedAt:void 0},jl=t=>{Pg=Cv(Pg,t),Fg.forEach(e=>{e(Pg)})},l5={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},c5=(t={})=>{let[e,n]=F.useState(Pg);F.useEffect(()=>(Fg.push(n),()=>{let r=Fg.indexOf(n);r>-1&&Fg.splice(r,1)}),[e]);let s=e.toasts.map(r=>{var i,o;return{...t,...t[r.type],...r,duration:r.duration||((i=t[r.type])==null?void 0:i.duration)||(t==null?void 0:t.duration)||l5[r.type],style:{...t.style,...(o=t[r.type])==null?void 0:o.style,...r.style}}});return{...e,toasts:s}},u5=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||r5()}),Ff=t=>(e,n)=>{let s=u5(e,t,n);return jl({type:2,toast:s}),s.id},yt=(t,e)=>Ff("blank")(t,e);yt.error=Ff("error");yt.success=Ff("success");yt.loading=Ff("loading");yt.custom=Ff("custom");yt.dismiss=t=>{jl({type:3,toastId:t})};yt.remove=t=>jl({type:4,toastId:t});yt.promise=(t,e,n)=>{let s=yt.loading(e.loading,{...n,...n==null?void 0:n.loading});return t.then(r=>(yt.success(Ey(e.success,r),{id:s,...n,...n==null?void 0:n.success}),r)).catch(r=>{yt.error(Ey(e.error,r),{id:s,...n,...n==null?void 0:n.error})}),t};var d5=(t,e)=>{jl({type:1,toast:{id:t,height:e}})},h5=()=>{jl({type:5,time:Date.now()})},f5=t=>{let{toasts:e,pausedAt:n}=c5(t);F.useEffect(()=>{if(n)return;let i=Date.now(),o=e.map(a=>{if(a.duration===1/0)return;let l=(a.duration||0)+a.pauseDuration-(i-a.createdAt);if(l<0){a.visible&&yt.dismiss(a.id);return}return setTimeout(()=>yt.dismiss(a.id),l)});return()=>{o.forEach(a=>a&&clearTimeout(a))}},[e,n]);let s=F.useCallback(()=>{n&&jl({type:6,time:Date.now()})},[n]),r=F.useCallback((i,o)=>{let{reverseOrder:a=!1,gutter:l=8,defaultPosition:c}=o||{},u=e.filter(f=>(f.position||c)===(i.position||c)&&f.height),d=u.findIndex(f=>f.id===i.id),h=u.filter((f,p)=>p<d&&f.visible).length;return u.filter(f=>f.visible).slice(...a?[h+1]:[0,h]).reduce((f,p)=>f+(p.height||0)+l,0)},[e]);return{toasts:e,handlers:{updateHeight:d5,startPause:h5,endPause:s,calculateOffset:r}}},p5=ro`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,m5=ro`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,g5=ro`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,y5=ka("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${p5} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${m5} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${g5} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,x5=ro`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,w5=ka("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${x5} 1s linear infinite;
`,b5=ro`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,v5=ro`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,S5=ka("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${b5} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${v5} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,k5=ka("div")`
  position: absolute;
`,C5=ka("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,N5=ro`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,T5=ka("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${N5} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,I5=({toast:t})=>{let{icon:e,type:n,iconTheme:s}=t;return e!==void 0?typeof e=="string"?F.createElement(T5,null,e):e:n==="blank"?null:F.createElement(C5,null,F.createElement(w5,{...s}),n!=="loading"&&F.createElement(k5,null,n==="error"?F.createElement(y5,{...s}):F.createElement(S5,{...s})))},$5=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,E5=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,R5="0%{opacity:0;} 100%{opacity:1;}",A5="0%{opacity:1;} 100%{opacity:0;}",_5=ka("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,D5=ka("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,O5=(t,e)=>{let n=t.includes("top")?1:-1,[s,r]=DF()?[R5,A5]:[$5(n),E5(n)];return{animation:e?`${ro(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ro(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},F5=F.memo(({toast:t,position:e,style:n,children:s})=>{let r=t.height?O5(t.position||e||"top-center",t.visible):{opacity:0},i=F.createElement(I5,{toast:t}),o=F.createElement(D5,{...t.ariaProps},Ey(t.message,t));return F.createElement(_5,{className:t.className,style:{...r,...n,...t.style}},typeof s=="function"?s({icon:i,message:o}):F.createElement(F.Fragment,null,i,o))});n5(F.createElement);var P5=({id:t,className:e,style:n,onHeightUpdate:s,children:r})=>{let i=F.useCallback(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;s(t,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return F.createElement("div",{ref:i,className:e,style:n},r)},L5=(t,e)=>{let n=t.includes("top"),s=n?{top:0}:{bottom:0},r=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:DF()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...s,...r}},M5=D0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Jm=16,B5=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:s,children:r,containerStyle:i,containerClassName:o})=>{let{toasts:a,handlers:l}=f5(n);return F.createElement("div",{style:{position:"fixed",zIndex:9999,top:Jm,left:Jm,right:Jm,bottom:Jm,pointerEvents:"none",...i},className:o,onMouseEnter:l.startPause,onMouseLeave:l.endPause},a.map(c=>{let u=c.position||e,d=l.calculateOffset(c,{reverseOrder:t,gutter:s,defaultPosition:e}),h=L5(u,d);return F.createElement(P5,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?M5:"",style:h},c.type==="custom"?Ey(c.message,c):r?r(c):F.createElement(F5,{toast:c,position:u}))}))},ve=yt;const Qk=F.createContext({});function Zk(t){const e=F.useRef(null);return e.current===null&&(e.current=t()),e.current}const eC=typeof window<"u",OF=eC?F.useLayoutEffect:F.useEffect,O0=F.createContext(null);function tC(t,e){t.indexOf(e)===-1&&t.push(e)}function nC(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const io=(t,e,n)=>n>e?e:n<t?t:n;let Ry=()=>{};const oo={},FF=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function PF(t){return typeof t=="object"&&t!==null}const LF=t=>/^0[^.\s]+$/u.test(t);function sC(t){let e;return()=>(e===void 0&&(e=t()),e)}const Tr=t=>t,z5=(t,e)=>n=>e(t(n)),Pf=(...t)=>t.reduce(z5),nf=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s};class rC{constructor(){this.subscriptions=[]}add(e){return tC(this.subscriptions,e),()=>nC(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ni=t=>t*1e3,br=t=>t/1e3;function MF(t,e){return e?t*(1e3/e):0}const BF=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,V5=1e-7,j5=12;function U5(t,e,n,s,r){let i,o,a=0;do o=e+(n-e)/2,i=BF(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>V5&&++a<j5);return o}function Lf(t,e,n,s){if(t===e&&n===s)return Tr;const r=i=>U5(i,0,1,t,n);return i=>i===0||i===1?i:BF(r(i),e,s)}const zF=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,VF=t=>e=>1-t(1-e),jF=Lf(.33,1.53,.69,.99),iC=VF(jF),UF=zF(iC),WF=t=>(t*=2)<1?.5*iC(t):.5*(2-Math.pow(2,-10*(t-1))),oC=t=>1-Math.sin(Math.acos(t)),GF=VF(oC),HF=zF(oC),W5=Lf(.42,0,1,1),G5=Lf(0,0,.58,1),qF=Lf(.42,0,.58,1),H5=t=>Array.isArray(t)&&typeof t[0]!="number",KF=t=>Array.isArray(t)&&typeof t[0]=="number",EE={linear:Tr,easeIn:W5,easeInOut:qF,easeOut:G5,circIn:oC,circInOut:HF,circOut:GF,backIn:iC,backInOut:UF,backOut:jF,anticipate:WF},q5=t=>typeof t=="string",RE=t=>{if(KF(t)){Ry(t.length===4);const[e,n,s,r]=t;return Lf(e,n,s,r)}else if(q5(t))return Ry(EE[t]!==void 0),EE[t];return t},Qm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],AE={value:null,addProjectionMetrics:null};function K5(t,e){let n=new Set,s=new Set,r=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){o.has(d)&&(u.schedule(d),t()),l++,d(a)}const u={schedule:(d,h=!1,f=!1)=>{const m=f&&r?n:s;return h&&o.add(d),m.has(d)||m.add(d),d},cancel:d=>{s.delete(d),o.delete(d)},process:d=>{if(a=d,r){i=!0;return}r=!0,[n,s]=[s,n],n.forEach(c),e&&AE.value&&AE.value.frameloop[e].push(l),l=0,n.clear(),r=!1,i&&(i=!1,u.process(d))}};return u}const X5=40;function XF(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Qm.reduce((w,b)=>(w[b]=K5(i,e?b:void 0),w),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:f,postRender:p}=o,m=()=>{const w=oo.useManualTiming?r.timestamp:performance.now();n=!1,oo.useManualTiming||(r.delta=s?1e3/60:Math.max(Math.min(w-r.timestamp,X5),1)),r.timestamp=w,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),d.process(r),h.process(r),f.process(r),p.process(r),r.isProcessing=!1,n&&e&&(s=!1,t(m))},g=()=>{n=!0,s=!0,r.isProcessing||t(m)};return{schedule:Qm.reduce((w,b)=>{const S=o[b];return w[b]=(T,I=!1,$=!1)=>(n||g(),S.schedule(T,I,$)),w},{}),cancel:w=>{for(let b=0;b<Qm.length;b++)o[Qm[b]].cancel(w)},state:r,steps:o}}const{schedule:_t,cancel:oa,state:Wn,steps:Ub}=XF(typeof requestAnimationFrame<"u"?requestAnimationFrame:Tr,!0);let Lg;function Y5(){Lg=void 0}const As={now:()=>(Lg===void 0&&As.set(Wn.isProcessing||oo.useManualTiming?Wn.timestamp:performance.now()),Lg),set:t=>{Lg=t,queueMicrotask(Y5)}},YF=t=>e=>typeof e=="string"&&e.startsWith(t),aC=YF("--"),J5=YF("var(--"),lC=t=>J5(t)?Q5.test(t.split("/*")[0].trim()):!1,Q5=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,wu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},sf={...wu,transform:t=>io(0,1,t)},Zm={...wu,default:1},Ah=t=>Math.round(t*1e5)/1e5,cC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Z5(t){return t==null}const eH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,uC=(t,e)=>n=>!!(typeof n=="string"&&eH.test(n)&&n.startsWith(t)||e&&!Z5(n)&&Object.prototype.hasOwnProperty.call(n,e)),JF=(t,e,n)=>s=>{if(typeof s!="string")return s;const[r,i,o,a]=s.match(cC);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},tH=t=>io(0,255,t),Wb={...wu,transform:t=>Math.round(tH(t))},Qa={test:uC("rgb","red"),parse:JF("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Wb.transform(t)+", "+Wb.transform(e)+", "+Wb.transform(n)+", "+Ah(sf.transform(s))+")"};function nH(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const Nv={test:uC("#"),parse:nH,transform:Qa.transform},Mf=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Eo=Mf("deg"),Ti=Mf("%"),De=Mf("px"),sH=Mf("vh"),rH=Mf("vw"),_E={...Ti,parse:t=>Ti.parse(t)/100,transform:t=>Ti.transform(t*100)},Cc={test:uC("hsl","hue"),parse:JF("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+Ti.transform(Ah(e))+", "+Ti.transform(Ah(n))+", "+Ah(sf.transform(s))+")"},an={test:t=>Qa.test(t)||Nv.test(t)||Cc.test(t),parse:t=>Qa.test(t)?Qa.parse(t):Cc.test(t)?Cc.parse(t):Nv.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Qa.transform(t):Cc.transform(t),getAnimatableNone:t=>{const e=an.parse(t);return e.alpha=0,an.transform(e)}},iH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function oH(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(cC))==null?void 0:e.length)||0)+(((n=t.match(iH))==null?void 0:n.length)||0)>0}const QF="number",ZF="color",aH="var",lH="var(",DE="${}",cH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function rf(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const a=e.replace(cH,l=>(an.test(l)?(s.color.push(i),r.push(ZF),n.push(an.parse(l))):l.startsWith(lH)?(s.var.push(i),r.push(aH),n.push(l)):(s.number.push(i),r.push(QF),n.push(parseFloat(l))),++i,DE)).split(DE);return{values:n,split:a,indexes:s,types:r}}function eP(t){return rf(t).values}function tP(t){const{split:e,types:n}=rf(t),s=e.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=e[o],r[o]!==void 0){const a=n[o];a===QF?i+=Ah(r[o]):a===ZF?i+=an.transform(r[o]):i+=r[o]}return i}}const uH=t=>typeof t=="number"?0:an.test(t)?an.getAnimatableNone(t):t;function dH(t){const e=eP(t);return tP(t)(e.map(uH))}const aa={test:oH,parse:eP,createTransformer:tP,getAnimatableNone:dH};function Gb(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function hH({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=Gb(l,a,t+1/3),i=Gb(l,a,t),o=Gb(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function Ay(t,e){return n=>n>0?e:t}const Mt=(t,e,n)=>t+(e-t)*n,Hb=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},fH=[Nv,Qa,Cc],pH=t=>fH.find(e=>e.test(t));function OE(t){const e=pH(t);if(!e)return!1;let n=e.parse(t);return e===Cc&&(n=hH(n)),n}const FE=(t,e)=>{const n=OE(t),s=OE(e);if(!n||!s)return Ay(t,e);const r={...n};return i=>(r.red=Hb(n.red,s.red,i),r.green=Hb(n.green,s.green,i),r.blue=Hb(n.blue,s.blue,i),r.alpha=Mt(n.alpha,s.alpha,i),Qa.transform(r))},Tv=new Set(["none","hidden"]);function mH(t,e){return Tv.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function gH(t,e){return n=>Mt(t,e,n)}function dC(t){return typeof t=="number"?gH:typeof t=="string"?lC(t)?Ay:an.test(t)?FE:wH:Array.isArray(t)?nP:typeof t=="object"?an.test(t)?FE:yH:Ay}function nP(t,e){const n=[...t],s=n.length,r=t.map((i,o)=>dC(i)(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function yH(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=dC(t[r])(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function xH(t,e){const n=[],s={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const i=e.types[r],o=t.indexes[i][s[i]],a=t.values[o]??0;n[r]=a,s[i]++}return n}const wH=(t,e)=>{const n=aa.createTransformer(e),s=rf(t),r=rf(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?Tv.has(t)&&!r.values.length||Tv.has(e)&&!s.values.length?mH(t,e):Pf(nP(xH(s,r),r.values),n):Ay(t,e)};function sP(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Mt(t,e,n):dC(t)(t,e)}const bH=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>_t.update(e,n),stop:()=>oa(e),now:()=>Wn.isProcessing?Wn.timestamp:As.now()}},rP=(t,e,n=10)=>{let s="";const r=Math.max(Math.round(e/n),2);for(let i=0;i<r;i++)s+=Math.round(t(i/(r-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},_y=2e4;function hC(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<_y;)e+=n,s=t.next(e);return e>=_y?1/0:e}function vH(t,e=100,n){const s=n({...t,keyframes:[0,e]}),r=Math.min(hC(s),_y);return{type:"keyframes",ease:i=>s.next(r*i).value/e,duration:br(r)}}const SH=5;function iP(t,e,n){const s=Math.max(e-SH,0);return MF(n-t(s),e-s)}const Ut={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},qb=.001;function kH({duration:t=Ut.duration,bounce:e=Ut.bounce,velocity:n=Ut.velocity,mass:s=Ut.mass}){let r,i,o=1-e;o=io(Ut.minDamping,Ut.maxDamping,o),t=io(Ut.minDuration,Ut.maxDuration,br(t)),o<1?(r=c=>{const u=c*o,d=u*t,h=u-n,f=Iv(c,o),p=Math.exp(-d);return qb-h/f*p},i=c=>{const d=c*o*t,h=d*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-d),m=Iv(Math.pow(c,2),o);return(-r(c)+qb>0?-1:1)*((h-f)*p)/m}):(r=c=>{const u=Math.exp(-c*t),d=(c-n)*t+1;return-qb+u*d},i=c=>{const u=Math.exp(-c*t),d=(n-c)*(t*t);return u*d});const a=5/t,l=NH(r,i,a);if(t=Ni(t),isNaN(l))return{stiffness:Ut.stiffness,damping:Ut.damping,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const CH=12;function NH(t,e,n){let s=n;for(let r=1;r<CH;r++)s=s-t(s)/e(s);return s}function Iv(t,e){return t*Math.sqrt(1-e*e)}const TH=["duration","bounce"],IH=["stiffness","damping","mass"];function PE(t,e){return e.some(n=>t[n]!==void 0)}function $H(t){let e={velocity:Ut.velocity,stiffness:Ut.stiffness,damping:Ut.damping,mass:Ut.mass,isResolvedFromDuration:!1,...t};if(!PE(t,IH)&&PE(t,TH))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),r=s*s,i=2*io(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:Ut.mass,stiffness:r,damping:i}}else{const n=kH(t);e={...e,...n,mass:Ut.mass},e.isResolvedFromDuration=!0}return e}function Dy(t=Ut.visualDuration,e=Ut.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:r}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=$H({...n,velocity:-br(n.velocity||0)}),p=h||0,m=c/(2*Math.sqrt(l*u)),g=o-i,y=br(Math.sqrt(l/u)),x=Math.abs(g)<5;s||(s=x?Ut.restSpeed.granular:Ut.restSpeed.default),r||(r=x?Ut.restDelta.granular:Ut.restDelta.default);let w;if(m<1){const S=Iv(y,m);w=T=>{const I=Math.exp(-m*y*T);return o-I*((p+m*y*g)/S*Math.sin(S*T)+g*Math.cos(S*T))}}else if(m===1)w=S=>o-Math.exp(-y*S)*(g+(p+y*g)*S);else{const S=y*Math.sqrt(m*m-1);w=T=>{const I=Math.exp(-m*y*T),$=Math.min(S*T,300);return o-I*((p+m*y*g)*Math.sinh($)+S*g*Math.cosh($))/S}}const b={calculatedDuration:f&&d||null,next:S=>{const T=w(S);if(f)a.done=S>=d;else{let I=S===0?p:0;m<1&&(I=S===0?Ni(p):iP(w,S,T));const $=Math.abs(I)<=s,_=Math.abs(o-T)<=r;a.done=$&&_}return a.value=a.done?o:T,a},toString:()=>{const S=Math.min(hC(b),_y),T=rP(I=>b.next(S*I).value,S,30);return S+"ms "+T},toTransition:()=>{}};return b}Dy.applyToOptions=t=>{const e=vH(t,100,Dy);return t.ease=e.ease,t.duration=Ni(e.duration),t.type="keyframes",t};function $v({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=t[0],h={done:!1,value:d},f=$=>a!==void 0&&$<a||l!==void 0&&$>l,p=$=>a===void 0?l:l===void 0||Math.abs(a-$)<Math.abs(l-$)?a:l;let m=n*e;const g=d+m,y=o===void 0?g:o(g);y!==g&&(m=y-d);const x=$=>-m*Math.exp(-$/s),w=$=>y+x($),b=$=>{const _=x($),D=w($);h.done=Math.abs(_)<=c,h.value=h.done?y:D};let S,T;const I=$=>{f(h.value)&&(S=$,T=Dy({keyframes:[h.value,p(h.value)],velocity:iP(w,$,h.value),damping:r,stiffness:i,restDelta:c,restSpeed:u}))};return I(0),{calculatedDuration:null,next:$=>{let _=!1;return!T&&S===void 0&&(_=!0,b($),I($)),S!==void 0&&$>=S?T.next($-S):(!_&&b($),h)}}}function EH(t,e,n){const s=[],r=n||oo.mix||sP,i=t.length-1;for(let o=0;o<i;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Tr:e;a=Pf(l,a)}s.push(a)}return s}function RH(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(Ry(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=EH(e,s,r),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=nf(t[d],t[d+1],u);return a[d](h)};return n?u=>c(io(t[0],t[i-1],u)):c}function AH(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=nf(0,e,s);t.push(Mt(n,1,r))}}function _H(t){const e=[0];return AH(e,t.length-1),e}function DH(t,e){return t.map(n=>n*e)}function OH(t,e){return t.map(()=>e||qF).splice(0,t.length-1)}function _h({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=H5(s)?s.map(RE):RE(s),i={done:!1,value:e[0]},o=DH(n&&n.length===e.length?n:_H(e),t),a=RH(o,e,{ease:Array.isArray(r)?r:OH(e,r)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const FH=t=>t!==null;function fC(t,{repeat:e,repeatType:n="loop"},s,r=1){const i=t.filter(FH),a=r<0||e&&n!=="loop"&&e%2===1?0:i.length-1;return!a||s===void 0?i[a]:s}const PH={decay:$v,inertia:$v,tween:_h,keyframes:_h,spring:Dy};function oP(t){typeof t.type=="string"&&(t.type=PH[t.type])}class pC{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const LH=t=>t/100;class mC extends pC{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,r;const{motionValue:n}=this.options;n&&n.updatedAt!==As.now()&&this.tick(As.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(s=this.options).onStop)==null||r.call(s))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;oP(e);const{type:n=_h,repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=e;let{keyframes:a}=e;const l=n||_h;l!==_h&&typeof a[0]!="number"&&(this.mixKeyframes=Pf(LH,sP(a[0],a[1])),a=[0,100]);const c=l({...e,keyframes:a});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=hC(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(s+1)-r,this.generator=c}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:s,totalDuration:r,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return s.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:f,type:p,onUpdate:m,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const y=this.currentTime-c*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?y<0:y>r;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let w=this.currentTime,b=s;if(d){const $=Math.min(this.currentTime,r)/a;let _=Math.floor($),D=$%1;!D&&$>=1&&(D=1),D===1&&_--,_=Math.min(_,d+1),!!(_%2)&&(h==="reverse"?(D=1-D,f&&(D-=f/a)):h==="mirror"&&(b=o)),w=io(0,1,D)*a}const S=x?{done:!1,value:u[0]}:b.next(w);i&&(S.value=i(S.value));let{done:T}=S;!x&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return I&&p!==$v&&(S.value=fC(u,this.options,g,this.speed)),m&&m(S.value),I&&this.finish(),S}then(e,n){return this.finished.then(e,n)}get duration(){return br(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+br(e)}get time(){return br(this.currentTime)}set time(e){var n;e=Ni(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(As.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=br(this.currentTime))}play(){var r,i;if(this.isStopped)return;const{driver:e=bH,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(r=this.options).onPlay)==null||i.call(r);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=n??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(As.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function MH(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Za=t=>t*180/Math.PI,Ev=t=>{const e=Za(Math.atan2(t[1],t[0]));return Rv(e)},BH={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Ev,rotateZ:Ev,skewX:t=>Za(Math.atan(t[1])),skewY:t=>Za(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Rv=t=>(t=t%360,t<0&&(t+=360),t),LE=Ev,ME=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),BE=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),zH={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:ME,scaleY:BE,scale:t=>(ME(t)+BE(t))/2,rotateX:t=>Rv(Za(Math.atan2(t[6],t[5]))),rotateY:t=>Rv(Za(Math.atan2(-t[2],t[0]))),rotateZ:LE,rotate:LE,skewX:t=>Za(Math.atan(t[4])),skewY:t=>Za(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Av(t){return t.includes("scale")?1:0}function _v(t,e){if(!t||t==="none")return Av(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,r;if(n)s=zH,r=n;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=BH,r=a}if(!r)return Av(e);const i=s[e],o=r[1].split(",").map(jH);return typeof i=="function"?i(o):o[i]}const VH=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return _v(n,e)};function jH(t){return parseFloat(t.trim())}const bu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],vu=new Set(bu),zE=t=>t===wu||t===De,UH=new Set(["x","y","z"]),WH=bu.filter(t=>!UH.has(t));function GH(t){const e=[];return WH.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const ol={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>_v(e,"x"),y:(t,{transform:e})=>_v(e,"y")};ol.translateX=ol.x;ol.translateY=ol.y;const al=new Set;let Dv=!1,Ov=!1,Fv=!1;function aP(){if(Ov){const t=Array.from(al).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=GH(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var a;(a=s.getValue(i))==null||a.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Ov=!1,Dv=!1,al.forEach(t=>t.complete(Fv)),al.clear()}function lP(){al.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Ov=!0)})}function HH(){Fv=!0,lP(),aP(),Fv=!1}class gC{constructor(e,n,s,r,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(al.add(this),Dv||(Dv=!0,_t.read(lP),_t.resolveKeyframes(aP))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;if(e[0]===null){const i=r==null?void 0:r.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(s&&n){const a=s.readValue(n,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),r&&i===void 0&&r.set(e[0])}MH(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),al.delete(this)}cancel(){this.state==="scheduled"&&(al.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const qH=t=>t.startsWith("--");function KH(t,e,n){qH(e)?t.style.setProperty(e,n):t.style[e]=n}const XH=sC(()=>window.ScrollTimeline!==void 0),YH={};function JH(t,e){const n=sC(t);return()=>YH[e]??n()}const cP=JH(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),dh=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,VE={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:dh([0,.65,.55,1]),circOut:dh([.55,0,1,.45]),backIn:dh([.31,.01,.66,-.59]),backOut:dh([.33,1.53,.69,.99])};function uP(t,e){if(t)return typeof t=="function"?cP()?rP(t,e):"ease-out":KF(t)?dh(t):Array.isArray(t)?t.map(n=>uP(n,e)||VE.easeOut):VE[t]}function QH(t,e,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:a="easeOut",times:l}={},c=void 0){const u={[e]:n};l&&(u.offset=l);const d=uP(a,r);Array.isArray(d)&&(u.easing=d);const h={delay:s,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),t.animate(u,h)}function dP(t){return typeof t=="function"&&"applyToOptions"in t}function ZH({type:t,...e}){return dP(t)&&cP()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class e8 extends pC{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:s,keyframes:r,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,Ry(typeof e.type!="string");const c=ZH(e);this.animation=QH(n,s,r,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=fC(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):KH(n,s,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,s;const e=((s=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:s.call(n).duration)||0;return br(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+br(e)}get time(){return br(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ni(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&XH()?(this.animation.timeline=e,Tr):n(this)}}const hP={anticipate:WF,backInOut:UF,circInOut:HF};function t8(t){return t in hP}function n8(t){typeof t.ease=="string"&&t8(t.ease)&&(t.ease=hP[t.ease])}const jE=10;class s8 extends e8{constructor(e){n8(e),oP(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:s,onComplete:r,element:i,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const a=new mC({...o,autoplay:!1}),l=Ni(this.finishedTime??this.time);n.setWithVelocity(a.sample(l-jE).value,a.sample(l).value,jE),a.stop()}}const UE=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(aa.test(t)||t==="0")&&!t.startsWith("url("));function r8(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function i8(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=UE(r,e),a=UE(i,e);return!o||!a?!1:r8(t)||(n==="spring"||dP(n))&&s}function Pv(t){t.duration=0,t.type="keyframes"}const o8=new Set(["opacity","clipPath","filter","transform"]),a8=sC(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function l8(t){var u;const{motionValue:e,name:n,repeatDelay:s,repeatType:r,damping:i,type:o}=t;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=e.owner.getProps();return a8()&&n&&o8.has(n)&&(n!=="transform"||!c)&&!l&&!s&&r!=="mirror"&&i!==0&&o!=="inertia"}const c8=40;class u8 extends pC{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",keyframes:a,name:l,motionValue:c,element:u,...d}){var p;super(),this.stop=()=>{var m,g;this._animation&&(this._animation.stop(),(m=this.stopTimeline)==null||m.call(this)),(g=this.keyframeResolver)==null||g.cancel()},this.createdAt=As.now();const h={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,name:l,motionValue:c,element:u,...d},f=(u==null?void 0:u.KeyframeResolver)||gC;this.keyframeResolver=new f(a,(m,g,y)=>this.onKeyframesResolved(m,g,h,!y),l,c,u),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,n,s,r){this.keyframeResolver=void 0;const{name:i,type:o,velocity:a,delay:l,isHandoff:c,onUpdate:u}=s;this.resolvedAt=As.now(),i8(e,i,o,a)||((oo.instantAnimations||!l)&&(u==null||u(fC(e,s,n))),e[0]=e[e.length-1],Pv(s),s.repeat=0);const h={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>c8?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...s,keyframes:e},f=!c&&l8(h)?new s8({...h,element:h.motionValue.owner.current}):new mC(h);f.finished.then(()=>this.notifyFinished()).catch(Tr),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),HH()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const d8=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function h8(t){const e=d8.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function fP(t,e,n=1){const[s,r]=h8(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return FF(o)?parseFloat(o):o}return lC(r)?fP(r,e,n+1):r}function yC(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const pP=new Set(["width","height","top","left","right","bottom",...bu]),f8={test:t=>t==="auto",parse:t=>t},mP=t=>e=>e.test(t),gP=[wu,De,Ti,Eo,rH,sH,f8],WE=t=>gP.find(mP(t));function p8(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||LF(t):!0}const m8=new Set(["brightness","contrast","saturate","opacity"]);function g8(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(cC)||[];if(!s)return t;const r=n.replace(s,"");let i=m8.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const y8=/\b([a-z-]*)\(.*?\)/gu,Lv={...aa,getAnimatableNone:t=>{const e=t.match(y8);return e?e.map(g8).join(" "):t}},GE={...wu,transform:Math.round},x8={rotate:Eo,rotateX:Eo,rotateY:Eo,rotateZ:Eo,scale:Zm,scaleX:Zm,scaleY:Zm,scaleZ:Zm,skew:Eo,skewX:Eo,skewY:Eo,distance:De,translateX:De,translateY:De,translateZ:De,x:De,y:De,z:De,perspective:De,transformPerspective:De,opacity:sf,originX:_E,originY:_E,originZ:De},xC={borderWidth:De,borderTopWidth:De,borderRightWidth:De,borderBottomWidth:De,borderLeftWidth:De,borderRadius:De,radius:De,borderTopLeftRadius:De,borderTopRightRadius:De,borderBottomRightRadius:De,borderBottomLeftRadius:De,width:De,maxWidth:De,height:De,maxHeight:De,top:De,right:De,bottom:De,left:De,padding:De,paddingTop:De,paddingRight:De,paddingBottom:De,paddingLeft:De,margin:De,marginTop:De,marginRight:De,marginBottom:De,marginLeft:De,backgroundPositionX:De,backgroundPositionY:De,...x8,zIndex:GE,fillOpacity:sf,strokeOpacity:sf,numOctaves:GE},w8={...xC,color:an,backgroundColor:an,outlineColor:an,fill:an,stroke:an,borderColor:an,borderTopColor:an,borderRightColor:an,borderBottomColor:an,borderLeftColor:an,filter:Lv,WebkitFilter:Lv},yP=t=>w8[t];function xP(t,e){let n=yP(t);return n!==Lv&&(n=aa),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const b8=new Set(["auto","none","0"]);function v8(t,e,n){let s=0,r;for(;s<t.length&&!r;){const i=t[s];typeof i=="string"&&!b8.has(i)&&rf(i).values.length&&(r=t[s]),s++}if(r&&n)for(const i of e)t[i]=xP(n,r)}class S8 extends gC{constructor(e,n,s,r,i){super(e,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),lC(c))){const u=fP(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!pP.has(s)||e.length!==2)return;const[r,i]=e,o=WE(r),a=WE(i);if(o!==a)if(zE(o)&&zE(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else ol[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)(e[r]===null||p8(e[r]))&&s.push(r);s.length&&v8(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ol[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var a;const{element:e,name:n,unresolvedKeyframes:s}=this;if(!e||!e.current)return;const r=e.getValue(n);r&&r.jump(this.measuredOrigin,!1);const i=s.length-1,o=s[i];s[i]=ol[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function k8(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){const r=document.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}const wP=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function bP(t){return PF(t)&&"offsetHeight"in t}const HE=30,C8=t=>!isNaN(parseFloat(t));class N8{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var i;const r=As.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=As.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=C8(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new rC);const s=this.events[e].add(n);return e==="change"?()=>{s(),_t.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=As.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>HE)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,HE);return MF(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Kc(t,e){return new N8(t,e)}const{schedule:wC,cancel:Y$e}=XF(queueMicrotask,!1),Mr={x:!1,y:!1};function vP(){return Mr.x||Mr.y}function T8(t){return t==="x"||t==="y"?Mr[t]?null:(Mr[t]=!0,()=>{Mr[t]=!1}):Mr.x||Mr.y?null:(Mr.x=Mr.y=!0,()=>{Mr.x=Mr.y=!1})}function SP(t,e){const n=k8(t),s=new AbortController,r={passive:!0,...e,signal:s.signal};return[n,r,()=>s.abort()]}function qE(t){return!(t.pointerType==="touch"||vP())}function I8(t,e,n={}){const[s,r,i]=SP(t,n),o=a=>{if(!qE(a))return;const{target:l}=a,c=e(l,a);if(typeof c!="function"||!l)return;const u=d=>{qE(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,r)};return s.forEach(a=>{a.addEventListener("pointerenter",o,r)}),i}const kP=(t,e)=>e?t===e?!0:kP(t,e.parentElement):!1,bC=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,$8=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function E8(t){return $8.has(t.tagName)||t.tabIndex!==-1}const Mg=new WeakSet;function KE(t){return e=>{e.key==="Enter"&&t(e)}}function Kb(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const R8=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=KE(()=>{if(Mg.has(n))return;Kb(n,"down");const r=KE(()=>{Kb(n,"up")}),i=()=>Kb(n,"cancel");n.addEventListener("keyup",r,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function XE(t){return bC(t)&&!vP()}function A8(t,e,n={}){const[s,r,i]=SP(t,n),o=a=>{const l=a.currentTarget;if(!XE(a))return;Mg.add(l);const c=e(l,a),u=(f,p)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),Mg.has(l)&&Mg.delete(l),XE(f)&&typeof c=="function"&&c(f,{success:p})},d=f=>{u(f,l===window||l===document||n.useGlobalTarget||kP(l,f.target))},h=f=>{u(f,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",h,r)};return s.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),bP(a)&&(a.addEventListener("focus",c=>R8(c,r)),!E8(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),i}function CP(t){return PF(t)&&"ownerSVGElement"in t}function _8(t){return CP(t)&&t.tagName==="svg"}const ss=t=>!!(t&&t.getVelocity),D8=[...gP,an,aa],O8=t=>D8.find(mP(t)),vC=F.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function YE(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function F8(...t){return e=>{let n=!1;const s=t.map(r=>{const i=YE(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():YE(t[r],null)}}}}function P8(...t){return F.useCallback(F8(...t),t)}class L8 extends F.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=n.offsetParent,r=bP(s)&&s.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=r-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function M8({children:t,isPresent:e,anchorX:n,root:s}){const r=F.useId(),i=F.useRef(null),o=F.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=F.useContext(vC),l=P8(i,t==null?void 0:t.ref);return F.useInsertionEffect(()=>{const{width:c,height:u,top:d,left:h,right:f}=o.current;if(e||!i.current||!c||!u)return;const p=n==="left"?`left: ${h}`:`right: ${f}`;i.current.dataset.motionPopId=r;const m=document.createElement("style");a&&(m.nonce=a);const g=s??document.head;return g.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${d}px !important;
          }
        `),()=>{g.contains(m)&&g.removeChild(m)}},[e]),v.jsx(L8,{isPresent:e,childRef:i,sizeRef:o,children:F.cloneElement(t,{ref:l})})}const B8=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o,anchorX:a,root:l})=>{const c=Zk(z8),u=F.useId();let d=!0,h=F.useMemo(()=>(d=!1,{id:u,initial:e,isPresent:n,custom:r,onExitComplete:f=>{c.set(f,!0);for(const p of c.values())if(!p)return;s&&s()},register:f=>(c.set(f,!1),()=>c.delete(f))}),[n,c,s]);return i&&d&&(h={...h}),F.useMemo(()=>{c.forEach((f,p)=>c.set(p,!1))},[n]),F.useEffect(()=>{!n&&!c.size&&s&&s()},[n]),o==="popLayout"&&(t=v.jsx(M8,{isPresent:n,anchorX:a,root:l,children:t})),v.jsx(O0.Provider,{value:h,children:t})};function z8(){return new Map}function NP(t=!0){const e=F.useContext(O0);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:r}=e,i=F.useId();F.useEffect(()=>{if(t)return r(i)},[t]);const o=F.useCallback(()=>t&&s&&s(i),[i,s,t]);return!n&&s?[!1,o]:[!0]}const eg=t=>t.key||"";function JE(t){const e=[];return F.Children.forEach(t,n=>{F.isValidElement(n)&&e.push(n)}),e}const V8=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:r=!0,mode:i="sync",propagate:o=!1,anchorX:a="left",root:l})=>{const[c,u]=NP(o),d=F.useMemo(()=>JE(t),[t]),h=o&&!c?[]:d.map(eg),f=F.useRef(!0),p=F.useRef(d),m=Zk(()=>new Map),[g,y]=F.useState(d),[x,w]=F.useState(d);OF(()=>{f.current=!1,p.current=d;for(let T=0;T<x.length;T++){const I=eg(x[T]);h.includes(I)?m.delete(I):m.get(I)!==!0&&m.set(I,!1)}},[x,h.length,h.join("-")]);const b=[];if(d!==g){let T=[...d];for(let I=0;I<x.length;I++){const $=x[I],_=eg($);h.includes(_)||(T.splice(I,0,$),b.push($))}return i==="wait"&&b.length&&(T=b),w(JE(T)),y(d),null}const{forceRender:S}=F.useContext(Qk);return v.jsx(v.Fragment,{children:x.map(T=>{const I=eg(T),$=o&&!c?!1:d===x||h.includes(I),_=()=>{if(m.has(I))m.set(I,!0);else return;let D=!0;m.forEach(z=>{z||(D=!1)}),D&&(S==null||S(),w(p.current),o&&(u==null||u()),s&&s())};return v.jsx(B8,{isPresent:$,initial:!f.current||n?void 0:!1,custom:e,presenceAffectsLayout:r,mode:i,root:l,onExitComplete:$?void 0:_,anchorX:a,children:T},I)})})},TP=F.createContext({strict:!1}),QE={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Xc={};for(const t in QE)Xc[t]={isEnabled:e=>QE[t].some(n=>!!e[n])};function j8(t){for(const e in t)Xc[e]={...Xc[e],...t[e]}}const U8=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Oy(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||U8.has(t)}let IP=t=>!Oy(t);function W8(t){typeof t=="function"&&(IP=e=>e.startsWith("on")?!Oy(e):t(e))}try{W8(require("@emotion/is-prop-valid").default)}catch{}function G8(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(IP(r)||n===!0&&Oy(r)||!e&&!Oy(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}const F0=F.createContext({});function P0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function of(t){return typeof t=="string"||Array.isArray(t)}const SC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kC=["initial",...SC];function L0(t){return P0(t.animate)||kC.some(e=>of(t[e]))}function $P(t){return!!(L0(t)||t.variants)}function H8(t,e){if(L0(t)){const{initial:n,animate:s}=t;return{initial:n===!1||of(n)?n:void 0,animate:of(s)?s:void 0}}return t.inherit!==!1?e:{}}function q8(t){const{initial:e,animate:n}=H8(t,F.useContext(F0));return F.useMemo(()=>({initial:e,animate:n}),[ZE(e),ZE(n)])}function ZE(t){return Array.isArray(t)?t.join(" "):t}const af={};function K8(t){for(const e in t)af[e]=t[e],aC(e)&&(af[e].isCSSVariable=!0)}function EP(t,{layout:e,layoutId:n}){return vu.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!af[t]||t==="opacity")}const X8={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Y8=bu.length;function J8(t,e,n){let s="",r=!0;for(let i=0;i<Y8;i++){const o=bu[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=wP(a,xC[o]);if(!l){r=!1;const u=X8[o]||o;s+=`${u}(${c}) `}n&&(e[o]=c)}}return s=s.trim(),n?s=n(e,r?"":s):r&&(s="none"),s}function CC(t,e,n){const{style:s,vars:r,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(vu.has(l)){o=!0;continue}else if(aC(l)){r[l]=c;continue}else{const u=wP(c,xC[l]);l.startsWith("origin")?(a=!0,i[l]=u):s[l]=u}}if(e.transform||(o||n?s.transform=J8(e,t.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;s.transformOrigin=`${l} ${c} ${u}`}}const NC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function RP(t,e,n){for(const s in e)!ss(e[s])&&!EP(s,n)&&(t[s]=e[s])}function Q8({transformTemplate:t},e){return F.useMemo(()=>{const n=NC();return CC(n,e,t),Object.assign({},n.vars,n.style)},[e])}function Z8(t,e){const n=t.style||{},s={};return RP(s,n,t),Object.assign(s,Q8(t,e)),s}function eq(t,e){const n={},s=Z8(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const tq={offset:"stroke-dashoffset",array:"stroke-dasharray"},nq={offset:"strokeDashoffset",array:"strokeDasharray"};function sq(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?tq:nq;t[i.offset]=De.transform(-s);const o=De.transform(e),a=De.transform(n);t[i.array]=`${o} ${a}`}function AP(t,{attrX:e,attrY:n,attrScale:s,pathLength:r,pathSpacing:i=1,pathOffset:o=0,...a},l,c,u){if(CC(t,a,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:h}=t;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),s!==void 0&&(d.scale=s),r!==void 0&&sq(d,r,i,o,!1)}const _P=()=>({...NC(),attrs:{}}),DP=t=>typeof t=="string"&&t.toLowerCase()==="svg";function rq(t,e,n,s){const r=F.useMemo(()=>{const i=_P();return AP(i,e,DP(s),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};RP(i,t.style,t),r.style={...i,...r.style}}return r}const iq=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function TC(t){return typeof t!="string"||t.includes("-")?!1:!!(iq.indexOf(t)>-1||/[A-Z]/u.test(t))}function oq(t,e,n,{latestValues:s},r,i=!1){const a=(TC(t)?rq:eq)(e,s,r,t),l=G8(e,typeof t=="string",i),c=t!==F.Fragment?{...l,...a,ref:n}:{},{children:u}=e,d=F.useMemo(()=>ss(u)?u.get():u,[u]);return F.createElement(t,{...c,children:d})}function eR(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function IC(t,e,n,s){if(typeof e=="function"){const[r,i]=eR(s);e=e(n!==void 0?n:t.custom,r,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,i]=eR(s);e=e(n!==void 0?n:t.custom,r,i)}return e}function Bg(t){return ss(t)?t.get():t}function aq({scrapeMotionValuesFromProps:t,createRenderState:e},n,s,r){return{latestValues:lq(n,s,r,t),renderState:e()}}function lq(t,e,n,s){const r={},i=s(t,{});for(const h in i)r[h]=Bg(i[h]);let{initial:o,animate:a}=t;const l=L0(t),c=$P(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!P0(d)){const h=Array.isArray(d)?d:[d];for(let f=0;f<h.length;f++){const p=IC(t,h[f]);if(p){const{transitionEnd:m,transition:g,...y}=p;for(const x in y){let w=y[x];if(Array.isArray(w)){const b=u?w.length-1:0;w=w[b]}w!==null&&(r[x]=w)}for(const x in m)r[x]=m[x]}}}return r}const OP=t=>(e,n)=>{const s=F.useContext(F0),r=F.useContext(O0),i=()=>aq(t,e,s,r);return n?i():Zk(i)};function $C(t,e,n){var i;const{style:s}=t,r={};for(const o in s)(ss(s[o])||e.style&&ss(e.style[o])||EP(o,t)||((i=n==null?void 0:n.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(r[o]=s[o]);return r}const cq=OP({scrapeMotionValuesFromProps:$C,createRenderState:NC});function FP(t,e,n){const s=$C(t,e,n);for(const r in t)if(ss(t[r])||ss(e[r])){const i=bu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=t[r]}return s}const uq=OP({scrapeMotionValuesFromProps:FP,createRenderState:_P}),dq=Symbol.for("motionComponentSymbol");function Nc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function hq(t,e,n){return F.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):Nc(n)&&(n.current=s))},[e])}const EC=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),fq="framerAppearId",PP="data-"+EC(fq),LP=F.createContext({});function pq(t,e,n,s,r){var m,g;const{visualElement:i}=F.useContext(F0),o=F.useContext(TP),a=F.useContext(O0),l=F.useContext(vC).reducedMotion,c=F.useRef(null);s=s||o.renderer,!c.current&&s&&(c.current=s(t,{visualState:e,parent:i,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=F.useContext(LP);u&&!u.projection&&r&&(u.type==="html"||u.type==="svg")&&mq(c.current,n,r,d);const h=F.useRef(!1);F.useInsertionEffect(()=>{u&&h.current&&u.update(n,a)});const f=n[PP],p=F.useRef(!!f&&!((m=window.MotionHandoffIsComplete)!=null&&m.call(window,f))&&((g=window.MotionHasOptimisedAnimation)==null?void 0:g.call(window,f)));return OF(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),p.current&&u.animationState&&u.animationState.animateChanges())}),F.useEffect(()=>{u&&(!p.current&&u.animationState&&u.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)==null||y.call(window,f)}),p.current=!1),u.enteringChildren=void 0)}),u}function mq(t,e,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:MP(t.parent)),t.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||a&&Nc(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,crossfade:u,layoutScroll:l,layoutRoot:c})}function MP(t){if(t)return t.options.allowProjection!==!1?t.projection:MP(t.parent)}function Xb(t,{forwardMotionProps:e=!1}={},n,s){n&&j8(n);const r=TC(t)?uq:cq;function i(a,l){let c;const u={...F.useContext(vC),...a,layoutId:gq(a)},{isStatic:d}=u,h=q8(a),f=r(a,d);if(!d&&eC){yq();const p=xq(u);c=p.MeasureLayout,h.visualElement=pq(t,f,u,s,p.ProjectionNode)}return v.jsxs(F0.Provider,{value:h,children:[c&&h.visualElement?v.jsx(c,{visualElement:h.visualElement,...u}):null,oq(t,a,hq(f,h.visualElement,l),f,d,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=F.forwardRef(i);return o[dq]=t,o}function gq({layoutId:t}){const e=F.useContext(Qk).id;return e&&t!==void 0?e+"-"+t:t}function yq(t,e){F.useContext(TP).strict}function xq(t){const{drag:e,layout:n}=Xc;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function wq(t,e){if(typeof Proxy>"u")return Xb;const n=new Map,s=(i,o)=>Xb(i,o,t,e),r=(i,o)=>s(i,o);return new Proxy(r,{get:(i,o)=>o==="create"?s:(n.has(o)||n.set(o,Xb(o,void 0,t,e)),n.get(o))})}function BP({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function bq({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function vq(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Yb(t){return t===void 0||t===1}function Mv({scale:t,scaleX:e,scaleY:n}){return!Yb(t)||!Yb(e)||!Yb(n)}function Va(t){return Mv(t)||zP(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function zP(t){return tR(t.x)||tR(t.y)}function tR(t){return t&&t!=="0%"}function Fy(t,e,n){const s=t-n,r=e*s;return n+r}function nR(t,e,n,s,r){return r!==void 0&&(t=Fy(t,r,s)),Fy(t,n,s)+e}function Bv(t,e=0,n=1,s,r){t.min=nR(t.min,e,n,s,r),t.max=nR(t.max,e,n,s,r)}function VP(t,{x:e,y:n}){Bv(t.x,e.translate,e.scale,e.originPoint),Bv(t.y,n.translate,n.scale,n.originPoint)}const sR=.999999999999,rR=1.0000000000001;function Sq(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Ic(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,VP(t,o)),s&&Va(i.latestValues)&&Ic(t,i.latestValues))}e.x<rR&&e.x>sR&&(e.x=1),e.y<rR&&e.y>sR&&(e.y=1)}function Tc(t,e){t.min=t.min+e,t.max=t.max+e}function iR(t,e,n,s,r=.5){const i=Mt(t.min,t.max,r);Bv(t,e,n,i,s)}function Ic(t,e){iR(t.x,e.x,e.scaleX,e.scale,e.originX),iR(t.y,e.y,e.scaleY,e.scale,e.originY)}function jP(t,e){return BP(vq(t.getBoundingClientRect(),e))}function kq(t,e,n){const s=jP(t,n),{scroll:r}=e;return r&&(Tc(s.x,r.offset.x),Tc(s.y,r.offset.y)),s}const oR=()=>({translate:0,scale:1,origin:0,originPoint:0}),$c=()=>({x:oR(),y:oR()}),aR=()=>({min:0,max:0}),yn=()=>({x:aR(),y:aR()}),zv={current:null},UP={current:!1};function Cq(){if(UP.current=!0,!!eC)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>zv.current=t.matches;t.addEventListener("change",e),e()}else zv.current=!1}const Nq=new WeakMap;function Tq(t,e,n){for(const s in e){const r=e[s],i=n[s];if(ss(r))t.addValue(s,r);else if(ss(i))t.addValue(s,Kc(r,{owner:t}));else if(i!==r)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=t.getStaticValue(s);t.addValue(s,Kc(o!==void 0?o:r,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const lR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Iq{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=gC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=As.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,_t.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=L0(n),this.isVariantNode=$P(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const f=d[h];l[h]!==void 0&&ss(f)&&f.set(l[h])}}mount(e){var n;this.current=e,Nq.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,r)=>this.bindToMotionValue(r,s)),UP.current||Cq(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:zv.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),oa(this.notifyUpdate),oa(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const s=this.features[n];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=vu.has(e);s&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&_t.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Xc){const n=Xc[e];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):yn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<lR.length;s++){const r=lR[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=e[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=Tq(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Kc(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(FF(s)||LF(s))?s=parseFloat(s):!O8(s)&&aa.test(n)&&(s=xP(e,n)),this.setBaseTarget(e,ss(s)?s.get():s)),ss(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var i;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const o=IC(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);o&&(s=o[e])}if(n&&s!==void 0)return s;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!ss(r)?r:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new rC),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){wC.render(this.render)}}class WP extends Iq{constructor(){super(...arguments),this.KeyframeResolver=S8}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ss(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function GP(t,{style:e,vars:n},s,r){const i=t.style;let o;for(o in e)i[o]=e[o];r==null||r.applyProjectionStyles(i,s);for(o in n)i.setProperty(o,n[o])}function $q(t){return window.getComputedStyle(t)}class Eq extends WP{constructor(){super(...arguments),this.type="html",this.renderInstance=GP}readValueFromInstance(e,n){var s;if(vu.has(n))return(s=this.projection)!=null&&s.isProjecting?Av(n):VH(e,n);{const r=$q(e),i=(aC(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return jP(e,n)}build(e,n,s){CC(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return $C(e,n,s)}}const HP=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Rq(t,e,n,s){GP(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(HP.has(r)?r:EC(r),e.attrs[r])}class Aq extends WP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=yn}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(vu.has(n)){const s=yP(n);return s&&s.default||0}return n=HP.has(n)?n:EC(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return FP(e,n,s)}build(e,n,s){AP(e,n,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(e,n,s,r){Rq(e,n,s,r)}mount(e){this.isSVGTag=DP(e.tagName),super.mount(e)}}const _q=(t,e)=>TC(t)?new Aq(e):new Eq(e,{allowProjection:t!==F.Fragment});function Pc(t,e,n){const s=t.getProps();return IC(s,e,n!==void 0?n:s.custom,t)}const Vv=t=>Array.isArray(t);function Dq(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Kc(n))}function Oq(t){return Vv(t)?t[t.length-1]||0:t}function Fq(t,e){const n=Pc(t,e);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const a=Oq(i[o]);Dq(t,o,a)}}function Pq(t){return!!(ss(t)&&t.add)}function jv(t,e){const n=t.getValue("willChange");if(Pq(n))return n.add(e);if(!n&&oo.WillChange){const s=new oo.WillChange("auto");t.addValue("willChange",s),s.add(e)}}function qP(t){return t.props[PP]}const Lq=t=>t!==null;function Mq(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(Lq),i=e&&n!=="loop"&&e%2===1?0:r.length-1;return!i||s===void 0?r[i]:s}const Bq={type:"spring",stiffness:500,damping:25,restSpeed:10},zq=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Vq={type:"keyframes",duration:.8},jq={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Uq=(t,{keyframes:e})=>e.length>2?Vq:vu.has(t)?t.startsWith("scale")?zq(e[1]):Bq:jq;function Wq({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const RC=(t,e,n,s={},r,i)=>o=>{const a=yC(s,t)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-Ni(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:r};Wq(a)||Object.assign(u,Uq(t,u)),u.duration&&(u.duration=Ni(u.duration)),u.repeatDelay&&(u.repeatDelay=Ni(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(Pv(u),u.delay===0&&(d=!0)),(oo.instantAnimations||oo.skipAnimations)&&(d=!0,Pv(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!i&&e.get()!==void 0){const h=Mq(u.keyframes,a);if(h!==void 0){_t.update(()=>{u.onUpdate(h),u.onComplete()});return}}return a.isSync?new mC(u):new u8(u)};function Gq({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function KP(t,e,{delay:n=0,transitionOverride:s,type:r}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...a}=e;s&&(i=s);const l=[],c=r&&t.animationState&&t.animationState.getState()[r];for(const u in a){const d=t.getValue(u,t.latestValues[u]??null),h=a[u];if(h===void 0||c&&Gq(c,u))continue;const f={delay:n,...yC(i||{},u)},p=d.get();if(p!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===p&&!f.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){const y=qP(t);if(y){const x=window.MotionHandoffAnimation(y,u,_t);x!==null&&(f.startTime=x,m=!0)}}jv(t,u),d.start(RC(u,d,h,t.shouldReduceMotion&&pP.has(u)?{type:!1}:f,t,m));const g=d.animation;g&&l.push(g)}return o&&Promise.all(l).then(()=>{_t.update(()=>{o&&Fq(t,o)})}),l}function XP(t,e,n,s=0,r=1){const i=Array.from(t).sort((c,u)=>c.sortNodePosition(u)).indexOf(e),o=t.size,a=(o-1)*s;return typeof n=="function"?n(i,o):r===1?i*s:a-i*s}function Uv(t,e,n={}){var l;const s=Pc(t,e,n.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(r=n.transitionOverride);const i=s?()=>Promise.all(KP(t,s,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=r;return Hq(t,e,c,u,d,h,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[c,u]=a==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function Hq(t,e,n=0,s=0,r=0,i=1,o){const a=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),a.push(Uv(l,e,{...o,delay:n+(typeof s=="function"?0:s)+XP(t.variantChildren,l,s,r,i)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function qq(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>Uv(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=Uv(t,e,n);else{const r=typeof e=="function"?Pc(t,e,n.custom):e;s=Promise.all(KP(t,r,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}function YP(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}const Kq=kC.length;function JP(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?JP(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<Kq;n++){const s=kC[n],r=t.props[s];(of(r)||r===!1)&&(e[s]=r)}return e}const Xq=[...SC].reverse(),Yq=SC.length;function Jq(t){return e=>Promise.all(e.map(({animation:n,options:s})=>qq(t,n,s)))}function Qq(t){let e=Jq(t),n=cR(),s=!0;const r=l=>(c,u)=>{var h;const d=Pc(t,u,l==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,...m}=d;c={...c,...m,...p}}return c};function i(l){e=l(t)}function o(l){const{props:c}=t,u=JP(t.parent)||{},d=[],h=new Set;let f={},p=1/0;for(let g=0;g<Yq;g++){const y=Xq[g],x=n[y],w=c[y]!==void 0?c[y]:u[y],b=of(w),S=y===l?x.isActive:null;S===!1&&(p=g);let T=w===u[y]&&w!==c[y]&&b;if(T&&s&&t.manuallyAnimateOnMount&&(T=!1),x.protectedKeys={...f},!x.isActive&&S===null||!w&&!x.prevProp||P0(w)||typeof w=="boolean")continue;const I=Zq(x.prevProp,w);let $=I||y===l&&x.isActive&&!T&&b||g>p&&b,_=!1;const D=Array.isArray(w)?w:[w];let z=D.reduce(r(y),{});S===!1&&(z={});const{prevResolvedValues:H={}}=x,X={...H,...z},Y=ee=>{$=!0,h.has(ee)&&(_=!0,h.delete(ee)),x.needsAnimating[ee]=!0;const M=t.getValue(ee);M&&(M.liveStyle=!1)};for(const ee in X){const M=z[ee],q=H[ee];if(f.hasOwnProperty(ee))continue;let te=!1;Vv(M)&&Vv(q)?te=!YP(M,q):te=M!==q,te?M!=null?Y(ee):h.add(ee):M!==void 0&&h.has(ee)?Y(ee):x.protectedKeys[ee]=!0}x.prevProp=w,x.prevResolvedValues=z,x.isActive&&(f={...f,...z}),s&&t.blockInitialAnimation&&($=!1);const J=T&&I;$&&(!J||_)&&d.push(...D.map(ee=>{const M={type:y};if(typeof ee=="string"&&s&&!J&&t.manuallyAnimateOnMount&&t.parent){const{parent:q}=t,te=Pc(q,ee);if(q.enteringChildren&&te){const{delayChildren:Z}=te.transition||{};M.delay=XP(q.enteringChildren,t,Z)}}return{animation:ee,options:M}}))}if(h.size){const g={};if(typeof c.initial!="boolean"){const y=Pc(t,Array.isArray(c.initial)?c.initial[0]:c.initial);y&&y.transition&&(g.transition=y.transition)}h.forEach(y=>{const x=t.getBaseTarget(y),w=t.getValue(y);w&&(w.liveStyle=!0),g[y]=x??null}),d.push({animation:g})}let m=!!d.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(m=!1),s=!1,m?e(d):Promise.resolve()}function a(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=t.variantChildren)==null||d.forEach(h=>{var f;return(f=h.animationState)==null?void 0:f.setActive(l,c)}),n[l].isActive=c;const u=o(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=cR()}}}function Zq(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!YP(e,t):!1}function Pa(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function cR(){return{animate:Pa(!0),whileInView:Pa(),whileHover:Pa(),whileTap:Pa(),whileDrag:Pa(),whileFocus:Pa(),exit:Pa()}}class Ca{constructor(e){this.isMounted=!1,this.node=e}update(){}}class eK extends Ca{constructor(e){super(e),e.animationState||(e.animationState=Qq(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();P0(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let tK=0;class nK extends Ca{constructor(){super(...arguments),this.id=tK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const sK={animation:{Feature:eK},exit:{Feature:nK}};function lf(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function Bf(t){return{point:{x:t.pageX,y:t.pageY}}}const rK=t=>e=>bC(e)&&t(e,Bf(e));function Dh(t,e,n,s){return lf(t,e,rK(n),s)}const QP=1e-4,iK=1-QP,oK=1+QP,ZP=.01,aK=0-ZP,lK=0+ZP;function hs(t){return t.max-t.min}function cK(t,e,n){return Math.abs(t-e)<=n}function uR(t,e,n,s=.5){t.origin=s,t.originPoint=Mt(e.min,e.max,t.origin),t.scale=hs(n)/hs(e),t.translate=Mt(n.min,n.max,t.origin)-t.originPoint,(t.scale>=iK&&t.scale<=oK||isNaN(t.scale))&&(t.scale=1),(t.translate>=aK&&t.translate<=lK||isNaN(t.translate))&&(t.translate=0)}function Oh(t,e,n,s){uR(t.x,e.x,n.x,s?s.originX:void 0),uR(t.y,e.y,n.y,s?s.originY:void 0)}function dR(t,e,n){t.min=n.min+e.min,t.max=t.min+hs(e)}function uK(t,e,n){dR(t.x,e.x,n.x),dR(t.y,e.y,n.y)}function hR(t,e,n){t.min=e.min-n.min,t.max=t.min+hs(e)}function Py(t,e,n){hR(t.x,e.x,n.x),hR(t.y,e.y,n.y)}function fr(t){return[t("x"),t("y")]}const eL=({current:t})=>t?t.ownerDocument.defaultView:null,fR=(t,e)=>Math.abs(t-e);function dK(t,e){const n=fR(t.x,e.x),s=fR(t.y,e.y);return Math.sqrt(n**2+s**2)}class tL{constructor(e,n,{transformPagePoint:s,contextWindow:r=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Qb(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=dK(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!p)return;const{point:m}=h,{timestamp:g}=Wn;this.history.push({...m,timestamp:g});const{onStart:y,onMove:x}=this.handlers;f||(y&&y(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Jb(f,this.transformPagePoint),_t.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:p,onSessionEnd:m,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=Qb(h.type==="pointercancel"?this.lastMoveEventInfo:Jb(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,y),m&&m(h,y)},!bC(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.distanceThreshold=o,this.contextWindow=r||window;const a=Bf(e),l=Jb(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=Wn;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,Qb(l,this.history)),this.removeListeners=Pf(Dh(this.contextWindow,"pointermove",this.handlePointerMove),Dh(this.contextWindow,"pointerup",this.handlePointerUp),Dh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),oa(this.updatePoint)}}function Jb(t,e){return e?{point:e(t.point)}:t}function pR(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Qb({point:t},e){return{point:t,delta:pR(t,nL(e)),offset:pR(t,hK(e)),velocity:fK(e,.1)}}function hK(t){return t[0]}function nL(t){return t[t.length-1]}function fK(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=nL(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>Ni(e)));)n--;if(!s)return{x:0,y:0};const i=br(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function pK(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Mt(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Mt(n,t,s.max):Math.min(t,n)),t}function mR(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function mK(t,{top:e,left:n,bottom:s,right:r}){return{x:mR(t.x,n,r),y:mR(t.y,e,s)}}function gR(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function gK(t,e){return{x:gR(t.x,e.x),y:gR(t.y,e.y)}}function yK(t,e){let n=.5;const s=hs(t),r=hs(e);return r>s?n=nf(e.min,e.max-s,t.min):s>r&&(n=nf(t.min,t.max-r,e.min)),io(0,1,n)}function xK(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Wv=.35;function wK(t=Wv){return t===!1?t=0:t===!0&&(t=Wv),{x:yR(t,"left","right"),y:yR(t,"top","bottom")}}function yR(t,e,n){return{min:xR(t,e),max:xR(t,n)}}function xR(t,e){return typeof t=="number"?t:t[e]||0}const bK=new WeakMap;class vK{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=yn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:s}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Bf(d).point)},o=(d,h)=>{const{drag:f,dragPropagation:p,onDragStart:m}=this.getProps();if(f&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=T8(f),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fr(y=>{let x=this.getAxisMotionValue(y).get()||0;if(Ti.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const b=w.layout.layoutBox[y];b&&(x=hs(b)*(parseFloat(x)/100))}}this.originPoint[y]=x}),m&&_t.postRender(()=>m(d,h)),jv(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},a=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h;const{dragPropagation:f,dragDirectionLock:p,onDirectionLock:m,onDrag:g}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:y}=h;if(p&&this.currentDirection===null){this.currentDirection=SK(y),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",h.point,y),this.updateAxis("y",h.point,y),this.visualElement.render(),g&&g(d,h)},l=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h,this.stop(d,h),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>fr(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)==null?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new tL(e,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:s,contextWindow:eL(this.visualElement)})}stop(e,n){const s=e||this.latestPointerEvent,r=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!r||!s)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&_t.postRender(()=>a(s,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!tg(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=pK(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,r=this.constraints;e&&Nc(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&s?this.constraints=mK(s.layoutBox,e):this.constraints=!1,this.elastic=wK(n),r!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&fr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=xK(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Nc(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=kq(s,r.root,this.visualElement.getTransformPagePoint());let o=gK(r.layout.layoutBox,i);if(n){const a=n(bq(o));this.hasMutatedConstraints=!!a,a&&(o=BP(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=fr(u=>{if(!tg(u,n,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const h=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?e[u]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return jv(this.visualElement,e),s.start(RC(e,s,0,n,this.visualElement,!1))}stopAnimation(){fr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){fr(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){fr(n=>{const{drag:s}=this.getProps();if(!tg(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(e[n]-Mt(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Nc(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};fr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=yK({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),fr(o=>{if(!tg(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Mt(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;bK.set(this.visualElement,this);const e=this.visualElement.current,n=Dh(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Nc(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),_t.read(s);const o=lf(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(fr(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=Wv,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function tg(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function SK(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class kK extends Ca{constructor(e){super(e),this.removeGroupControls=Tr,this.removeListeners=Tr,this.controls=new vK(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Tr}unmount(){this.removeGroupControls(),this.removeListeners()}}const wR=t=>(e,n)=>{t&&_t.postRender(()=>t(e,n))};class CK extends Ca{constructor(){super(...arguments),this.removePointerDownListener=Tr}onPointerDown(e){this.session=new tL(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:eL(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:wR(e),onStart:wR(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&_t.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=Dh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const zg={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function bR(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Jd={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(De.test(t))t=parseFloat(t);else return t;const n=bR(t,e.target.x),s=bR(t,e.target.y);return`${n}% ${s}%`}},NK={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=aa.parse(t);if(r.length>5)return s;const i=aa.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=Mt(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}};let Zb=!1;class TK extends F.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;K8(IK),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),Zb&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),zg.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,{projection:o}=s;return o&&(o.isPresent=i,Zb=!0,r||e.layoutDependency!==n||n===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||_t.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),wC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;Zb=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function sL(t){const[e,n]=NP(),s=F.useContext(Qk);return v.jsx(TK,{...t,layoutGroup:s,switchLayoutGroup:F.useContext(LP),isPresent:e,safeToRemove:n})}const IK={borderRadius:{...Jd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Jd,borderTopRightRadius:Jd,borderBottomLeftRadius:Jd,borderBottomRightRadius:Jd,boxShadow:NK};function $K(t,e,n){const s=ss(t)?t:Kc(t);return s.start(RC("",s,e,n)),s.animation}const EK=(t,e)=>t.depth-e.depth;class RK{constructor(){this.children=[],this.isDirty=!1}add(e){tC(this.children,e),this.isDirty=!0}remove(e){nC(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(EK),this.isDirty=!1,this.children.forEach(e)}}function AK(t,e){const n=As.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(oa(s),t(i-e))};return _t.setup(s,!0),()=>oa(s)}const rL=["TopLeft","TopRight","BottomLeft","BottomRight"],_K=rL.length,vR=t=>typeof t=="string"?parseFloat(t):t,SR=t=>typeof t=="number"||De.test(t);function DK(t,e,n,s,r,i){r?(t.opacity=Mt(0,n.opacity??1,OK(s)),t.opacityExit=Mt(e.opacity??1,0,FK(s))):i&&(t.opacity=Mt(e.opacity??1,n.opacity??1,s));for(let o=0;o<_K;o++){const a=`border${rL[o]}Radius`;let l=kR(e,a),c=kR(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||SR(l)===SR(c)?(t[a]=Math.max(Mt(vR(l),vR(c),s),0),(Ti.test(c)||Ti.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Mt(e.rotate||0,n.rotate||0,s))}function kR(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const OK=iL(0,.5,GF),FK=iL(.5,.95,Tr);function iL(t,e,n){return s=>s<t?0:s>e?1:n(nf(t,e,s))}function CR(t,e){t.min=e.min,t.max=e.max}function Pr(t,e){CR(t.x,e.x),CR(t.y,e.y)}function NR(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function TR(t,e,n,s,r){return t-=e,t=Fy(t,1/n,s),r!==void 0&&(t=Fy(t,1/r,s)),t}function PK(t,e=0,n=1,s=.5,r,i=t,o=t){if(Ti.test(e)&&(e=parseFloat(e),e=Mt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Mt(i.min,i.max,s);t===i&&(a-=e),t.min=TR(t.min,e,n,a,r),t.max=TR(t.max,e,n,a,r)}function IR(t,e,[n,s,r],i,o){PK(t,e[n],e[s],e[r],e.scale,i,o)}const LK=["x","scaleX","originX"],MK=["y","scaleY","originY"];function $R(t,e,n,s){IR(t.x,e,LK,n?n.x:void 0,s?s.x:void 0),IR(t.y,e,MK,n?n.y:void 0,s?s.y:void 0)}function ER(t){return t.translate===0&&t.scale===1}function oL(t){return ER(t.x)&&ER(t.y)}function RR(t,e){return t.min===e.min&&t.max===e.max}function BK(t,e){return RR(t.x,e.x)&&RR(t.y,e.y)}function AR(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function aL(t,e){return AR(t.x,e.x)&&AR(t.y,e.y)}function _R(t){return hs(t.x)/hs(t.y)}function DR(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class zK{constructor(){this.members=[]}add(e){tC(this.members,e),e.scheduleRender()}remove(e){if(nC(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function VK(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),d&&(s+=`rotateX(${d}deg) `),h&&(s+=`rotateY(${h}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const e1=["","X","Y","Z"],jK=1e3;let UK=0;function t1(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function lL(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=qP(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",_t,!(r||i))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&lL(s)}function cL({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=UK++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(HK),this.nodes.forEach(YK),this.nodes.forEach(JK),this.nodes.forEach(qK)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new RK)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new rC),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=CP(o)&&!_8(o),this.instance=o;const{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),t){let u,d=0;const h=()=>this.root.updateBlockedByResize=!1;_t.read(()=>{d=window.innerWidth}),t(o,()=>{const f=window.innerWidth;f!==d&&(d=f,this.root.updateBlockedByResize=!0,u&&u(),u=AK(h,250),zg.hasAnimatedSinceResize&&(zg.hasAnimatedSinceResize=!1,this.nodes.forEach(PR)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||c.getDefaultTransition()||n7,{onLayoutAnimationStart:m,onLayoutAnimationComplete:g}=c.getProps(),y=!this.targetLayout||!aL(this.targetLayout,f),x=!d&&h;if(this.options.layoutRoot||this.resumeFrom||x||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...yC(p,"layout"),onPlay:m,onComplete:g};(c.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(u,x)}else d||PR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),oa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(QK),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(OR);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(FR);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(XK),this.nodes.forEach(WK),this.nodes.forEach(GK)):this.nodes.forEach(FR),this.clearAllSnapshots();const a=As.now();Wn.delta=io(0,1e3/60,a-Wn.timestamp),Wn.timestamp=a,Wn.isProcessing=!0,Ub.update.process(Wn),Ub.preRender.process(Wn),Ub.render.process(Wn),Wn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,wC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(KK),this.sharedNodes.forEach(ZK)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,_t.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){_t.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!hs(this.snapshot.measuredBox.x)&&!hs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=yn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!oL(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&this.instance&&(a||Va(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),s7(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:o}=this.options;if(!o)return yn();const a=o.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(r7))){const{scroll:u}=this.root;u&&(Tc(a.x,u.offset.x),Tc(a.y,u.offset.y))}return a}removeElementScroll(o){var l;const a=yn();if(Pr(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Pr(a,o),Tc(a.x,d.offset.x),Tc(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const l=yn();Pr(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Ic(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Va(u.latestValues)&&Ic(l,u.latestValues)}return Va(this.latestValues)&&Ic(l,this.latestValues),l}removeTransform(o){const a=yn();Pr(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Va(c.latestValues))continue;Mv(c.latestValues)&&c.updateSnapshot();const u=yn(),d=c.measurePageBox();Pr(u,d),$R(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Va(this.latestValues)&&$R(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Wn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var f;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!this.layout||!(u||d))return;this.resolvedRelativeTargetAt=Wn.timestamp;const h=this.getClosestProjectingParent();h&&this.linkedParentVersion!==h.layoutVersion&&!h.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(h&&h.layout?this.createRelativeTarget(h,this.layout.layoutBox,h.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=yn(),this.targetWithTransforms=yn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),uK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Pr(this.target,this.layout.layoutBox),VP(this.target,this.targetDelta)):Pr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?this.createRelativeTarget(h,this.target,h.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Mv(this.parent.latestValues)||zP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,a,l){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=yn(),this.relativeTargetOrigin=yn(),Py(this.relativeTargetOrigin,a,l),Pr(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var p;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Wn.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Pr(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;Sq(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=yn());const{target:f}=o;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(NR(this.prevProjectionDelta.x,this.projectionDelta.x),NR(this.prevProjectionDelta.y,this.projectionDelta.y)),Oh(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!DR(this.projectionDelta.x,this.prevProjectionDelta.x)||!DR(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=$c(),this.projectionDelta=$c(),this.projectionDeltaWithTransform=$c()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=$c();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=yn(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,g=this.getStack(),y=!g||g.members.length<=1,x=!!(m&&!y&&this.options.crossfade===!0&&!this.path.some(t7));this.animationProgress=0;let w;this.mixTargetDelta=b=>{const S=b/1e3;LR(d.x,o.x,S),LR(d.y,o.y,S),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Py(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),e7(this.relativeTarget,this.relativeTargetOrigin,h,S),w&&BK(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=yn()),Pr(w,this.relativeTarget)),m&&(this.animationValues=u,DK(u,c,this.latestValues,S,x,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,c;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(c=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||c.stop(),this.pendingAnimation&&(oa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=_t.update(()=>{zg.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Kc(0)),this.currentAnimation=$K(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jK),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&uL(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||yn();const d=hs(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const h=hs(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}Pr(a,l),Ic(a,u),Oh(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new zK),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&t1("z",o,c,this.animationValues);for(let u=0;u<e1.length;u++)t1(`rotate${e1[u]}`,o,c,this.animationValues),t1(`skew${e1[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Bg(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Bg(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Va(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let d=VK(this.projectionDeltaWithTransform,this.treeScale,u);l&&(d=l(u,d)),o.transform=d;const{x:h,y:f}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${f.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in af){if(u[p]===void 0)continue;const{correct:m,applyTo:g,isCSSVariable:y}=af[p],x=d==="none"?u[p]:m(u[p],c);if(g){const w=g.length;for(let b=0;b<w;b++)o[g[b]]=x}else y?this.options.visualElement.renderState.vars[p]=x:o[p]=x}this.options.layoutId&&(o.pointerEvents=c===this?Bg(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(OR),this.root.sharedNodes.clear()}}}function WK(t){t.updateLayout()}function GK(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=e.source!==t.layout.source;i==="size"?fr(d=>{const h=o?e.measuredBox[d]:e.layoutBox[d],f=hs(h);h.min=s[d].min,h.max=h.min+f}):uL(i,e.layoutBox,s)&&fr(d=>{const h=o?e.measuredBox[d]:e.layoutBox[d],f=hs(s[d]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+f)});const a=$c();Oh(a,s,e.layoutBox);const l=$c();o?Oh(l,t.applyTransform(r,!0),e.measuredBox):Oh(l,s,e.layoutBox);const c=!oL(a);let u=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const p=yn();Py(p,e.layoutBox,h.layoutBox);const m=yn();Py(m,s,f.layoutBox),aL(p,m)||(u=!0),d.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=p,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function HK(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function qK(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function KK(t){t.clearSnapshot()}function OR(t){t.clearMeasurements()}function FR(t){t.isLayoutDirty=!1}function XK(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function PR(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function YK(t){t.resolveTargetDelta()}function JK(t){t.calcProjection()}function QK(t){t.resetSkewAndRotation()}function ZK(t){t.removeLeadSnapshot()}function LR(t,e,n){t.translate=Mt(e.translate,0,n),t.scale=Mt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function MR(t,e,n,s){t.min=Mt(e.min,n.min,s),t.max=Mt(e.max,n.max,s)}function e7(t,e,n,s){MR(t.x,e.x,n.x,s),MR(t.y,e.y,n.y,s)}function t7(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const n7={duration:.45,ease:[.4,0,.1,1]},BR=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),zR=BR("applewebkit/")&&!BR("chrome/")?Math.round:Tr;function VR(t){t.min=zR(t.min),t.max=zR(t.max)}function s7(t){VR(t.x),VR(t.y)}function uL(t,e,n){return t==="position"||t==="preserve-aspect"&&!cK(_R(e),_R(n),.2)}function r7(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const i7=cL({attachResizeListener:(t,e)=>lf(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),n1={current:void 0},dL=cL({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!n1.current){const t=new i7({});t.mount(window),t.setOptions({layoutScroll:!0}),n1.current=t}return n1.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),o7={pan:{Feature:CK},drag:{Feature:kK,ProjectionNode:dL,MeasureLayout:sL}};function jR(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,i=s[r];i&&_t.postRender(()=>i(e,Bf(e)))}class a7 extends Ca{mount(){const{current:e}=this.node;e&&(this.unmount=I8(e,(n,s)=>(jR(this.node,s,"Start"),r=>jR(this.node,r,"End"))))}unmount(){}}class l7 extends Ca{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Pf(lf(this.node.current,"focus",()=>this.onFocus()),lf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function UR(t,e,n){const{props:s}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),i=s[r];i&&_t.postRender(()=>i(e,Bf(e)))}class c7 extends Ca{mount(){const{current:e}=this.node;e&&(this.unmount=A8(e,(n,s)=>(UR(this.node,s,"Start"),(r,{success:i})=>UR(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Gv=new WeakMap,s1=new WeakMap,u7=t=>{const e=Gv.get(t.target);e&&e(t)},d7=t=>{t.forEach(u7)};function h7({root:t,...e}){const n=t||document;s1.has(n)||s1.set(n,{});const s=s1.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(d7,{root:t,...e})),s[r]}function f7(t,e,n){const s=h7(e);return Gv.set(t,n),s.observe(t),()=>{Gv.delete(t),s.unobserve(t)}}const p7={some:0,all:1};class m7 extends Ca{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:p7[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return f7(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(g7(e,n))&&this.startObserver()}unmount(){}}function g7({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const y7={inView:{Feature:m7},tap:{Feature:c7},focus:{Feature:l7},hover:{Feature:a7}},x7={layout:{ProjectionNode:dL,MeasureLayout:sL}},w7={...sK,...y7,...o7,...x7},b7=wq(w7,_q),WR=t=>{let e;const n=new Set,s=(c,u)=>{const d=typeof c=="function"?c(e):c;if(!Object.is(d,e)){const h=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(f=>f(e,h))}},r=()=>e,a={setState:s,getState:r,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=e=t(s,r,a);return a},v7=t=>t?WR(t):WR,S7=t=>t;function k7(t,e=S7){const n=T1.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return T1.useDebugValue(n),n}const GR=t=>{const e=v7(t),n=s=>k7(e,s);return Object.assign(n,e),n},zf=t=>t?GR(t):GR;function hL(t,e){return function(){return t.apply(e,arguments)}}const{toString:C7}=Object.prototype,{getPrototypeOf:AC}=Object,{iterator:M0,toStringTag:fL}=Symbol,B0=(t=>e=>{const n=C7.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ii=t=>(t=t.toLowerCase(),e=>B0(e)===t),z0=t=>e=>typeof e===t,{isArray:Su}=Array,Yc=z0("undefined");function Vf(t){return t!==null&&!Yc(t)&&t.constructor!==null&&!Yc(t.constructor)&&Ps(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const pL=ii("ArrayBuffer");function N7(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&pL(t.buffer),e}const T7=z0("string"),Ps=z0("function"),mL=z0("number"),jf=t=>t!==null&&typeof t=="object",I7=t=>t===!0||t===!1,Vg=t=>{if(B0(t)!=="object")return!1;const e=AC(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(fL in t)&&!(M0 in t)},$7=t=>{if(!jf(t)||Vf(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},E7=ii("Date"),R7=ii("File"),A7=ii("Blob"),_7=ii("FileList"),D7=t=>jf(t)&&Ps(t.pipe),O7=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ps(t.append)&&((e=B0(t))==="formdata"||e==="object"&&Ps(t.toString)&&t.toString()==="[object FormData]"))},F7=ii("URLSearchParams"),[P7,L7,M7,B7]=["ReadableStream","Request","Response","Headers"].map(ii),z7=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Uf(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),Su(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{if(Vf(t))return;const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(s=0;s<o;s++)a=i[s],e.call(null,t[a],a,t)}}function gL(t,e){if(Vf(t))return null;e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const el=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,yL=t=>!Yc(t)&&t!==el;function Hv(){const{caseless:t,skipUndefined:e}=yL(this)&&this||{},n={},s=(r,i)=>{const o=t&&gL(n,i)||i;Vg(n[o])&&Vg(r)?n[o]=Hv(n[o],r):Vg(r)?n[o]=Hv({},r):Su(r)?n[o]=r.slice():(!e||!Yc(r))&&(n[o]=r)};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Uf(arguments[r],s);return n}const V7=(t,e,n,{allOwnKeys:s}={})=>(Uf(e,(r,i)=>{n&&Ps(r)?t[i]=hL(r,n):t[i]=r},{allOwnKeys:s}),t),j7=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),U7=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},W7=(t,e,n,s)=>{let r,i,o;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),i=r.length;i-- >0;)o=r[i],(!s||s(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&AC(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},G7=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},H7=t=>{if(!t)return null;if(Su(t))return t;let e=t.length;if(!mL(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},q7=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&AC(Uint8Array)),K7=(t,e)=>{const s=(t&&t[M0]).call(t);let r;for(;(r=s.next())&&!r.done;){const i=r.value;e.call(t,i[0],i[1])}},X7=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},Y7=ii("HTMLFormElement"),J7=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),HR=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Q7=ii("RegExp"),xL=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Uf(n,(r,i)=>{let o;(o=e(r,i,t))!==!1&&(s[i]=o||r)}),Object.defineProperties(t,s)},Z7=t=>{xL(t,(e,n)=>{if(Ps(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(Ps(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},eX=(t,e)=>{const n={},s=r=>{r.forEach(i=>{n[i]=!0})};return Su(t)?s(t):s(String(t).split(e)),n},tX=()=>{},nX=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function sX(t){return!!(t&&Ps(t.append)&&t[fL]==="FormData"&&t[M0])}const rX=t=>{const e=new Array(10),n=(s,r)=>{if(jf(s)){if(e.indexOf(s)>=0)return;if(Vf(s))return s;if(!("toJSON"in s)){e[r]=s;const i=Su(s)?[]:{};return Uf(s,(o,a)=>{const l=n(o,r+1);!Yc(l)&&(i[a]=l)}),e[r]=void 0,i}}return s};return n(t,0)},iX=ii("AsyncFunction"),oX=t=>t&&(jf(t)||Ps(t))&&Ps(t.then)&&Ps(t.catch),wL=((t,e)=>t?setImmediate:e?((n,s)=>(el.addEventListener("message",({source:r,data:i})=>{r===el&&i===n&&s.length&&s.shift()()},!1),r=>{s.push(r),el.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Ps(el.postMessage)),aX=typeof queueMicrotask<"u"?queueMicrotask.bind(el):typeof process<"u"&&process.nextTick||wL,lX=t=>t!=null&&Ps(t[M0]),ie={isArray:Su,isArrayBuffer:pL,isBuffer:Vf,isFormData:O7,isArrayBufferView:N7,isString:T7,isNumber:mL,isBoolean:I7,isObject:jf,isPlainObject:Vg,isEmptyObject:$7,isReadableStream:P7,isRequest:L7,isResponse:M7,isHeaders:B7,isUndefined:Yc,isDate:E7,isFile:R7,isBlob:A7,isRegExp:Q7,isFunction:Ps,isStream:D7,isURLSearchParams:F7,isTypedArray:q7,isFileList:_7,forEach:Uf,merge:Hv,extend:V7,trim:z7,stripBOM:j7,inherits:U7,toFlatObject:W7,kindOf:B0,kindOfTest:ii,endsWith:G7,toArray:H7,forEachEntry:K7,matchAll:X7,isHTMLForm:Y7,hasOwnProperty:HR,hasOwnProp:HR,reduceDescriptors:xL,freezeMethods:Z7,toObjectSet:eX,toCamelCase:J7,noop:tX,toFiniteNumber:nX,findKey:gL,global:el,isContextDefined:yL,isSpecCompliantForm:sX,toJSONObject:rX,isAsyncFn:iX,isThenable:oX,setImmediate:wL,asap:aX,isIterable:lX};function Me(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}ie.inherits(Me,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const bL=Me.prototype,vL={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{vL[t]={value:t}});Object.defineProperties(Me,vL);Object.defineProperty(bL,"isAxiosError",{value:!0});Me.from=(t,e,n,s,r,i)=>{const o=Object.create(bL);ie.toFlatObject(t,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const a=t&&t.message?t.message:"Error",l=e==null&&t?t.code:e;return Me.call(o,a,l,n,s,r),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",i&&Object.assign(o,i),o};const cX=null;function qv(t){return ie.isPlainObject(t)||ie.isArray(t)}function SL(t){return ie.endsWith(t,"[]")?t.slice(0,-2):t}function qR(t,e,n){return t?t.concat(e).map(function(r,i){return r=SL(r),!n&&i?"["+r+"]":r}).join(n?".":""):e}function uX(t){return ie.isArray(t)&&!t.some(qv)}const dX=ie.toFlatObject(ie,{},null,function(e){return/^is[A-Z]/.test(e)});function V0(t,e,n){if(!ie.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=ie.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!ie.isUndefined(g[m])});const s=n.metaTokens,r=n.visitor||u,i=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(e);if(!ie.isFunction(r))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(ie.isDate(p))return p.toISOString();if(ie.isBoolean(p))return p.toString();if(!l&&ie.isBlob(p))throw new Me("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(p)||ie.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,m,g){let y=p;if(p&&!g&&typeof p=="object"){if(ie.endsWith(m,"{}"))m=s?m:m.slice(0,-2),p=JSON.stringify(p);else if(ie.isArray(p)&&uX(p)||(ie.isFileList(p)||ie.endsWith(m,"[]"))&&(y=ie.toArray(p)))return m=SL(m),y.forEach(function(w,b){!(ie.isUndefined(w)||w===null)&&e.append(o===!0?qR([m],b,i):o===null?m:m+"[]",c(w))}),!1}return qv(p)?!0:(e.append(qR(g,m,i),c(p)),!1)}const d=[],h=Object.assign(dX,{defaultVisitor:u,convertValue:c,isVisitable:qv});function f(p,m){if(!ie.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(p),ie.forEach(p,function(y,x){(!(ie.isUndefined(y)||y===null)&&r.call(e,y,ie.isString(x)?x.trim():x,m,h))===!0&&f(y,m?m.concat(x):[x])}),d.pop()}}if(!ie.isObject(t))throw new TypeError("data must be an object");return f(t),e}function KR(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function _C(t,e){this._pairs=[],t&&V0(t,this,e)}const kL=_C.prototype;kL.append=function(e,n){this._pairs.push([e,n])};kL.toString=function(e){const n=e?function(s){return e.call(this,s,KR)}:KR;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function hX(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function CL(t,e,n){if(!e)return t;const s=n&&n.encode||hX;ie.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let i;if(r?i=r(e,n):i=ie.isURLSearchParams(e)?e.toString():new _C(e,n).toString(s),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class XR{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ie.forEach(this.handlers,function(s){s!==null&&e(s)})}}const NL={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fX=typeof URLSearchParams<"u"?URLSearchParams:_C,pX=typeof FormData<"u"?FormData:null,mX=typeof Blob<"u"?Blob:null,gX={isBrowser:!0,classes:{URLSearchParams:fX,FormData:pX,Blob:mX},protocols:["http","https","file","blob","url","data"]},DC=typeof window<"u"&&typeof document<"u",Kv=typeof navigator=="object"&&navigator||void 0,yX=DC&&(!Kv||["ReactNative","NativeScript","NS"].indexOf(Kv.product)<0),xX=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wX=DC&&window.location.href||"http://localhost",bX=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:DC,hasStandardBrowserEnv:yX,hasStandardBrowserWebWorkerEnv:xX,navigator:Kv,origin:wX},Symbol.toStringTag,{value:"Module"})),es={...bX,...gX};function vX(t,e){return V0(t,new es.classes.URLSearchParams,{visitor:function(n,s,r,i){return es.isNode&&ie.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function SX(t){return ie.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function kX(t){const e={},n=Object.keys(t);let s;const r=n.length;let i;for(s=0;s<r;s++)i=n[s],e[i]=t[i];return e}function TL(t){function e(n,s,r,i){let o=n[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=n.length;return o=!o&&ie.isArray(r)?r.length:o,l?(ie.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!a):((!r[o]||!ie.isObject(r[o]))&&(r[o]=[]),e(n,s,r[o],i)&&ie.isArray(r[o])&&(r[o]=kX(r[o])),!a)}if(ie.isFormData(t)&&ie.isFunction(t.entries)){const n={};return ie.forEachEntry(t,(s,r)=>{e(SX(s),r,n,0)}),n}return null}function CX(t,e,n){if(ie.isString(t))try{return(e||JSON.parse)(t),ie.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(0,JSON.stringify)(t)}const Wf={transitional:NL,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,i=ie.isObject(e);if(i&&ie.isHTMLForm(e)&&(e=new FormData(e)),ie.isFormData(e))return r?JSON.stringify(TL(e)):e;if(ie.isArrayBuffer(e)||ie.isBuffer(e)||ie.isStream(e)||ie.isFile(e)||ie.isBlob(e)||ie.isReadableStream(e))return e;if(ie.isArrayBufferView(e))return e.buffer;if(ie.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return vX(e,this.formSerializer).toString();if((a=ie.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return V0(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||r?(n.setContentType("application/json",!1),CX(e)):e}],transformResponse:[function(e){const n=this.transitional||Wf.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(ie.isResponse(e)||ie.isReadableStream(e))return e;if(e&&ie.isString(e)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?Me.from(a,Me.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:es.classes.FormData,Blob:es.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],t=>{Wf.headers[t]={}});const NX=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),TX=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||e[n]&&NX[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},YR=Symbol("internals");function Qd(t){return t&&String(t).trim().toLowerCase()}function jg(t){return t===!1||t==null?t:ie.isArray(t)?t.map(jg):String(t)}function IX(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const $X=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function r1(t,e,n,s,r){if(ie.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!ie.isString(e)){if(ie.isString(s))return e.indexOf(s)!==-1;if(ie.isRegExp(s))return s.test(e)}}function EX(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function RX(t,e){const n=ie.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,i,o){return this[s].call(this,e,r,i,o)},configurable:!0})})}class Ls{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function i(a,l,c){const u=Qd(l);if(!u)throw new Error("header name must be a non-empty string");const d=ie.findKey(r,u);(!d||r[d]===void 0||c===!0||c===void 0&&r[d]!==!1)&&(r[d||l]=jg(a))}const o=(a,l)=>ie.forEach(a,(c,u)=>i(c,u,l));if(ie.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(ie.isString(e)&&(e=e.trim())&&!$X(e))o(TX(e),n);else if(ie.isObject(e)&&ie.isIterable(e)){let a={},l,c;for(const u of e){if(!ie.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?ie.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,n)}else e!=null&&i(n,e,s);return this}get(e,n){if(e=Qd(e),e){const s=ie.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return IX(r);if(ie.isFunction(n))return n.call(this,r,s);if(ie.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Qd(e),e){const s=ie.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||r1(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function i(o){if(o=Qd(o),o){const a=ie.findKey(s,o);a&&(!n||r1(s,s[a],a,n))&&(delete s[a],r=!0)}}return ie.isArray(e)?e.forEach(i):i(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const i=n[s];(!e||r1(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const n=this,s={};return ie.forEach(this,(r,i)=>{const o=ie.findKey(s,i);if(o){n[o]=jg(r),delete n[i];return}const a=e?EX(i):String(i).trim();a!==i&&delete n[i],n[a]=jg(r),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return ie.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&ie.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[YR]=this[YR]={accessors:{}}).accessors,r=this.prototype;function i(o){const a=Qd(o);s[a]||(RX(r,o),s[a]=!0)}return ie.isArray(e)?e.forEach(i):i(e),this}}Ls.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(Ls.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});ie.freezeMethods(Ls);function i1(t,e){const n=this||Wf,s=e||n,r=Ls.from(s.headers);let i=s.data;return ie.forEach(t,function(a){i=a.call(n,i,r.normalize(),e?e.status:void 0)}),r.normalize(),i}function IL(t){return!!(t&&t.__CANCEL__)}function ku(t,e,n){Me.call(this,t??"canceled",Me.ERR_CANCELED,e,n),this.name="CanceledError"}ie.inherits(ku,Me,{__CANCEL__:!0});function $L(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new Me("Request failed with status code "+n.status,[Me.ERR_BAD_REQUEST,Me.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function AX(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function _X(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=s[i];o||(o=c),n[r]=l,s[r]=c;let d=i,h=0;for(;d!==r;)h+=n[d++],d=d%t;if(r=(r+1)%t,r===i&&(i=(i+1)%t),c-o<e)return;const f=u&&c-u;return f?Math.round(h*1e3/f):void 0}}function DX(t,e){let n=0,s=1e3/e,r,i;const o=(c,u=Date.now())=>{n=u,r=null,i&&(clearTimeout(i),i=null),t(...c)};return[(...c)=>{const u=Date.now(),d=u-n;d>=s?o(c,u):(r=c,i||(i=setTimeout(()=>{i=null,o(r)},s-d)))},()=>r&&o(r)]}const Ly=(t,e,n=3)=>{let s=0;const r=_X(50,250);return DX(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-s,c=r(l),u=o<=a;s=o;const d={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(d)},n)},JR=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},QR=t=>(...e)=>ie.asap(()=>t(...e)),OX=es.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,es.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(es.origin),es.navigator&&/(msie|trident)/i.test(es.navigator.userAgent)):()=>!0,FX=es.hasStandardBrowserEnv?{write(t,e,n,s,r,i,o){if(typeof document>"u")return;const a=[`${t}=${encodeURIComponent(e)}`];ie.isNumber(n)&&a.push(`expires=${new Date(n).toUTCString()}`),ie.isString(s)&&a.push(`path=${s}`),ie.isString(r)&&a.push(`domain=${r}`),i===!0&&a.push("secure"),ie.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function PX(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function LX(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function EL(t,e,n){let s=!PX(e);return t&&(s||n==!1)?LX(t,e):e}const ZR=t=>t instanceof Ls?{...t}:t;function wl(t,e){e=e||{};const n={};function s(c,u,d,h){return ie.isPlainObject(c)&&ie.isPlainObject(u)?ie.merge.call({caseless:h},c,u):ie.isPlainObject(u)?ie.merge({},u):ie.isArray(u)?u.slice():u}function r(c,u,d,h){if(ie.isUndefined(u)){if(!ie.isUndefined(c))return s(void 0,c,d,h)}else return s(c,u,d,h)}function i(c,u){if(!ie.isUndefined(u))return s(void 0,u)}function o(c,u){if(ie.isUndefined(u)){if(!ie.isUndefined(c))return s(void 0,c)}else return s(void 0,u)}function a(c,u,d){if(d in e)return s(c,u);if(d in t)return s(void 0,c)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,d)=>r(ZR(c),ZR(u),d,!0)};return ie.forEach(Object.keys({...t,...e}),function(u){const d=l[u]||r,h=d(t[u],e[u],u);ie.isUndefined(h)&&d!==a||(n[u]=h)}),n}const RL=t=>{const e=wl({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:a}=e;if(e.headers=o=Ls.from(o),e.url=CL(EL(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),ie.isFormData(n)){if(es.hasStandardBrowserEnv||es.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(ie.isFunction(n.getHeaders)){const l=n.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([u,d])=>{c.includes(u.toLowerCase())&&o.set(u,d)})}}if(es.hasStandardBrowserEnv&&(s&&ie.isFunction(s)&&(s=s(e)),s||s!==!1&&OX(e.url))){const l=r&&i&&FX.read(i);l&&o.set(r,l)}return e},MX=typeof XMLHttpRequest<"u",BX=MX&&function(t){return new Promise(function(n,s){const r=RL(t);let i=r.data;const o=Ls.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,u,d,h,f,p;function m(){f&&f(),p&&p(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(r.method.toUpperCase(),r.url,!0),g.timeout=r.timeout;function y(){if(!g)return;const w=Ls.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),S={data:!a||a==="text"||a==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:w,config:t,request:g};$L(function(I){n(I),m()},function(I){s(I),m()},S),g=null}"onloadend"in g?g.onloadend=y:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(y)},g.onabort=function(){g&&(s(new Me("Request aborted",Me.ECONNABORTED,t,g)),g=null)},g.onerror=function(b){const S=b&&b.message?b.message:"Network Error",T=new Me(S,Me.ERR_NETWORK,t,g);T.event=b||null,s(T),g=null},g.ontimeout=function(){let b=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const S=r.transitional||NL;r.timeoutErrorMessage&&(b=r.timeoutErrorMessage),s(new Me(b,S.clarifyTimeoutError?Me.ETIMEDOUT:Me.ECONNABORTED,t,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&ie.forEach(o.toJSON(),function(b,S){g.setRequestHeader(S,b)}),ie.isUndefined(r.withCredentials)||(g.withCredentials=!!r.withCredentials),a&&a!=="json"&&(g.responseType=r.responseType),c&&([h,p]=Ly(c,!0),g.addEventListener("progress",h)),l&&g.upload&&([d,f]=Ly(l),g.upload.addEventListener("progress",d),g.upload.addEventListener("loadend",f)),(r.cancelToken||r.signal)&&(u=w=>{g&&(s(!w||w.type?new ku(null,t,g):w),g.abort(),g=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const x=AX(r.url);if(x&&es.protocols.indexOf(x)===-1){s(new Me("Unsupported protocol "+x+":",Me.ERR_BAD_REQUEST,t));return}g.send(i||null)})},zX=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const i=function(c){if(!r){r=!0,a();const u=c instanceof Error?c:this.reason;s.abort(u instanceof Me?u:new ku(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,i(new Me(`timeout ${e} of ms exceeded`,Me.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),t=null)};t.forEach(c=>c.addEventListener("abort",i));const{signal:l}=s;return l.unsubscribe=()=>ie.asap(a),l}},VX=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},jX=async function*(t,e){for await(const n of UX(t))yield*VX(n,e)},UX=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},eA=(t,e,n,s)=>{const r=jX(t,e);let i=0,o,a=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await r.next();if(c){a(),l.close();return}let d=u.byteLength;if(n){let h=i+=d;n(h)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},tA=64*1024,{isFunction:ng}=ie,WX=(({Request:t,Response:e})=>({Request:t,Response:e}))(ie.global),{ReadableStream:nA,TextEncoder:sA}=ie.global,rA=(t,...e)=>{try{return!!t(...e)}catch{return!1}},GX=t=>{t=ie.merge.call({skipUndefined:!0},WX,t);const{fetch:e,Request:n,Response:s}=t,r=e?ng(e):typeof fetch=="function",i=ng(n),o=ng(s);if(!r)return!1;const a=r&&ng(nA),l=r&&(typeof sA=="function"?(p=>m=>p.encode(m))(new sA):async p=>new Uint8Array(await new n(p).arrayBuffer())),c=i&&a&&rA(()=>{let p=!1;const m=new n(es.origin,{body:new nA,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!m}),u=o&&a&&rA(()=>ie.isReadableStream(new s("").body)),d={stream:u&&(p=>p.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!d[p]&&(d[p]=(m,g)=>{let y=m&&m[p];if(y)return y.call(m);throw new Me(`Response type '${p}' is not supported`,Me.ERR_NOT_SUPPORT,g)})});const h=async p=>{if(p==null)return 0;if(ie.isBlob(p))return p.size;if(ie.isSpecCompliantForm(p))return(await new n(es.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(p)||ie.isArrayBuffer(p))return p.byteLength;if(ie.isURLSearchParams(p)&&(p=p+""),ie.isString(p))return(await l(p)).byteLength},f=async(p,m)=>{const g=ie.toFiniteNumber(p.getContentLength());return g??h(m)};return async p=>{let{url:m,method:g,data:y,signal:x,cancelToken:w,timeout:b,onDownloadProgress:S,onUploadProgress:T,responseType:I,headers:$,withCredentials:_="same-origin",fetchOptions:D}=RL(p),z=e||fetch;I=I?(I+"").toLowerCase():"text";let H=zX([x,w&&w.toAbortSignal()],b),X=null;const Y=H&&H.unsubscribe&&(()=>{H.unsubscribe()});let J;try{if(T&&c&&g!=="get"&&g!=="head"&&(J=await f($,y))!==0){let Z=new n(m,{method:"POST",body:y,duplex:"half"}),le;if(ie.isFormData(y)&&(le=Z.headers.get("content-type"))&&$.setContentType(le),Z.body){const[de,fe]=JR(J,Ly(QR(T)));y=eA(Z.body,tA,de,fe)}}ie.isString(_)||(_=_?"include":"omit");const Q=i&&"credentials"in n.prototype,ee={...D,signal:H,method:g.toUpperCase(),headers:$.normalize().toJSON(),body:y,duplex:"half",credentials:Q?_:void 0};X=i&&new n(m,ee);let M=await(i?z(X,D):z(m,ee));const q=u&&(I==="stream"||I==="response");if(u&&(S||q&&Y)){const Z={};["status","statusText","headers"].forEach(ne=>{Z[ne]=M[ne]});const le=ie.toFiniteNumber(M.headers.get("content-length")),[de,fe]=S&&JR(le,Ly(QR(S),!0))||[];M=new s(eA(M.body,tA,de,()=>{fe&&fe(),Y&&Y()}),Z)}I=I||"text";let te=await d[ie.findKey(d,I)||"text"](M,p);return!q&&Y&&Y(),await new Promise((Z,le)=>{$L(Z,le,{data:te,headers:Ls.from(M.headers),status:M.status,statusText:M.statusText,config:p,request:X})})}catch(Q){throw Y&&Y(),Q&&Q.name==="TypeError"&&/Load failed|fetch/i.test(Q.message)?Object.assign(new Me("Network Error",Me.ERR_NETWORK,p,X),{cause:Q.cause||Q}):Me.from(Q,Q&&Q.code,p,X)}}},HX=new Map,AL=t=>{let e=t&&t.env||{};const{fetch:n,Request:s,Response:r}=e,i=[s,r,n];let o=i.length,a=o,l,c,u=HX;for(;a--;)l=i[a],c=u.get(l),c===void 0&&u.set(l,c=a?new Map:GX(e)),u=c;return c};AL();const OC={http:cX,xhr:BX,fetch:{get:AL}};ie.forEach(OC,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const iA=t=>`- ${t}`,qX=t=>ie.isFunction(t)||t===null||t===!1;function KX(t,e){t=ie.isArray(t)?t:[t];const{length:n}=t;let s,r;const i={};for(let o=0;o<n;o++){s=t[o];let a;if(r=s,!qX(s)&&(r=OC[(a=String(s)).toLowerCase()],r===void 0))throw new Me(`Unknown adapter '${a}'`);if(r&&(ie.isFunction(r)||(r=r.get(e))))break;i[a||"#"+o]=r}if(!r){const o=Object.entries(i).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=n?o.length>1?`since :
`+o.map(iA).join(`
`):" "+iA(o[0]):"as no adapter specified";throw new Me("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r}const _L={getAdapter:KX,adapters:OC};function o1(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ku(null,t)}function oA(t){return o1(t),t.headers=Ls.from(t.headers),t.data=i1.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),_L.getAdapter(t.adapter||Wf.adapter,t)(t).then(function(s){return o1(t),s.data=i1.call(t,t.transformResponse,s),s.headers=Ls.from(s.headers),s},function(s){return IL(s)||(o1(t),s&&s.response&&(s.response.data=i1.call(t,t.transformResponse,s.response),s.response.headers=Ls.from(s.response.headers))),Promise.reject(s)})}const DL="1.13.2",j0={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{j0[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const aA={};j0.transitional=function(e,n,s){function r(i,o){return"[Axios v"+DL+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,a)=>{if(e===!1)throw new Me(r(o," has been removed"+(n?" in "+n:"")),Me.ERR_DEPRECATED);return n&&!aA[o]&&(aA[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,a):!0}};j0.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function XX(t,e,n){if(typeof t!="object")throw new Me("options must be an object",Me.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const i=s[r],o=e[i];if(o){const a=t[i],l=a===void 0||o(a,i,t);if(l!==!0)throw new Me("option "+i+" must be "+l,Me.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Me("Unknown option "+i,Me.ERR_BAD_OPTION)}}const Ug={assertOptions:XX,validators:j0},fi=Ug.validators;class ll{constructor(e){this.defaults=e||{},this.interceptors={request:new XR,response:new XR}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=wl(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:i}=n;s!==void 0&&Ug.assertOptions(s,{silentJSONParsing:fi.transitional(fi.boolean),forcedJSONParsing:fi.transitional(fi.boolean),clarifyTimeoutError:fi.transitional(fi.boolean)},!1),r!=null&&(ie.isFunction(r)?n.paramsSerializer={serialize:r}:Ug.assertOptions(r,{encode:fi.function,serialize:fi.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Ug.assertOptions(n,{baseUrl:fi.spelling("baseURL"),withXsrfToken:fi.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&ie.merge(i.common,i[n.method]);i&&ie.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),n.headers=Ls.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,d=0,h;if(!l){const p=[oA.bind(this),void 0];for(p.unshift(...a),p.push(...c),h=p.length,u=Promise.resolve(n);d<h;)u=u.then(p[d++],p[d++]);return u}h=a.length;let f=n;for(;d<h;){const p=a[d++],m=a[d++];try{f=p(f)}catch(g){m.call(this,g);break}}try{u=oA.call(this,f)}catch(p){return Promise.reject(p)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=wl(this.defaults,e);const n=EL(e.baseURL,e.url,e.allowAbsoluteUrls);return CL(n,e.params,e.paramsSerializer)}}ie.forEach(["delete","get","head","options"],function(e){ll.prototype[e]=function(n,s){return this.request(wl(s||{},{method:e,url:n,data:(s||{}).data}))}});ie.forEach(["post","put","patch"],function(e){function n(s){return function(i,o,a){return this.request(wl(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}ll.prototype[e]=n(),ll.prototype[e+"Form"]=n(!0)});class FC{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(a=>{s.subscribe(a),i=a}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},e(function(i,o,a){s.reason||(s.reason=new ku(i,o,a),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new FC(function(r){e=r}),cancel:e}}}function YX(t){return function(n){return t.apply(null,n)}}function JX(t){return ie.isObject(t)&&t.isAxiosError===!0}const Xv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Xv).forEach(([t,e])=>{Xv[e]=t});function OL(t){const e=new ll(t),n=hL(ll.prototype.request,e);return ie.extend(n,ll.prototype,e,{allOwnKeys:!0}),ie.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return OL(wl(t,r))},n}const mn=OL(Wf);mn.Axios=ll;mn.CanceledError=ku;mn.CancelToken=FC;mn.isCancel=IL;mn.VERSION=DL;mn.toFormData=V0;mn.AxiosError=Me;mn.Cancel=mn.CanceledError;mn.all=function(e){return Promise.all(e)};mn.spread=YX;mn.isAxiosError=JX;mn.mergeConfig=wl;mn.AxiosHeaders=Ls;mn.formToJSON=t=>TL(ie.isHTMLForm(t)?new FormData(t):t);mn.getAdapter=_L.getAdapter;mn.HttpStatusCode=Xv;mn.default=mn;const QX="https://z-app-backend.onrender.com",St=mn.create({baseURL:`${QX}/api`,withCredentials:!0,timeout:15e3,headers:{"Content-Type":"application/json"}});St.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t));St.interceptors.response.use(t=>t,t=>{var e,n,s,r,i,o;if(((e=t.response)==null?void 0:e.status)===401){const a=((n=t.config)==null?void 0:n.url)||"",l=((r=(s=t.response)==null?void 0:s.data)==null?void 0:r.message)||((o=(i=t.response)==null?void 0:i.data)==null?void 0:o.error)||"";(a.includes("/auth/check")||l.toLowerCase().includes("invalid")||l.toLowerCase().includes("expired")||l.toLowerCase().includes("no token"))&&(localStorage.removeItem("token"),localStorage.removeItem("authUser"),window.location.pathname.includes("/login")||(window.location.href="/login"))}return Promise.reject(t)});const ZX=Object.freeze(Object.defineProperty({__proto__:null,axiosInstance:St},Symbol.toStringTag,{value:"Module"})),Di=Object.create(null);Di.open="0";Di.close="1";Di.ping="2";Di.pong="3";Di.message="4";Di.upgrade="5";Di.noop="6";const Wg=Object.create(null);Object.keys(Di).forEach(t=>{Wg[Di[t]]=t});const Yv={type:"error",data:"parser error"},FL=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",PL=typeof ArrayBuffer=="function",LL=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,PC=({type:t,data:e},n,s)=>FL&&e instanceof Blob?n?s(e):lA(e,s):PL&&(e instanceof ArrayBuffer||LL(e))?n?s(e):lA(new Blob([e]),s):s(Di[t]+(e||"")),lA=(t,e)=>{const n=new FileReader;return n.onload=function(){const s=n.result.split(",")[1];e("b"+(s||""))},n.readAsDataURL(t)};function cA(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let a1;function e9(t,e){if(FL&&t.data instanceof Blob)return t.data.arrayBuffer().then(cA).then(e);if(PL&&(t.data instanceof ArrayBuffer||LL(t.data)))return e(cA(t.data));PC(t,!1,n=>{a1||(a1=new TextEncoder),e(a1.encode(n))})}const uA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<uA.length;t++)hh[uA.charCodeAt(t)]=t;const t9=t=>{let e=t.length*.75,n=t.length,s,r=0,i,o,a,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(s=0;s<n;s+=4)i=hh[t.charCodeAt(s)],o=hh[t.charCodeAt(s+1)],a=hh[t.charCodeAt(s+2)],l=hh[t.charCodeAt(s+3)],u[r++]=i<<2|o>>4,u[r++]=(o&15)<<4|a>>2,u[r++]=(a&3)<<6|l&63;return c},n9=typeof ArrayBuffer=="function",LC=(t,e)=>{if(typeof t!="string")return{type:"message",data:ML(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:s9(t.substring(1),e)}:Wg[n]?t.length>1?{type:Wg[n],data:t.substring(1)}:{type:Wg[n]}:Yv},s9=(t,e)=>{if(n9){const n=t9(t);return ML(n,e)}else return{base64:!0,data:t}},ML=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},BL="",r9=(t,e)=>{const n=t.length,s=new Array(n);let r=0;t.forEach((i,o)=>{PC(i,!1,a=>{s[o]=a,++r===n&&e(s.join(BL))})})},i9=(t,e)=>{const n=t.split(BL),s=[];for(let r=0;r<n.length;r++){const i=LC(n[r],e);if(s.push(i),i.type==="error")break}return s};function o9(){return new TransformStream({transform(t,e){e9(t,n=>{const s=n.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}t.data&&typeof t.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(n)})}})}let l1;function sg(t){return t.reduce((e,n)=>e+n.length,0)}function rg(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)n[r]=t[0][s++],s===t[0].length&&(t.shift(),s=0);return t.length&&s<t[0].length&&(t[0]=t[0].slice(s)),n}function a9(t,e){l1||(l1=new TextDecoder);const n=[];let s=0,r=-1,i=!1;return new TransformStream({transform(o,a){for(n.push(o);;){if(s===0){if(sg(n)<1)break;const l=rg(n,1);i=(l[0]&128)===128,r=l[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(sg(n)<2)break;const l=rg(n,2);r=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),s=3}else if(s===2){if(sg(n)<8)break;const l=rg(n,8),c=new DataView(l.buffer,l.byteOffset,l.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(Yv);break}r=u*Math.pow(2,32)+c.getUint32(4),s=3}else{if(sg(n)<r)break;const l=rg(n,r);a.enqueue(LC(i?l:l1.decode(l),e)),s=0}if(r===0||r>t){a.enqueue(Yv);break}}}})}const zL=4;function un(t){if(t)return l9(t)}function l9(t){for(var e in un.prototype)t[e]=un.prototype[e];return t}un.prototype.on=un.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};un.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};un.prototype.off=un.prototype.removeListener=un.prototype.removeAllListeners=un.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var s,r=0;r<n.length;r++)if(s=n[r],s===e||s.fn===e){n.splice(r,1);break}return n.length===0&&delete this._callbacks["$"+t],this};un.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(n){n=n.slice(0);for(var s=0,r=n.length;s<r;++s)n[s].apply(this,e)}return this};un.prototype.emitReserved=un.prototype.emit;un.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};un.prototype.hasListeners=function(t){return!!this.listeners(t).length};const U0=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),xr=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),c9="arraybuffer";function VL(t,...e){return e.reduce((n,s)=>(t.hasOwnProperty(s)&&(n[s]=t[s]),n),{})}const u9=xr.setTimeout,d9=xr.clearTimeout;function W0(t,e){e.useNativeTimers?(t.setTimeoutFn=u9.bind(xr),t.clearTimeoutFn=d9.bind(xr)):(t.setTimeoutFn=xr.setTimeout.bind(xr),t.clearTimeoutFn=xr.clearTimeout.bind(xr))}const h9=1.33;function f9(t){return typeof t=="string"?p9(t):Math.ceil((t.byteLength||t.size)*h9)}function p9(t){let e=0,n=0;for(let s=0,r=t.length;s<r;s++)e=t.charCodeAt(s),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(s++,n+=4);return n}function jL(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function m9(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function g9(t){let e={},n=t.split("&");for(let s=0,r=n.length;s<r;s++){let i=n[s].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}class y9 extends Error{constructor(e,n,s){super(e),this.description=n,this.context=s,this.type="TransportError"}}class MC extends un{constructor(e){super(),this.writable=!1,W0(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,s){return super.emitReserved("error",new y9(e,n,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=LC(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=m9(e);return n.length?"?"+n:""}}class x9 extends MC{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||n()})),this.writable||(s++,this.once("drain",function(){--s||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};i9(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,r9(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=jL()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let UL=!1;try{UL=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const w9=UL;function b9(){}class v9 extends x9{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let s=location.port;s||(s=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,n){const s=this.request({method:"POST",data:e});s.on("success",n),s.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,s)=>{this.onError("xhr poll error",n,s)}),this.pollXhr=e}}class Ii extends un{constructor(e,n,s){super(),this.createRequest=e,W0(this,s),this._opts=s,this._method=s.method||"GET",this._uri=n,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const n=VL(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(n);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=Ii.requestsCount++,Ii.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=b9,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ii.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Ii.requestsCount=0;Ii.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",dA);else if(typeof addEventListener=="function"){const t="onpagehide"in xr?"pagehide":"unload";addEventListener(t,dA,!1)}}function dA(){for(let t in Ii.requests)Ii.requests.hasOwnProperty(t)&&Ii.requests[t].abort()}const S9=function(){const t=WL({xdomain:!1});return t&&t.responseType!==null}();class k9 extends v9{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=S9&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Ii(WL,this.uri(),e)}}function WL(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||w9))return new XMLHttpRequest}catch{}if(!e)try{return new xr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const GL=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class C9 extends MC{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,s=GL?{}:VL(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const s=e[n],r=n===e.length-1;PC(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}r&&U0(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=jL()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const c1=xr.WebSocket||xr.MozWebSocket;class N9 extends C9{createSocket(e,n,s){return GL?new c1(e,n,s):n?new c1(e,n):new c1(e)}doWrite(e,n){this.ws.send(n)}}class T9 extends MC{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=a9(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(n).getReader(),r=o9();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const i=()=>{s.read().then(({done:a,value:l})=>{a||(this.onPacket(l),i())}).catch(a=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const s=e[n],r=n===e.length-1;this._writer.write(s).then(()=>{r&&U0(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const I9={websocket:N9,webtransport:T9,polling:k9},$9=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,E9=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Jv(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),s=t.indexOf("]");n!=-1&&s!=-1&&(t=t.substring(0,n)+t.substring(n,s).replace(/:/g,";")+t.substring(s,t.length));let r=$9.exec(t||""),i={},o=14;for(;o--;)i[E9[o]]=r[o]||"";return n!=-1&&s!=-1&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=R9(i,i.path),i.queryKey=A9(i,i.query),i}function R9(t,e){const n=/\/{2,9}/g,s=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function A9(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,i){r&&(n[r]=i)}),n}const Qv=typeof addEventListener=="function"&&typeof removeEventListener=="function",Gg=[];Qv&&addEventListener("offline",()=>{Gg.forEach(t=>t())},!1);class Zo extends un{constructor(e,n){if(super(),this.binaryType=c9,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const s=Jv(e);n.hostname=s.host,n.secure=s.protocol==="https"||s.protocol==="wss",n.port=s.port,s.query&&(n.query=s.query)}else n.host&&(n.hostname=Jv(n.host).host);W0(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=g9(this.opts.query)),Qv&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Gg.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=zL,n.transport=e,this.id&&(n.sid=this.id);const s=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Zo.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Zo.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(n+=f9(r)),s>0&&n>this._maxPayload)return this.writeBuffer.slice(0,s);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,U0(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,s){return this._sendPacket("message",e,n,s),this}send(e,n,s){return this._sendPacket("message",e,n,s),this}_sendPacket(e,n,s,r){if(typeof n=="function"&&(r=n,n=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:e,data:n,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},s=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(Zo.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Qv&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Gg.indexOf(this._offlineEventListener);s!==-1&&Gg.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}Zo.protocol=zL;class _9 extends Zo{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),s=!1;Zo.priorWebsocketSuccess=!1;const r=()=>{s||(n.send([{type:"ping",data:"probe"}]),n.once("packet",d=>{if(!s)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Zo.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=n.name,this.emitReserved("upgradeError",h)}}))};function i(){s||(s=!0,u(),n.close(),n=null)}const o=d=>{const h=new Error("probe error: "+d);h.transport=n.name,i(),this.emitReserved("upgradeError",h)};function a(){o("transport closed")}function l(){o("socket closed")}function c(d){n&&d.name!==n.name&&i()}const u=()=>{n.removeListener("open",r),n.removeListener("error",o),n.removeListener("close",a),this.off("close",l),this.off("upgrading",c)};n.once("open",r),n.once("error",o),n.once("close",a),this.once("close",l),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&n.push(e[s]);return n}}let D9=class extends _9{constructor(e,n={}){const s=typeof e=="object"?e:n;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>I9[r]).filter(r=>!!r)),super(e,s)}};function O9(t,e="",n){let s=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),s=Jv(t)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+e,s.href=s.protocol+"://"+i+(n&&n.port===s.port?"":":"+s.port),s}const F9=typeof ArrayBuffer=="function",P9=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,HL=Object.prototype.toString,L9=typeof Blob=="function"||typeof Blob<"u"&&HL.call(Blob)==="[object BlobConstructor]",M9=typeof File=="function"||typeof File<"u"&&HL.call(File)==="[object FileConstructor]";function BC(t){return F9&&(t instanceof ArrayBuffer||P9(t))||L9&&t instanceof Blob||M9&&t instanceof File}function Hg(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,s=t.length;n<s;n++)if(Hg(t[n]))return!0;return!1}if(BC(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Hg(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Hg(t[n]))return!0;return!1}function B9(t){const e=[],n=t.data,s=t;return s.data=Zv(n,e),s.attachments=e.length,{packet:s,buffers:e}}function Zv(t,e){if(!t)return t;if(BC(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let s=0;s<t.length;s++)n[s]=Zv(t[s],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=Zv(t[s],e));return n}return t}function z9(t,e){return t.data=eS(t.data,e),delete t.attachments,t}function eS(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=eS(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=eS(t[n],e));return t}const V9=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],j9=5;var Ye;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Ye||(Ye={}));class U9{constructor(e){this.replacer=e}encode(e){return(e.type===Ye.EVENT||e.type===Ye.ACK)&&Hg(e)?this.encodeAsBinary({type:e.type===Ye.EVENT?Ye.BINARY_EVENT:Ye.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===Ye.BINARY_EVENT||e.type===Ye.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=B9(e),s=this.encodeAsString(n.packet),r=n.buffers;return r.unshift(s),r}}function hA(t){return Object.prototype.toString.call(t)==="[object Object]"}class zC extends un{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const s=n.type===Ye.BINARY_EVENT;s||n.type===Ye.BINARY_ACK?(n.type=s?Ye.EVENT:Ye.ACK,this.reconstructor=new W9(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(BC(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const s={type:Number(e.charAt(0))};if(Ye[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Ye.BINARY_EVENT||s.type===Ye.BINARY_ACK){const i=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const o=e.substring(i,n);if(o!=Number(o)||e.charAt(n)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););s.nsp=e.substring(i,n)}else s.nsp="/";const r=e.charAt(n+1);if(r!==""&&Number(r)==r){const i=n+1;for(;++n;){const o=e.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===e.length)break}s.id=Number(e.substring(i,n+1))}if(e.charAt(++n)){const i=this.tryParse(e.substr(n));if(zC.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case Ye.CONNECT:return hA(n);case Ye.DISCONNECT:return n===void 0;case Ye.CONNECT_ERROR:return typeof n=="string"||hA(n);case Ye.EVENT:case Ye.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&V9.indexOf(n[0])===-1);case Ye.ACK:case Ye.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class W9{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=z9(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const G9=Object.freeze(Object.defineProperty({__proto__:null,Decoder:zC,Encoder:U9,get PacketType(){return Ye},protocol:j9},Symbol.toStringTag,{value:"Module"}));function Ur(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const H9=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class qL extends un{constructor(e,n,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ur(e,"open",this.onopen.bind(this)),Ur(e,"packet",this.onpacket.bind(this)),Ur(e,"error",this.onerror.bind(this)),Ur(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var s,r,i;if(H9.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:Ye.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const u=this.ids++,d=n.pop();this._registerAckCallback(u,d),o.id=u}const a=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,l=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,n){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);n.call(this,new Error("operation has timed out"))},r),o=(...a)=>{this.io.clearTimeoutFn(i),n.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...n){return new Promise((s,r)=>{const i=(o,a)=>o?r(o):s(a);i.withError=!0,n.push(i),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...i)=>s!==this._queue[0]?void 0:(r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(r)):(this._queue.shift(),n&&n(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Ye.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Ye.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ye.EVENT:case Ye.BINARY_EVENT:this.onevent(e);break;case Ye.ACK:case Ye.BINARY_ACK:this.onack(e);break;case Ye.DISCONNECT:this.ondisconnect();break;case Ye.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const s of n)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let s=!1;return function(...r){s||(s=!0,n.packet({type:Ye.ACK,id:e,data:r}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ye.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let s=0;s<n.length;s++)if(e===n[s])return n.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let s=0;s<n.length;s++)if(e===n[s])return n.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const s of n)s.apply(this,e.data)}}}function Cu(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Cu.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+n:t-n}return Math.min(t,this.max)|0};Cu.prototype.reset=function(){this.attempts=0};Cu.prototype.setMin=function(t){this.ms=t};Cu.prototype.setMax=function(t){this.max=t};Cu.prototype.setJitter=function(t){this.jitter=t};class tS extends un{constructor(e,n){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,W0(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((s=n.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Cu({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const r=n.parser||G9;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new D9(this.uri,this.opts);const n=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=Ur(n,"open",function(){s.onopen(),e&&e()}),i=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=Ur(n,"error",i);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),n.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ur(e,"ping",this.onping.bind(this)),Ur(e,"data",this.ondata.bind(this)),Ur(e,"error",this.onerror.bind(this)),Ur(e,"close",this.onclose.bind(this)),Ur(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){U0(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new qL(this,e,n),this.nsps[e]=s),s}_destroy(e){const n=Object.keys(this.nsps);for(const s of n)if(this.nsps[s].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let s=0;s<n.length;s++)this.engine.write(n[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},n);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Zd={};function qg(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=O9(t,e.path||"/socket.io"),s=n.source,r=n.id,i=n.path,o=Zd[r]&&i in Zd[r].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new tS(s,e):(Zd[r]||(Zd[r]=new tS(s,e)),l=Zd[r]),n.query&&!e.query&&(e.query=n.queryKey),l.socket(n.path,e)}Object.assign(qg,{Manager:tS,Socket:qL,io:qg,connect:qg});const q9="zapp-cache",K9=1;let ig=null;const Gf=()=>ig?Promise.resolve(ig):new Promise((t,e)=>{const n=indexedDB.open(q9,K9);n.onerror=()=>e(n.error),n.onsuccess=()=>{ig=n.result,t(ig)},n.onupgradeneeded=s=>{const r=s.target.result;r.objectStoreNames.contains("friends")||r.createObjectStore("friends",{keyPath:"userId"}),r.objectStoreNames.contains("messages")||r.createObjectStore("messages",{keyPath:"chatId"}),r.objectStoreNames.contains("users")||r.createObjectStore("users",{keyPath:"userId"})}}),X9=async(t,e)=>{try{await(await Gf()).transaction("friends","readwrite").objectStore("friends").put({userId:t,data:e,timestamp:Date.now()})}catch(n){console.error("Failed to cache friends:",n)}},Y9=async t=>{try{const s=await(await Gf()).transaction("friends","readonly").objectStore("friends").get(t);return s&&Date.now()-s.timestamp<5*60*1e3?s.data:null}catch(e){return console.error("Failed to get cached friends:",e),null}},J9=async(t,e)=>{try{await(await Gf()).transaction("messages","readwrite").objectStore("messages").put({chatId:t,messages:e,timestamp:Date.now()})}catch(n){console.error("Failed to cache messages:",n)}},Q9=async t=>{try{const s=await(await Gf()).transaction("messages","readonly").objectStore("messages").get(t);return s&&Date.now()-s.timestamp<10*60*1e3?s.messages:null}catch(e){return console.error("Failed to get cached messages:",e),null}},Z9=async()=>{try{const t=await Gf(),e=["friends","messages","users"],n=Date.now()-60*60*1e3;for(const s of e){const o=t.transaction(s,"readwrite").objectStore(s).openCursor();o.onsuccess=a=>{const l=a.target.result;l&&(l.value.timestamp<n&&l.delete(),l.continue())}}}catch(t){console.error("Failed to clean old cache:",t)}};typeof window<"u"&&setInterval(Z9,30*60*1e3);const qr=zf((t,e)=>({friends:[],pendingReceived:[],pendingSent:[],isLoading:!1,fetchFriendData:async()=>{var i,o,a;const s=JSON.parse(localStorage.getItem("authUser")||"{}")._id,r=await Y9(s);t(r?{friends:r.friends||[],pendingReceived:r.received||[],pendingSent:r.sent||[],isLoading:!1}:{isLoading:!0});try{const[l,c]=await Promise.all([St.get("/friends/all"),St.get("/friends/requests")]),u={friends:l.data||[],received:((i=c.data)==null?void 0:i.received)||[],sent:((o=c.data)==null?void 0:o.sent)||[]};await X9(s,u),t(d=>{var S,T;const h=l.data||[],f=((S=c.data)==null?void 0:S.received)||[],p=((T=c.data)==null?void 0:T.sent)||[],m=new Set(f.map(I=>I._id)),g=new Set(p.map(I=>I._id)),y=d.pendingReceived.filter(I=>m.has(I._id)),x=d.pendingSent.filter(I=>g.has(I._id)),w=[...y];f.forEach(I=>{w.some($=>$._id===I._id)||w.push(I)});const b=[...x];return p.forEach(I=>{b.some($=>$._id===I._id)||b.push(I)}),{friends:h,pendingReceived:w,pendingSent:b}})}catch(l){console.error(" Failed to fetch friend data:",((a=l.response)==null?void 0:a.data)||l.message),t({friends:[],pendingReceived:[],pendingSent:[]})}finally{t({isLoading:!1})}},getFriendshipStatus:n=>{const{friends:s,pendingSent:r,pendingReceived:i}=e();return s.some(o=>o._id===n)?"FRIENDS":r.some(o=>o._id===n)?"REQUEST_SENT":i.some(o=>o._id===n)?"REQUEST_RECEIVED":"NOT_FRIENDS"},addPendingReceived:n=>{t(s=>s.pendingReceived.some(r=>r._id===n._id)?s:(ve.success(`New friend request from ${n.nickname||n.username}! `),{pendingReceived:[n,...s.pendingReceived]}))},sendRequest:async n=>{var s,r;try{return await St.post(`/friends/send/${n}`),e().fetchFriendData(),ve.success("Friend request sent!"),!0}catch(i){return ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to send request."),!1}},acceptRequest:async n=>{var s,r;try{const i=e().pendingReceived.find(o=>o._id===n);return t(o=>({pendingReceived:o.pendingReceived.filter(a=>a._id!==n),friends:i?[...o.friends,i]:o.friends})),await St.post(`/friends/accept/${n}`),ve.success("Friend request accepted!"),e().fetchFriendData(),!0}catch(i){return ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to accept request."),e().fetchFriendData(),!1}},rejectRequest:async n=>{var s,r;try{return await St.post(`/friends/reject/${n}`),t(i=>({pendingReceived:i.pendingReceived.filter(o=>o._id!==n),pendingSent:i.pendingSent.filter(o=>o._id!==n)})),ve.success("Request rejected."),!0}catch(i){return ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to reject request."),!1}},unfriend:async n=>{var s,r;try{return await St.delete(`/friends/unfriend/${n}`),t(i=>({friends:i.friends.filter(o=>o._id!==n)})),ve.success("User unfriended."),!0}catch(i){return ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to unfriend."),!1}},clearFriendData:()=>{t({friends:[],pendingReceived:[],pendingSent:[]})}})),fA="https://z-app-backend.onrender.com",Wt=zf((t,e)=>({authUser:null,isSigningUp:!1,isLoggingIn:!1,isUpdatingProfile:!1,isCheckingAuth:!0,onlineUsers:[],socket:null,setAuthUser:n=>{t({authUser:n})},checkAuth:async()=>{var n,s,r,i;try{const o=localStorage.getItem("token"),a=localStorage.getItem("authUser");if(!o){t({authUser:null,isCheckingAuth:!1});return}if(a)try{const u=JSON.parse(a);t({authUser:u,isCheckingAuth:!1})}catch{console.error("Failed to parse cached user")}else t({isCheckingAuth:!0});St.defaults.headers.common.Authorization=`Bearer ${o}`;const c=(await St.get("/auth/check")).data;if(!c||typeof c!="object")throw new Error("Invalid user data received");if(c.isBlocked){console.log("User is blocked"),ve.error("Account is blocked"),t({authUser:null,isCheckingAuth:!1}),localStorage.removeItem("authUser"),localStorage.removeItem("token");return}if(c.isSuspended&&c.suspendedUntil&&new Date(c.suspendedUntil)>new Date){console.log("User is suspended"),ve.error("Account is suspended"),t({authUser:null,isCheckingAuth:!1}),localStorage.removeItem("authUser"),localStorage.removeItem("token");return}console.log("Auth check successful for user:",c.username),t({authUser:c}),localStorage.setItem("authUser",JSON.stringify(c)),e().connectSocket(),qr.getState().fetchFriendData()}catch(o){if(console.log("Auth check failed:",(n=o.response)==null?void 0:n.status,((r=(s=o.response)==null?void 0:s.data)==null?void 0:r.message)||o.message),((i=o.response)==null?void 0:i.status)===401)console.log("Token invalid or expired, clearing auth"),t({authUser:null}),localStorage.removeItem("authUser"),localStorage.removeItem("token"),delete St.defaults.headers.common.Authorization,e().disconnectSocket(),qr.getState().clearFriendData();else{console.log("Network error during auth check, keeping user logged in");const a=localStorage.getItem("authUser");if(a)try{t({authUser:JSON.parse(a)})}catch(l){console.error("Failed to parse cached user:",l)}}}finally{t({isCheckingAuth:!1})}},signup:async n=>{var s,r;t({isSigningUp:!0});try{const i=await St.post("/auth/signup",n),{token:o,...a}=i.data;return o&&(localStorage.setItem("token",o),St.defaults.headers.common.Authorization=`Bearer ${o}`),t({authUser:a}),localStorage.setItem("authUser",JSON.stringify(a)),ve.success("Account created successfully"),e().connectSocket(),qr.getState().fetchFriendData(),!0}catch(i){return ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Signup failed"),!1}finally{t({isSigningUp:!1})}},login:async n=>{var s,r;t({isLoggingIn:!0});try{const i=await St.post("/auth/login",n),{token:o,...a}=i.data;if(!a||typeof a!="object")throw new Error("Invalid login response");if(a.isBlocked){ve.error("Account is blocked");return}if(a.suspension&&new Date(a.suspension.endTime)>new Date){ve.error("Account is suspended");return}return o&&(localStorage.setItem("token",o),St.defaults.headers.common.Authorization=`Bearer ${o}`),t({authUser:a}),localStorage.setItem("authUser",JSON.stringify(a)),ve.success("Logged in successfully"),e().connectSocket(),qr.getState().fetchFriendData(),!0}catch(i){return ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Login failed"),!1}finally{t({isLoggingIn:!1})}},logout:async()=>{var s,r;e().socket&&e().disconnectSocket();try{await St.post("/auth/logout",{})}catch(i){console.error("Logout API call error:",((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||i.message)}finally{localStorage.removeItem("authUser"),localStorage.removeItem("token"),delete St.defaults.headers.common.Authorization,t({authUser:null,onlineUsers:[],socket:null}),qr.getState().clearFriendData(),ve.success("Logged out successfully")}},updateProfile:async n=>{var s,r;t({isUpdatingProfile:!0});try{const o=(await St.put("/auth/update-profile",n)).data;t({authUser:o}),localStorage.setItem("authUser",JSON.stringify(o)),ve.success("Profile updated successfully")}catch(i){ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Profile update failed")}finally{t({isUpdatingProfile:!1})}},connectSocket:()=>{const{authUser:n,socket:s}=e();if(!n||s){console.log(`connectSocket: Skipped. authUser: ${!!n}, socket: ${!!s}`);return}console.log(`Connecting socket to ${fA} for user ${n._id}`);const r=localStorage.getItem("token"),i=qg(fA,{query:{userId:n._id,token:r},auth:{token:r},transports:["websocket"]});t({socket:i}),i.on("connect",()=>console.log(" Socket connected:",i.id)),i.on("connect_error",a=>{console.error("Socket connection error:",a.message),ve.error("Real-time connection failed."),e().disconnectSocket()}),i.on("getOnlineUsers",a=>{console.log(" Online users updated:",a),t({onlineUsers:a})});const o=a=>{ve.error(a),e().logout()};i.on("user-suspended",({reason:a})=>{o(`Suspended: ${a||"N/A"}`)}),i.on("user-blocked",()=>o("Account blocked")),i.on("user-deleted",()=>o("Account deleted")),i.on("disconnect",a=>{console.log(" Socket disconnected:",a)}),i.io.on("reconnect",async a=>{console.log(` Socket reconnected after ${a} attempts`),e().authUser&&(i.emit("register-user",e().authUser._id),await e().checkAuth())}),i.io.on("reconnect_attempt",a=>{console.log(`Attempting to reconnect socket... (${a})`)}),i.io.on("reconnect_error",a=>{console.error("Socket reconnection error:",a.message)}),i.io.on("reconnect_failed",()=>{console.error("Socket reconnection failed after multiple attempts."),ve.error("Disconnected from server.")})},disconnectSocket:()=>{const n=e().socket;n&&(console.log("Disconnecting socket...",n.id),n.disconnect(),t({socket:null,onlineUsers:[]}))}})),VC={MESSAGES:"z_app_messages_cache",USERS:"z_app_users_cache",FRIENDS:"z_app_friends_cache",PROFILE:"z_app_profile_cache",LAST_SYNC:"z_app_last_sync"},eY=(t,e)=>{try{localStorage.setItem(t,JSON.stringify({data:e,timestamp:Date.now()}))}catch(n){console.error("Failed to save to cache:",n)}},tY=t=>{try{const e=localStorage.getItem(t);if(!e)return null;const{data:n,timestamp:s}=JSON.parse(e),r=7*24*60*60*1e3;return Date.now()-s>r?(localStorage.removeItem(t),null):n}catch(e){return console.error("Failed to get from cache:",e),null}},pA=(t,e)=>{const n=`${VC.MESSAGES}_${t}`;eY(n,e)},mA=t=>{const e=`${VC.MESSAGES}_${t}`;return tY(e)},nY=()=>{localStorage.setItem(VC.LAST_SYNC,Date.now().toString())},Na=zf((t,e)=>({messages:[],selectedUser:null,isMessagesLoading:!1,unreadCounts:{},callState:"idle",callPartner:null,callType:null,incomingCallData:null,isMuted:!1,isCameraOff:!1,getMessages:async n=>{var r,i,o;t({messages:[],isMessagesLoading:!0});const s=await Q9(n);if(s&&s.length>0)t({messages:s,isMessagesLoading:!1});else{const a=mA(n);a&&a.length>0&&t({messages:a,isMessagesLoading:!1})}try{const a=await St.get(`/messages/${n}`);t({messages:a.data}),await J9(n,a.data),pA(n,a.data),nY(),e().resetUnread(n),e().markMessagesAsRead(n)}catch(a){(s==null?void 0:s.length)>0||((r=mA(n))==null?void 0:r.length)>0?console.log("Using cached messages - API failed"):(ve.error(((o=(i=a.response)==null?void 0:i.data)==null?void 0:o.message)||"Failed to fetch messages"),t({messages:[]}))}finally{t({isMessagesLoading:!1})}},sendMessage:async n=>{var l,c;const{selectedUser:s,messages:r}=e(),{authUser:i}=Wt.getState();if(!s)return;if(!navigator.onLine){ve.error("You are offline - Cannot send messages");return}const o=`temp-${Date.now()}`,a={_id:o,senderId:i._id,receiverId:s._id,text:n.text||"",image:n.image||null,voice:n.voice||null,voiceDuration:n.voiceDuration||null,replyTo:n.replyTo||null,status:"sending",createdAt:new Date().toISOString(),reactions:[],isOptimistic:!0};t({messages:[...r,a]});try{const u=await St.post(`/messages/send/${s._id}`,n);if(u.data&&u.data._id){const d=r.filter(h=>h._id!==o).concat(u.data);t({messages:d}),pA(s._id,d)}}catch(u){t({messages:r.filter(d=>d._id!==o)}),ve.error(((c=(l=u.response)==null?void 0:l.data)==null?void 0:c.message)||"Failed to send message")}},subscribeToMessages:()=>{const{socket:n}=Wt.getState();if(!n)return;const s=a=>{const{selectedUser:l,messages:c}=e();a&&a._id&&!c.find(u=>u._id===a._id)?l&&(a.senderId===l._id||a.receiverId===l._id)?(t({messages:[...c,a]}),e().markMessagesAsRead(l._id)):a.senderId&&e().incrementUnread(a.senderId):(!a||!a._id)&&console.warn("Received invalid message object:",a)},r=({messageId:a,deliveredAt:l})=>{const{messages:c}=e(),u=c.map(d=>d._id===a?{...d,status:"delivered",deliveredAt:l}:d);t({messages:u})},i=({messageIds:a,deliveredAt:l})=>{const{messages:c}=e(),u=c.map(d=>a.includes(d._id)?{...d,status:"delivered",deliveredAt:l}:d);t({messages:u})},o=({readBy:a})=>{const{messages:l,selectedUser:c}=e();console.log(` Received messagesRead event. ReadBy: ${a}`),console.log(` Current messages count: ${l.length}`);const u=l.map(h=>{const f=typeof h.receiverId=="object"?h.receiverId._id||h.receiverId.toString():h.receiverId,p=typeof a=="object"?a._id||a.toString():a,m=f===p&&h.status!=="read";return m&&(console.log(` Updating message ${h._id} to read status`),console.log(` Message receiverId: ${f}, readBy: ${p}`)),m?{...h,status:"read",readAt:new Date}:h}),d=u.filter(h=>h.status==="read").length;console.log(` Total messages with read status: ${d}`),t({messages:u})};n.off("newMessage",s),n.off("messageDelivered",r),n.off("messagesDelivered",i),n.off("messagesRead",o),n.on("newMessage",s),n.on("messageDelivered",r),n.on("messagesDelivered",i),n.on("messagesRead",o)},markMessagesAsRead:async n=>{try{await St.put(`/messages/read/${n}`)}catch(s){console.error("Failed to mark messages as read:",s)}},unsubscribeFromMessages:()=>{const{socket:n}=Wt.getState();n&&n.off("newMessage")},setSelectedUser:n=>{t({selectedUser:n,messages:[]}),n&&e().getMessages(n._id)},incrementUnread:n=>t(s=>({unreadCounts:{...s.unreadCounts,[n]:(s.unreadCounts[n]||0)+1}})),resetUnread:n=>t(s=>{const r={...s.unreadCounts};return delete r[n],{unreadCounts:r}}),addReaction:async(n,s)=>{var r,i;try{const o=await St.post(`/messages/reaction/${n}`,{emoji:s}),{messages:a}=e(),l=a.map(c=>c._id===n?{...c,reactions:o.data.reactions}:c);t({messages:l})}catch(o){ve.error(((i=(r=o.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to add reaction")}},removeReaction:async n=>{var s,r;try{const i=await St.delete(`/messages/reaction/${n}`),{messages:o}=e(),a=o.map(l=>l._id===n?{...l,reactions:i.data.reactions}:l);t({messages:a})}catch(i){ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to remove reaction")}},deleteMessage:async n=>{var s,r;try{await St.delete(`/messages/message/${n}`);const{messages:i}=e(),o=i.map(a=>a._id===n?{...a,isDeleted:!0,deletedAt:new Date}:a);t({messages:o}),ve.success("Message deleted")}catch(i){ve.error(((r=(s=i.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to delete message")}},subscribeToReactions:()=>{const{socket:n}=Wt.getState();if(!n)return;const s=({messageId:i,reactions:o})=>{const{messages:a}=e(),l=a.map(c=>c._id===i?{...c,reactions:o}:c);t({messages:l})},r=({messageId:i,isDeleted:o,deletedAt:a})=>{const{messages:l}=e(),c=l.map(u=>u._id===i?{...u,isDeleted:o,deletedAt:a}:u);t({messages:c})};n.off("messageReaction",s),n.off("messageDeleted",r),n.on("messageReaction",s),n.on("messageDeleted",r)},resetCallState:()=>{t({callState:"idle",callPartner:null,callType:null,incomingCallData:null,isMuted:!1,isCameraOff:!1})},initiateCall:(n,s)=>{const{callState:r}=e();if(r!=="idle")return ve.error("Already busy in another call attempt.");const{authUser:i,socket:o}=Wt.getState();if(!o||!i||!n||!n._id)return ve.error("Cannot initiate call. Connection error.");t({callState:"outgoing",callPartner:n,callType:s,isCameraOff:s==="audio"}),o.emit("private:initiate-call",{receiverId:n._id,callerInfo:{_id:i._id,nickname:i.nickname||i.username,profilePic:i.profilePic},callType:s})},acceptCall:()=>{const{incomingCallData:n}=e(),{authUser:s,socket:r}=Wt.getState();!n||!r||!s||(t({callState:"connecting",callPartner:n.callerInfo,callType:n.callType,isCameraOff:n.callType==="audio",incomingCallData:null}),r.emit("private:call-accepted",{callerId:n.callerId,acceptorInfo:{_id:s._id,nickname:s.nickname||s.username,profilePic:s.profilePic}}))},rejectCall:(n="declined")=>{var a;const{callState:s,incomingCallData:r,callPartner:i}=e(),{socket:o}=Wt.getState();o&&(s==="incoming"&&r?(console.log(`Rejecting incoming call from ${(a=r.callerInfo)==null?void 0:a.nickname}. Reason: ${n}`),o.emit("private:call-rejected",{callerId:r.callerId,reason:n})):s==="outgoing"&&i&&(console.log(`Cancelling outgoing call to ${i.nickname||i.username}`),o.emit("private:end-call",{targetUserId:i._id})),e().resetCallState())},endCall:()=>{const{callState:n,callPartner:s}=e(),{socket:r}=Wt.getState();!r||n==="idle"||(console.log(`Ending call with ${(s==null?void 0:s.nickname)||(s==null?void 0:s.username)||"partner"}`),s&&(n==="connected"||n==="connecting"||n==="outgoing")&&r.emit("private:end-call",{targetUserId:s._id}),e().resetCallState())},handleIncomingCall:n=>{var i,o;const{callState:s}=e(),{socket:r}=Wt.getState();if(s!=="idle"){console.log(`Received incoming call from ${(i=n.callerInfo)==null?void 0:i.nickname} but already busy (state: ${s}). Rejecting.`),r&&r.emit("private:call-rejected",{callerId:n.callerId,reason:"busy"});return}console.log(`Incoming ${n.callType} call from ${(o=n.callerInfo)==null?void 0:o.nickname}`),t({callState:"incoming",incomingCallData:n,callPartner:n.callerInfo,callType:n.callType})},handleCallAccepted:n=>{var r;const{callState:s}=e();if(s!=="outgoing"){console.warn("Received call-accepted signal but wasn't in outgoing state.");return}console.log(`Call accepted by ${(r=n.acceptorInfo)==null?void 0:r.nickname}`),t({callState:"connecting"})},handleCallRejected:n=>{const{callState:s,callPartner:r}=e();s==="outgoing"&&(r==null?void 0:r._id)===n.rejectorId?(console.log(`Call rejected by ${r.nickname}. Reason: ${n.reason}`),ve.error(`Call ${n.reason||"declined"} by user.`),e().resetCallState()):console.warn("Received call-rejected signal but wasn't the caller or partner mismatch.")},handleCallEnded:n=>{const{callState:s,callPartner:r}=e();s!=="idle"&&(console.log(`Received signal: Call ended by ${(n==null?void 0:n.userId)===(r==null?void 0:r._id)?r.nickname:"partner"}.`),ve("Call ended",{icon:""}),e().resetCallState())},toggleMute:()=>{t(n=>({isMuted:!n.isMuted}))},toggleCamera:()=>{t(n=>({isCameraOff:!n.isCameraOff}))},subscribeToCallEvents:()=>{console.log("Call events handled in HomePage (useChatStore subscription disabled)")},unsubscribeFromCallEvents:()=>{const{socket:n}=Wt.getState();n&&(console.log("Unsubscribing from private call events"),n.off("private:incoming-call"),n.off("private:call-accepted"),n.off("private:call-rejected"),n.off("private:call-ended"))}}));let og=!1;Wt.subscribe((t,e)=>{const n=Na.getState();t.socket&&!e.socket&&!og?(console.log("AuthStore subscription: Socket connected, subscribing call events."),n.subscribeToCallEvents(),n.subscribeToMessages(),n.subscribeToReactions(),og=!0):!t.socket&&e.socket&&og&&(console.log("AuthStore subscription: Socket disconnected, unsubscribing call events."),n.unsubscribeFromCallEvents(),n.unsubscribeFromMessages(),n.resetCallState(),og=!1)});const Fh=zf((t,e)=>({notifications:[],unreadCount:0,addNotification:n=>{const s={id:Date.now()+Math.random(),timestamp:new Date,read:!1,...n};t(r=>({notifications:[s,...r.notifications],unreadCount:r.unreadCount+1}))},markAsRead:n=>{t(s=>({notifications:s.notifications.map(r=>r.id===n?{...r,read:!0}:r),unreadCount:Math.max(0,s.unreadCount-1)}))},markAllAsRead:()=>{t(n=>({notifications:n.notifications.map(s=>({...s,read:!0})),unreadCount:0}))},clearNotification:n=>{t(s=>{const r=s.notifications.find(i=>i.id===n);return{notifications:s.notifications.filter(i=>i.id!==n),unreadCount:r&&!r.read?Math.max(0,s.unreadCount-1):s.unreadCount}})},clearAllNotifications:()=>{t({notifications:[],unreadCount:0})}}));/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sY=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),KL=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iY=F.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...a},l)=>F.createElement("svg",{ref:l,...rY,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:KL("lucide",r),...a},[...o.map(([c,u])=>F.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=(t,e)=>{const n=F.forwardRef(({className:s,...r},i)=>F.createElement(iY,{ref:i,iconNode:e,className:KL(`lucide-${sY(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oY=Ke("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aY=Ke("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lY=Ke("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=Ke("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yA=Ke("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cY=Ke("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XL=Ke("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YL=Ke("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uY=Ke("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dY=Ke("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jC=Ke("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=Ke("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hY=Ke("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fY=Ke("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=Ke("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pY=Ke("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=Ke("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mY=Ke("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gY=Ke("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=Ke("PhoneIncoming",[["polyline",{points:"16 2 16 8 22 8",key:"1ygljm"}],["line",{x1:"22",x2:"16",y1:"2",y2:"8",key:"1xzwqn"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZL=Ke("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xY=Ke("PhoneOutgoing",[["polyline",{points:"22 8 22 2 16 2",key:"1g204g"}],["line",{x1:"16",x2:"22",y1:"8",y2:"2",key:"1ggias"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const My=Ke("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wY=Ke("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=Ke("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Ke("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=Ke("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=Ke("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vY=Ke("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=Ke("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=Ke("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=Ke("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=Ke("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=Ke("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=Ke("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SY=Ke("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.459.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=Ke("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),kY=()=>{var a;const{authUser:t}=Wt();Na();const e=t==null?void 0:t.isAdmin,{pendingReceived:n}=qr(),{notifications:s}=Fh(),r=s.filter(l=>l.type==="admin"||l.type==="admin_broadcast"),i=((a=t==null?void 0:t.verificationRequest)==null?void 0:a.status)&&t.verificationRequest.status!=="none",o=n.length+r.length+(i?1:0)+(t!=null&&t.isSuspended?1:0);return v.jsx("header",{className:"bg-base-100 border-b border-base-300 fixed w-full top-0 z-40 shadow-sm",children:v.jsx("div",{className:"px-3 sm:px-4 lg:px-6 h-14 sm:h-16",children:v.jsxs("div",{className:"flex items-center justify-between h-full max-w-7xl mx-auto",children:[v.jsx(wi,{to:"/",className:"flex items-center active:opacity-70 transition",children:v.jsx("img",{src:"/zn4.png",alt:"Z-APP",className:"h-8 sm:h-9 w-auto"})}),v.jsxs("div",{className:"flex items-center -space-x-2 sm:space-x-0 sm:gap-1",children:[t&&v.jsxs(wi,{to:"/discover",className:"btn btn-ghost btn-sm btn-circle relative w-9 h-9 min-h-0 sm:w-11 sm:h-11 btn-touch",title:"Social Hub",children:[v.jsx(n3,{className:"w-[18px] h-[18px] sm:w-5 sm:h-5"}),o>0&&v.jsx("span",{className:"absolute -top-0.5 -right-0.5 bg-error text-white text-[10px] sm:text-xs font-bold rounded-full w-4 h-4 sm:w-5 sm:h-5 flex items-center justify-center shadow-lg animate-pulse",children:o>9?"9+":o})]}),e&&v.jsx(wi,{to:"/admin",className:"btn btn-ghost btn-sm btn-circle w-9 h-9 min-h-0 sm:w-11 sm:h-11 btn-touch",title:"Admin Dashboard",children:v.jsx(dY,{className:"w-[18px] h-[18px] sm:w-5 sm:h-5"})}),v.jsx(wi,{to:"/settings",className:"btn btn-ghost btn-sm btn-circle w-9 h-9 min-h-0 sm:w-11 sm:h-11 btn-touch",title:"Settings",children:v.jsx(t3,{className:"w-[18px] h-[18px] sm:w-5 sm:h-5"})}),t&&v.jsx(wi,{to:"/profile",className:"btn btn-ghost btn-sm btn-circle w-9 h-9 min-h-0 sm:w-11 sm:h-11 btn-touch",title:"Profile",children:v.jsx(UC,{className:"w-[18px] h-[18px] sm:w-5 sm:h-5"})})]})]})})})},CY=()=>{const[t,e]=F.useState(navigator.onLine);return F.useEffect(()=>{const n=()=>{e(!0),console.log(" Back online")},s=()=>{e(!1),console.log(" Gone offline")};return window.addEventListener("online",n),window.addEventListener("offline",s),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}},[]),t},NY=()=>CY()?null:v.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 bg-error text-white py-2 px-4 flex items-center justify-center gap-2 shadow-lg animate-pulse",children:[v.jsx(s3,{size:20}),v.jsx("span",{className:"font-medium",children:"You are offline - Showing cached data"})]}),TY=()=>{const[t,e]=F.useState({camera:null,microphone:null}),[n,s]=F.useState(!1);F.useEffect(()=>{let d=null,h=null,f=null,p=null;return(async()=>{try{if(!navigator.permissions){console.log("Permissions API not supported");return}try{d=await navigator.permissions.query({name:"camera"}),e(g=>({...g,camera:d.state})),f=()=>{e(g=>({...g,camera:d.state}))},d.addEventListener("change",f)}catch(g){console.log("Camera permission check not supported:",g)}try{h=await navigator.permissions.query({name:"microphone"}),e(g=>({...g,microphone:h.state})),p=()=>{e(g=>({...g,microphone:h.state}))},h.addEventListener("change",p)}catch(g){console.log("Microphone permission check not supported:",g)}}catch(g){console.error("Error checking permissions:",g)}})(),()=>{d&&f&&d.removeEventListener("change",f),h&&p&&h.removeEventListener("change",p)}},[]);const r=async()=>{try{if(!navigator.permissions){console.log("Permissions API not supported");return}try{const d=await navigator.permissions.query({name:"camera"});e(h=>({...h,camera:d.state}))}catch(d){console.log("Camera permission check not supported:",d)}try{const d=await navigator.permissions.query({name:"microphone"});e(h=>({...h,microphone:d.state}))}catch(d){console.log("Microphone permission check not supported:",d)}}catch(d){console.error("Error checking permissions:",d)}},i=()=>{ve.success("Opening Settings...",{duration:2e3});try{const h="intent://settings/app_detail?package=com.zapp.app#Intent;scheme=android-app;end";window.location.href=h,setTimeout(()=>{window.location.href="app-settings:"},1e3),setTimeout(()=>{ve("If settings didn't open, go to: Settings > Apps > Z-APP > Permissions",{duration:6e3,icon:""})},2e3)}catch(d){console.log("Could not auto-open settings:",d),ve("Please go to: Settings > Apps > Z-APP > Permissions",{duration:6e3,icon:""})}},o=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(h=>h.stop()),ve.success("Permissions granted!"),s(!1),r()}catch(d){console.error("Permission denied:",d),d.name==="NotAllowedError"?(ve.error("Please enable permissions manually",{duration:4e3}),ve("Go to: Settings > Apps > Z-APP > Permissions > Enable Camera & Microphone",{duration:8e3,icon:"",style:{maxWidth:"90vw",fontSize:"14px"}})):d.name==="NotFoundError"?ve.error("No camera or microphone found on this device"):ve.error("Failed to get permissions: "+d.message)}},a=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(h=>h.stop()),ve.success("Camera access granted!"),r()}catch(d){console.error("Camera permission denied:",d),ve.error("Camera access denied")}},l=async()=>{try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(h=>h.stop()),ve.success("Microphone access granted!"),r()}catch(d){console.error("Microphone permission denied:",d),ve.error("Microphone access denied")}};if(F.useEffect(()=>{const d=window.Capacitor!==void 0;if(d&&!sessionStorage.getItem("permissionsChecked")){const f=setTimeout(()=>{s(!0),sessionStorage.setItem("permissionsChecked","true")},1e3);return()=>clearTimeout(f)}if((t.camera==="prompt"||t.microphone==="prompt"||t.camera==="denied"||t.microphone==="denied")&&!d&&!sessionStorage.getItem("permissionsChecked")){const f=setTimeout(()=>{s(!0),sessionStorage.setItem("permissionsChecked","true")},2e3);return()=>clearTimeout(f)}},[t]),!n)return null;const c=t.camera==="granted"&&t.microphone==="granted",u=t.camera==="denied"||t.microphone==="denied";return v.jsx("div",{className:"modal modal-open backdrop-blur-sm",children:v.jsxs("div",{className:"modal-box max-w-md shadow-xl border border-base-300",children:[v.jsxs("div",{className:"text-center mb-6",children:[v.jsx("div",{className:"w-16 h-16 rounded-full bg-base-200 flex items-center justify-center mx-auto mb-3",children:v.jsx(yA,{className:"w-8 h-8 text-primary"})}),v.jsx("h3",{className:"font-bold text-xl mb-1",children:"Permissions Required"}),v.jsx("p",{className:"text-sm text-base-content/60",children:"Enable camera and microphone for calls"})]}),v.jsxs("div",{className:"space-y-3 mb-6",children:[v.jsxs("div",{className:`flex items-center gap-3 p-3 bg-base-100 rounded-lg border-2 transition-all ${t.camera==="granted"?"border-success":t.camera==="denied"?"border-error":"border-base-300"}`,children:[v.jsx(gA,{className:`w-5 h-5 flex-shrink-0 ${t.camera==="granted"?"text-success":t.camera==="denied"?"text-error":"text-base-content/60"}`}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("p",{className:"font-medium text-sm",children:"Camera"}),v.jsx("p",{className:"text-xs text-base-content/50",children:"Video calls"})]}),v.jsx("span",{className:`text-xs font-semibold ${t.camera==="granted"?"text-success":t.camera==="denied"?"text-error":"text-base-content/40"}`,children:t.camera==="granted"?"Allowed":t.camera==="denied"?"Denied":"Not set"})]}),v.jsxs("div",{className:`flex items-center gap-3 p-3 bg-base-100 rounded-lg border-2 transition-all ${t.microphone==="granted"?"border-success":t.microphone==="denied"?"border-error":"border-base-300"}`,children:[v.jsx(Lc,{className:`w-5 h-5 flex-shrink-0 ${t.microphone==="granted"?"text-success":t.microphone==="denied"?"text-error":"text-base-content/60"}`}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("p",{className:"font-medium text-sm",children:"Microphone"}),v.jsx("p",{className:"text-xs text-base-content/50",children:"Voice calls"})]}),v.jsx("span",{className:`text-xs font-semibold ${t.microphone==="granted"?"text-success":t.microphone==="denied"?"text-error":"text-base-content/40"}`,children:t.microphone==="granted"?"Allowed":t.microphone==="denied"?"Denied":"Not set"})]})]}),u&&v.jsxs("div",{className:"bg-base-100 border-2 border-warning rounded-lg p-3 mb-4 flex items-start gap-2",children:[v.jsx(yA,{className:"w-4 h-4 text-warning flex-shrink-0 mt-0.5"}),v.jsx("p",{className:"text-xs text-base-content/70",children:"Permissions denied. Please open settings to enable them manually."})]}),v.jsxs("div",{className:"space-y-2",children:[!c&&!u&&v.jsx("button",{className:"btn btn-primary w-full",onClick:o,children:"Allow Permissions"}),u&&v.jsxs("button",{className:"btn btn-warning w-full gap-2",onClick:i,children:[v.jsx(t3,{className:"w-4 h-4"}),"Open Settings"]}),!c&&!u&&v.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.camera!=="granted"&&v.jsxs("button",{className:"btn btn-outline btn-sm",onClick:a,children:[v.jsx(gA,{className:"w-4 h-4"}),"Camera"]}),t.microphone!=="granted"&&v.jsxs("button",{className:"btn btn-outline btn-sm",onClick:l,children:[v.jsx(Lc,{className:"w-4 h-4"}),"Microphone"]})]}),v.jsx("button",{className:"btn btn-ghost btn-sm w-full",onClick:()=>s(!1),children:"Skip for now"})]})]})})},IY=()=>{const[t,e]=F.useState(navigator.onLine),[n,s]=F.useState(!1);return F.useEffect(()=>{const r=()=>{e(!0),s(!0),setTimeout(()=>s(!1),3e3)},i=()=>{e(!1),s(!0)};return window.addEventListener("online",r),window.addEventListener("offline",i),navigator.onLine||s(!0),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",i)}},[]),n?v.jsx("div",{className:`fixed top-16 left-1/2 transform -translate-x-1/2 z-50 px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 transition-all duration-300 ${t?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:t?v.jsxs(v.Fragment,{children:[v.jsx(SY,{size:20}),v.jsx("span",{className:"font-medium",children:"Back online"})]}):v.jsxs(v.Fragment,{children:[v.jsx(s3,{size:20}),v.jsx("span",{className:"font-medium",children:"No internet connection"})]})}):null},ji=({children:t})=>v.jsx(b7.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:"easeInOut"},children:t}),$Y=()=>{const t=Array(8).fill(null);return v.jsxs("aside",{className:`h-full w-20 lg:w-72 border-r border-base-300 \r
    flex flex-col transition-all duration-200`,children:[v.jsx("div",{className:"border-b border-base-300 w-full p-5",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(n3,{className:"w-6 h-6"}),v.jsx("span",{className:"font-medium hidden lg:block",children:"Contacts"})]})}),v.jsx("div",{className:"overflow-y-auto w-full py-3",children:t.map((e,n)=>v.jsxs("div",{className:"w-full p-3 flex items-center gap-3",children:[v.jsx("div",{className:"relative mx-auto lg:mx-0",children:v.jsx("div",{className:"skeleton size-12 rounded-full"})}),v.jsxs("div",{className:"hidden lg:block text-left min-w-0 flex-1",children:[v.jsx("div",{className:"skeleton h-4 w-32 mb-2"}),v.jsx("div",{className:"skeleton h-3 w-16"})]})]},n))})]})},nS=({size:t="sm",className:e=""})=>{const n={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};return v.jsx(lY,{className:`${n[t]} text-primary fill-primary/20 flex-shrink-0 ${e}`,title:"Verified"})},EY=()=>{var x;const{selectedUser:t,setSelectedUser:e,unreadCounts:n={}}=Na(),{onlineUsers:s=[],authUser:r}=Wt();F.useEffect(()=>{console.log(" Online users in Sidebar:",s)},[s]);const{friends:i,isLoading:o,pendingReceived:a}=qr(),{notifications:l}=Fh(),[c,u]=F.useState(!1),[d,h]=F.useState(""),[f,p]=F.useState(!1),m=l.filter(w=>w.type==="admin"||w.type==="admin_broadcast"),g=((x=r==null?void 0:r.verificationRequest)==null?void 0:x.status)&&r.verificationRequest.status!=="none";a.length>0||m.length>0;const y=i.filter(w=>w&&w._id).filter(w=>d?`${w.nickname||w.username}`.toLowerCase().includes(d.toLowerCase()):!0).filter(w=>f?s.includes(w._id):!0).sort((w,b)=>{const S=s.includes(w._id),T=s.includes(b._id);return S===T?0:S?-1:1});return v.jsxs(v.Fragment,{children:[v.jsxs("aside",{className:`
          ${t?"hidden":"flex"} 
          md:flex 
          w-full md:w-80 lg:w-96
          bg-base-100 
          border-r border-base-300
          flex-col
          h-full
          overflow-hidden
        `,children:[v.jsxs("div",{className:"flex-shrink-0 px-3 sm:px-4 pt-3 sm:pt-4 pb-2 sm:pb-3 border-b border-base-300",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsx("h3",{className:"text-xl sm:text-2xl font-bold",children:"Chats"}),v.jsx("button",{onClick:()=>u(!0),className:"btn btn-ghost btn-circle btn-sm","aria-label":"Search",children:v.jsx(eh,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"flex gap-3 sm:gap-4 overflow-x-auto py-2 -mx-3 sm:-mx-4 px-3 sm:px-4 scrollbar-hide",children:[v.jsxs(wi,{to:"/discover",className:"flex-none flex flex-col items-center gap-1 min-w-[56px] sm:min-w-[64px] active:scale-95 transition-transform",style:{WebkitTapHighlightColor:"transparent"},children:[v.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full overflow-hidden border-2 border-primary flex items-center justify-center bg-primary/10",children:v.jsx(eh,{className:"w-6 h-6 sm:w-7 sm:h-7 text-primary"})}),v.jsx("span",{className:"text-xs sm:text-sm truncate w-14 sm:w-16 text-center font-semibold",children:"Discover"})]}),v.jsxs(wi,{to:"/stranger",className:"flex-none flex flex-col items-center gap-1 min-w-[56px] sm:min-w-[64px] active:scale-95 transition-transform",style:{WebkitTapHighlightColor:"transparent"},children:[v.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full overflow-hidden border-2 border-dashed border-base-content/50 flex items-center justify-center bg-base-200",children:v.jsx(Jc,{className:"w-6 h-6 sm:w-7 sm:h-7 text-base-content/70"})}),v.jsx("span",{className:"text-xs sm:text-sm truncate w-14 sm:w-16 text-center text-base-content/70 font-semibold",children:"Stranger"})]}),i.slice(0,8).map(w=>v.jsxs("button",{onClick:()=>e(w),className:"flex-none flex flex-col items-center gap-1 min-w-[56px] sm:min-w-[64px] active:scale-95 transition-transform focus:outline-none",style:{WebkitTapHighlightColor:"transparent"},children:[v.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full p-[2px] ring-2 ring-primary overflow-hidden",children:v.jsx("img",{src:w.profilePic||"/avatar.png",alt:w.nickname||w.username,className:"w-full h-full object-cover rounded-full"})}),v.jsx("span",{className:"text-xs sm:text-sm truncate w-14 sm:w-16 text-center",children:(w.nickname||w.username||"User").split(" ")[0]})]},w._id))]})]}),v.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[v.jsx("div",{className:"flex-shrink-0 px-2 sm:px-4 py-0.5 sm:py-1 border-b border-base-200",children:v.jsxs("label",{className:"flex items-center gap-1.5 sm:gap-2 cursor-pointer group",children:[v.jsx("input",{type:"checkbox",checked:f,onChange:w=>p(w.target.checked),className:"checkbox checkbox-primary w-3 h-3 sm:w-4 sm:h-4 rounded-full"}),v.jsx("span",{className:"text-[11px] sm:text-xs font-medium text-base-content/80",children:"Show Active only"})]})}),v.jsx("div",{className:"flex-1 overflow-y-auto px-2 sm:px-3 py-2",children:v.jsx("div",{className:"space-y-1",children:o?v.jsx($Y,{}):y.length===0?v.jsx("div",{className:"text-center text-base-content/60 py-8 px-4 text-sm sm:text-base",children:d?"No results found":"No friends yet. Add some friends to start chatting!"}):y.map(w=>{var T;const b=n[w._id]||0,S=s.includes(w._id);return v.jsxs("button",{onClick:()=>{e(w),c&&u(!1)},className:`w-full flex items-center gap-2 sm:gap-3 p-2 sm:p-3 rounded-lg text-left transition-all hover:bg-base-200 card-touch ${(t==null?void 0:t._id)===w._id?"bg-base-200 ring-2 ring-primary/20":""}`,children:[v.jsxs("div",{className:"relative flex-shrink-0",children:[v.jsx("div",{className:"w-11 h-11 sm:w-12 sm:h-12 md:w-14 md:h-14 rounded-full overflow-hidden ring-2 ring-base-300",children:v.jsx("img",{src:w.profilePic||"/avatar.png",alt:w.nickname||w.username,className:"w-full h-full object-cover"})}),S&&v.jsx("span",{className:"absolute right-0 bottom-0 w-3 h-3 rounded-full ring-2 ring-base-100 bg-success animate-pulse"})]}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"font-semibold truncate text-sm sm:text-base flex items-center gap-1",children:[v.jsx("span",{className:"truncate",children:w.nickname||w.username}),w.isVerified&&v.jsx(nS,{size:"xs"})]}),v.jsx("div",{className:"text-xs sm:text-sm text-base-content/60 truncate",children:((T=w.lastMessage)==null?void 0:T.text)||"Start a chat!"})]}),b>0&&v.jsx("div",{className:"flex-shrink-0",children:v.jsx("span",{className:"inline-flex items-center justify-center min-w-[20px] h-5 sm:min-w-[24px] sm:h-6 px-1.5 sm:px-2 bg-error text-error-content rounded-full text-[10px] sm:text-xs font-bold shadow-lg animate-pulse",children:b>99?"99+":b})})]},w._id)})})})]})]}),c&&v.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-fadeIn",onClick:()=>{u(!1),h("")},children:v.jsxs("div",{className:"bg-gradient-to-br from-base-100 to-base-200 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col border border-primary/20 animate-scaleIn",onClick:w=>w.stopPropagation(),children:[v.jsxs("div",{className:"p-4 sm:p-6 border-b border-base-300",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("h2",{className:"text-xl sm:text-2xl font-bold flex items-center gap-2",children:[v.jsx(eh,{className:"w-6 h-6 text-primary"}),"Search Friends"]}),v.jsx("button",{onClick:()=>{u(!1),h("")},className:"btn btn-ghost btn-circle btn-sm hover:bg-error/10 hover:text-error","aria-label":"Close search",children:v.jsx(bl,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:v.jsx(eh,{className:"w-5 h-5 text-base-content/40"})}),v.jsx("input",{type:"text",placeholder:"Search by name or username...",value:d,onChange:w=>h(w.target.value),className:"w-full pl-12 pr-4 py-3 sm:py-4 bg-base-200 rounded-xl outline-none border-2 border-transparent focus:border-primary transition-all text-base sm:text-lg",autoFocus:!0}),d&&v.jsx("button",{onClick:()=>h(""),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-base-content/40 hover:text-base-content",children:v.jsx(bl,{className:"w-5 h-5"})})]}),d&&v.jsxs("p",{className:"mt-3 text-sm text-base-content/60",children:[y.length," ",y.length===1?"friend":"friends"," found"]})]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:d?y.length>0?v.jsx("div",{className:"space-y-2",children:y.map(w=>{const b=s.includes(w._id),S=n[w._id]||0;return v.jsxs("button",{onClick:()=>{e(w),u(!1),h("")},className:"w-full flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-xl hover:bg-base-200 active:bg-base-300 transition-all group",children:[v.jsxs("div",{className:"relative flex-shrink-0",children:[v.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-full overflow-hidden ring-2 ring-base-300 group-hover:ring-primary transition-all",children:v.jsx("img",{src:w.profilePic||"/avatar.png",alt:w.nickname||w.username,className:"w-full h-full object-cover"})}),b&&v.jsx("span",{className:"absolute right-0 bottom-0 w-3 h-3 sm:w-4 sm:h-4 rounded-full ring-2 ring-base-100 bg-success animate-pulse"})]}),v.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx("span",{className:"font-semibold text-base sm:text-lg truncate",children:w.nickname||w.username}),w.isVerified&&v.jsx(nS,{size:"sm"})]}),v.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-base-content/60",children:[v.jsxs("span",{className:"truncate",children:["@",w.username]}),b&&v.jsxs("span",{className:"flex items-center gap-1 text-success",children:[v.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-success"}),"Online"]})]})]}),S>0&&v.jsx("div",{className:"flex-shrink-0",children:v.jsx("span",{className:"inline-flex items-center justify-center min-w-[24px] h-6 sm:min-w-[28px] sm:h-7 px-2 bg-error text-error-content rounded-full text-xs sm:text-sm font-bold shadow-lg",children:S>99?"99+":S})}),v.jsx("div",{className:"flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity",children:v.jsx("svg",{className:"w-5 h-5 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]},w._id)})}):v.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[v.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-base-300 flex items-center justify-center mb-4",children:v.jsx("svg",{className:"w-10 h-10 sm:w-12 sm:h-12 text-base-content/40",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),v.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-2",children:"No Results Found"}),v.jsxs("p",{className:"text-sm sm:text-base text-base-content/60 max-w-sm",children:['No friends found matching "',v.jsx("span",{className:"font-semibold",children:d}),'"']})]}):v.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[v.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:v.jsx(eh,{className:"w-10 h-10 sm:w-12 sm:h-12 text-primary"})}),v.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-2",children:"Search Your Friends"}),v.jsx("p",{className:"text-sm sm:text-base text-base-content/60 max-w-sm",children:"Type a name or username to find your friends quickly"})]})})]})}),v.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes scaleIn {
          from { 
            opacity: 0;
            transform: scale(0.95);
          }
          to { 
            opacity: 1;
            transform: scale(1);
          }
        }
        .animate-fadeIn {
          animation: fadeIn 0.2s ease-out;
        }
        .animate-scaleIn {
          animation: scaleIn 0.3s ease-out;
        }
      `})]})},RY=()=>v.jsx("div",{className:"hidden md:flex w-full flex-1 flex-col items-center justify-center p-6 bg-base-100/50",children:v.jsxs("div",{className:"max-w-md text-center space-y-6",children:[v.jsx("div",{className:"flex justify-center gap-4 mb-4",children:v.jsx("div",{className:"w-32 h-32 rounded-2xl bg-primary/10 flex items-center justify-center animate-bounce",children:v.jsx("img",{src:"/z-app-logo.png",alt:"Z-APP Logo",className:"w-20 h-20 object-contain"})})}),v.jsx("h2",{className:"text-2xl font-bold text-primary",children:"Welcome to Z-APP!"}),v.jsx("p",{className:"text-base-content/60 text-lg",children:"Select a conversation from the sidebar to start chatting"})]})}),AY=({onStartCall:t})=>{const{selectedUser:e,setSelectedUser:n}=Na(),{onlineUsers:s}=Wt(),r=Of();if(!e)return null;const i=s.includes(e._id),o=l=>{t&&t(l)},a=()=>{r(`/profile/${e.username}`)};return v.jsxs("div",{className:"px-2.5 sm:px-4 py-2.5 sm:py-3 border-b border-base-300 flex items-center justify-between bg-base-100",children:[v.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-3 min-w-0 flex-1",children:[v.jsx("button",{className:"btn btn-ghost btn-circle btn-sm md:hidden",onClick:()=>n(null),children:v.jsx(oY,{className:"w-5 h-5"})}),v.jsx("button",{onClick:a,className:"flex-shrink-0 touch-feedback",children:v.jsx("div",{className:"w-10 h-10 sm:w-11 sm:h-11 rounded-full ring-2 ring-base-300 overflow-hidden",children:v.jsx("img",{src:e.profilePic||"/avatar.png",alt:e.nickname||e.username,className:"w-full h-full object-cover"})})}),v.jsxs("button",{onClick:a,className:"min-w-0 flex-1 text-left hover:opacity-80 transition-opacity",children:[v.jsxs("div",{className:"font-semibold truncate text-base flex items-center gap-1.5",children:[v.jsx("span",{className:"truncate",children:e.nickname||e.username}),e.isVerified&&v.jsx(nS,{size:"xs"})]}),v.jsx("p",{className:"text-sm text-base-content/60 truncate",children:i?v.jsxs("span",{className:"flex items-center gap-1.5",children:[v.jsx("span",{className:"w-2 h-2 rounded-full bg-success animate-pulse"}),"Online"]}):"Offline"})]})]}),v.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[v.jsx("button",{className:"btn btn-ghost btn-circle btn-sm sm:btn-md btn-touch",onClick:()=>o("audio"),title:"Audio call",children:v.jsx(My,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),v.jsx("button",{className:"btn btn-ghost btn-circle btn-sm sm:btn-md btn-touch",onClick:()=>o("video"),title:"Video call",children:v.jsx(Jc,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]})]})},_Y=({onSendVoice:t,disabled:e})=>{const[n,s]=F.useState(!1),[r,i]=F.useState(null),[o,a]=F.useState(null),[l,c]=F.useState(0),[u,d]=F.useState(!1),h=F.useRef(null),f=F.useRef([]),p=F.useRef(null);F.useEffect(()=>()=>{p.current&&clearInterval(p.current),o&&URL.revokeObjectURL(o)},[o]);const m=async()=>{try{const b=await navigator.mediaDevices.getUserMedia({audio:!0}),S=new MediaRecorder(b);h.current=S,f.current=[],S.ondataavailable=T=>{T.data.size>0&&f.current.push(T.data)},S.onstop=()=>{const T=new Blob(f.current,{type:"audio/webm"}),I=URL.createObjectURL(T);i(T),a(I),b.getTracks().forEach($=>$.stop())},S.start(),s(!0),c(0),p.current=setInterval(()=>{c(T=>T+1)},1e3)}catch(b){console.error("Error accessing microphone:",b),ve.error("Could not access microphone")}},g=()=>{h.current&&n&&(h.current.stop(),s(!1),p.current&&(clearInterval(p.current),p.current=null))},y=()=>{o&&URL.revokeObjectURL(o),i(null),a(null),c(0)},x=async()=>{if(r){d(!0);try{const b=new FileReader;b.readAsDataURL(r),b.onloadend=async()=>{const S=b.result;await t(S,l),y(),ve.success("Voice message sent!")}}catch(b){console.error("Error sending voice:",b),ve.error("Failed to send voice message")}finally{d(!1)}}},w=b=>{const S=Math.floor(b/60),T=b%60;return`${S}:${T.toString().padStart(2,"0")}`};return r?v.jsx("div",{className:"fixed inset-x-0 bottom-0 z-50 bg-base-100 border-t-2 border-primary shadow-2xl",children:v.jsxs("div",{className:"max-w-2xl mx-auto p-3 sm:p-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("h3",{className:"text-sm sm:text-base font-semibold flex items-center gap-2",children:[v.jsx(Lc,{className:"w-4 h-4 text-primary"}),"Voice Message"]}),v.jsx("span",{className:"text-xs sm:text-sm font-mono bg-base-200 px-2 py-1 rounded",children:w(l)})]}),v.jsx("audio",{src:o,controls:!0,className:"w-full mb-3 h-10 sm:h-12",style:{outline:"none"}}),v.jsxs("div",{className:"flex gap-2",children:[v.jsxs("button",{onClick:y,className:"btn btn-ghost flex-1 gap-2",disabled:u,children:[v.jsx(bl,{className:"w-4 h-4"}),v.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]}),v.jsx("button",{onClick:x,className:"btn btn-primary flex-1 gap-2",disabled:u,children:u?v.jsxs(v.Fragment,{children:[v.jsx(jC,{className:"w-4 h-4 animate-spin"}),v.jsx("span",{className:"hidden sm:inline",children:"Sending..."})]}):v.jsxs(v.Fragment,{children:[v.jsx(e3,{className:"w-4 h-4"}),v.jsx("span",{className:"hidden sm:inline",children:"Send"})]})})]})]})}):n?v.jsx("div",{className:"fixed inset-x-0 bottom-0 z-50 bg-base-100 border-t border-base-300 shadow-lg",children:v.jsx("div",{className:"max-w-2xl mx-auto p-3 sm:p-4",children:v.jsxs("div",{className:"flex items-center justify-between gap-3",children:[v.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1",children:[v.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-error rounded-full flex items-center justify-center",children:v.jsx(Lc,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-xs sm:text-sm font-medium text-base-content/70",children:"Recording"}),v.jsx("p",{className:"text-xl sm:text-2xl font-mono font-bold text-error",children:w(l)})]})]}),v.jsxs("button",{onClick:g,className:"btn btn-error gap-2",children:[v.jsx("div",{className:"w-3 h-3 bg-white rounded-sm"}),v.jsx("span",{className:"hidden sm:inline",children:"Stop"})]})]})})}):v.jsx("button",{onClick:m,className:"btn btn-ghost btn-circle btn-sm sm:btn-md hover:bg-primary/10 hover:text-primary transition-colors flex-shrink-0",disabled:e,title:"Record voice message",children:v.jsx(Lc,{className:"w-4 h-4 sm:w-5 sm:h-5"})})},DY=({replyingTo:t,onCancelReply:e})=>{const[n,s]=F.useState(""),[r,i]=F.useState(null),[o,a]=F.useState(!1),[l,c]=F.useState(!1),u=F.useRef(null),d=F.useRef(null),{sendMessage:h,selectedUser:f}=Na(),{socket:p}=Wt(),m=["","","","","","","","","","","",""],g=T=>{s(T),!(!p||!f)&&(p.emit("typing",{receiverId:f._id}),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{p.emit("stopTyping",{receiverId:f._id})},2e3))};F.useEffect(()=>()=>{d.current&&clearTimeout(d.current),p&&f&&p.emit("stopTyping",{receiverId:f._id})},[p,f]);const y=T=>{const I=T.target.files[0];if(!I||!I.type.startsWith("image/")){ve.error("Please select an image file");return}const $=new FileReader;$.onloadend=()=>{i($.result)},$.readAsDataURL(I)},x=()=>{i(null),u.current&&(u.current.value="")},w=async T=>{if(T.preventDefault(),!(!n.trim()&&!r)){c(!0),p&&f&&p.emit("stopTyping",{receiverId:f._id});try{await h({text:n.trim(),image:r,replyTo:(t==null?void 0:t._id)||null}),s(""),i(null),a(!1),u.current&&(u.current.value=""),e&&e()}catch(I){console.error("Failed to send message:",I)}finally{setTimeout(()=>c(!1),300)}}},b=async(T,I)=>{try{await h({voice:T,voiceDuration:I}),ve.success("Voice message sent!")}catch($){console.error("Failed to send voice:",$),ve.error("Failed to send voice message")}},S=T=>{s(I=>I+T),a(!1)};return v.jsxs("div",{className:"p-2.5 sm:p-4 w-full bg-base-100 border-t border-base-300 sticky bottom-0 z-10",style:{paddingBottom:"max(10px, env(safe-area-inset-bottom))"},children:[t&&v.jsxs("div",{className:"mb-2 sm:mb-3 flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-base-200 rounded-xl border-l-4 border-primary reply-slide-in",children:[v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"text-xs font-semibold text-primary mb-0.5",children:["Replying to ",t.senderId===(f==null?void 0:f._id)?f.fullName:"You"]}),v.jsx("div",{className:"text-sm text-base-content/70 truncate",children:t.text||(t.image?" Image":t.voice?" Voice message":"Message")})]}),v.jsx("button",{onClick:e,className:"btn btn-ghost btn-xs btn-circle flex-shrink-0 hover:bg-error/20 hover:text-error transition-colors",type:"button",children:v.jsx(bl,{className:"w-4 h-4"})})]}),r&&v.jsxs("div",{className:"mb-2 sm:mb-3 flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-base-200 rounded-xl",children:[v.jsxs("div",{className:"relative",children:[v.jsx("img",{src:r,alt:"Preview",className:"w-16 h-16 sm:w-20 sm:h-20 object-cover rounded-lg border-2 border-primary"}),v.jsx("button",{onClick:x,className:`absolute -top-2 -right-2 w-6 h-6 rounded-full bg-error text-white\r
              flex items-center justify-center hover:scale-110 active:scale-95 transition shadow-lg`,type:"button",children:v.jsx(bl,{className:"w-4 h-4"})})]}),v.jsx("span",{className:"text-sm text-base-content/70",children:"Image ready to send"})]}),o&&v.jsx("div",{className:"mb-2 sm:mb-3 p-2 sm:p-3 bg-base-200 rounded-xl shadow-lg",children:v.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 justify-center",children:m.map(T=>v.jsx("button",{type:"button",onClick:()=>S(T),className:"text-2xl p-2 hover:bg-base-300 rounded-lg active:scale-110 transition",children:T},T))})}),v.jsxs("form",{onSubmit:w,className:"flex items-center gap-2",children:[v.jsxs("div",{className:"flex-1 flex items-center gap-1 sm:gap-1.5 bg-base-200 rounded-full px-3 sm:px-4 py-2 sm:py-2.5 min-w-0",children:[v.jsx("input",{type:"text",className:"flex-1 bg-transparent outline-none border-none text-sm sm:text-base placeholder:text-base-content/50 min-w-0",placeholder:"Type a message...",value:n,onChange:T=>g(T.target.value)}),v.jsx("button",{type:"button",className:`p-1 sm:p-1.5 rounded-full hover:bg-base-300 active:scale-95 transition flex-shrink-0
              ${o?"text-primary":"text-base-content/60"}`,onClick:()=>a(!o),title:"Add emoji",children:v.jsx(vY,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),v.jsx("button",{type:"button",className:`p-1 sm:p-1.5 rounded-full hover:bg-base-300 active:scale-95 transition flex-shrink-0
              ${r?"text-primary":"text-base-content/60"}`,onClick:()=>{var T;return(T=u.current)==null?void 0:T.click()},title:"Attach image",children:v.jsx(uY,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),v.jsx("input",{type:"file",accept:"image/*",className:"hidden",ref:u,onChange:y})]}),!n.trim()&&!r&&v.jsx(_Y,{onSendVoice:b}),(n.trim()||r)&&v.jsx("button",{type:"submit",className:`btn btn-primary btn-circle btn-sm sm:btn-md flex-shrink-0 shadow-lg transition-all ${l?"scale-90":"scale-100 hover:scale-105"}`,disabled:l,children:v.jsx(e3,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]})},OY=()=>{const t=Array(6).fill(null);return v.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:t.map((e,n)=>v.jsxs("div",{className:`chat ${n%2===0?"chat-start":"chat-end"}`,children:[v.jsx("div",{className:"chat-image avatar",children:v.jsx("div",{className:"size-10 rounded-full",children:v.jsx("div",{className:"skeleton w-full h-full rounded-full"})})}),v.jsx("div",{className:"chat-header mb-1",children:v.jsx("div",{className:"skeleton h-4 w-16"})}),v.jsx("div",{className:"chat-bubble bg-transparent p-0",children:v.jsx("div",{className:"skeleton h-16 w-[200px]"})})]},n))})},FY=({message:t,isOwnMessage:e})=>{const{callData:n}=t;if(!n)return null;const s=a=>{if(a<60)return`${a} second${a!==1?"s":""}`;const l=Math.floor(a/60),c=a%60;return c===0?`${l} minute${l!==1?"s":""}`:`${l} minute${l!==1?"s":""} ${c} second${c!==1?"s":""}`},r=n.type==="video",i=r?Jc:My,o=e?xY:yY;return v.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${e?"bg-primary/10 border border-primary/20":"bg-base-200 border border-base-300"}`,children:[v.jsx("div",{className:`p-2 rounded-full ${e?"bg-primary/20":"bg-base-300"}`,children:v.jsx(i,{className:`w-4 h-4 ${e?"text-primary":"text-base-content/70"}`})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx(o,{className:`w-3 h-3 ${e?"text-primary":"text-base-content/50"}`}),v.jsxs("span",{className:`text-sm font-medium ${e?"text-primary":"text-base-content/70"}`,children:[e?"Outgoing":"Incoming"," ",r?"Video":"Voice"," Call"]})]}),v.jsxs("p",{className:"text-xs text-base-content/60",children:["Duration: ",s(n.duration)]})]}),v.jsx("div",{className:"text-xs text-base-content/40",children:new Date(n.timestamp||t.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})};function bA(t){return!t||isNaN(new Date(t))?"":new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}const PY=["","","","","",""],LY=500,MY=300,th=60,BY=({message:t,onReply:e})=>{var fe,ne;const{authUser:n}=Wt(),{addReaction:s,removeReaction:r,deleteMessage:i,selectedUser:o}=Na(),[a,l]=F.useState(!1),[c,u]=F.useState(!1),[d,h]=F.useState(!1),[f,p]=F.useState(0),[m,g]=F.useState(0),[y,x]=F.useState(!1),w=F.useRef(null),b=F.useRef(0),S=F.useRef({x:0,y:0}),T=F.useRef(0),I=F.useRef(null),$=t.senderId===n._id,_=(fe=t.reactions)==null?void 0:fe.find(U=>{var ae;return((ae=U.userId)==null?void 0:ae._id)===n._id||U.userId===n._id});F.useEffect(()=>{const U=I.current;if(!U)return;const ae=()=>{p(U.currentTime)};return U.addEventListener("timeupdate",ae),()=>U.removeEventListener("timeupdate",ae)},[]);const D=U=>{const ae=U.touches[0];S.current={x:ae.clientX,y:ae.clientY},T.current=Date.now(),w.current=setTimeout(()=>{t.image?X():Y()},LY)},z=U=>{const ae=U.touches[0],ge=ae.clientX-S.current.x,be=Math.abs(ae.clientY-S.current.y);if((Math.abs(ge)>10||be>10)&&clearTimeout(w.current),Math.abs(ge)>10&&be<30){const $e=$?Math.min(0,ge):Math.max(0,ge);g(Math.abs($e)>th?$?-th:th:$e)}},H=()=>{clearTimeout(w.current),Math.abs(m)>=th&&(e&&e(t),navigator.vibrate&&navigator.vibrate(30)),setTimeout(()=>g(0),200);const U=Date.now();U-T.current<200&&U-b.current<MY&&J(),b.current=U},X=()=>{t.image&&(navigator.vibrate&&navigator.vibrate(50),x(!0))},Y=()=>{navigator.vibrate&&navigator.vibrate(50),u(!0)},J=()=>{navigator.vibrate&&navigator.vibrate(30),(_==null?void 0:_.emoji)===""?r(t._id):(s(t._id,""),Q())},Q=()=>{const U=document.createElement("div");U.innerHTML="",U.style.cssText=`
      position: fixed;
      font-size: 60px;
      pointer-events: none;
      z-index: 9999;
      animation: heartFloat 1s ease-out forwards;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    `,document.body.appendChild(U),setTimeout(()=>U.remove(),1e3)},ee=U=>{(_==null?void 0:_.emoji)===U?r(t._id):s(t._id,U)},M=()=>{i(t._id)},q=async U=>{try{const ge=await(await fetch(U)).blob(),be=window.URL.createObjectURL(ge),$e=document.createElement("a");$e.href=be,$e.download=`image-${Date.now()}.jpg`,document.body.appendChild($e),$e.click(),document.body.removeChild($e),window.URL.revokeObjectURL(be),ve.success("Image saved!"),x(!1)}catch{ve.error("Failed to save image")}},te=()=>{I.current&&(d?(I.current.pause(),h(!1)):(I.current.play(),h(!0)))},Z=((ne=t.reactions)==null?void 0:ne.reduce((U,ae)=>(U[ae.emoji]||(U[ae.emoji]=[]),U[ae.emoji].push(ae.userId),U),{}))||{},le=t.text&&/^[\p{Emoji}\s]+$/u.test(t.text)&&!t.image&&!t.voice,de=t.text?(t.text.match(new RegExp("\\p{Emoji}","gu"))||[]).length:0;return t.isDeleted?v.jsxs("div",{className:`flex flex-col ${$?"items-end":"items-start"} mb-3`,children:[v.jsxs("div",{className:"flex items-end max-w-[85%] sm:max-w-[75%] gap-2",children:[!$&&v.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border-2 border-base-300 flex-shrink-0 opacity-50",children:v.jsx("img",{src:(o==null?void 0:o.profilePic)||"/avatar.png",alt:"avatar",className:"w-full h-full object-cover"})}),v.jsx("div",{className:"px-3 py-2 text-sm rounded-2xl bg-base-200/50 border border-base-300/50",children:v.jsxs("div",{className:"flex items-center gap-2 text-base-content/50 italic text-xs",children:[v.jsx(xA,{className:"w-3 h-3"}),v.jsx("span",{children:"Message deleted"})]})})]}),v.jsx("div",{className:"text-[10px] text-base-content/40 mt-1 px-1",children:bA(t.createdAt)})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{id:`message-${t._id}`,className:`flex flex-col ${$?"items-end":"items-start"} ${Object.keys(Z).length>0?"mb-6":"mb-3"} relative`,children:[v.jsxs("div",{className:"flex items-end max-w-[80%] sm:max-w-[70%] gap-2 relative",children:[!$&&!le&&v.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden border-2 border-base-300 flex-shrink-0",children:v.jsx("img",{src:(o==null?void 0:o.profilePic)||"/avatar.png",alt:"avatar",className:"w-full h-full object-cover"})}),v.jsxs("div",{className:"relative",style:{WebkitTapHighlightColor:"transparent",transform:`translateX(${m}px)`,transition:m===0?"transform 0.2s ease-out":"none"},onTouchStart:D,onTouchMove:z,onTouchEnd:H,children:[Math.abs(m)>20&&v.jsx("div",{className:`absolute top-1/2 -translate-y-1/2 ${$?"-right-10":"-left-10"}`,style:{opacity:Math.min(Math.abs(m)/th,1)},children:v.jsx(bY,{className:`w-5 h-5 text-base-content/50 ${$?"":"scale-x-[-1]"}`})}),t.image&&!t.text&&!t.voice?v.jsx("div",{className:"relative group",onClick:U=>{U.stopPropagation(),x(!0)},children:v.jsx("img",{src:t.image,className:"rounded-2xl max-h-64 sm:max-h-80 object-cover cursor-pointer active:scale-[0.98] transition-transform shadow-lg",alt:"attached",loading:"lazy",decoding:"async",onError:U=>{console.error("Image failed to load:",t.image),U.target.src="/avatar.png"}})}):v.jsxs("div",{className:le?"":`relative px-3 sm:px-4 py-2 sm:py-2.5 text-sm rounded-2xl shadow-sm ${$?"bg-gradient-to-br from-primary to-primary/90 text-primary-content":"bg-base-200 text-base-content"}`,children:[t.replyTo&&v.jsxs("div",{className:`mb-2 border-l-4 pl-2 py-1 rounded-sm cursor-pointer active:scale-[0.98] transition-transform ${$?"bg-primary-content/10 border-primary-content/50":"bg-base-300/40 border-primary/70"}`,onClick:()=>{const U=document.getElementById(`message-${t.replyTo._id}`);U&&(U.scrollIntoView({behavior:"smooth",block:"center"}),U.classList.add("highlight-flash"),setTimeout(()=>U.classList.remove("highlight-flash"),1500))},children:[v.jsx("div",{className:`text-[10px] font-bold mb-0.5 ${$?"text-primary-content":"text-primary"}`,children:t.replyTo.senderId===n._id?"You":(o==null?void 0:o.fullName)||"User"}),v.jsxs("div",{className:`text-[11px] leading-tight truncate ${$?"text-primary-content/80":"text-base-content/70"}`,children:[t.replyTo.image&&" ",t.replyTo.voice&&" ",t.replyTo.text||(t.replyTo.image?"Photo":t.replyTo.voice?"Voice message":"Message")]})]}),le&&de>0?v.jsx("div",{className:`${de===1?"text-5xl sm:text-6xl":"text-4xl sm:text-5xl"} leading-tight`,children:t.text}):v.jsxs(v.Fragment,{children:[t.image&&t.text&&v.jsx("div",{className:"relative group mb-2",onClick:U=>{U.stopPropagation(),x(!0)},children:v.jsx("img",{src:t.image,className:"rounded-xl max-h-64 sm:max-h-80 object-cover w-full cursor-pointer active:scale-[0.98] transition-transform",alt:"attached",loading:"lazy",decoding:"async",onError:U=>{console.error("Image failed to load:",t.image),U.target.src="/avatar.png"}})}),t.voice&&v.jsxs("div",{className:"flex items-center gap-2 min-w-[200px] max-w-[280px]",children:[v.jsx("button",{onClick:te,className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 transition-all ${d?"bg-primary/20 scale-110":$?"bg-primary-content/20":"bg-primary/10"}`,children:d?v.jsx(gY,{className:"w-4 h-4",fill:"currentColor"}):v.jsx(wY,{className:"w-4 h-4 ml-0.5",fill:"currentColor"})}),v.jsx("div",{className:"flex-1 flex items-center justify-center gap-[3px] h-8",children:[4,7,5,9,6,10,7,8,5,9,6,7,8,6,9,7,5,8,6,7].map((U,ae)=>{const ge=t.voiceDuration||3,be=f/ge,$e=d&&ae/20<=be;return v.jsx("div",{className:`w-[3px] rounded-full transition-all duration-150 ${$e?$?"bg-primary-content":"bg-primary":$?"bg-primary-content/30":"bg-base-content/30"}`,style:{height:`${U*2.5}px`,transform:d&&$e?"scaleY(1.15)":"scaleY(1)",opacity:$e?1:.6}},ae)})}),v.jsx("span",{className:"text-xs opacity-70 font-medium min-w-[32px] text-right",children:d?`${Math.max(0,Math.ceil((t.voiceDuration||0)-f))}s`:`${t.voiceDuration||0}s`}),v.jsx("audio",{ref:I,src:t.voice,onEnded:()=>{h(!1),p(0)}})]}),t.text&&!le&&v.jsx("p",{className:"break-words whitespace-pre-wrap leading-relaxed",children:t.text})]})]}),Object.keys(Z).length>0&&v.jsx("div",{className:`absolute -bottom-4 ${$?"right-0":"left-0"} flex gap-1 z-10`,onClick:()=>l(!a),children:Object.entries(Z).map(([U,ae])=>v.jsxs("div",{className:"flex items-center gap-1 bg-base-100 border-2 border-base-300 rounded-full px-2 py-1 shadow-xl cursor-pointer hover:scale-110 transition-all active:scale-95 hover:shadow-2xl",children:[v.jsx("span",{className:"text-sm leading-none",children:U}),ae.length>1&&v.jsx("span",{className:"text-xs font-bold text-base-content/80 leading-none",children:ae.length})]},U))})]})]}),v.jsxs("div",{className:"flex items-center gap-2 mt-1 px-1",children:[v.jsx("span",{className:"text-[10px] text-base-content/50",children:bA(t.createdAt)}),$&&t.status&&v.jsx("span",{className:"text-[10px] font-bold",children:t.status==="sending"?v.jsx("span",{className:"text-gray-400 opacity-50 animate-pulse",title:"Sending",children:""}):t.status==="read"?v.jsx("span",{className:"text-blue-500",title:"Read",children:""}):t.status==="delivered"?v.jsx("span",{className:"text-gray-400",title:"Delivered",children:""}):v.jsx("span",{className:"text-gray-400",title:"Sent",children:""})})]})]}),c&&v.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end sm:items-center justify-center",onClick:()=>u(!1),children:v.jsxs("div",{className:"bg-base-100 rounded-t-3xl sm:rounded-3xl p-3 sm:p-4 shadow-2xl w-full sm:w-auto",onClick:U=>U.stopPropagation(),children:[v.jsx("div",{className:"flex justify-center gap-2 sm:gap-3 mb-3",children:PY.map(U=>v.jsx("button",{onClick:()=>{ee(U),u(!1)},className:`text-2xl sm:text-3xl hover:scale-110 active:scale-95 transition-transform p-2 rounded-full hover:bg-base-200 ${(_==null?void 0:_.emoji)===U?"scale-110 bg-base-200":""}`,style:{WebkitTapHighlightColor:"transparent"},children:U},U))}),$&&v.jsxs("button",{onClick:()=>{M(),u(!1)},className:"w-full btn btn-error btn-sm gap-2",children:[v.jsx(xA,{className:"w-4 h-4"}),"Delete Message"]})]})}),a&&v.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end sm:items-center justify-center",onClick:()=>l(!1),children:v.jsxs("div",{className:"bg-base-100 rounded-t-2xl sm:rounded-2xl p-3 sm:p-4 max-w-sm w-full shadow-2xl max-h-[70vh] overflow-y-auto",onClick:U=>U.stopPropagation(),children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsx("h3",{className:"font-semibold text-sm",children:"Reactions"}),v.jsx("button",{onClick:()=>l(!1),className:"btn btn-ghost btn-xs btn-circle",children:v.jsx(bl,{className:"w-4 h-4"})})]}),v.jsx("div",{className:"space-y-2",children:Object.entries(Z).map(([U,ae])=>v.jsxs("div",{className:"flex items-start gap-2 py-1",children:[v.jsx("span",{className:"text-xl flex-shrink-0",children:U}),v.jsx("div",{className:"flex-1 min-w-0",children:v.jsx("div",{className:"flex flex-wrap gap-1.5",children:ae.map((ge,be)=>v.jsxs("span",{className:"text-xs text-base-content/70",children:[(ge==null?void 0:ge.fullName)||"User",be<ae.length-1?",":""]},be))})}),v.jsx("span",{className:"text-xs text-base-content/50 flex-shrink-0",children:ae.length})]},U))})]})}),y&&t.image&&v.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:()=>x(!1),children:[v.jsx("button",{onClick:()=>x(!1),className:"absolute top-4 right-4 btn btn-circle btn-sm bg-base-100/20 border-none text-white",children:v.jsx(bl,{className:"w-5 h-5"})}),v.jsxs("div",{className:"relative max-w-4xl w-full",onClick:U=>U.stopPropagation(),children:[v.jsx("img",{src:t.image,className:"w-full h-auto max-h-[80vh] object-contain rounded-lg",alt:"Full size"}),v.jsxs("button",{onClick:()=>q(t.image),className:"absolute bottom-4 right-4 btn btn-primary gap-2",children:[v.jsx(cY,{className:"w-4 h-4"}),"Save Image"]})]})]})]})},zY=({onStartCall:t})=>{const{messages:e=[],getMessages:n,isMessagesLoading:s,selectedUser:r,subscribeToMessages:i}=Na(),{authUser:o,socket:a}=Wt(),l=F.useRef(null),c=F.useRef(null),u=F.useRef(!0),d=F.useRef(0);F.useState(null),F.useRef({});const[h,f]=F.useState(!1),p=F.useRef(null),[m,g]=F.useState(null),y=w=>{g(w)};F.useEffect(()=>{if(!(r!=null&&r._id))return;u.current=!0,d.current=0,c.current&&(c.current.scrollTop=c.current.scrollHeight),n==null||n(r._id);const w=i==null?void 0:i(r._id);return()=>typeof w=="function"&&w()},[r==null?void 0:r._id,n,i]),F.useEffect(()=>{l.current&&(u.current&&e.length>0?(setTimeout(()=>{l.current&&l.current.scrollIntoView({behavior:"auto",block:"end"})},0),u.current=!1,d.current=e.length):e.length>d.current&&!u.current&&(l.current.scrollIntoView({behavior:"smooth",block:"end"}),d.current=e.length))},[e.length,h]),F.useEffect(()=>{if(!a||!r)return;const w=({senderId:S})=>{S===r._id&&(f(!0),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{f(!1)},3e3))},b=({senderId:S})=>{S===r._id&&(f(!1),p.current&&clearTimeout(p.current))};return a.on("typing",w),a.on("stopTyping",b),()=>{a.off("typing",w),a.off("stopTyping",b),p.current&&clearTimeout(p.current)}},[a,r]);const x=w=>{t&&t(w)};return r?v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"flex-1 flex flex-col h-full w-full",children:[v.jsx(AY,{onStartCall:x}),v.jsxs("div",{ref:c,className:"flex-1 overflow-y-auto p-2.5 sm:p-4 space-y-2.5 sm:space-y-4 bg-base-100 scrollbar-thin scrollbar-thumb-base-300 scrollbar-track-transparent",style:{WebkitOverflowScrolling:"touch"},children:[s?v.jsx(OY,{}):e.length===0?v.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[v.jsx("div",{className:"text-6xl mb-4",children:""}),v.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No messages yet"}),v.jsx("p",{className:"text-sm text-base-content/60",children:"Start the conversation by sending a message!"})]}):e.map(w=>{const b=w.senderId===(o==null?void 0:o._id);return w.messageType==="call"||w.callData?v.jsx("div",{className:"flex justify-center w-full my-2",children:v.jsx("div",{className:"max-w-md w-full",children:v.jsx(FY,{message:w,isOwnMessage:b})})},w._id||w.id):v.jsx(BY,{message:w,onReply:y},w._id||w.id)}),h&&v.jsxs("div",{className:"flex items-start gap-2 animate-fadeIn",children:[v.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full overflow-hidden border-2 border-base-300 flex-shrink-0",children:v.jsx("img",{src:r.profilePic||"/avatar.png",alt:"avatar",className:"w-full h-full object-cover"})}),v.jsx("div",{className:"bg-base-200 px-4 py-3 rounded-2xl shadow-sm",children:v.jsxs("div",{className:"flex gap-1",children:[v.jsx("span",{className:"w-2 h-2 bg-base-content/50 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),v.jsx("span",{className:"w-2 h-2 bg-base-content/50 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),v.jsx("span",{className:"w-2 h-2 bg-base-content/50 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),v.jsx("div",{ref:l})]}),v.jsx(DY,{replyingTo:m,onCancelReply:()=>g(null)})]}),v.jsx("style",{children:`
        .bubble-left::after {
          content: "";
          position: absolute;
          left: -6px;
          bottom: 4px;
          border-top: 6px solid transparent;
          border-right: 6px solid var(--b2);
          border-bottom: 6px solid transparent;
        }
        .bubble-right::after {
          content: "";
          position: absolute;
          right: -6px;
          bottom: 4px;
          border-top: 6px solid transparent;
          border-left: 6px solid var(--p);
          border-bottom: 6px solid transparent;
        }
      `})]}):v.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:v.jsxs("div",{className:"max-w-md text-center",children:[v.jsx("h2",{className:"text-2xl font-bold",children:"Welcome to Z-APP"}),v.jsx("p",{className:"text-zinc-500 mt-2",children:"Select a conversation to start messaging."})]})})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VY=1e-7,jY=1e-4;class WC{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class G0{refCount(e){return Cs("refCount")}incRef(e){return Cs("incRef")}timerAvailable(){return!0}time(e){return Cs("time")}read(e){return Cs("read")}readSync(e){return Cs("readSync")}readToGPU(e,n){return Cs("readToGPU")}numDataIds(){return Cs("numDataIds")}disposeData(e,n){return Cs("disposeData")}write(e,n,s){return Cs("write")}move(e,n,s,r,i){return Cs("move")}createTensorFromGPUData(e,n,s){return Cs("createTensorFromGPUData")}memory(){return Cs("memory")}floatPrecision(){return Cs("floatPrecision")}epsilon(){return this.floatPrecision()===32?VY:jY}dispose(){return Cs("dispose")}}function Cs(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GC(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Ki(t,e,n)}function UY(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,Ki(t,n,s),Ki(e,n,s)}function la(t,e,n){return Math.max(t,Math.min(e,n))}function H0(t){return t%2===0?t:t+1}function Ki(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function r3(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function WY(t,e){const n=Math.random();return e*n+(1-n)*t}function GY(t,e){let n=0;for(let s=0;s<t.length;s++){const r=Number(t[s])-Number(e[s]);n+=r*r}return n}function E(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Ln(t,e,n=""){E(Ue(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Ul(t){E(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function se(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function HY(t){return t.length===0}function i3(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Ue(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function vl(t){return t%1===0}function qY(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function By(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function KY(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return GC(e),e}function cl(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function sS(t,e=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function HC(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function ze(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),E(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),E(t.every(s=>vl(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function wo(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:ze(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function kn(t,e){return Bt(t,e)}function Bt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function o3(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function a3(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function qC(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function cf(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function l3(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function vi(t){return typeof t=="string"||t instanceof String}function c3(t){return typeof t=="boolean"}function zy(t){return typeof t=="number"}function Wl(t){return Array.isArray(t)?Wl(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":zy(t)?"float32":vi(t)?"string":c3(t)?"bool":"float32"}function ca(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Vy(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Re(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function u3(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=u3(t+l*a,o,n,s)}return r}function sr(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return u3(0,t,e,n)}function d3(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function q0(t,e){const n=Pn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Pn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function KC(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return sr(t,new Float32Array(n));if(e==="int32")return sr(t,new Int32Array(n));if(e==="bool")return sr(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function Us(t){t.forEach(e=>{E(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Yr(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Gl(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function ao(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vA="tfjsflags";class h3{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=XY,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(ao(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);vA in e&&e[vA].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=JY(r,i)})}}function XY(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(YY(e,s[0],s[1]),s.join("="))),e}function YY(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function JY(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function K(){return XC}let XC=null;function QY(t){XC=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let u1;function f3(){if(u1==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");u1=t}return u1}function ZY(){const t=f3();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function YC(t,e){const n=ZY();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Hf="Abs",Nu="Acos",Tu="Acosh",Hl="Add",qf="AddN",K0="All",X0="Any",Kf="ArgMax",Xf="ArgMin",Iu="Asin",$u="Asinh",Eu="Atan",Ru="Atanh",Au="Atan2",Yf="AvgPool",Y0="AvgPoolGrad",Jf="AvgPool3D",J0="AvgPool3DGrad",Qf="BatchMatMul",Zf="BatchToSpaceND",Q0="Bincount",ep="BitwiseAnd",p3="BroadcastTo",Z0="BroadcastArgs",_u="Cast",Du="Ceil",Ou="ClipByValue",ex="Complex",tp="ComplexAbs",np="Concat",sp="Conv2D",tx="Conv2DBackpropFilter",rp="Conv2DBackpropInput",ip="Conv3D",nx="Conv3DBackpropFilterV2",sx="Conv3DBackpropInputV2",Fu="Cos",Pu="Cosh",rx="Cumprod",op="Cumsum",ix="CropAndResize",ox="DenseBincount",ax="DepthToSpace",ap="DepthwiseConv2dNative",lx="DepthwiseConv2dNativeBackpropFilter",cx="DepthwiseConv2dNativeBackpropInput",ux="Diag",lp="Dilation2D",jy="Dilation2DBackpropInput",Uy="Dilation2DBackpropFilter",dx="Draw",Lu="RealDiv",hx="Einsum",Mu="Elu",fx="EluGrad",Bu="Erf",cp="Equal",zu="Exp",up="ExpandDims",Vu="Expm1",px="FFT",mx="Fill",gx="FlipLeftRight",ju="Floor",Uu="FloorDiv",dp="FusedBatchNorm",hp="GatherV2",yx="GatherNd",fp="Greater",Wu="GreaterEqual",Gu="Identity",xx="IFFT",wx="Imag",Hu="IsFinite",qu="IsInf",Ku="IsNan",pp="LeakyRelu",mp="Less",gp="LessEqual",bx="LinSpace",Xu="Log",Yu="Log1p",yp="LogicalAnd",xp="LogicalNot",wp="LogicalOr",eJ="LogicalXor",m3="LogSoftmax",tJ="LowerBound",bp="LRN",vx="LRNGrad",nJ="MatrixBandPart",vp="Max",Ju="Maximum",Sp="MaxPool",Sx="MaxPoolGrad",kp="MaxPool3D",kx="MaxPool3DGrad",Cx="MaxPoolWithArgmax",Cp="Mean",Np="Min",Qu="Minimum",Tp="MirrorPad",Zu="Mod",Nx="Multinomial",ed="Multiply",Ip="Neg",$p="NotEqual",Tx="NonMaxSuppressionV3",Ix="NonMaxSuppressionV4",$x="NonMaxSuppressionV5",Ep="OnesLike",Rp="OneHot",Ap="Pack",_p="PadV2",sJ="Pool",td="Pow",Dp="Prelu",Op="Prod",Ex="RaggedGather",Rx="RaggedRange",Ax="RaggedTensorToTensor",_x="Range",Dx="Real",nd="Reciprocal",sd="Relu",Fp="Reshape",Pp="ResizeNearestNeighbor",Ox="ResizeNearestNeighborGrad",Lp="ResizeBilinear",Fx="ResizeBilinearGrad",rd="Relu6",Mp="Reverse",id="Round",od="Rsqrt",Px="ScatterNd",Lx="TensorScatterUpdate",Mx="SearchSorted",Bp="Select",ad="Selu",zp="Slice",ld="Sin",cd="Sinh",ud="Sign",dd="Sigmoid",hd="Softplus",fd="Sqrt",Vp="Sum",jp="SpaceToBatchND",Up="SplitV",Wp="Softmax",Bx="SparseFillEmptyRows",zx="SparseReshape",Vx="SparseSegmentMean",jx="SparseSegmentSum",Ux="SparseToDense",pd="SquaredDifference",Wx="Square",Gp="StaticRegexReplace",Gx="StridedSlice",Hx="StringNGrams",qx="StringSplit",Kx="StringToHashBucketFast",md="Sub",gd="Tan",yd="Tanh",xd="Tile",Xx="TopK",Yx="Transform",ul="Transpose",Jx="Unique",Hp="Unpack",qp="UnsortedSegmentSum",rJ="UpperBound",Kp="ZerosLike",wd="Step",Wy="FromPixels",Qx="RotateWithOffset",uf="_FusedMatMul",df="FusedConv2D",hf="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xs(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(...t)}function iJ(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qc=YC("kernelRegistry",()=>new Map),ff=YC("gradRegistry",()=>new Map);function pf(t,e){const n=JC(t,e);return Qc.get(n)}function rS(t){return ff.get(t)}function Gy(t){const e=Qc.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function Zx(t){const{kernelName:e,backendName:n}=t,s=JC(e,n);Qc.has(s)&&Xs(`The kernel '${e}' for backend '${n}' is already registered`),Qc.set(s,t)}function g3(t){const{kernelName:e}=t;ff.has(e)&&K().getBool("DEBUG")&&Xs(`Overriding the gradient for '${e}'`),ff.set(e,t)}function oJ(t,e){const n=JC(t,e);if(!Qc.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);Qc.delete(n)}function aJ(t){if(!ff.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);ff.delete(t)}function lJ(t,e){Gy(t).forEach(s=>{const r=Object.assign({},s,{backendName:e});Zx(r)})}function JC(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var x3=wt,vr=null;try{vr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function wt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}wt.prototype.__isLong__;Object.defineProperty(wt.prototype,"__isLong__",{value:!0});function Ws(t){return(t&&t.__isLong__)===!0}wt.isLong=Ws;var SA={},kA={};function ql(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=kA[t],s)?s:(n=bt(t,(t|0)<0?-1:0,!0),r&&(kA[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=SA[t],s)?s:(n=bt(t,t<0?-1:0,!1),r&&(SA[t]=n),n))}wt.fromInt=ql;function Sr(t,e){if(isNaN(t))return e?tl:kr;if(e){if(t<0)return tl;if(t>=w3)return S3}else{if(t<=-NA)return _s;if(t+1>=NA)return v3}return t<0?Sr(-t,e).neg():bt(t%Zc|0,t/Zc|0,e)}wt.fromNumber=Sr;function bt(t,e,n){return new wt(t,e,n)}wt.fromBits=bt;var Hy=Math.pow;function QC(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return kr;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return QC(t.substring(1),e,n).neg();for(var r=Sr(Hy(n,8)),i=kr,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=Sr(Hy(n,a));i=i.mul(c).add(Sr(l))}else i=i.mul(r),i=i.add(Sr(l))}return i.unsigned=e,i}wt.fromString=QC;function oi(t,e){return typeof t=="number"?Sr(t,e):typeof t=="string"?QC(t,e):bt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}wt.fromValue=oi;var CA=65536,cJ=1<<24,Zc=CA*CA,w3=Zc*Zc,NA=w3/2,TA=ql(cJ),kr=ql(0);wt.ZERO=kr;var tl=ql(0,!0);wt.UZERO=tl;var Ec=ql(1);wt.ONE=Ec;var b3=ql(1,!0);wt.UONE=b3;var iS=ql(-1);wt.NEG_ONE=iS;var v3=bt(-1,2147483647,!1);wt.MAX_VALUE=v3;var S3=bt(-1,-1,!0);wt.MAX_UNSIGNED_VALUE=S3;var _s=bt(0,-2147483648,!1);wt.MIN_VALUE=_s;var we=wt.prototype;we.toInt=function(){return this.unsigned?this.low>>>0:this.low};we.toNumber=function(){return this.unsigned?(this.high>>>0)*Zc+(this.low>>>0):this.high*Zc+(this.low>>>0)};we.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(_s)){var n=Sr(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Sr(Hy(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};we.getHighBits=function(){return this.high};we.getHighBitsUnsigned=function(){return this.high>>>0};we.getLowBits=function(){return this.low};we.getLowBitsUnsigned=function(){return this.low>>>0};we.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_s)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};we.isZero=function(){return this.high===0&&this.low===0};we.eqz=we.isZero;we.isNegative=function(){return!this.unsigned&&this.high<0};we.isPositive=function(){return this.unsigned||this.high>=0};we.isOdd=function(){return(this.low&1)===1};we.isEven=function(){return(this.low&1)===0};we.equals=function(e){return Ws(e)||(e=oi(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};we.eq=we.equals;we.notEquals=function(e){return!this.eq(e)};we.neq=we.notEquals;we.ne=we.notEquals;we.lessThan=function(e){return this.comp(e)<0};we.lt=we.lessThan;we.lessThanOrEqual=function(e){return this.comp(e)<=0};we.lte=we.lessThanOrEqual;we.le=we.lessThanOrEqual;we.greaterThan=function(e){return this.comp(e)>0};we.gt=we.greaterThan;we.greaterThanOrEqual=function(e){return this.comp(e)>=0};we.gte=we.greaterThanOrEqual;we.ge=we.greaterThanOrEqual;we.compare=function(e){if(Ws(e)||(e=oi(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};we.comp=we.compare;we.negate=function(){return!this.unsigned&&this.eq(_s)?_s:this.not().add(Ec)};we.neg=we.negate;we.add=function(e){Ws(e)||(e=oi(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=i+c,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+o,u&=65535,bt(h<<16|f,u<<16|d,this.unsigned)};we.subtract=function(e){return Ws(e)||(e=oi(e)),this.add(e.neg())};we.sub=we.subtract;we.multiply=function(e){if(this.isZero())return kr;if(Ws(e)||(e=oi(e)),vr){var n=vr.mul(this.low,this.high,e.low,e.high);return bt(n,vr.get_high(),this.unsigned)}if(e.isZero())return kr;if(this.eq(_s))return e.isOdd()?_s:kr;if(e.eq(_s))return this.isOdd()?_s:kr;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TA)&&e.lt(TA))return Sr(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=i*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=s*u+r*c+i*l+o*a,d&=65535,bt(f<<16|p,d<<16|h,this.unsigned)};we.mul=we.multiply;we.divide=function(e){if(Ws(e)||(e=oi(e)),e.isZero())throw Error("division by zero");if(vr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?vr.div_u:vr.div_s)(this.low,this.high,e.low,e.high);return bt(n,vr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?tl:kr;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return tl;if(e.gt(this.shru(1)))return b3;i=tl}else{if(this.eq(_s)){if(e.eq(Ec)||e.eq(iS))return _s;if(e.eq(_s))return Ec;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(kr)?e.isNegative()?Ec:iS:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(_s))return this.unsigned?tl:kr;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=kr}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:Hy(2,a-48),c=Sr(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=Sr(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Ec),i=i.add(c),r=r.sub(u)}return i};we.div=we.divide;we.modulo=function(e){if(Ws(e)||(e=oi(e)),vr){var n=(this.unsigned?vr.rem_u:vr.rem_s)(this.low,this.high,e.low,e.high);return bt(n,vr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};we.mod=we.modulo;we.rem=we.modulo;we.not=function(){return bt(~this.low,~this.high,this.unsigned)};we.and=function(e){return Ws(e)||(e=oi(e)),bt(this.low&e.low,this.high&e.high,this.unsigned)};we.or=function(e){return Ws(e)||(e=oi(e)),bt(this.low|e.low,this.high|e.high,this.unsigned)};we.xor=function(e){return Ws(e)||(e=oi(e)),bt(this.low^e.low,this.high^e.high,this.unsigned)};we.shiftLeft=function(e){return Ws(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?bt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):bt(0,this.low<<e-32,this.unsigned)};we.shl=we.shiftLeft;we.shiftRight=function(e){return Ws(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?bt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):bt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};we.shr=we.shiftRight;we.shiftRightUnsigned=function(e){if(Ws(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return bt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?bt(n,0,this.unsigned):bt(n>>>e-32,0,this.unsigned)};we.shru=we.shiftRightUnsigned;we.shr_u=we.shiftRightUnsigned;we.toSigned=function(){return this.unsigned?bt(this.low,this.high,!1):this};we.toUnsigned=function(){return this.unsigned?this:bt(this.low,this.high,!0)};we.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};we.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};we.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};wt.fromBytes=function(e,n,s){return s?wt.fromBytesLE(e,n):wt.fromBytesBE(e,n)};wt.fromBytesLE=function(e,n){return new wt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};wt.fromBytesBE=function(e,n){return new wt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const k3=lD(x3),uJ=aD({__proto__:null,default:k3},[x3]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wa=k3||uJ;function Xp(t){return Wa.fromString(t,!0,16)}const C3=Xp("c3a5c85c97cb3127"),ja=Xp("b492b66fbe98f273"),Zn=Xp("9ae16a3b2f90404f");function oS(t){return t.xor(t.shru(47))}function N3(t,e,n){const s=t.slice(e,e+n);return Wa.fromBytes(Array.from(s),!0,!0)}function pt(t,e){return N3(t,e,8)}function IA(t,e){return N3(t,e,4)}function wn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function ea(t,e,n=Xp("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function dJ(t,e,n,s,r,i){r=r.add(t),i=wn(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(wn(r,44)),[r.add(s),i.add(o)]}function ag(t,e,n,s){return dJ(pt(t,e),pt(t,e+8),pt(t,e+16),pt(t,e+24),n,s)}function hJ(t,e=t.length){if(e>=8){const n=Zn.add(e*2),s=pt(t,0).add(Zn),r=pt(t,e-8),i=wn(r,37).mul(n).add(s),o=wn(s,25).add(r).mul(n);return ea(i,o,n)}if(e>=4){const n=Zn.add(e*2),s=IA(t,0);return ea(s.shl(3).add(e),IA(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return oS(Zn.mul(i).xor(C3.mul(o))).mul(Zn)}return Zn}function fJ(t,e=t.length){const n=Zn.add(e*2),s=pt(t,0).mul(ja),r=pt(t,8),i=pt(t,e-8).mul(n),o=pt(t,e-16).mul(Zn);return ea(wn(s.add(r),43).add(wn(i,30)).add(o),s.add(wn(r.add(Zn),18)).add(i),n)}function pJ(t,e=t.length){const n=Zn.add(e*2),s=pt(t,0).mul(Zn),r=pt(t,8),i=pt(t,e-8).mul(n),o=pt(t,e-16).mul(Zn),a=wn(s.add(r),43).add(wn(i,30)).add(o),l=ea(a,s.add(wn(r.add(Zn),18)).add(i),n),c=pt(t,16).mul(n),u=pt(t,24),d=a.add(pt(t,e-32)).mul(n),h=l.add(pt(t,e-24)).mul(n);return ea(wn(c.add(u),43).add(wn(d,30)).add(h),c.add(wn(u.add(s),18)).add(d),n)}function T3(t,e=t.length){const n=Wa.fromNumber(81,!0);if(e<=32)return e<=16?hJ(t,e):fJ(t,e);if(e<=64)return pJ(t,e);let s=n,r=n.mul(ja).add(113),i=oS(r.mul(Zn).add(113)).mul(Zn),o=[Wa.UZERO,Wa.UZERO],a=[Wa.UZERO,Wa.UZERO];s=s.mul(Zn).add(pt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=wn(s.add(r).add(o[0]).add(pt(t,l+8)),37).mul(ja),r=wn(r.add(o[1]).add(pt(t,l+48)),42).mul(ja),s=s.xor(a[1]),r=r.add(o[0]).add(pt(t,l+40)),i=wn(i.add(a[0]),33).mul(ja),o=ag(t,l,o[1].mul(ja),s.add(a[0])),a=ag(t,l+32,i.add(a[1]),r.add(pt(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const d=ja.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=wn(s.add(r).add(o[0]).add(pt(t,l+8)),37).mul(d),r=wn(r.add(o[1]).add(pt(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(pt(t,l+40))),i=wn(i.add(a[0]),33).mul(d),o=ag(t,l,o[1].mul(d),s.add(a[0])),a=ag(t,l+32,i.add(a[1]),r.add(pt(t,l+16))),[i,s]=[s,i],ea(ea(o[0],a[0],d).add(oS(r).mul(C3)).add(i),ea(o[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bo(t,e){return e==="string"?$i(t):Ta([t],e)}function mJ(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Ta(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Oi(t)),K().getBool("DEBUG")&&o3(t,e),mJ(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Rn(){return K().platform.now()}function I3(t,e){return K().platform.fetch(t,e)}function $i(t,e="utf-8"){return e=e||"utf-8",K().platform.encode(t,e)}function lo(t,e="utf-8"){return e=e||"utf-8",K().platform.decode(t,e)}function ln(t){return K().platform.isTypedArray!=null?K().platform.isTypedArray(t):y3(t)}function Oi(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||ao(t)||t==null||ln(t)&&n)e.push(t);else if(Array.isArray(t)||ln(t))for(let s=0;s<t.length;++s)Oi(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Oi(t[r],e,n)}return e}const gJ=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Ue,arraysEqualWithNull:i3,assert:E,assertNonNegativeIntegerDimensions:Us,assertNonNull:Ul,assertShapesMatch:Ln,bytesFromStringArray:l3,bytesPerElement:cf,checkConversionForErrors:o3,clamp:la,computeStrides:Re,convertBackendValuesAndArrayBuffer:d3,createScalarValue:bo,createShuffledIndices:KY,decodeString:lo,distSquared:GY,encodeString:$i,fetch:I3,fingerPrint64:T3,flatten:Oi,getArrayFromDType:Bt,getTypedArrayFromDType:kn,hasEncodingLoss:qC,hexToLong:Xp,indexToLoc:Gl,inferDtype:Wl,inferFromImplicitShape:HC,isBoolean:c3,isFunction:ca,isInt:vl,isNumber:zy,isPromise:ao,isScalarShape:HY,isString:vi,isTypedArray:ln,isValidDtype:a3,locToIndex:Yr,makeOnesTypedArray:q0,makeZerosNestedTypedArray:KC,makeZerosTypedArray:Pn,nearestDivisor:Vy,nearestLargerEven:H0,now:Rn,parseAxisParam:ze,randUniform:WY,repeatedTry:sS,rightPad:cl,shuffle:GC,shuffleCombo:UY,sizeFromShape:se,sizeToSquarishShape:By,squeezeShape:wo,sum:r3,swap:Ki,tanh:qY,toNestedArray:sr,toTypedArray:Ta},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yJ{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new wJ)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=Rn();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:Rn()-a})}if(K().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{xJ(d,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function xJ(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class wJ{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?cl(`${r}ms`,9):r.error,l=cl(e,25),c=n.rank,u=n.size,d=cl(n.shape.toString(),14);let h="";for(const f in i){const p=i[f];if(p!=null){const m=p.shape||n.shape,g=m.length;h+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(s[h.id]){c.outputs.forEach(m=>s[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const h in u)i[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];s[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function vJ(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!Ue(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $A=20,nh=3,d1=7;function SJ(t,e,n,s){const r=Re(e),i=kJ(t,e,n,r),o=e.length,a=Kg(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function kJ(t,e,n,s){const r=se(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?ph(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],fh(l[u+d],0,n).length)}return o}function fh(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(d1))} + ${parseFloat(t[1].toFixed(d1))}j`:vi(t)?s=`'${t}'`:n==="bool"?s=$3(t):s=parseFloat(t.toFixed(d1)).toString(),cl(s,e)}function $3(t){return t===0?"false":"true"}function Kg(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=ph(t);return[fh(m[0],0,n)]}return n==="bool"?[$3(t[0])]:[t[0].toString()]}if(l===1){if(a>$A){const g=nh*o;let y=Array.from(t.slice(0,g)),x=Array.from(t.slice((a-nh)*o,a*o));return n==="complex64"&&(y=ph(y),x=ph(x)),["["+y.map((w,b)=>fh(w,r[b],n)).join(", ")+", ..., "+x.map((w,b)=>fh(w,r[a-nh+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?ph(t):Array.from(t)).map((g,y)=>fh(g,r[y],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),d=s[0]*o,h=[];if(a>$A){for(let m=0;m<nh;m++){const g=m*d,y=g+d;h.push(...Kg(t.slice(g,y),c,n,u,r,!1))}h.push("...");for(let m=a-nh;m<a;m++){const g=m*d,y=g+d;h.push(...Kg(t.slice(g,y),c,n,u,r,m===a-1))}}else for(let m=0;m<a;m++){const g=m*d,y=g+d;h.push(...Kg(t.slice(g,y),c,n,u,r,m===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":p),h}function ph(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=se(e),s!=null){const r=s.length;E(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Bt(n,this.size),this.strides=Re(e)}set(e,...n){n.length===0&&(n=[0]),E(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Gr().makeTensor(this.values,this.shape,this.dtype)}}let Gr=null,uc=null;function CJ(t){Gr=t}function NJ(t){uc=t}class Xe{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=se(e),this.strides=Re(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return uc.buffer(this.shape,this.dtype,e)}bufferSync(){return uc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return sr(this.shape,e,this.dtype==="complex64")}arraySync(){return sr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Gr().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>lo(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Gr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Gr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>lo(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Gr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Gr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return uc.print(this,e)}clone(){return this.throwIfDisposed(),uc.clone(this)}toString(e=!1){const n=this.dataSync();return SJ(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),uc.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Gr().makeVariable(this,e,n,s)}}Object.defineProperty(Xe,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function oe(){return YC("Tensor",()=>Xe)}oe();class mf extends Xe{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Ue(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Gr().disposeTensor(this),this.dataId=e.dataId,Gr().incRef(this,null)}dispose(){Gr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(mf,Symbol.hasInstance,{value:t=>t instanceof Xe&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var aS;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(aS||(aS={}));var lS;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(lS||(lS={}));var cS;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(cS||(cS={}));var uS;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(uS||(uS={}));var dS;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(dS||(dS={}));const TJ={float32:uS,int32:lS,bool:cS,complex64:dS};function gs(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return TJ[t][e]}function ew(t){return gs(t,"int32")}function E3(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function R3(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ot(t,e){if(t.dtype===e.dtype)return[t,e];const n=gs(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function A3(t,e){E(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function tw(t,e){return e.some(n=>n.id===t.id)}function co(t){const e=[];return _3(t,e,new Set),e}function _3(t,e,n){if(t==null)return;if(t instanceof Xe){e.push(t);return}if(!IJ(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),_3(i,e,n))}}function IJ(t){return Array.isArray(t)||typeof t=="object"}const $J=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:A3,getTensorsInContainer:co,isTensorInList:tw,makeTypesMatch:Ot},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1(t){return t.kernelName!=null}class EA{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class eu{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new EA}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Xs(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new yJ(this.backendInstance),!0}setupRegisteredKernels(){Gy(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Gy(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof G0)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Xs(`Initialization of backend ${e} failed`),Xs(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Xs(`Initialization of backend ${e} failed`),Xs(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return eu.nextTensorId++}nextVariableId(){return eu.nextVariableId++}clone(e){const n=P.runKernel(Gu,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return P.runKernel(_u,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(pf(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=h1(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(h1(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const y=pf(p,this.backendName);E(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const x=this.backend.numDataIds();l=y.kernelFunc({inputs:m,attrs:g,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,x,w);const b=w.map(S=>S.rank!=null?S:this.makeTensorFromTensorInfo(S));if(r){const S=this.getTensorsForGradient(p,m,b);s=this.saveTensorsForBackwardMode(S)}return b}}else{const{forwardFunc:p}=e,m=g=>{r&&(s=g.map(y=>this.keep(this.clone(y))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,g,y),y}}const{inputs:u,attrs:d}=e,h=h1(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=rS(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(E(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&vi(e[0])&&(i=e.map(l=>$i(l)));const o=r.write(i,n,s),a=new Xe(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=l3(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new Xe(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new mf(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*cf(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof mf||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*cf(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=rS(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],f=Pn(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=co(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(E(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));E(i instanceof Xe,()=>"The result y returned by f() must be a tensor.");const o=bJ(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??EJ(i.shape),vJ(a,o,c=>this.tidy(c),RJ);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return E(ca(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{E(n.every(a=>a instanceof Xe),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),E(s.value instanceof Xe,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),E(ca(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];E(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),E(u.every(h=>h instanceof Xe),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Rn(),s=await this.backend.time(e);return s.wallMs=Rn()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new EA;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}eu.nextTensorId=0;eu.nextVariableId=0;function EJ(t){const e=q0(se(t),"float32");return P.makeTensor(e,t,"float32")}function D3(){const t=f3();if(t._tfengine==null){const e=new h3(t);t._tfengine=new eu(e)}return QY(t._tfengine.ENV),CJ(()=>t._tfengine),t._tfengine}const P=D3();function RJ(t,e){const n={a:t,b:e};return P.runKernel(Hl,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(){return typeof navigator<"u"&&navigator!=null}let hS;function _J(t){hS=t}function ZC(t){if(hS!==void 0)return hS;if(t||AJ()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function eN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const DJ=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:eN,isMobile:ZC,mockIsMobile:_J},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ys=K();ys.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ys.registerFlag("IS_BROWSER",()=>eN());ys.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ys.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ys.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ys.registerFlag("PROD",()=>!1);ys.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ys.getBool("DEBUG"));ys.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ys.registerFlag("IS_TEST",()=>!1);ys.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ys.getBool("DEBUG"));ys.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ys.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ys.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(t,e){let n=t;if(ln(t))return e==="string"?[]:[t.length];if(E3(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(R3(t))return[t.buffer.size/(e==null?4:cf(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||ln(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&O3(t,s,[]),s}function O3(t,e,n){if(n=n||[],!Array.isArray(t)&&!ln(t)){E(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}E(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),E(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)O3(t[r],s,n.concat(r))}function RA(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function R(t,e,n,s="numeric"){if(t instanceof oe())return RA(s,t.dtype,e,n),t;let r=Wl(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),RA(s,r,e,n),t==null||!ln(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=Fi(t,r);!ln(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Ta(t,r):Oi(t,[],!0);return P.makeTensor(a,i,r)}function gf(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>R(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tN="__op";function L(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+tN;const r=(...i)=>{P.startScope(n);try{const o=s(...i);return ao(o)&&console.error("Cannot return a Promise inside of tidy."),P.endScope(o),o}catch(o){throw P.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OJ(t,e){const n=R(t,"real","complex"),s=R(e,"imag","complex");Ln(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return P.runKernel(ex,r)}const uo=L({complex_:OJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ia(t,e,n,s){if(s==null)s=Wl(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(R3(t)||E3(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return P.backend.createTensorFromGPUData(t,e||n,s)}if(!ln(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Us(e);const r=se(e),i=se(n);E(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==se(e.slice(o)):!0;E(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!ln(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Ta(t,s):Oi(t,[],!0),P.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ms(t,e,n){const s=Fi(t,n);return Ia(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sl={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ai{static join(e){return new ai(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>ln(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,p=Math.min(n,c.end)-c.start,m=new Uint8Array(c.buffer,d,p-d);if(o.set(m,h),a+=m.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=FJ(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function FJ(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=e(t[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PJ(){K().set("PROD",!0)}function LJ(){K().set("DEBUG",!0)}function MJ(){K().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function BJ(t){K().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function zJ(){P.disposeVariables()}function Vr(){return P}function fS(){return P.memory()}function VJ(t){return P.profile(t)}function G(t,e){return P.tidy(t,e)}function Oe(t){co(t).forEach(n=>n.dispose())}function dn(t){return P.keep(t)}function jJ(t){return P.time(t)}function UJ(t){return P.setBackend(t)}function WJ(){return P.ready()}function F3(){return P.backendName}function GJ(t){P.removeBackend(t)}function HJ(t){return P.findBackend(t)}function qJ(t){return P.findBackendFactory(t)}function nN(t,e,n=1){return P.registerBackend(t,e,n)}function sN(){return P.backend}function KJ(t,e){K().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ua=4;async function pS(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((g,y)=>g+y.length,0)+ua*h.length,p=new Uint8Array(f);let m=0;for(let g=0;g<h.length;g++){const y=h[g],x=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(x,m),m+=ua,p.set(y,m),m+=y.length}d(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:JJ(i),specs:n}}function rN(t,e){const n=new ai(t),s={};let r=0;for(const i of e){const o=XJ(i,(a,l)=>n.slice(r+a,r+l));s[i.name]=P3(i,n.slice(r,r+o)),r+=o}return s}function XJ(t,e){const n=se(t.shape);let s;if("quantization"in t){const r=t.quantization;s=Sl[r.dtype]}else if(t.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=ua+new Uint32Array(e(r,r+ua))[0];return r}else s=Sl[t.dtype];return n*s}async function YJ(t,e){const n=se(t.shape);let s;if("quantization"in t){const r=t.quantization;s=Sl[r.dtype]}else if(t.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=ua+new Uint32Array(await e(r,r+ua))[0];return r}else s=Sl[t.dtype];return n*s}function P3(t,e){const n=t.name,s=t.dtype,r=t.shape,i=se(r);let o,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Sl[l.dtype],u=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=h*l.scale+l.min}}else if(l.dtype==="float16")o=sQ()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*c}else if(s==="string"){const l=se(t.shape);o=[];for(let c=0;c<l;c++){const u=new Uint32Array(e.slice(a,a+ua))[0];a+=ua;const d=new Uint8Array(e.slice(a,a+u));o.push(d),a+=u}}else{const l=Sl[s];if(s==="float32")o=new Float32Array(e);else if(s==="int32")o=new Int32Array(e);else if(s==="bool")o=new Uint8Array(e);else if(s==="complex64"){o=new Float32Array(e);const c=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let p=0;p<c.length;p++)c[p]=o[p*2],u[p]=o[p*2+1];const d=Ms(c,r,"float32"),h=Ms(u,r,"float32"),f=uo(d,h);return d.dispose(),h.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*l}return Ms(o,r,s)}async function AA(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:r,value:i}=await t.read();if(r&&i==null){const a=n-s.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(s.length+i.byteLength);o.set(s,0),o.set(new Uint8Array(i),s.length),s=o}return s.buffer}async function L3(t,e){const n={},s=t.getReader();let r=new ArrayBuffer(0);for(const i of e){const o=await YJ(i,async(c,u)=>(r=await AA(s,r,u),r.slice(c,u)));r=await AA(s,r,o);const a=r.slice(0,o);r=r.slice(o);const l=P3(i,a);if(n[i.name]=l,F3()==="webgpu"){const c=sN();"uploadToGPU"in c&&se(l.shape)>=K().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return n}function JJ(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const iN=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function _A(t){return iN?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function QJ(t){if(iN)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function ZJ(t){if(iN){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function M3(t){return ai.join(t)}function DA(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function B3(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function oN(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function aN(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),oN(t,n,s)}function Yp(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:_A(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:_A(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ai(t.weightData).byteLength}}function qy(t){const e=[];for(const n of t)e.push(...n.weights);return e}function eQ(){const t=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function tQ(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function nQ(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function sQ(){const t=eQ(),e=tQ(),n=nQ();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let o=0;o<s.length;o++){const a=s[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Et{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Et.instance==null&&(Et.instance=new Et),Et.instance}static registerSaveRouter(e){Et.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Et.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Et.getHandlers(e,"save")}static getLoadHandlers(e,n){return Et.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Et.getInstance().loadRouters:Et.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const rQ=t=>Et.registerSaveRouter(t),iQ=t=>Et.registerLoadRouter(t),z3=t=>Et.getSaveHandlers(t),V3=(t,e)=>Et.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mS="tensorflowjs",gS=1,nl="models_store",zo="model_info_store";function j3(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function yS(t){const e=t.result;e.createObjectStore(nl,{keyPath:"modelPath"}),e.createObjectStore(zo,{keyPath:"modelPath"})}class kl{constructor(e){if(this.indexedDB=j3(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(mS,gS);i.onupgradeneeded=()=>yS(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(nl,"readonly"),c=a.objectStore(nl).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=ai.join(n.weightData);const a=Yp(n),l=o.transaction(zo,"readwrite");let c=l.objectStore(zo),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;u.onsuccess=()=>{d=o.transaction(nl,"readwrite");const h=d.objectStore(nl);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(zo);const m=c.delete(this.modelPath);m.onsuccess=()=>(o.close(),r(f.error)),m.onerror=g=>(o.close(),r(f.error))}},u.onerror=h=>(o.close(),r(u.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}kl.URL_SCHEME="indexeddb://";const U3=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(kl.URL_SCHEME)?oQ(t.slice(kl.URL_SCHEME.length)):null;Et.registerSaveRouter(U3);Et.registerLoadRouter(U3);function oQ(t){return new kl(t)}function aQ(t){return t.startsWith(kl.URL_SCHEME)?t.slice(kl.URL_SCHEME.length):t}class lQ{constructor(){this.indexedDB=j3()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(mS,gS);s.onupgradeneeded=()=>yS(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(zo,"readonly"),a=i.objectStore(zo).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=aQ(e),new Promise((n,s)=>{const r=this.indexedDB.open(mS,gS);r.onupgradeneeded=()=>yS(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(zo,"readwrite"),a=o.objectStore(zo),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=i.transaction(nl,"readwrite");const f=c.objectStore(nl).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xi="/",dc="tensorflowjs_models",W3="info",cQ="model_topology",uQ="weight_specs",dQ="weight_data",hQ="model_metadata";function G3(t){return{info:[dc,t,W3].join(Xi),topology:[dc,t,cQ].join(Xi),weightSpecs:[dc,t,uQ].join(Xi),weightData:[dc,t,dQ].join(Xi),modelMetadata:[dc,t,hQ].join(Xi)}}function H3(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function fQ(t){const e=t.split(Xi);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Xi)}function pQ(t){return t.startsWith(Cl.URL_SCHEME)?t.slice(Cl.URL_SCHEME.length):t}class Cl{constructor(e){if(!K().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=G3(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Yp(e),i=ai.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,QJ(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw H3(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=ZJ(o),n}}Cl.URL_SCHEME="localstorage://";const q3=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Cl.URL_SCHEME)?mQ(t.slice(Cl.URL_SCHEME.length)):null;Et.registerSaveRouter(q3);Et.registerLoadRouter(q3);function mQ(t){return new Cl(t)}class gQ{constructor(){E(K().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),E(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=dc+Xi,s=Xi+W3;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=fQ(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=pQ(e);const n=G3(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return H3(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mc="://";class Jn{constructor(){this.managers={}}static getInstance(){return Jn.instance==null&&(Jn.instance=new Jn),Jn.instance}static registerManager(e,n){E(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Mc)&&(e=e.slice(0,e.indexOf(Mc))),E(e.length>0,()=>"scheme must not be an empty string.");const s=Jn.getInstance();E(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=Jn.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(Jn.getInstance().managers)}}function Xg(t){if(t.indexOf(Mc)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Jn.getSchemes().join(",")}`);return{scheme:t.split(Mc)[0],path:t.split(Mc)[1]}}async function K3(t,e,n=!1){E(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=Et.getLoadHandlers(t);E(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),E(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const r=s[0],i=Et.getSaveHandlers(e);E(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),E(i.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const o=i[0],a=Xg(t).scheme,l=Xg(t).path,c=a===Xg(t).scheme,u=await r.load();n&&c&&await Jn.getManager(a).removeModel(l);const d=await o.save(u);return n&&!c&&await Jn.getManager(a).removeModel(l),d.modelArtifactsInfo}async function yQ(){const t=Jn.getSchemes(),e={};for(const n of t){const s=await Jn.getManager(n).listModels();for(const r in s){const i=n+Mc+r;e[i]=s[r]}}return e}async function xQ(t){const e=Xg(t);return Jn.getManager(e.scheme).removeModel(e.path)}async function wQ(t,e){return K3(t,e,!1)}async function bQ(t,e){return K3(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vQ{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!K().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return y3(e)}}if(K().get("IS_BROWSER")){K().setPlatform("browser",new vQ);try{Jn.registerManager(Cl.URL_SCHEME,new gQ)}catch{}try{Jn.registerManager(kl.URL_SCHEME,new lQ)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ={importFetch:()=>require("node-fetch")};let f1;class kQ{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return K().global.fetch!=null?K().global.fetch(e,n):(f1==null&&(f1=SQ.importFetch()),f1(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}K().get("IS_NODE")&&!K().get("IS_BROWSER")&&K().setPlatform("node",new kQ);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Le(t,e="float32",n){return e=e||"float32",Us(t),new rn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CQ(t,e){const n=R(t,"x","cast");if(!a3(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return P.runKernel(_u,s,r)}const me=L({cast_:CQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NQ(t){const n={x:R(t,"x","clone","string_or_numeric")};return P.runKernel(Gu,n)}const Ei=L({clone_:NQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lN(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */D3();const TQ={buffer:Le,cast:me,clone:Ei,print:lN};NJ(TQ);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQ(t,e){let n=R(t,"a","add"),s=R(e,"b","add");[n,s]=Ot(n,s);const r={a:n,b:s};return P.runKernel(Hl,r)}const ue=L({add_:IQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(t,e){let n=R(t,"a","floorDiv"),s=R(e,"b","floorDiv");[n,s]=Ot(n,s);const r={a:n,b:s};return P.runKernel(Uu,r)}const nw=L({floorDiv_:$Q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(t,e){let n=R(t,"a","div"),s=R(e,"b","div");if([n,s]=Ot(n,s),n.dtype==="int32"&&s.dtype==="int32")return nw(n,s);const r={a:n,b:s},i={};return P.runKernel(Lu,r,i)}const Te=L({div_:EQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RQ(t,e){let n=R(t,"a","mul"),s=R(e,"b","mul");[n,s]=Ot(n,s);const r={a:n,b:s};return P.runKernel(ed,r)}const B=L({mul_:RQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(t){const e=R(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return P.runKernel(tp,n)}else{const n={x:e};return P.runKernel(Hf,n)}}const en=L({abs_:AQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(t){const n={x:R(t,"x","acos")};return P.runKernel(Nu,n)}const cN=L({acos_:_Q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(t){const n={x:R(t,"x","acosh")};return P.runKernel(Tu,n)}const uN=L({acosh_:DQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(t){E(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),E(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((r,i)=>R(r,`tensors${i}`,"addN")),n=e[0];e.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!Ue(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return P.runKernel(qf,s)}const X3=L({addN_:OQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(t,e=null,n=!1){const r={x:R(t,"x","all","bool")},i={axis:e,keepDims:n};return P.runKernel(K0,r,i)}const sw=L({all_:FQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(t,e=null,n=!1){const r={x:R(t,"x","any","bool")},i={axis:e,keepDims:n};return P.runKernel(X0,r,i)}const yf=L({any_:PQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQ(t,e=0){const s={x:R(t,"x","argMax")},r={axis:e};return P.runKernel(Kf,s,r)}const Nl=L({argMax_:LQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(t,e=0){const s={x:R(t,"x","argMin")},r={axis:e};return P.runKernel(Xf,s,r)}const dN=L({argMin_:MQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(t){const n={x:R(t,"x","asin")};return P.runKernel(Iu,n)}const hN=L({asin_:BQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(t){const n={x:R(t,"x","asinh")};return P.runKernel($u,n)}const fN=L({asinh_:zQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(t){const n={x:R(t,"x","atan")};return P.runKernel(Eu,n)}const pN=L({atan_:VQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jQ(t,e){let n=R(t,"a","atan2"),s=R(e,"b","atan2");[n,s]=Ot(n,s);const r={a:n,b:s};return P.runKernel(Au,r)}const mN=L({atan2_:jQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UQ(t){const n={x:R(t,"x","atanh")};return P.runKernel(Ru,n)}const gN=L({atanh_:UQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jp(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=So(r);return Tn(t,a,n,i,s,null,null,l)}function Rr(t,e,n,s,r,i,o="channelsLast"){const[a,l]=xf(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Tn(t,c,n,s,r,i,!1,o)}function vo(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=xS(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return $a(t,u,n,s,r,!1,d,i)}function Tn(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,g]=xf(n),[y,x]=xf(s),w=Bc(h,y),b=Bc(f,x),{padInfo:S,outHeight:T,outWidth:I}=HQ(r,c,u,m,g,w,b,i,a),$=o?p*d:p;let _;return a==="channelsFirst"?_=[l,$,T,I]:a==="channelsLast"&&(_=[l,T,I,$]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:T,outWidth:I,outChannels:$,padInfo:S,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:f,effectiveFilterHeight:w,effectiveFilterWidth:b,dilationHeight:y,dilationWidth:x,inShape:t,outShape:_,filterShape:e}}function $a(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d,h]=t;else if(o==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,m,,g]=e,[y,x,w]=xS(n),[b,S,T]=xS(s),I=Bc(f,b),$=Bc(p,S),_=Bc(m,T),{padInfo:D,outDepth:z,outHeight:H,outWidth:X}=qQ(r,c,u,d,y,x,w,I,$,_,a),Y=i?g*h:g;let J;return o==="channelsFirst"?J=[l,Y,z,H,X]:o==="channelsLast"&&(J=[l,z,H,X,Y]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:z,outHeight:H,outWidth:X,outChannels:Y,padInfo:D,strideDepth:y,strideHeight:x,strideWidth:w,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:I,effectiveFilterHeight:$,effectiveFilterWidth:_,dilationDepth:b,dilationHeight:S,dilationWidth:T,inShape:t,outShape:J,filterShape:e}}function WQ(t,e,n,s,r){s==null&&(s=yN(t,e,n));const i=t[0],o=t[1],a=wf((i-e+2*s)/n+1,r),l=wf((o-e+2*s)/n+1,r);return[a,l]}function GQ(t,e,n,s,r,i){r==null&&(r=yN(t,e[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(o[a]=wf((t[a]-e[a]+2*r)/s[a]+1,i));return o}function yN(t,e,n,s=1){const r=Bc(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function xf(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function xS(t){return typeof t=="number"?[t,t,t]:t}function Bc(t,e){return e<=1?t:t+(t-1)*(e-1)}function HQ(t,e,n,s,r,i,o,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=WQ([e,n],i,s,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+i-e),f=Math.max(0,(d-1)*r+o-n),p=Math.floor(h/2),m=h-p,g=Math.floor(f/2),y=f-g;c={top:p,bottom:m,left:g,right:y,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),d=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=wf((e-i+h+f)/s+1,a),d=wf((n-o+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function qQ(t,e,n,s,r,i,o,a,l,c,u){let d,h,f,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const g=GQ([e,n,s,1],[a,l,c],1,[r,i,o],t,u);h=g[0],f=g[1],p=g[2]}else if(t==="same"){h=Math.ceil(e/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const m=(h-1)*r+a-e,g=(f-1)*i+l-n,y=(p-1)*o+c-s,x=Math.floor(m/2),w=m-x,b=Math.floor(g/2),S=g-b,T=Math.floor(y/2),I=y-T;d={top:b,bottom:S,left:T,right:I,front:x,back:w,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function wf(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function da(t){const[e,n,s]=xf(t);return e===1&&n===1&&s===1}function Mn(t,e){return da(t)||da(e)}function Tl(t){return xf(t).every(e=>e>0)}function So(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function as(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")E(vl(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{E(vl(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KQ(t,e){const s={x:R(t,"x","reshape","string_or_numeric")},r={shape:e};return P.runKernel(Fp,s,r)}const V=L({reshape_:KQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(t,e,n,s,r){const i=R(t,"x","avgPool","float32"),o=1;E(Mn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),as("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=P.runKernel(Yf,c,u);return d=me(d,i.dtype),l?V(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Qp=L({avgPool_:XQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YQ(t,e,n,s,r,i="NDHWC"){const o=R(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),E(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),E(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),E(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),as("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let d=P.runKernel(Jf,c,u);return d=me(d,a.dtype),l?V(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const xN=L({avgPool3d_:YQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQ(t,e=0){E(t.length>=1,()=>"Pass at least one tensor to concat");const n=gf(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Ei(n[0]);const s=n,r={axis:e};return P.runKernel(np,s,r)}const Kt=L({concat_:JQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(t,e,n=!1,s=!1){let r=R(t,"a","matMul"),i=R(e,"b","matMul");[r,i]=Ot(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return P.runKernel(Qf,o,a)}const Be=L({matMul_:QQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(t){const n={x:R(t,"x","sigmoid","float32")};return P.runKernel(dd,n)}const Jr=L({sigmoid_:ZQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eZ(t,e,n){const s=R(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return P.runKernel(zp,r,i)}const Ge=L({slice_:eZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tZ(t){const n={x:R(t,"x","tanh","float32")};return P.runKernel(yd,n)}const ha=L({tanh_:tZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nZ(t,e,n,s,r,i){const o=R(t,"forgetBias","basicLSTMCell"),a=R(e,"lstmKernel","basicLSTMCell"),l=R(n,"lstmBias","basicLSTMCell"),c=R(s,"data","basicLSTMCell"),u=R(r,"c","basicLSTMCell"),d=R(i,"h","basicLSTMCell"),h=Kt([c,d],1),f=Be(h,a),p=ue(f,l),m=p.shape[0],g=p.shape[1]/4,y=[m,g],x=Ge(p,[0,0],y),w=Ge(p,[0,g],y),b=Ge(p,[0,g*2],y),S=Ge(p,[0,g*3],y),T=ue(B(Jr(x),ha(w)),B(u,Jr(ue(o,b)))),I=B(ha(T),Jr(S));return[T,I]}const Y3=L({basicLSTMCell_:nZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sZ(t,e,n){const s=R(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);E(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),E(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),E(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return P.runKernel(Zf,i,o)}const Zp=L({batchToSpaceND_:sZ});function rZ(t){let e;return t.rank===0||t.rank===1?e=V(t,[1,1,1,t.size]):t.rank===2?e=V(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iZ(t,e,n,s,r,i){i==null&&(i=.001);const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;r!=null&&(c=R(r,"scale","batchNorm"));let u;s!=null&&(u=R(s,"offset","batchNorm")),E(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:rZ(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=P.runKernel(dp,h,f);return V(p,o.shape)}const bd=L({batchNorm_:iZ});function oZ(t,e,n,s,r,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;r!=null&&(c=R(r,"scale","batchNorm"));let u;return s!=null&&(u=R(s,"offset","batchNorm")),E(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),E(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),E(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&E(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&E(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),bd(o,a,l,u,c,i)}const wN=L({batchNorm2d_:oZ});function aZ(t,e,n,s,r,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;r!=null&&(c=R(r,"scale","batchNorm"));let u;return s!=null&&(u=R(s,"offset","batchNorm")),E(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),E(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),E(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&E(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&E(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),bd(o,a,l,u,c,i)}const bN=L({batchNorm3d_:aZ});function lZ(t,e,n,s,r,i){const o=R(t,"x","batchNorm"),a=R(e,"mean","batchNorm"),l=R(n,"variance","batchNorm");let c;r!=null&&(c=R(r,"scale","batchNorm"));let u;return s!=null&&(u=R(s,"offset","batchNorm")),E(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),E(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),E(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&E(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&E(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),bd(o,a,l,u,c,i)}const vN=L({batchNorm4d_:lZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cZ(t,e,n){const s=R(t,"x","bincount"),r=R(e,"weights","bincount");E(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),E(n>=0,()=>`size must be non-negative, but got ${n}.`),E(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return P.runKernel(Q0,i,o)}const SN=L({bincount_:cZ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uZ(t,e){const n=R(t,"x","bitwiseAnd"),s=R(e,"y","bitwiseAnd");if(!Ue(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return P.runKernel(ep,r)}const J3=L({bitwiseAnd_:uZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dZ(t,e){const n=R(t,"s0","broadcastArgs","int32"),s=R(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return P.runKernel(Z0,r)}const Q3=L({broadcastArgs_:dZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hZ(t,e){let n=R(t,"broadcastTo","x");const s=n.shape;if(Us(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=V(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Ei(n);const a={x:n},l={reps:i};return P.runKernel(xd,a,l)}const dl=L({broadcastTo_:hZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZ(t){const n={x:R(t,"x","ceil","float32")};return P.runKernel(Du,n)}const kN=L({ceil_:fZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kl(t,e,n){Us(t),n=n||Wl(e);const s={shape:t,value:e,dtype:n};return P.runKernel(mx,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pZ(t,e,n){const s=R(t,"x","clipByValue");if(E(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Kl(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return P.runKernel(Ou,r,i)}const xs=L({clipByValue_:pZ});function mZ(t){return Kt(t,0)}const CN=L({concat1d_:mZ});function gZ(t,e){return Kt(t,e)}const NN=L({concat2d_:gZ});function yZ(t,e){return Kt(t,e)}const TN=L({concat3d_:yZ});function xZ(t,e){return Kt(t,e)}const IN=L({concat4d_:xZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wZ(t,e,n,s,r="NHWC",i=[1,1],o){const a=R(t,"x","conv2d","float32"),l=R(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),E(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),as("conv2d",s,o);const d=r==="NHWC"?c.shape[3]:c.shape[1];E(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),E(Mn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),E(Tl(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),E(Tl(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=P.runKernel(sp,h,f);return u?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const ho=L({conv2d_:wZ});function bZ(t,e,n,s,r="NWC",i=1,o){const a=R(t,"x","conv1d"),l=R(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=V(a,[1,a.shape[0],a.shape[1]])),E(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),E(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),as("conv1d",s,o),E(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),E(Mn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),E(Tl(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),E(Tl(n),()=>"Error in conv1D: Stride should be larger than 0."),E(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=V(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=V(c,[c.shape[0],1,c.shape[1],c.shape[2]]),g=ho(h,d,[1,n],s,"NHWC",[1,i],o);return u?V(g,[g.shape[2],g.shape[3]]):V(g,[g.shape[0],g.shape[2],g.shape[3]])}const rw=L({conv1d_:bZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZ(t,e,n,s,r,i="NHWC",o){E(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),E(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),E(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),E(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];E(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),E(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),as("conv2dDerInput",r,o);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=P.runKernel(rp,h,f);return c?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const $N=L({conv2DBackpropInput_:vZ});function SZ(t,e,n,s,r,i){const o=R(t,"x","conv2dTranspose"),a=R(e,"filter","conv2dTranspose");return $N(n,o,a,s,r,"NHWC",i)}const iw=L({conv2dTranspose_:SZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kZ(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=R(t,"x","conv3d"),a=R(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),E(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),E(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),E(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),E(Mn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),E(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),E(Tl(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),E(Tl(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:i},h=P.runKernel(ip,u,d);return c?V(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const EN=L({conv3d_:kZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CZ(t,e,n,s,r){E(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=V(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];E(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),E(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),E(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),E(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),E(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},d={pad:r,strides:s,inputShape:i},h=P.runKernel(sx,u,d);return a?V(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Z3=L({conv3DBackpropInput_:CZ});function NZ(t,e,n,s,r){const i=R(t,"x","conv3dTranspose"),o=R(e,"filter","conv3dTranspose");return Z3(n,i,o,s,r)}const RN=L({conv3dTranspose_:NZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TZ(t){const n={x:R(t,"x","cos","float32")};return P.runKernel(Fu,n)}const em=L({cos_:TZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IZ(t){const n={x:R(t,"x","cosh","float32")};return P.runKernel(Pu,n)}const ow=L({cosh_:IZ});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Z(t,e=0,n=!1,s=!1){const i={x:R(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return P.runKernel(rx,i,o)}const bf=L({cumprod_:$Z});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(t,e=0,n=!1,s=!1){const i={x:R(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return P.runKernel(op,i,o)}const aw=L({cumsum_:EZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RZ(t,e,n,s=!1){const r=R(t,"x","denseBincount"),i=R(e,"weights","denseBincount");E(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),E(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),E(n>=0,()=>`size must be non-negative, but got ${n}.`),E(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return P.runKernel(ox,o,a)}const Ky=L({denseBincount_:RZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(t,e,n="NHWC"){const s=R(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];E(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),E(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),E(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),E(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return P.runKernel(ax,a,l)}const AN=L({depthToSpace_:AZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Z(t,e,n,s,r="NHWC",i=[1,1],o){const a=R(t,"x","depthwiseConv2d","float32"),l=R(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),E(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];E(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),as("depthwiseConv2d",s,o);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=P.runKernel(ap,h,f);return u?V(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const vd=L({depthwiseConv2d_:_Z});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(t){const n={x:R(t,"x","diag")};return P.runKernel(ux,n)}const eM=L({diag_:DZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OZ(t,e,n,s,r=[1,1],i="NHWC"){const o=R(t,"x","dilation2d"),a=R(e,"filter","dilation2d");E(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),E(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),E(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=V(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),E(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=P.runKernel(lp,u,d);return c?V(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const _N=L({dilation2d_:OZ});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function on(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function Fe(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=i}return s}const FZ=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Fe,getBroadcastDims:Il,getReductionAxes:on},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZ(t,e){let n=R(t,"a","equal","string_or_numeric"),s=R(e,"b","equal","string_or_numeric");[n,s]=Ot(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(cp,r)}const Bs=L({equal_:PZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LZ(t,e,n){const s=R(e,"a","where"),r=R(n,"b","where"),i=R(t,"condition","where","bool"),o=Fe(Fe(i.shape,s.shape),r.shape),a=dl(i,o),l=dl(s,o),c=dl(r,o),u={condition:a,t:l,e:c};return P.runKernel(Bp,u)}const Sn=L({where_:LZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(t){const n={x:R(t,"x","zerosLike")};return P.runKernel(Kp,n)}const He=L({zerosLike_:MZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BZ(t,e){let n=R(t,"a","div"),s=R(e,"b","div");[n,s]=Ot(n,s);const r=Te(n,s),i=He(r),o=Bs(s,i);return Sn(o,i,r)}const DN=L({divNoNan_:BZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zZ(t,e){const n=R(t,"t1","dot"),s=R(e,"t2","dot");E((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(E(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=V(n,[1,-1]),a=V(s,[-1,1]),l=Be(o,a);return V(l,[])}else if(n.rank===1&&s.rank===2){const o=V(n,[1,-1]),a=V(s,[s.shape[0],s.shape[1]]),l=Be(o,a);return V(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=V(s,[-1,1]),a=Be(n,o);return V(a,[a.size])}else{const o=V(s,[s.shape[0],s.shape[1]]);return Be(n,o)}}const ON=L({dot_:zZ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(t,...e){const n=e.map((r,i)=>R(r,`tensors${i}`,"einsum")),s={equation:t};return P.runKernel(hx,n,s)}const Ga=L({einsum_:VZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jZ(t){const n={x:R(t,"x","elu","float32")};return P.runKernel(Mu,n)}const Sd=L({elu_:jZ});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UZ(t,e){const n=R(t,"x","ensureShape","string_or_numeric");if(!i3(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const tM=L({ensureShape_:UZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WZ(t){let e=R(t,"x","erf");E(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=me(e,"float32"));const n={x:e};return P.runKernel(Bu,n)}const lw=L({erf_:WZ});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FN(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function nM(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function In(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function Xt(t,e){const n=e.map(s=>1);return nM(t,n,e)}function Bn(t,e,n){E(FN(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Ft(t,e){if(FN(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function Ea(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Yt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GZ(t,e=null,n=!1){const r={x:R(t,"x","max")},i={reductionIndices:e,keepDims:n};return P.runKernel(vp,r,i)}const rr=L({max_:GZ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HZ(t,e=null,n=!1){const r={x:R(t,"x","min")},i={axis:e,keepDims:n};return P.runKernel(Np,r,i)}const tu=L({min_:HZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(t,e){let n=R(t,"base","pow"),s=R(e,"exp","pow");[n,s]=Ot(n,s);const r={a:n,b:s};return P.runKernel(td,r)}const Pi=L({pow_:qZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(t,e){if((ln(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&ln(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ia(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KZ(t){const n={x:R(t,"x","sqrt","float32")};return P.runKernel(fd,n)}const Cn=L({sqrt_:KZ});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XZ(t){const e=R(t,"x","square"),n={};return P.runKernel("Square",{x:e},n)}const at=L({square_:XZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YZ(t,e=null,n=!1){let s=R(t,"x","sum");s.dtype==="bool"&&(s=me(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return P.runKernel(Vp,r,i)}const ke=L({sum_:YZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JZ(t,e="euclidean",n=null,s=!1){t=R(t,"x","norm");const r=sM(t,e,n);let i=r.shape;if(s){const o=ze(n,t.shape);i=Xt(r.shape,o)}return V(r,i)}function sM(t,e,n=null){if(t.rank===0)return en(t);if(t.rank!==1&&n===null)return sM(V(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return ke(en(t),n);if(e===1/0)return rr(en(t),n);if(e===-1/0)return tu(en(t),n);if(e==="euclidean"||e===2)return Cn(ke(Pi(en(t),Ee(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return rr(ke(en(t),n[0]),n[1]-1);if(e===1/0)return rr(ke(en(t),n[1]),n[0]);if(e===-1/0)return tu(ke(en(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Cn(ke(at(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const kd=L({norm_:JZ});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QZ(t,e=null,n=!1){return kd(t,"euclidean",e,n)}const PN=L({euclideanNorm_:QZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZZ(t){const n={x:R(t,"x","exp")};return P.runKernel(zu,n)}const ws=L({exp_:ZZ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(t,e=0){const n=R(t,"x","expandDims","string_or_numeric");E(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return P.runKernel(up,s,r)}const An=L({expandDims_:eee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tee(t){const n={x:R(t,"x","expm1")};return P.runKernel(Vu,n)}const LN=L({expm1_:tee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(t,e){const n=R(t,"x","tile","string_or_numeric");E(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return P.runKernel(xd,s,r)}const Qs=L({tile_:nee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function see(t,e,n,s="float32"){e==null&&(e=t);const r=Le([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=V(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Qs(An(o,0),[n[0],1,1]);if(n.length===2)return Qs(An(An(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Qs(An(An(An(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const cw=L({eye_:see});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(t){const n={x:R(t,"x","floor","float32")};return P.runKernel(ju,n)}const Cd=L({floor_:ree});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iee(t,e,n=0,s=0){const r=R(t,"x","gather"),i=R(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return P.runKernel(hp,o,a)}const Nd=L({gather_:iee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(t,e){let n=R(t,"a","greater","string_or_numeric"),s=R(e,"b","greater","string_or_numeric");[n,s]=Ot(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(fp,r)}const ls=L({greater_:oee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(t,e){let n=R(t,"a","greaterEqual","string_or_numeric"),s=R(e,"b","greaterEqual","string_or_numeric");[n,s]=Ot(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(Wu,r)}const ko=L({greaterEqual_:aee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(t){const n={input:R(t,"input","imag")};return P.runKernel(wx,n)}const tm=L({imag_:lee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cee(t){const n={x:R(t,"x","isFinite")};return P.runKernel(Hu,n)}const MN=L({isFinite_:cee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(t){const n={x:R(t,"x","isInf")};return P.runKernel(qu,n)}const BN=L({isInf_:uee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(t){const n={x:R(t,"x","isNaN")};return P.runKernel(Ku,n)}const zN=L({isNaN_:dee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hee(t,e=.2){const s={x:R(t,"x","leakyRelu")},r={alpha:e};return P.runKernel(pp,s,r)}const nm=L({leakyRelu_:hee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fee(t,e){let n=R(t,"a","less","string_or_numeric"),s=R(e,"b","less","string_or_numeric");[n,s]=Ot(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(mp,r)}const nu=L({less_:fee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(t,e){let n=R(t,"a","lessEqual","string_or_numeric"),s=R(e,"b","lessEqual","string_or_numeric");[n,s]=Ot(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(gp,r)}const Ra=L({lessEqual_:pee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rM(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return P.runKernel(bx,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(t,e=5,n=1,s=1,r=.5){const i=R(t,"x","localResponseNormalization");E(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),E(vl(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=V(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=P.runKernel(bp,l,c);return a?V(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const VN=L({localResponseNormalization_:mee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(t){const n={x:R(t,"x","log","float32")};return P.runKernel(Xu,n)}const zs=L({log_:gee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t){const n={x:R(t,"x","log1p")};return P.runKernel(Yu,n)}const sm=L({log1p_:yee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t){return E(ca(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=R(e,"x","tf.grad","string_or_numeric"),r=n!=null?R(n,"dy","tf.grad"):null;return P.tidy(()=>{const{value:i,grads:o}=P.gradients(()=>t(s),[s],r);return r!=null&&Ln(i.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),uw(o),o[0]})}}function wee(t){return E(ca(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{E(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=gf(e,"args","tf.grads","string_or_numeric"),r=n!=null?R(n,"dy","tf.grads"):null;return P.tidy(()=>{const{value:i,grads:o}=P.gradients(()=>t(...s),s,r);return r!=null&&Ln(i.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),uw(o),o})}}function bee(t){return E(ca(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{E(e instanceof Xe,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),E(n==null||n instanceof Xe,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=P.gradients(()=>t(e),[e],n);return uw(s),{grad:s[0],value:r}}}function vee(t){return E(ca(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{E(Array.isArray(e)&&e.every(r=>r instanceof Xe),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),E(n==null||n instanceof Xe,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=P.gradients(()=>t(...e),e,n);return n!=null&&Ln(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),uw(s.grads),s}}function iM(t,e){E(ca(t),()=>"The f passed in variableGrads(f) must be a function"),E(e==null||Array.isArray(e)&&e.every(c=>c instanceof mf),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in P.registeredVariables)e.push(P.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),E(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=P.gradients(t,e,null,i);E(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),E(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function Li(t){return P.customGrad(t)}function uw(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t){const n={x:R(t,"x","neg")};return P.runKernel(Ip,n)}const mt=L({neg_:See});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(t){const n={x:R(t,"x","softplus")};return P.runKernel(hd,n)}const Xl=L({softplus_:kee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t){const e=R(t,"x","logSigmoid");return Li(s=>({value:mt(Xl(mt(s))),gradFunc:o=>B(o,Jr(mt(s)))}))(e)}const jN=L({logSigmoid_:Cee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nee(t,e){let n=R(t,"a","sub"),s=R(e,"b","sub");[n,s]=Ot(n,s);const r={a:n,b:s};return P.runKernel(md,r)}const Se=L({sub_:Nee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(t,e=-1){const n=R(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Li((r,i)=>{const a=rr(r,e,!0),l=Se(r,a),c=Se(me(l,"float32"),zs(ke(ws(l),e,!0)));return i([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=ws(f);return Se(d,B(ke(d,e,p),m))}}})(n)}const dw=L({logSoftmax_:Tee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iee(t,e=null,n=!1){const s=R(t,"x","logSumExp"),r=ze(e,s.shape),i=rr(s,r,!0),o=Se(s,i),a=ws(o),l=ke(a,r),c=zs(l),u=ue(V(i,c.shape),c);if(n){const d=Xt(u.shape,r);return V(u,d)}return u}const rm=L({logSumExp_:Iee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(t,e){const n=R(t,"a","logicalAnd","bool"),s=R(e,"b","logicalAnd","bool");Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(yp,r)}const Er=L({logicalAnd_:$ee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eee(t){const n={x:R(t,"x","logicalNot","bool")};return P.runKernel(xp,n)}const im=L({logicalNot_:Eee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ree(t,e){const n=R(t,"a","logicalOr","bool"),s=R(e,"b","logicalOr","bool");Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(wp,r)}const hw=L({logicalOr_:Ree});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t,e){const n=R(t,"a","logicalXor","bool"),s=R(e,"b","logicalXor","bool");return Fe(n.shape,s.shape),Er(hw(t,e),im(Er(t,e)))}const UN=L({logicalXor_:Aee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lg=2147483648;function _ee(t,e,n="left"){const s=R(t,"sortedSequence","searchSorted"),r=R(e,"values","searchSorted"),i=s.shape[s.shape.length-1],o=r.shape[r.shape.length-1],a=V(s,[-1,i]),l=V(r,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(se(l.shape)>=lg)throw new Error(`values tensor size must less than ${lg}`);if(a.shape[1]>=lg)throw new Error(`trailing dim_size must less than ${lg} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:l},u={side:n};return P.runKernel(Mx,c,u)}const fw=L({searchSorted_:_ee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oM(t,e){return fw(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dee(t,e,n,s,r){const i=R(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),E(Mn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),as("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=P.runKernel(Sp,c,u);return l?V(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const om=L({maxPool_:Dee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oee(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=R(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),E(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),E(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),as("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},d=P.runKernel(kp,c,u);return l?V(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const WN=L({maxPool3d_:Oee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t,e,n,s,r=!1){const o={x:R(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:s,includeBatchInIndex:r},l=P.runKernel(Cx,o,a);return{result:l[0],indexes:l[1]}}const aM=L({maxPoolWithArgmax_:Fee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t,e){let n=R(t,"a","maximum"),s=R(e,"b","maximum");[n,s]=Ot(n,s),n.dtype==="bool"&&(n=me(n,"int32"),s=me(s,"int32")),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(Ju,r)}const Bi=L({maximum_:Pee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lee(t,e=null,n=!1){const r={x:R(t,"x","mean")},i={axis:e,keepDims:n};return P.runKernel(Cp,r,i)}const At=L({mean_:Lee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t,e="float32"){if(Us(t),e==="complex64"){const s=Ht(t,"float32"),r=Ht(t,"float32");return uo(s,r)}const n=Pn(se(t),e);return P.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fs(t,e="float32"){if(Us(t),e==="complex64"){const s=fs(t,"float32"),r=Ht(t,"float32");return uo(s,r)}const n=q0(se(t),e);return P.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lM(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=R(t,"x","meshgrid",t instanceof Xe?t.dtype:"float32");if(e===void 0)return[s];let r=R(e,"y","meshgrid",e instanceof Xe?e.dtype:"float32");const i=se(s.shape),o=se(r.shape);return n==="xy"?(s=V(s,[1,-1]),r=V(r,[-1,1]),[Be(fs([o,1],s.dtype),s),Be(r,fs([1,i],r.dtype))]):(s=V(s,[-1,1]),r=V(r,[1,-1]),[Be(s,fs([1,o],s.dtype)),Be(fs([i,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(t,e){let n=R(t,"a","minimum"),s=R(e,"b","minimum");[n,s]=Ot(n,s),n.dtype==="bool"&&(n=me(n,"int32"),s=me(s,"int32")),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel(Qu,r)}const fa=L({minimum_:Mee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(t,e,n){E(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=R(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");E(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)E(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),E(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return P.runKernel(Tp,o,i)}const GN=L({mirrorPad_:Bee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zee(t,e){let n=R(t,"a","mod"),s=R(e,"b","mod");[n,s]=Ot(n,s);const r={a:n,b:s};return P.runKernel(Zu,r)}const HN=L({mod_:zee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vee(t,e=null,n=!1){t=R(t,"x","moments");const s=ze(e,t.shape),r=At(t,s,n);let i=r.shape;n||(i=Xt(r.shape,s));const o=at(Se(me(t,"float32"),V(r,i))),a=At(o,s,n);return{mean:r,variance:a}}const am=L({moments_:Vee});function jee(t,e,n,s){const r=R(e,"data","multiRNNCell"),i=gf(n,"c","multiRNNCell"),o=gf(s,"h","multiRNNCell");let a=r;const l=[];for(let d=0;d<t.length;d++){const h=t[d](a,i[d],o[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}const cM=L({multiRNNCell_:jee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(t,e,n,s=!1){const r=R(t,"logits","multinomial"),i=r.size,o=r.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?V(r,[1,-1]):r},c={numSamples:e,seed:n,normalized:s},u=P.runKernel(Nx,l,c);return o===1?V(u,[u.size]):u}const uM=L({multinomial_:Uee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t,e){let n=R(t,"a","notEqual","string_or_numeric"),s=R(e,"b","notEqual","string_or_numeric");[n,s]=Ot(n,s),Fe(n.shape,s.shape);const r={a:n,b:s};return P.runKernel($p,r)}const $l=L({notEqual_:Wee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:R(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return P.runKernel(Rp,o,a)}const su=L({oneHot_:Gee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t){const n={x:R(t,"x","onesLike")};return P.runKernel(Ep,n)}const Vs=L({onesLike_:Hee});function qee(t,e){const n=R(t,"v1","outerProduct"),s=R(e,"v2","outerProduct");E(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=V(n,[-1,1]),i=V(s,[1,-1]);return Be(r,i)}const dM=L({outerProduct_:qee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kee(t,e,n=0){const s=R(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return P.runKernel(_p,i,r)}const Co=L({pad_:Kee});function Xee(t,e,n=0){return E(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Co(t,[e],n)}const hM=L({pad1d_:Xee});function Yee(t,e,n=0){return E(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Co(t,e,n)}const fM=L({pad2d_:Yee});function Jee(t,e,n=0){return E(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Co(t,e,n)}const pM=L({pad3d_:Jee});function Qee(t,e,n=0){return E(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Co(t,e,n)}const mM=L({pad4d_:Qee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e,n){const s=R(t,"x","spaceToBatchND");E(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),E(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),E(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return P.runKernel(jp,r,i)}const lm=L({spaceToBatchND_:Zee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=R(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),E(Mn(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=Rr(l.shape,e,i,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=nte([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=tte([u.inHeight,u.inWidth],d,h),g=f?s:"valid",y=f?l:lm(l,d,p),w=(n==="avg"?()=>Qp(y,e,i,g,o):()=>om(y,e,i,g,o))(),b=f?w:Zp(w,d,m);return c?V(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function tte(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,d)=>(u-i[d]%u)%u),a=r.map((u,d)=>u+o[d]),l=e.map((u,d)=>[s[d],a[d]]),c=e.map((u,d)=>[0,o[d]]);return[l,c]}function nte(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const qN=L({pool_:ete});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ste(t,e){const n=R(t,"x","prelu"),s=R(e,"alpha","prelu"),r={x:n,alpha:s};return P.runKernel(Dp,r)}const cm=L({prelu_:ste});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rte(t,e=null,n=!1){let s=R(t,"x","prod");s.dtype==="bool"&&(s=me(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return P.runKernel(Op,r,i)}const KN=L({prod_:rte});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ite(t,e,n,s){const r=t.map((u,d)=>R(u,`tensors${d}`,"raggedGather","int32")),i=R(e,"paramsDenseValues","raggedGather"),o=R(n,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:i,indices:o},l={outputRaggedRank:s},c=P.runKernel(Ex,a,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const gM=L({raggedGather_:ite});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(t,e,n){const s=R(t,"starts","raggedRange"),r=R(e,"limits","raggedRange",s.dtype),i=R(n,"deltas","raggedRange",s.dtype),o={starts:s,limits:r,deltas:i},a=P.runKernel(Rx,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const yM=L({raggedRange_:ote});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(t,e,n,s,r){const i=R(t,"shape","raggedTensorToTensor","int32"),o=R(e,"values","raggedTensorToTensor"),a=R(n,"defaultValue","raggedTensorToTensor",o.dtype),l=s.map((d,h)=>R(d,`tensors${h}`,"raggedTensorToTensor","int32")),c={shape:i,values:o,defaultValue:a,rowPartitionTensors:l},u={rowPartitionTypes:r};return P.runKernel(Ax,c,u)}const xM=L({raggedTensorToTensor_:ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(t,e,n){Us(t);const s=se(t);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<s;i++)r[i]=e();return P.makeTensor(r,t,n)}const wM=L({rand_:lte});var XN={exports:{}};XN.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(Bl,t)})(XN);var cte=XN.exports,YN={exports:{}};YN.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(Bl,t)})(YN);var ute=YN.exports,JN={exports:{}};JN.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(Bl,t)})(JN);var dte=JN.exports,QN={exports:{}};QN.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(Bl,t)})(QN);var hte=QN.exports,ZN={exports:{}};ZN.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,g,y=[],x=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,x=Math.max(x,d.length)),p=0,m=-32;m<x;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,h=y[m&127]^=f+g,p=h==0?p+1:0);for(p>=128&&(y[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=y[p+34&127],h=y[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,y[p]=f^h;u.w=g,u.X=y,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(Bl,t)})(ZN);var fte=ZN.exports,e2={exports:{}};e2.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(Bl,t)})(e2);var pte=e2.exports,bM={exports:{}};const mte={},gte=Object.freeze(Object.defineProperty({__proto__:null,default:mte},Symbol.toStringTag,{value:"Module"})),yte=SU(gte);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,d=r-1,h;function f(b,S,T){var I=[];S=S==!0?{entropy:!0}:S||{};var $=y(g(S.entropy?[b,w(n)]:b??x(),3),I),_=new p(I),D=function(){for(var z=_.g(i),H=l,X=0;z<c;)z=(z+X)*r,H*=r,X=_.g(1);for(;z>=u;)z/=2,H/=2,X>>>=1;return(z+X)/H};return D.int32=function(){return _.g(4)|0},D.quick=function(){return _.g(4)/4294967296},D.double=D,y(w(_.S),n),(S.pass||T||function(z,H,X,Y){return Y&&(Y.S&&m(Y,_),z.state=function(){return m(_,{})}),X?(s[a]=z,H):z})(D,$,"global"in S?S.global:this==s,S.state)}function p(b){var S,T=b.length,I=this,$=0,_=I.i=I.j=0,D=I.S=[];for(T||(b=[T++]);$<r;)D[$]=$++;for($=0;$<r;$++)D[$]=D[_=d&_+b[$%T]+(S=D[$])],D[_]=S;(I.g=function(z){for(var H,X=0,Y=I.i,J=I.j,Q=I.S;z--;)H=Q[Y=d&Y+1],X=X*r+Q[d&(Q[Y]=Q[J=d&J+H])+(Q[J]=H)];return I.i=Y,I.j=J,X})(r)}function m(b,S){return S.i=b.i,S.j=b.j,S.S=b.S.slice(),S}function g(b,S){var T=[],I=typeof b,$;if(S&&I=="object")for($ in b)try{T.push(g(b[$],S-1))}catch{}return T.length?T:I=="string"?b:b+"\0"}function y(b,S){for(var T=b+"",I,$=0;$<T.length;)S[d&$]=d&(I^=S[d&$]*19)+T.charCodeAt($++);return w(S)}function x(){try{var b;return h&&(b=h.randomBytes)?b=b(r):(b=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(b)),w(b)}catch{var S=e.navigator,T=S&&S.plugins;return[+new Date,e,T,e.screen,w(n)]}}function w(b){return String.fromCharCode.apply(0,b)}if(y(s.random(),n),t.exports){t.exports=f;try{h=yte}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:Bl,[],Math)})(bM);var xte=bM.exports,wte=cte,bte=ute,vte=dte,Ste=hte,kte=fte,Cte=pte,Yl=xte;Yl.alea=wte;Yl.xor128=bte;Yl.xorwow=vte;Yl.xorshift7=Ste;Yl.xor4096=kte;Yl.tychei=Cte;var Td=Yl;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nte=.001,vM=.1;function Tte(t,e,n){return n==null&&(n=t2()),wS(t,e,(s,r)=>n2(s,r,n))}function t2(){return P.backend.floatPrecision()===32?Nte:vM}function wS(t,e,n){let s=!0;if((ln(t)||ln(e))&&(s=!1),ln(t)&&ln(e)&&(s=!0),s){const o=t.constructor.name,a=e.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(t)&&Array.isArray(e)){const o=Fi(t),a=Fi(e);if(!Ue(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const r=ln(t)?t:Oi(t),i=ln(e)?e:Oi(e);if(r.length!==i.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${i.length}.
Actual:   ${r}.
Expected: ${i}.`);for(let o=0;o<i.length;++o){const a=r[o],l=i[o];if(!n(a,l))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${l}.
Actual:   ${r}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function Ite(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function $te(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return vi(t)||vi(t[0])||vi(e)||vi(e[0])?wS(t,n,(s,r)=>s==r):wS(t,e,(s,r)=>n2(s,r,0))}function Ete(t,e,n){if(n==null&&(n=t2()),!n2(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function n2(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Rte(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function Ate(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let r=0;r<s.length;r++)if(n[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${n[r]} instead`)}function SM(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?SM(n):t[e]=$i(n)}return t}function _te(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function Dte(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const Ote=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:vM,createVideoElement:_te,encodeStrings:SM,expectArrayBuffersEqual:Ate,expectArraysClose:Tte,expectArraysEqual:$te,expectNumbersClose:Ete,expectPromiseToFail:Ite,expectValuesInRange:Rte,play:Dte,testEpsilon:t2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s2{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=Td.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Fte{constructor(e,n,s,r){this.alpha=e,this.beta=1/n,this.dtype=s;const i=r||Math.random();this.randu=Td.alea(i.toString()),this.randn=new s2(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,r,i,o;for(;;){do r=this.randn.nextValue(),o=1+this.c*r;while(o<=0);if(o*=o*o,e=r*r,n=1-.331*e*e,s=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Pte{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Td.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t,e,n=1,s="float32",r){if(Us(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const i=new Fte(e,n,s,r),o=Le(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const kM=L({randomGamma_:Lte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t,e=0,n=1,s,r){if(Us(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new s2(e,n,s,!1,r),o=Le(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const pw=L({randomNormal_:Mte});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return pw(t,0,1,e,n)}const CM=L({randomStandardNormal_:Bte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t,e=0,n=1,s="float32",r){Us(t);const i=Le(t,s),o=new Pte(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Aa=L({randomUniform_:zte});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t,e,n,s){return Aa(t,e,n,"int32",s)}const NM=L({randomUniformInt_:Vte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function El(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return P.runKernel(_x,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t){const n={input:R(t,"input","real")};return P.runKernel(Dx,n)}const ru=L({real_:jte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(t){const n={x:R(t,"x","reciprocal")};return P.runKernel(nd,n)}const r2=L({reciprocal_:Ute});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wte(t){const n={x:R(t,"x","relu")};return P.runKernel(sd,n)}const li=L({relu_:Wte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(t){const n={x:R(t,"x","relu6")};return P.runKernel(rd,n)}const mw=L({relu6_:Gte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t,e){const s={x:R(t,"x","reverse")},r={dims:e};return P.runKernel(Mp,s,r)}const or=L({reverse_:Hte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qte(t){const e=R(t,"x","reverse");return E(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),or(e,0)}const TM=L({reverse1d_:qte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(t,e){const n=R(t,"x","reverse");return E(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),or(n,e)}const IM=L({reverse2d_:Kte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(t,e){const n=R(t,"x","reverse");return E(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),or(n,e)}const $M=L({reverse3d_:Xte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t,e){const n=R(t,"x","reverse");return E(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),or(n,e)}const EM=L({reverse4d_:Yte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jte(t){const n={x:R(t,"x","round")};return P.runKernel(id,n)}const gw=L({round_:Jte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qte(t){const n={x:R(t,"x","rsqrt","float32")};return P.runKernel(od,n)}const yw=L({rsqrt_:Qte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t){const n={x:R(t,"x","selu")};return P.runKernel(ad,n)}const xw=L({selu_:Zte});function ene(t,e,n,s,r,i=[1,1],o="NHWC"){const a=R(t,"x","separableConv2d"),l=R(e,"depthwiseFilter","separableConv2d"),c=R(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");E(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),E(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),E(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),E(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),E(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];E(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=vd(u,l,s,r,o,i),g=ho(p,c,1,"valid",o);return d?V(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const ww=L({separableConv2d_:ene});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function tne(t,e){const n=R(t,"x","setdiff1d"),s=R(e,"y","setdiff1d");E(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),E(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),E(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),i=await s.data(),o=new Set(i);let a=0;for(let u=0;u<r.length;u++)o.has(r[u])||a++;const l=new rn([a],n.dtype),c=new rn([a],"int32");for(let u=0,d=0;u<r.length;u++)o.has(r[u])||(l.values[d]=r[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}const RM=tne;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t){const n={x:R(t,"x","sign")};return P.runKernel(ud,n)}const i2=L({sign_:nne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sne(t){const n={x:R(t,"x","sin","float32")};return P.runKernel(ld,n)}const bw=L({sin_:sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t){const n={x:R(t,"x","sinh")};return P.runKernel(cd,n)}const vw=L({sinh_:rne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t,e,n){const s=R(t,"x","slice1d");return E(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Ge(s,[e],[n])}const um=L({slice1d_:ine});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t,e,n){const s=R(t,"x","slice2d");return E(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Ge(s,e,n)}const Sw=L({slice2d_:one});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t,e,n){const s=R(t,"x","slice3d");return E(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Ge(s,e,n)}const dm=L({slice3d_:ane});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t,e,n){const s=R(t,"x","slice4d");return E(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Ge(s,e,n)}const iu=L({slice4d_:lne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t,e=-1){const n=R(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return P.runKernel(Wp,s,r)}const hm=L({softmax_:cne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(t){E(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return P.runKernel(px,e)}const fm=L({fft_:une});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t){E(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return P.runKernel(xx,e)}const ou=L({ifft_:dne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=V(t,[n,e]);s=ou(r)}else{const r=[n,2*(e-1)],i=V(ru(t),[n,e]),o=V(tm(t),[n,e]),a=or(Ge(i,[0,1],[n,e-2]),1),l=B(or(Ge(o,[0,1],[n,e-2]),1),Ee(-1)),c=Kt([i,a],1),u=Kt([o,l],1),d=V(uo(c,u),[r[0],r[1]]);s=ou(d)}if(s=ru(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=V(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const kw=L({irfft_:hne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t,e,n=0){const r={x:R(t,"x","split")},i={numOrSizeSplits:e,axis:n};return P.runKernel(Up,r,i)}const ms=L({split_:fne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(t,e){E(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=e,r=Ge(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,r=Kt([t,Ht(p)],t.shape.length-1),n=e}else r=t;const i=He(r),o=V(uo(r,i),[s,n]),a=fm(o),l=Math.floor(n/2)+1,c=ru(a),u=tm(a),d=ms(c,[l,n-l],c.shape.length-1),h=ms(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,V(uo(d[0],h[0]),f)}const pm=L({rfft_:pne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t,e){let n=R(t,"a","squaredDifference"),s=R(e,"b","squaredDifference");[n,s]=Ot(n,s),Fe(n.shape,s.shape);const r={a:n,b:s},i={};return P.runKernel(pd,r,i)}const Cw=L({squaredDifference_:mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(t,e){const n=R(t,"x","squeeze","string_or_numeric");return V(n,wo(n.shape,e).newShape)}const _a=L({squeeze_:gne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yne(t,e=0){const n=gf(t,"tensors","stack","string_or_numeric");E(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&E(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return P.runKernel(Ap,s,r)}const is=L({stack_:yne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t,e=0){const s={x:R(t,"x","step")},r={alpha:e};return P.runKernel(wd,s,r)}const Jl=L({step_:xne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:R(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return P.runKernel(Gx,u,d)}const o2=L({stridedSlice_:wne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(t){const n={x:R(t,"x","tan","float32")};return P.runKernel(gd,n)}const a2=L({tan_:bne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(t,e){Ul(t);const n=Fi(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ia(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ta(t,e,n){if(Ul(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Fi(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ia(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l2(t,e,n){if(Ul(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Fi(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ia(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AM(t,e,n){if(Ul(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Fi(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ia(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _M(t,e,n){if(Ul(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Fi(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ia(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DM(t,e,n){if(Ul(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Fi(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,Ia(t,e,s,n)}function c2(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function Nw(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}c2(n,e,t)}function Da(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let d=r;d<i;++d)o*=n[d];const a=r<1?1:r,l=se(e.shape)/a,c=[...Re(n.slice(0,r)),1],u=se(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}const vne=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:Da,validateInput:Nw,validateUpdateShape:c2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t,e,n){const s=R(t,"tensor","tensorScatterupdate"),r=R(e,"indices","tensorScatterupdate","int32"),i=R(n,"updates","tensorScatterupdate");if(Nw(i,r,s.shape),s.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${i.dtype}.`);const o={tensor:s,indices:r,updates:i},a={};return P.runKernel(Lx,o,a)}const OM=L({tensorScatterUpdate_:Sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(t,e=1,n=!0){const s=R(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=P.runKernel(Xx,i,o);return{values:a,indices:l}}const u2=L({topk_:kne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cne(t,e=0,n=1,s,r){if(Us(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new s2(e,n,s,!0,r),o=Le(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Tw=L({truncatedNormal_:Cne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t,e=0){const n=R(t,"x","unique","string_or_numeric");E(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=P.runKernel(Jx,s,r);return{values:i,indices:o}}const d2=L({unique_:Nne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t,e,n){const s=R(t,"x","unsortedSegmentSum"),r=R(e,"segmentIds","unsortedSegmentSum","int32");E(vl(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return P.runKernel(qp,i,o)}const Iw=L({unsortedSegmentSum_:Tne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e=0){const n=R(t,"x","unstack","string_or_numeric");E(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return P.runKernel(Hp,s,r)}const ar=L({unstack_:Ine});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FM(t,e){return fw(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2(t,e=!0,n,s){return P.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $w(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=Le(t,"int32"),r=Le([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function $ne(t){const e=R(t,"condition","whereAsync","bool"),n=await e.data(),s=$w(e.shape,n);return t!==e&&e.dispose(),s}const f2=$ne;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ene(t,e,n){const s=R(t,"tensor","boolMask"),r=R(e,"mask","boolMask","bool"),i=n??0,o=r.rank,a=s.shape;E(o>0,()=>"mask cannot be scalar"),Ln(a.slice(i,i+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=i;m<i+o;m++)l*=a[m];const c=a.slice(0,i).concat([l],a.slice(i+o)),u=V(s,c),d=V(r,[-1]),h=await f2(d),f=_a(h,[1]),p=Nd(u,f,i);return t!==s&&s.dispose(),e!==r&&r.dispose(),f.dispose(),u.dispose(),d.dispose(),h.dispose(),p}const PM=Ene;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne(t,e,n){const s=R(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),E(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{E(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?G(()=>{let o=ru(s),a=tm(s);return o=P.runKernel(ul,{x:o},i),a=P.runKernel(ul,{x:a},i),n&&(a=mt(a)),uo(o,a)}):P.runKernel(ul,r,i)}const We=L({transpose_:Rne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t,e,n,s,r=!0){const i=R(t,"v","movingAverage"),o=R(e,"x","movingAverage"),a=R(n,"decay","movingAverage");A3(i,o),E(Ue(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=Ee(1),c=Se(l,a);let u=B(Se(o,i),c);if(r){E(s!=null,()=>"When using zeroDebias: true, step is required.");const d=R(s,"step","movingAverage");u=Te(u,Se(l,Pi(a,d)))}return ue(i,u)}const LM=L({movingAverage_:Ane});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t,e,n){Us(n);const s=R(t,"indices","scatterND","int32"),r=R(e,"updates","scatterND");Nw(r,s,n);const i={indices:s,updates:r},o={shape:n};return P.runKernel(Px,i,o)}const MM=L({scatterND_:_ne});function Dne(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function One(t,e,n,s=0){Us(n);const r=R(t,"sparseIndices","sparseToDense","int32"),i=R(e,"sparseValues","sparseToDense","string_or_numeric"),o=R(s,"defaultValue","sparseToDense",i.dtype);Dne(r,i,n,o);const a={sparseIndices:r,sparseValues:i,defaultValue:o},l={outputShape:n};return P.runKernel(Ux,a,l)}const BM=L({sparseToDense_:One});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne(t,e){const n=R(e,"indices","gatherND","int32"),r={params:R(t,"x","gatherND","string_or_numeric"),indices:n};return P.runKernel(yx,r)}const zM=L({gatherND_:Fne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pne(t,e){if(e==null)return t.shape.slice();if(Ue(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t,e,n,s){const r=R(t,"x","dropout");if(E(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),E(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Xe?r.clone():r;const i=Pne(r,n),o=1-e,a=Te(Cd(ue(Aa(i,0,1,"float32",s),o)),o);return B(r,a)}const p2=L({dropout_:Lne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Ew(t,e,n){const s=1-t%2,r=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+s-1);r[i]=e-n*Math.cos(o)}return On(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Mne(t,e,n=1){const s=R(t,"predictions","inTopK"),r=R(e,"targets","inTopK");E(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),E(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Ln(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=s.shape[s.shape.length-1];E(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await s.data(),a=await r.data(),[l,c]=[o.length/i,i],u=kn("bool",l);for(let d=0;d<l;d++){const h=d*c,f=o.subarray(h,h+c),p=[];for(let m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((m,g)=>g.value-m.value),u[d]=0;for(let m=0;m<n;m++)if(p[m].index===a[d]){u[d]=1;break}}return t!==s&&s.dispose(),e!==r&&r.dispose(),Ms(u,r.shape,"bool")}const VM=Mne;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=V(e,[1,e.shape[0],e.shape[1],e.shape[2]])),E(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),E(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),E(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];E(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),E(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),as("conv2dDerFilter",r,o);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return P.runKernel(tx,d,h)}const g2=L({conv2DBackpropFilter_:Bne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rw(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return B(t,Jl(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Aw(t,e){let n=e;const s=on(t.shape,e.shape);return s.length>0&&(n=ke(n,s)),V(n,t.shape)}function _w(t,e,n,s){if(e==="linear")return t;if(e==="relu")return li(t);if(e==="elu")return Sd(t);if(e==="relu6")return mw(t);if(e==="prelu")return cm(t,n);if(e==="leakyrelu")return nm(t,s);if(e==="sigmoid")return Jr(t);throw new Error(`Unknown fused activation ${e}.`)}const Dw=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",Dw(P.state.gradientDepth,l)===!1){E(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let T=ho(t,e,n,s,r,i,o);return a!=null&&(T=ue(T,a)),_w(T,l,c,u)}const d=R(t,"x","conv2d","float32"),h=R(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=V(d,[1,d.shape[0],d.shape[1],d.shape[2]])),E(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),E(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),as("fused conv2d",s,o);const m=r==="NHWC"?f.shape[3]:f.shape[1];E(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),E(Mn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const g=Tn(f.shape,h.shape,n,i,s,o);let y;a!=null&&(y=R(a,"bias","fused conv2d"),[y]=Ot(y,d),r==="NHWC"?Fe(g.outShape,y.shape):(E(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),E(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let x;if(c!=null){const T=c.shape;if(E(T.length<=1||T.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${T.length}.`),T.length===1)E(T[0]===1||T[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the number of output channels (${g.outChannels}).`);else if(T.length===3)try{Fe(T,g.outShape)}catch{const $=`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error($)}x=R(c,"prelu weights","fused conv2d")}const w=(T,I)=>{E(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[$,_,D,z]=I,H=Rw(T,D,l);E(da(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const X=$N(_.shape,H,$,n,s),Y=g2(_,H,$.shape,n,s),J=[X,Y];if(z!=null){const Q=Aw(z,H);J.push(Q)}return J},b={x:f,filter:h,bias:y,preluActivationWeights:x},S={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Li((I,$,_)=>{let D=P.runKernel(df,b,S);return _([$,I,D]),p&&(D=V(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:w}})(f,h):Li((I,$,_,D)=>{let z=P.runKernel(df,b,S);return D([$,I,z,_]),p&&(z=V(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:w}})(f,h,y)}const jM=L({fusedConv2d_:zne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=V(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return P.runKernel(lx,c,u)}const UM=L({depthwiseConv2dNativeBackpropFilter_:Vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=V(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},d=P.runKernel(cx,c,u);return l?V(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const WM=L({depthwiseConv2dNativeBackpropInput_:jne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(Dw(P.state.gradientDepth,l)===!1){let S=vd(t,e,n,s,r,i,o);return a!=null&&(S=ue(S,a)),_w(S,l,c,u)}const d=R(t,"x","depthwiseConv2d","float32"),h=R(e,"filter","depthwiseConv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=V(d,[1,d.shape[0],d.shape[1],d.shape[2]])),E(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),E(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),E(f.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),i==null&&(i=[1,1]),E(Mn(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),as("fused depthwiseConv2d",s,o);const m=Tn(f.shape,h.shape,n,i,s,o,!0);let g;a!=null&&(g=R(a,"bias","fused conv2d"),[g]=Ot(g,d),Fe(m.outShape,g.shape));let y;c!=null&&(y=R(c,"prelu weights","fused depthwiseConv2d"));const x=(S,T)=>{E(da(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[I,$,_,D]=T,z=Rw(S,_,l),H=WM($.shape,z,I,n,s,i,o),X=UM($,z,I.shape,n,s,i,o);if(D!=null){const Y=Aw(g,z);return[H,X,Y]}return[H,X]},w={x:f,filter:h,bias:g,preluActivationWeights:y},b={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Li((T,I,$)=>{let _=P.runKernel(hf,w,b);return $([I,T,_]),p&&(_=V(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:x}})(f,h):Li((T,I,$,_)=>{let D=P.runKernel(hf,w,b);return _([I,T,D,$]),p&&(D=V(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:x}})(f,h,g)}const Wne=L({fusedDepthwiseConv2d_:Une});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(Dw(P.state.gradientDepth,i)===!1){let z=Be(t,e,n,s);return r!=null&&(z=ue(z,r)),_w(z,i,o,a)}let l=R(t,"a","fused matMul"),c=R(e,"b","fused matMul");[l,c]=Ot(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=se(p),y=se(m);E(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=Fe(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),b=n?V(l,[g,u,h]):V(l,[g,h,u]),S=s?V(c,[y,f,d]):V(c,[y,d,f]);let T;r!=null&&(T=R(r,"bias","fused matMul"),[T]=Ot(T,l),Fe(w,T.shape));let I;o!=null&&(I=R(o,"prelu weights","fused matMul"));const $=(z,H)=>{const[X,Y,J,Q]=H,ee=Rw(V(z,J.shape),J,i);let M,q;if(!n&&!s?(M=Be(ee,Y,!1,!0),q=Be(X,ee,!0,!1)):!n&&s?(M=Be(ee,Y,!1,!1),q=Be(ee,X,!0,!1)):n&&!s?(M=Be(Y,ee,!1,!0),q=Be(X,ee,!1,!1)):(M=Be(Y,ee,!0,!0),q=Be(ee,X,!0,!0)),r!=null){const te=Aw(Q,ee);return[M,q,te]}else return[M,q]},_={a:b,b:S,bias:T,preluActivationWeights:I},D={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?Li((H,X,Y)=>{const J=P.runKernel(uf,_,D);return Y([H,X,J]),{value:V(J,w),gradFunc:$}})(b,S):Li((H,X,Y,J)=>{const Q=P.runKernel(uf,_,D);return J([H,X,Q,Y]),{value:V(Q,w),gradFunc:$}})(b,S,T)}const bS=L({fusedMatMul_:Gne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GM=Object.freeze(Object.defineProperty({__proto__:null,conv2d:jM,depthwiseConv2d:Wne,matMul:bS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t){return Ew(t,.54,.46)}const qne=L({hammingWindow_:Hne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t){return Ew(t,.5,.5)}const HM=L({hannWindow_:Kne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t,e,n,s=!1,r=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(Ge(t,i,e)),i+=n;if(s)for(;i<t.size;){const a=i+e-t.size,l=Kt([Ge(t,i,e-a),Kl([a],r)]);o.push(l),i+=n}return o.length===0?ta([],[0,e]):V(Kt(o),[o.length,e])}const qM=L({frame_:Xne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(t,e,n,s,r=HM){s==null&&(s=m2(e));const i=qM(t,e,n),o=B(i,r(e));return pm(o,s)}const Jne=L({stft_:Yne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t,e,n,s,r="bilinear",i=0){const o=R(t,"image","cropAndResize"),a=R(e,"boxes","cropAndResize","float32"),l=R(n,"boxInd","cropAndResize","int32"),c=a.shape[0];E(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),E(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),E(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),E(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),E(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),E(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},d={method:r,extrapolationValue:i,cropSize:s};return P.runKernel(ix,u,d)}const Zne=L({cropAndResize_:Qne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t){const e=R(t,"image","flipLeftRight","float32");E(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return P.runKernel(gx,n,{})}const tse=L({flipLeftRight_:ese});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nse(t){const e=R(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];E(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),E(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Qs(e,r)}const sse=L({grayscaleToRGB_:nse});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rse(t){const e=R(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];E(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),E(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=me(e,"float32"),o=On([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Ga("ij,j->i",i,o);break;case 3:a=Ga("ijk,k->ij",i,o);break;case 4:a=Ga("ijkl,l->ijk",i,o);break;case 5:a=Ga("ijklm,m->ijkl",i,o);break;case 6:a=Ga("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=An(a,-1),me(a,r)}const ise=L({rgbToGrayscale_:rse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e,n=0,s=.5){const r=R(t,"image","rotateWithOffset","float32");E(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return P.runKernel(Qx,i,o)}const ase=L({rotateWithOffset_:ose});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Id(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),E(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),E(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),E(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),E(e.rank===1,()=>"scores must be a 1D tensor"),E(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),E(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=R(t,"boxes","nonMaxSuppression","float32"),o=R(e,"scores","nonMaxSuppression","float32"),a=Id(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return P.runKernel(Tx,{boxes:i,scores:o},l)}const cse=L({nonMaxSuppression_:lse});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function use(t,e,n){const s=dse(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function dse(t,e,n){return fse(t,e,n||hse)}function hse(t,e){return t>e?1:t<e?-1:0}function fse(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ow(t,e,n,s,r){return y2(t,e,n,s,r,0)}function Fw(t,e,n,s,r,i){return y2(t,e,n,s,r,0,!1,i,!0)}function Pw(t,e,n,s,r,i){return y2(t,e,n,s,r,i,!0)}function y2(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let g=0;g<e.length;g++)e[g]>r&&c.push({score:e[g],boxIndex:g,suppressBeginIndex:0});c.sort(OA);const u=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&c.length>0;){const g=c.pop(),{score:y,boxIndex:x,suppressBeginIndex:w}=g;if(y<r)break;let b=!1;for(let S=d.length-1;S>=w;--S){const T=pse(t,x,d[S]);if(T>=s){b=!0;break}if(g.score=g.score*mse(s,u,T),g.score<=r)break}g.suppressBeginIndex=d.length,b||(g.score===y?(d.push(x),h.push(g.score)):g.score>r&&use(c,g,OA))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return o&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function pse(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(i,c),g=Math.max(o,u),y=Math.min(a,d),x=Math.min(l,h),w=Math.max(y-m,0)*Math.max(x-g,0);return w/(f+p-w)}function mse(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function OA(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function gse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=R(t,"boxes","nonMaxSuppressionAsync"),o=R(e,"scores","nonMaxSuppressionAsync"),a=Id(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=Ow(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),On(d,"int32")}const yse=gse;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=Id(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},d=P.runKernel($x,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const wse=L({nonMaxSuppressionWithScore_:xse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function bse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=Id(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=Pw(u,d,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:On(h,"int32"),selectedScores:On(f)}}const vse=bse;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=R(t,"boxes","nonMaxSuppression"),a=R(e,"scores","nonMaxSuppression"),l=Id(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},p=P.runKernel(Ix,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const kse=L({nonMaxSuppressionPadded_:Sse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Cse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=R(t,"boxes","nonMaxSuppressionAsync"),a=R(e,"scores","nonMaxSuppressionAsync"),l=Id(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=Fw(h,f,c,u,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:On(p,"int32"),validOutputs:Ee(m,"int32")}}const Nse=Cse;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(t,e,n=!1,s=!1){const r=R(t,"images","resizeBilinear");E(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),E(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),E(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=V(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=P.runKernel(Lp,a,l);return o?V(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const KM=L({resizeBilinear_:Tse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ise(t,e,n=!1,s=!1){const r=R(t,"images","resizeNearestNeighbor");E(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),E(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),E(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),E(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=V(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=P.runKernel(Pp,a,l);return o?V(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const XM=L({resizeNearestNeighbor_:Ise});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $se(t,e="binary",n=!1,s=.5){const r=R(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=B(On([s]),255),u,d,h,f;if(E(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),E(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),E(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),E(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,d,h]=ms(r,[1,1,1],-1);const g=B(u,i),y=B(d,o),x=B(h,a);f=ue(ue(g,y),x)}else f=t;if(e==="otsu"){const g=SN(me(gw(f),"int32"),Ms([]),256);c=Ese(g,l)}const p=n?Ra(f,c):ls(f,c);return me(B(p,255),"int32")}function Ese(t,e){let n=On([-1]),s=On([0]),r=On([0]),i,o,a,l,c,u;for(let d=0;d<t.size-1;d++){i=Ge(t,0,d+1),o=Ge(t,d+1),c=Te(ke(i),e),u=Te(ke(o),e);const h=ke(B(i,El(0,i.size)));a=Te(h,ke(i));const f=Kl(o.shape,i.size),p=ue(El(0,o.size),f),m=B(o,p);l=Te(ke(m),ke(o));const g=Se(a,l),y=Se(a,l),x=B(c,u);r=B(B(x,g),y);const w=ls(r,s);s=Sn(w,r,s),n=Sn(w,On([d]),n)}return n}const Rse=L({threshold_:$se});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ase(t,e,n="nearest",s="constant",r=0,i){const o=R(t,"image","transform","float32"),a=R(e,"transforms","transform","float32");E(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),E(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),E(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return P.runKernel(Yx,l,c)}const _se=L({transform_:Ase});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t,e,n){const s=R(t,"a","bandPart");E(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(E(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),E(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=R(e<0?i:e,"numLower","bandPart")):(E(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Sn(nu(e,0),i,fa(e,i))),typeof n=="number"?(E(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),E(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=R(n<0?o:n,"numUpper","bandPart")):(E(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Sn(nu(n,0),o,fa(n,o)));const c=V(El(0,i,1,"int32"),[-1,1]),u=El(0,o,1,"int32"),d=Se(c,u),h=Er(Ra(d,a),ko(d,mt(l))),f=Ht([i,o],s.dtype);return V(is(ar(V(s,[-1,i,o])).map(p=>Sn(h,p,f))),r)}const Ose=L({bandPart_:Dse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(t){let e;if(Array.isArray(t)){e=!1,E(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)E(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=ms(t,t.shape[0],0).map(r=>_a(r,[0]));E(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(P.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=B(ke(B(n[o],i)),n[o]);i=Se(i,a)}return Te(i,kd(i,"euclidean"))}));return e?is(n,0):n}const Pse=L({gramSchmidt_:Fse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(t,e=!1){if(E(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return FA(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=ar(V(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=FA(l,e);r.push(c),i.push(u)});const o=V(is(r,0),t.shape),a=V(is(i,0),t.shape);return[o,a]}}function FA(t,e=!1){return P.tidy(()=>{E(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=cw(n),i=Ei(t);const o=ta([[1]],[1,1]);let a=Ei(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,d=a,h=r;[a,i,r]=P.tidy(()=>{const f=Ge(i,[c,c],[n-c,1]),p=kd(f),m=Ge(i,[c,c],[1,1]),g=Sn(ls(m,0),ta([[-1]]),ta([[1]])),y=Se(m,B(g,p)),x=Te(f,y);x.shape[0]===1?a=Ei(o):a=Kt([o,Ge(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const w=mt(Te(Be(g,y),p)),b=Ge(i,[c,0],[n-c,s]),S=B(w,a),T=We(a);if(c===0)i=Se(b,Be(S,Be(T,b)));else{const _=Se(b,Be(S,Be(T,b)));i=Kt([Ge(i,[0,0],[c,s]),_],0)}const I=We(S),$=Ge(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=Se($,Be(Be($,a),I));else{const _=Se($,Be(Be($,a),I));r=Kt([Ge(r,[0,0],[n,c]),_],1)}return[a,i,r]}),Oe([u,d,h])}return!e&&n>s&&(r=Ge(r,[0,0],[n,s]),i=Ge(i,[0,0],[s,s])),[r,i]})}const Mse=L({qr_:Lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ts;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(ts||(ts={}));function Bse(t,e,n=ts.SUM_BY_NONZERO_WEIGHTS){const s=R(t,"losses","computeWeightedLoss");let r=null;e!=null&&(r=R(e,"weights","computeWeightedLoss"));const i=r==null?s:B(s,r);if(n===ts.NONE)return i;if(n===ts.SUM)return ke(i);if(n===ts.MEAN){if(r==null)return At(i);{const o=s.size/r.size,a=Te(ke(i),ke(r));return o>1?Te(a,Ee(o)):a}}if(n===ts.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Te(ke(i),Ee(s.size));{const o=B(r,fs(s.shape)),a=me(ke($l(o,Ee(0))),"float32");return Te(ke(i),a)}}throw Error(`Unknown reduction: ${n}`)}const No=L({computeWeightedLoss_:Bse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zse(t,e,n,s=ts.SUM_BY_NONZERO_WEIGHTS){const r=R(t,"labels","absoluteDifference"),i=R(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=R(n,"weights","absoluteDifference")),Ln(r.shape,i.shape,"Error in absoluteDifference: ");const a=en(Se(r,i));return No(a,o,s)}const Vse=L({absoluteDifference_:zse});function jse(t,e,n,s,r=ts.SUM_BY_NONZERO_WEIGHTS){const i=R(t,"labels","cosineDistance"),o=R(e,"predictions","cosineDistance");let a=null;s!=null&&(a=R(s,"weights","cosineDistance")),Ln(i.shape,o.shape,"Error in cosineDistance: ");const l=Ee(1),c=Se(l,ke(B(i,o),n,!0));return No(c,a,r)}const Use=L({cosineDistance_:jse});function Wse(t,e,n,s=ts.SUM_BY_NONZERO_WEIGHTS){let r=R(t,"labels","hingeLoss");const i=R(e,"predictions","hingeLoss");let o=null;n!=null&&(o=R(n,"weights","hingeLoss")),Ln(r.shape,i.shape,"Error in hingeLoss: ");const a=Ee(1);r=Se(B(Ee(2),r),a);const l=li(Se(a,B(r,i)));return No(l,o,s)}const Gse=L({hingeLoss_:Wse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t,e,n,s=1,r=ts.SUM_BY_NONZERO_WEIGHTS){const i=R(t,"labels","huberLoss"),o=R(e,"predictions","huberLoss");let a=null;n!=null&&(a=R(n,"weights","huberLoss")),Ln(i.shape,o.shape,"Error in huberLoss: ");const l=Ee(s),c=en(Se(o,i)),u=fa(c,l),d=Se(c,u),h=ue(B(Ee(.5),at(u)),B(l,d));return No(h,a,r)}const qse=L({huberLoss_:Hse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kse(t,e,n,s=1e-7,r=ts.SUM_BY_NONZERO_WEIGHTS){const i=R(t,"labels","logLoss"),o=R(e,"predictions","logLoss");let a=null;n!=null&&(a=R(n,"weights","logLoss")),Ln(i.shape,o.shape,"Error in logLoss: ");const l=Ee(1),c=Ee(s),u=mt(B(i,zs(ue(o,c)))),d=B(Se(l,i),zs(ue(Se(l,o),c))),h=Se(u,d);return No(h,a,r)}const Xse=L({logLoss_:Kse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yse(t,e,n,s=ts.SUM_BY_NONZERO_WEIGHTS){const r=R(t,"labels","meanSquaredError"),i=R(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=R(n,"weights","meanSquaredError")),Ln(r.shape,i.shape,"Error in meanSquaredError: ");const a=Cw(r,i);return No(a,o,s)}const Jse=L({meanSquaredError_:Yse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t,e){const n=R(t,"labels","sigmoidCrossEntropyWithLogits"),s=R(e,"logits","sigmoidCrossEntropyWithLogits");Ln(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=li(s),i=B(s,n),o=sm(ws(mt(en(s))));return ue(Se(r,i),o)}function Zse(t,e,n,s=0,r=ts.SUM_BY_NONZERO_WEIGHTS){let i=R(t,"multiClassLabels","sigmoidCrossEntropy");const o=R(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=R(n,"weights","sigmoidCrossEntropy")),Ln(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Ee(s),u=Ee(1),d=Ee(.5);i=ue(B(i,Se(u,c)),B(d,c))}const l=Qse(i,o);return No(l,a,r)}const ere=L({sigmoidCrossEntropy_:Zse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Li((r,i,o)=>{const l=rm(i,[n],!0),c=Se(me(i,"float32"),l);o([r,c]);const u=mt(B(c,r));return{value:ke(u,[n]),gradFunc:(f,p)=>{const[m,g]=p,y=Xt(f.shape,[n]);return[B(V(f,y),Se(me(m,"float32"),ws(g))),B(V(f,y),Se(ws(g),me(m,"float32")))]}}})(t,e)}function nre(t,e,n,s=0,r=ts.SUM_BY_NONZERO_WEIGHTS){let i=R(t,"onehotLabels","softmaxCrossEntropy");const o=R(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=R(n,"weights","softmaxCrossEntropy")),Ln(i.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Ee(s),u=Ee(1),d=Ee(i.shape[1]);i=ue(B(i,Se(u,c)),Te(c,d))}const l=tre(i,o);return No(l,a,r)}const sre=L({softmaxCrossEntropy_:nre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rre(t,e,n,s){const r=R(t,"indices","sparseFillEmptyRows","int32"),i=R(e,"values","sparseFillEmptyRows"),o=R(n,"denseShape","sparseFillEmptyRows","int32"),a=R(s,"defaultValue","sparseFillEmptyRows",i.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:i,denseShape:o,defaultValue:a},c=P.runKernel(Bx,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const ire=L({sparseFillEmptyRows_:rre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ore(t,e,n){const s=R(t,"inputIndices","sparseReshape","int32"),r=R(e,"inputShape","sparseReshape","int32"),i=R(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:s,inputShape:r,newShape:i},a=P.runKernel(zx,o);return{outputIndices:a[0],outputShape:a[1]}}const are=L({sparseReshape_:ore});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lre(t,e,n){const s=R(t,"data","sparseSegmentMean"),r=R(e,"indices","sparseSegmentMean","int32"),i=R(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return P.runKernel(Vx,o)}const cre=L({sparseSegmentMean_:lre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t,e,n){const s=R(t,"data","sparseSegmentSum"),r=R(e,"indices","sparseSegmentSum","int32"),i=R(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return P.runKernel(jx,o)}const dre=L({sparseSegmentSum_:ure});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t,e,n,s,r,i,o,a){const l=R(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=R(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:s,leftPad:r,rightPad:i,padWidth:o,preserveShortSequences:a},d={data:l,dataSplits:c},h=P.runKernel(Hx,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}const fre=L({stringNGrams_:hre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t,e,n=!0){const s=R(t,"input","stringSplit","string"),r=R(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const i={skipEmpty:n},o={input:s,delimiter:r},a=P.runKernel(qx,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const mre=L({stringSplit_:pre});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(t,e){const n=R(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return P.runKernel(Kx,r,s)}const yre=L({stringToHashBucketFast_:gre});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xre(t,e,n,s=!0){const r=R(t,"input","staticRegexReplace","string"),i={pattern:e,rewrite:n,replaceGlobal:s};return P.runKernel(Gp,{x:r},i)}const wre=L({staticRegexReplace_:xre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YM={fft:fm,ifft:ou,rfft:pm,irfft:kw},JM={hammingWindow:qne,hannWindow:HM,frame:qM,stft:Jne},Zs={flipLeftRight:tse,grayscaleToRGB:sse,resizeNearestNeighbor:XM,resizeBilinear:KM,rgbToGrayscale:ise,rotateWithOffset:ase,cropAndResize:Zne,nonMaxSuppression:cse,nonMaxSuppressionAsync:yse,nonMaxSuppressionWithScore:wse,nonMaxSuppressionWithScoreAsync:vse,nonMaxSuppressionPadded:kse,nonMaxSuppressionPaddedAsync:Nse,threshold:Rse,transform:_se},x2={bandPart:Ose,gramSchmidt:Pse,qr:Mse},QM={absoluteDifference:Vse,computeWeightedLoss:No,cosineDistance:Use,hingeLoss:Gse,huberLoss:qse,logLoss:Xse,meanSquaredError:Jse,sigmoidCrossEntropy:ere,softmaxCrossEntropy:sre},ZM={sparseFillEmptyRows:ire,sparseReshape:are,sparseSegmentMean:cre,sparseSegmentSum:dre},eB={stringNGrams:fre,stringSplit:mre,stringToHashBucketFast:yre,staticRegexReplace:wre};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bre=new Map,vS=new Map;class Ql{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Ys{constructor(){this.classNameMap={}}static getMap(){return Ys.instance==null&&(Ys.instance=new Ys),Ys.instance}static register(e){Ys.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function he(t,e,n){E(t.className!=null,()=>"Class being registered does not have the static className property defined."),E(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),E(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return Ys.register(t),bre.set(r,t),vS.set(t,r),t}function vre(t){return vS.has(t)?vS.get(t):t.className}const Sre=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Ql,SerializationMap:Ys,getRegisteredName:vre,registerClass:he},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class To extends Ql{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Oe(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return iM(e,n)}dispose(){this.iterations_!=null&&Oe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ee(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(To,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w2 extends To{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:G(()=>He(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:G(()=>He(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;G(()=>{const u=ue(B(l,this.rho),B(at(a),1-this.rho)),d=B(Te(Cn(ue(c,this.epsilon)),Cn(ue(l,this.epsilon))),a),h=ue(B(c,this.rho),B(at(d),1-this.rho));l.assign(u),c.assign(h);const f=ue(B(d,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Oe(this.accumulatedGrads.map(e=>e.variable)),Oe(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b2 extends To{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:G(()=>Kl(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;G(()=>{const l=ue(a,at(o));a.assign(l);const c=ue(B(Te(o,Cn(ue(l,P.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Oe(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v2 extends To{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],G(()=>{this.accBeta1=Ee(n).variable(),this.accBeta2=Ee(s).variable()}),r==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);G(()=>{const s=Se(1,this.accBeta1),r=Se(1,this.accBeta2);n.forEach((i,o)=>{const a=P.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:G(()=>He(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:G(()=>He(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=ue(B(u,this.beta1),B(c,1-this.beta1)),f=ue(B(d,this.beta2),B(at(c),1-this.beta2)),p=Te(h,s),m=Te(f,r);u.assign(h),d.assign(f);const g=ue(B(Te(p,ue(Cn(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(B(this.accBeta1,this.beta1)),this.accBeta2.assign(B(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Oe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Oe(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),G(()=>{this.accBeta1.assign(Pi(this.beta1,this.iterations_+1)),this.accBeta2.assign(Pi(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S2 extends To{static get className(){return"Adamax"}constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],G(()=>{this.iteration=Ee(0).variable(),this.accBeta1=Ee(n).variable()}),r==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);G(()=>{const s=Se(1,this.accBeta1),r=Te(-this.learningRate,ue(B(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=P.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:He(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:He(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=ue(B(u,this.beta1),B(c,1-this.beta1)),f=B(d,this.beta2),p=en(c),m=Bi(f,p);u.assign(h),d.assign(m);const g=ue(B(Te(r,s),Te(h,ue(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(ue(this.iteration,1)),this.accBeta1.assign(B(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Oe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Oe(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lw extends To{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=P.registeredVariables[s];G(()=>{const a=ue(B(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=dn(Ee(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k2 extends Lw{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Ee(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:G(()=>He(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&G(()=>{let l;const c=ue(B(this.m,o),a);this.useNesterov?l=ue(B(this.c,ue(a,B(c,this.m))),i):l=ue(B(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Oe(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C2 extends To{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=P.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=P.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:G(()=>He(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:G(()=>He(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:G(()=>He(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;G(()=>{const u=ue(B(l,this.decay),B(at(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=ue(B(d,this.decay),B(a,1-this.decay)),f=Te(B(a,this.learningRate),Cn(Se(u,ue(at(h),this.epsilon)))),p=ue(B(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=Se(i,p);i.assign(m)}else{const d=ue(B(l,this.decay),B(at(a),1-this.decay)),h=ue(B(c,this.momentum),Te(B(a,this.learningRate),Cn(ue(d,this.epsilon))));l.assign(d),c.assign(h);const f=Se(i,h);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Oe(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Oe(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Oe(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kre=[w2,b2,v2,S2,k2,C2,Lw];function Cre(){for(const t of kre)he(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nre="model",Tre=".json",Ire=".weights.bin";function PA(t){return new Promise(e=>setTimeout(e)).then(t)}class Rl{constructor(e){if(!K().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Rl.URL_SCHEME)&&(e=e.slice(Rl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Nre),this.modelJsonFileName=e+Tre,this.weightDataFileName=e+Ire}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=ai.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=B3(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await PA(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await PA(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Yp(e)}}}}Rl.URL_SCHEME="downloads://";class $re{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=r=>{const i=JSON.parse(r.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=aN(i,c=>this.loadWeights(c));e(l)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const o of e)n.push(...o.weights),s.push(...o.paths);const r=this.checkManifestAndWeightFiles(e),i=s.map(o=>this.loadWeightsFile(o,r[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((s,r)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;s(a)},i.onerror=o=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(i=>DA(i.name)),r={};for(const i of e)i.paths.forEach(o=>{const a=DA(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[o]=this.weightsFiles[s.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const Ere=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Rl.URL_SCHEME)?Rre(t.slice(Rl.URL_SCHEME.length)):null;Et.registerSaveRouter(Ere);function Rre(t="model"){return new Rl(t)}function Are(t){return new $re(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LA(t,e,n,s){o(t),n=n??0,s=s??1,a(n,s);let r=0;const i=l=>(l.then(c=>{const u=n+ ++r/t.length*(s-n);return e(u),c}),l);function o(l){E(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){E(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),E(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),E(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function tB(t,e){e==null&&(e={});const n=e.fetchFunc==null?K().platform.fetch:e.fetchFunc,s=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await LA(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await LA(a,e.onProgress,.5,1)}function _re(t,e){var n;const s=e.fetchFunc==null?K().platform.fetch:e.fetchFunc;let r=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;r<t.length;){i||(i=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await i.read();if(l){r++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,r/t.length);continue}o.enqueue(c);return}o.close()}})}async function nB(t,e="",n,s){return sB(o=>tB(o,{requestInit:s}))(t,e,n)}function sB(t){return async(e,n="",s)=>{const r=e.map(()=>!1),i={},o=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((f,p)=>{let m=0;f.weights.forEach(g=>{const y="quantization"in g?g.quantization.dtype:g.dtype,x=Sl[y]*se(g.shape),w=()=>{r[p]=!0,i[p]==null&&(i[p]=[]),i[p].push({manifestEntry:g,groupOffset:m,sizeBytes:x})};s!=null?s.forEach((b,S)=>{b===g.name&&(w(),o[S]=!0)}):w(),a.push(g.name),m+=x})}),!o.every(f=>f)){const f=s.filter((p,m)=>!o[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((f,p,m)=>(p&&f.push(m),f),[]),c=[];l.forEach(f=>{e[f].paths.forEach(p=>{const m=n+(n.endsWith("/")?"":"/")+p;c.push(m)})});const u=await t(c),d={};let h=0;return l.forEach(f=>{const p=e[f].paths.length,m=new ai(u.slice(h,h+p));i[f].forEach(y=>{const x=m.slice(y.groupOffset,y.groupOffset+y.sizeBytes),w=rN(x,[y.manifestEntry]);for(const b in w)d[b]=w[b]}),h+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dre="application/octet-stream",Ore="application/json";class N2{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(E(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=K().platform.fetch,E(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&E(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=B3(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:Ore}),"model.json"),e.weightData!=null){const o=ai.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:Dre}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:Yp(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return aN(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=qy(e.weightsManifest),r=()=>_re(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=Fre(n),i=this.weightPathPrefix||s,o=[],a=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(c)):o.push(i+c+r);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),s=qy(e),r=await tB(n,this.loadOptions);return[s,r]}}N2.URL_SCHEME_REGEX=/^https?:\/\//;function Fre(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function SS(t){return t.match(N2.URL_SCHEME_REGEX)!=null}const rB=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>SS(s)):n=SS(t),n)return T2(t,e)}return null};Et.registerSaveRouter(rB);Et.registerLoadRouter(rB);function T2(t,e){return new N2(t,e)}function iB(t,e){return T2(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p1{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class oB{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Pre{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Lre(t,e,n,s){const r=arguments;return new Pre(Xy(...r))}function Xy(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new p1(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new p1({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new p1({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function Mre(t){return new oB(t)}function Bre(t){return new oB(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I2=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:ai,browserFiles:Are,browserHTTPRequest:iB,concatenateArrayBuffers:M3,copyModel:wQ,decodeWeights:rN,decodeWeightsStream:L3,encodeWeights:pS,fromMemory:Lre,fromMemorySync:Xy,getLoadHandlers:V3,getModelArtifactsForJSON:aN,getModelArtifactsForJSONSync:oN,getModelArtifactsInfoForJSON:Yp,getSaveHandlers:z3,getWeightSpecs:qy,http:T2,isHTTPScheme:SS,listModels:yQ,loadWeights:nB,moveModel:bQ,registerLoadRouter:iQ,registerSaveRouter:rQ,removeModel:xQ,weightsLoaderFactory:sB,withSaveHandler:Mre,withSaveHandlerSync:Bre},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zre(t,e,n){const s=R(t,"labels","confusionMatrix"),r=R(e,"predictions","confusionMatrix");E(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),E(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),E(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),E(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),E(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const i=su(me(s,"int32"),n),o=su(me(r,"int32"),n),a=We(i),l=Be(a,o);return me(l,"int32")}const Vre=L({confusionMatrix_:zre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jre=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:Vre},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let La,MA=!1;function aB(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(pf(Wy,P.backendName)!=null){const p={pixels:t},m={numChannels:e};return P.runKernel(Wy,p,m)}const[c,u]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,c,u).data;else if(s||n)d=t.data;else if(i||r||a){if(La==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")La=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else La=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});La.canvas.width=c,La.canvas.height=u,La.drawImage(t,0,0,c,u),d=La.getImageData(0,0,c,u).data}let h;if(e===4)h=new Int32Array(d);else{const p=c*u;h=new Int32Array(p*e);for(let m=0;m<p;m++)for(let g=0;g<e;++g)h[m*e+g]=d[m*4+g]}return l2(h,[u,c,e],"int32")}function Ure(t){return t!=null&&t.data instanceof Uint8Array}function Wre(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function Gre(t){return t!=null&&t.width!==0&&t.height!==0}function Hre(t){return Wre()&&!(t instanceof ImageBitmap)&&Gre(t)&&!Ure(t)}async function qre(t,e=3){let n=null;if(K().getBool("WRAP_TO_IMAGEBITMAP")&&Hre(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return aB(n,e)}function lB(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function Kre(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function Xre(t,e){let n=R(t,"img","toPixels");if(!(t instanceof Xe)){const c=n;n=me(c,"int32"),c.dispose()}lB(n);const[s,r]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const u=[0,0,0,255];for(let h=0;h<i;h++){const f=o[c*i+h];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);i===1?(u[0]=f*a,u[1]=f*a,u[2]=f*a):u[h]=f*a}const d=c*4;l[d+0]=Math.round(u[0]),l[d+1]=Math.round(u[1]),l[d+2]=Math.round(u[2]),l[d+3]=Math.round(u[3])}if(e!=null){MA||pf(dx,P.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),MA=!0),e.width=r,e.height=s;const c=e.getContext("2d"),u=new ImageData(l,r,s);c.putImageData(u,0,0)}return n!==t&&n.dispose(),l}function Yre(t,e,n){let s=R(t,"img","draw");if(!(t instanceof Xe)){const o=s;s=me(o,"int32"),o.dispose()}lB(s),Kre(n==null?void 0:n.imageOptions);const r={image:s},i={canvas:e,options:n};P.runKernel(dx,r,i)}const $2=L({fromPixels_:aB}),Jre=Object.freeze(Object.defineProperty({__proto__:null,draw:Yre,fromPixels:$2,fromPixelsAsync:qre,toPixels:Xre},Symbol.toStringTag,{value:"Module"}));function Mw(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(se(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let d=0;d<r.length-1;++d)o*=r[d];const a=t.shape,l=r.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=a[d],l.push(a[d]);const u=[...Re(t.shape).map(d=>d/c),1].slice(0,i);return[l,o,c,u]}const Qre=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:Mw},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kS=-2,Zre=-1;function E2(t,e,n){const s=t.shape.length;E(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),E(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)E(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function eie(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function R2(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function cB(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function uB(t,e,n){return n<=t?n:n-(e-1)}function dB(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function tie(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=hB(o,f,p,s,t),d=fB(a,f,p,r,t),h=cB(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=mB(o,s,i,t,f,l),d[f]=gB(a,r,i,t,f,l),h[f]=pB(i,f,l);return{begin:u,end:d,strides:h}}function hB(t,e,n,s,r){const i=[...r],o=dB(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=uB(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function fB(t,e,n,s,r){const i=[...r],o=dB(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=uB(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=la(0,i[a],r[a])}return i}function pB(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function mB(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=la(0,o,l-1),o}function gB(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=la(0,o,l):o=la(-1,o,l-1),o}function A2(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function _2(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Bw(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{E(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(E(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function D2(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let w=0;w<d.dims;w++)u&&1<<w&a&&d.numAddAxisAfterEllipsis++,1<<w&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};nie(d,h);let f=!0,p=!0,m=!0;const g=[],y=[];for(let w=0;w<t.length;++w){if(h.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const b=!!(h.shrinkAxisMask&1<<w),S=t[w];if(S===-1){g.push(b?1:-1);continue}const T=[h.beginMask&1<<w,h.endMask&1<<w],I=[h.strides[w]>0?0:-1,h.strides[w]>0?S:S-1];if(b&&h.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[w]===1;const $=!!(h.beginMask&1<<w&&h.endMask&1<<w);if(h.beginValid&&h.endValid){if(b){const H=h.begin[w]<0?S+h.begin[w]:h.begin[w];if(h.begin[w]=H,h.end[w]=h.begin[w]+1,H<0||H>=S)throw Error(`slice index ${h.begin[w]} of dimension ${w} out of bounds.`)}else h.begin[w]=BA(h.begin[w],0,h.strides[w],S,T,I),h.end[w]=BA(h.end[w],1,h.strides[w],S,T,I);const z=h.strides[w]===1&&h.begin[w]===0&&h.end[w]===S;f=f&&z,p=p&&(w===0&&h.strides[w]===1||z)}else f=f&&h.strides[w]===1&&$,p=p&&(w===0&&h.strides[w]===1||$);let _,D=!1;if(h.beginValid&&h.endValid?(_=h.end[w]-h.begin[w],D=!0):b?(_=1,D=!0):$&&S>=0&&(h.strides[w]<0?_=-S:_=S,D=!0),D){let z;_===0||_<0!=h.strides[w]<0?z=0:z=Math.trunc(_/h.strides[w])+(_%h.strides[w]!==0?1:0),g.push(z)}else g.push(-1)}for(let w=0;w<h.finalShapeGatherIndices.length;++w){const b=h.finalShapeGatherIndices[w];b>=0?y.push(g[b]):b===kS&&y.push(1)}return{finalShapeSparse:y.filter((w,b)=>h.finalShapeGatherIndices[b]!==kS),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function nie(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(kS),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Zre),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function BA(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const yB=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:E2,computeFlatOffset:_2,computeOutShape:R2,getNormalizedAxes:tie,isSliceContinous:A2,maskToAxes:eie,parseSliceParams:Bw,sliceInfo:D2,startForAxis:mB,startIndicesWithElidedDims:hB,stopForAxis:gB,stopIndicesWithElidedDims:fB,stridesForAxis:pB,stridesWithElidedDims:cB},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const xB="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wB{static sgd(e){return new Lw(e)}static momentum(e,n,s=!1){return new k2(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new C2(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new v2(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new w2(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new S2(e,n,s,r,i)}static adagrad(e,n=.1){return new b2(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ua=wB;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sie=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function O2(){return new Promise(t=>sie(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F2(t,e){const n=t[0].length;t.forEach((r,i)=>{E(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),E(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)E(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Ri(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Hr||(Hr={}));function bB(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function vB(t){const e={FIRST_DIM_SIZE:Hr.FIRST_DIM_SIZE,VALUE_ROWIDS:Hr.VALUE_ROWIDS,ROW_LENGTHS:Hr.ROW_LENGTHS,ROW_SPLITS:Hr.ROW_SPLITS,ROW_LIMITS:Hr.ROW_LIMITS,ROW_STARTS:Hr.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function SB(t){return t.length===0?0:t[0]===Hr.FIRST_DIM_SIZE?t.length-1:t.length}function kB(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P2=30;function zw(t){return t<=P2?t:Vy(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mm(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function gm(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function ym(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function M2(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function B2(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vw=1.7580993408473768,jw=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z2=.3275911,V2=.254829592,j2=-.284496736,U2=1.421413741,W2=-1.453152027,G2=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function CB(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function NB(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function TB(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function H2(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function IB(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function $B(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function EB(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1="->",rie=/->/g,zA=",",VA="...";function q2(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(rie,"").length)/m1.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${m1}").`);const[s,r]=t.split(m1);E(s.indexOf(VA)===-1,()=>`The ellipsis notation ("${VA}") is not supported yet.`);const i=s.split(zA),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==zA&&a.push(f)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<i[h].length;++f)l[h].push(a.indexOf(i[h][f]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function K2(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function X2(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:E(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function Y2(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=iie(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function J2(t){return t.every((e,n)=>e===n)}function iie(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function Q2(t,e,n=0){let s=[];if(typeof e=="number")E(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);E(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}E(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RB(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function AB(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function _B(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function OB(t,e){return`size ${t} must be non-negative, not ${e}`}function FB(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function PB(t,e){const n=se(t),s=se(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function LB(t,e){const n=se(t),s=se(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CS(){return"segment ids must be >= 0"}function MB(){return"segment ids are not increasing"}function BB(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function zB(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VB(t,e){let n=!1,s;for(t<=P2?(s=t,n=!0):s=Vy(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=Vy(t,s+1);return s}function jB(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function Z2(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const oie=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Z2,computeOutShape:jB,segOpComputeOptimalWindowSize:VB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(t){try{return t.map(e=>lo(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function UB(t){return t.map(e=>$i(e))}const WB=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:V2,ERF_A2:j2,ERF_A3:U2,ERF_A4:W2,ERF_A5:G2,ERF_P:z2,PARALLELIZE_THRESHOLD:P2,get RowPartitionType(){return Hr},SELU_SCALE:jw,SELU_SCALEALPHA:Vw,applyActivation:_w,assertAndGetBroadcastShape:Fe,assertAxesAreInnerMostDims:Bn,assertParamsConsistent:F2,assignToTypedArray:IB,axesAreInnerMostDims:FN,calculateShapes:Da,checkEinsumDimSizes:X2,checkPadOnDimRoundingMode:as,combineLocations:nM,combineRaggedTensorToTensorShapes:bB,complexWithEvenIndex:NB,complexWithOddIndex:TB,computeConv2DInfo:Tn,computeConv3DInfo:$a,computeDefaultPad:yN,computeDilation2DInfo:Jp,computeOptimalWindowSize:zw,computeOutAndReduceShapes:In,computeOutShape:Ri,computePool2DInfo:Rr,computePool3DInfo:vo,convertConv2DDataFormat:So,decodeEinsumEquation:q2,eitherStridesOrDilationsAreOne:Mn,expandShapeToKeepDim:Xt,exponent:EB,exponents:$B,fromStringArrayToUint8:UB,fromUint8ToStringArray:po,getAxesPermutation:Ft,getBroadcastDims:Il,getComplexWithIndex:H2,getEinsumComputePath:Y2,getEinsumPermutation:K2,getFusedBiasGradient:Aw,getFusedDyActivation:Rw,getImageCenter:L2,getInnerMostAxes:Yt,getPermuted:gm,getRaggedRank:SB,getReductionAxes:on,getReshaped:mm,getReshapedPermuted:ym,getRowPartitionTypesHelper:vB,getSliceBeginCoords:M2,getSliceSize:B2,getSparseFillEmptyRowsIndicesDenseShapeMismatch:RB,getSparseFillEmptyRowsNegativeIndexErrorMessage:AB,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:_B,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:FB,getSparseReshapeInputOutputMismatchErrorMessage:LB,getSparseReshapeInputOutputMultipleErrorMessage:PB,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:DB,getSparseReshapeNegativeOutputDimErrorMessage:OB,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:zB,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:CS,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:MB,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:BB,getUndoAxesPermutation:Ea,isIdentityPermutation:J2,log:iJ,mergeRealAndImagArrays:fo,prepareAndValidate:Mw,prepareSplitSize:Q2,segment_util:oie,shouldFuse:Dw,slice_util:yB,splitRealAndImagArrays:CB,stridesOrDilationsArePositive:Tl,tupleValuesAreOne:da,upcastType:gs,validateDefaultValueShape:kB,validateInput:Nw,validateUpdateShape:c2,warn:Xs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aie=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:Ow,nonMaxSuppressionV4Impl:Fw,nonMaxSuppressionV5Impl:Pw,whereImpl:$w},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Cre();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GB={kernelName:Hf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,Jl(me(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lie={kernelName:Nu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=at(me(n,"float32")),r=Cn(Se(Ee(1),s));return mt(Te(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cie={kernelName:Tu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Cn(Se(at(me(n,"float32")),1));return Te(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uie={kernelName:Hl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Fe(n.shape,s.shape);return{a:()=>{let a=t;const l=on(n.shape,r);return l.length>0&&(a=ke(a,l)),V(a,n.shape)},b:()=>{let a=t;const l=on(s.shape,r);return l.length>0&&(a=ke(a,l)),V(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const die={kernelName:qf,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hie={kernelName:Kf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>He(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fie={kernelName:Xf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>He(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pie={kernelName:Iu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,Cn(Se(Ee(1),at(me(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mie={kernelName:$u,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Cn(ue(Ee(1),at(me(n,"float32"))));return Te(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gie={kernelName:Au,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Fe(n.shape,s.shape);return{a:()=>{const a=ue(at(n),at(s));let l=B(t,Te(s,a));const c=on(n.shape,r);return c.length>0&&(l=ke(l,c)),V(l,n.shape)},b:()=>{const a=ue(at(n),at(s));let l=mt(B(t,Te(n,a)));const c=on(s.shape,r);return c.length>0&&(l=ke(l,c)),V(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yie={kernelName:Eu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,ue(at(me(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xie={kernelName:Ru,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,Se(Ee(1),at(me(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wie(t,e,n,s,r,i){const o=R(t,"dy","avgPool3dGrad"),a=R(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=V(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),E(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),E(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),as("avgPool3dGrad",r,i);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=P.runKernel(J0,d,h);return u?V(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const bie=L({avgPool3dGrad_:wie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vie={kernelName:Jf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>bie(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t,e,n,s,r){const i=R(t,"dy","avgPoolGrad"),o=R(e,"input","avgPoolGrad");E(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=V(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=V(i,[1,i.shape[0],i.shape[1],i.shape[2]])),E(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),E(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=P.runKernel(Y0,u,d);return c?V(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const kie=L({avgPoolGrad_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cie={kernelName:Yf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>kie(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nie={kernelName:Qf,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>Be(t,r,!1,!0),b:()=>Be(s,t,!0,!1)}:!i&&o?{a:()=>Be(t,r,!1,!1),b:()=>Be(t,s,!0,!1)}:i&&!o?{a:()=>Be(r,t,!1,!0),b:()=>Be(s,t,!1,!1)}:{a:()=>Be(r,t,!0,!0),b:()=>Be(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tie={kernelName:Zf,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>lm(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iie={kernelName:p3,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>ke(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ie={kernelName:_u,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eie={kernelName:Du,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rie={kernelName:Ou,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>Sn(Er(ko(s,r),Ra(s,i)),t,He(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aie={kernelName:tp,inputsToSave:["x"],gradFunc:GB.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ie={kernelName:np,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=ze(r,e[0].shape)[0],o=s.map(l=>l[i]);return ms(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Die={kernelName:sp,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return E(da(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>$N(s.shape,t,r,o,a,l),filter:()=>g2(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oie={kernelName:rp,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>ho(t,r,i,o,a,1,l),filter:()=>g2(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(t,e,n,s,r){let i=t;t.rank===4&&(i=V(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=V(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),E(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),E(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),E(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),E(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),E(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return P.runKernel(nx,a,l)}const Pie=L({conv3DBackpropFilter_:Fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lie={kernelName:ip,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;E(da(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>Z3(o.shape,t,a,r,i),filter:()=>Pie(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mie={kernelName:Fu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(mt(bw(me(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bie={kernelName:Pu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(vw(me(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zie={kernelName:op,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=Ft([r],s.rank);let l=aw(t,r,i,!o);return a!=null&&(l=We(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vie={kernelName:ap,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];E(da(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return E(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),E(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),E(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),E(Mn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),as("depthwiseConv2d",i,o),{x:()=>WM(l.shape,t,c,r,i,a,o),filter:()=>UM(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jie={kernelName:lp,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>P.runKernel(jy,i,n),filter:()=>P.runKernel(Uy,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uie={kernelName:Mu,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>P.runKernel(fx,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wie={kernelName:Bu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=B(ws(mt(at(n))),2/Math.sqrt(Math.PI));return{x:()=>B(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gie={kernelName:zu,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hie={kernelName:up,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>V(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qie={kernelName:Vu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,ws(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kie={kernelName:ju,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xie={kernelName:Uu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Fe(n.shape,s.shape);return{a:()=>{const a=Te(t,me(s,"float32")),l=on(n.shape,r);return l.length>0?V(ke(a,l),n.shape):a},b:()=>{let a=B(t,me(n,"float32"));const l=on(s.shape,r);l.length>0&&(a=V(ke(a,l),s.shape));const c=at(s);return mt(Te(a,me(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yie={kernelName:dp,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??Ee(1),c=on(i.shape,r.shape),u=[];if(i.rank===1){for(let b=0;b<r.shape.length-1;++b)u.push(r.shape[b]);u.push(1)}const d=Se(r,i),h=B(t,l),f=yw(ue(o,Ee(s))),p=B(B(B(f,f),f),Ee(-.5));return{x:()=>i.rank===1?V(B(B(t,Qs(V(f,[1,1,1,i.shape[0]]),u)),l),r.shape):V(B(B(t,f),l),r.shape),mean:()=>{let b=B(B(f,Ee(-1)),h);return i.rank===1&&(b=ke(b,c)),V(b,i.shape)},variance:()=>{let b=B(B(p,d),h);return i.rank===1&&(b=ke(b,c)),V(b,i.shape)},scale:()=>{const b=B(d,f);let S=B(t,b);return i.rank===1&&(S=ke(S,c)),V(S,i.shape)},offset:()=>{let b=t;return i.rank===1&&(b=ke(b,c)),V(b,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jie={kernelName:hp,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i,batchDims:o}=n,a=ze(i,s.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,a),m=p.length,g=h.slice(i,h.length).slice(1),y=g.length,x=jA(0,m),w=jA(m+1,m+1+y),b=UA([p,[f],g]),S=V(d,b),T=V(u,[f]),I=UA([[m],x,w]),$=We(S,I);let _=Iw($,T,c.shape[a]);const D=Ea(I);return _=We(_,D),_};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>is(u.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function jA(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function UA(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qie={kernelName:Wu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>He(n),b:()=>He(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zie={kernelName:Gu,gradFunc:t=>({x:()=>me(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eoe={kernelName:Hu,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const toe={kernelName:qu,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const noe={kernelName:Ku,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const soe={kernelName:pp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=ls(s,0);return{x:()=>Sn(i,t,B(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const roe={kernelName:Yu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,ue(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe={kernelName:Xu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,me(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ooe={kernelName:m3,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=ws(s);return Se(t,B(ke(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return P.runKernel(vx,a,l)}const loe=L({localResponseNormalizationBackprop_:aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const coe={kernelName:bp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>loe(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HB(t,e,n,s){return e.rank<n.rank&&(e=V(e,Xt(e.shape,s))),t.rank<n.rank&&(t=V(t,Xt(t.shape,s))),{x:()=>B(t,me(Bs(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WA={kernelName:vp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=ze(r,i.shape),l=HB(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uoe={kernelName:Ju,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>B(t,me(ko(n,s),"float32")),b:()=>B(t,me(nu(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t,e,n,s,r,i,o){const a=R(t,"dy","maxPool3dGrad"),l=R(e,"input","maxPool3dGrad"),c=R(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=V(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=V(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=V(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),E(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),E(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),E(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),as("maxPool3dGrad",i,o);const p={dy:u,input:d,output:h},m={filterSize:s,strides:r,pad:i,dimRoundingMode:o},g=P.runKernel(kx,p,m);return f?V(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const hoe=L({maxPool3dGrad_:doe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const foe={kernelName:kp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>hoe(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function poe(t,e,n,s,r,i,o){const a=R(t,"dy","maxPoolGrad"),l=R(e,"input","maxPoolGrad"),c=R(n,"output","maxPoolGrad");E(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),E(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),E(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),as("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return P.runKernel(Sx,u,d)}const moe=L({maxPoolGrad_:poe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe={kernelName:Sp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>moe(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yoe={kernelName:Cp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=ze(r,s.shape),a=In(s.shape,i)[1],l=se(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const d=V(t,u);return Te(B(d,fs(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xoe={kernelName:Np,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=ze(r,i.shape),l=HB(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const woe={kernelName:Qu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>B(t,me(Ra(n,s),"float32")),b:()=>B(t,me(ls(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const boe={kernelName:Tp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>Ge(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const voe={kernelName:Zu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Fe(n.shape,s.shape);return{a:()=>{const a=on(n.shape,r);return a.length>0?V(ke(t,a),n.shape):t},b:()=>{const a=B(t,mt(Cd(Te(n,s)))),l=on(s.shape,r);return l.length>0?V(ke(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Soe={kernelName:ed,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Fe(n.shape,s.shape);return{a:()=>{const a=B(t,me(s,"float32")),l=on(n.shape,r);return l.length>0?V(ke(a,l),n.shape):a},b:()=>{const a=B(t,me(n,"float32")),l=on(s.shape,r);return l.length>0?V(ke(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const koe={kernelName:Ip,gradFunc:t=>({x:()=>mt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Coe={kernelName:Rp,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Ht(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe={kernelName:Ep,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Toe={kernelName:Ap,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return ar(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GA={kernelName:_p,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>Ge(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ioe={kernelName:td,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=Fe(i.shape,o.shape);return{a:()=>{const u=me(o,"float32");let d=B(t,B(u,Pi(i,Se(u,Ee(1)))));const h=on(i.shape,a);return h.length>0&&(d=ke(d,h)),V(d,i.shape)},b:()=>{const u=ls(i,0),d=Sn(u,zs(i),He(i));let h=B(t,B(r,d));const f=on(o.shape,a);return f.length>0&&(h=ke(h,f)),V(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $oe={kernelName:Dp,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=ls(n,0);return{x:()=>Sn(r,t,B(t,s)),alpha:()=>{let i=Sn(r,He(t),B(t,n));const o=on(s.shape,t.shape);return o.length>0&&(i=ke(i,o)),V(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t,e,n){const s=t.shape.slice();s[n]=1;const r=V(e,s),i=bf(t,n,!0,!1),o=bf(t,n,!0,!0),a=B(i,o);return B(r,a)}function Roe(t,e,n){const s=t.shape.length,r=s-n.length,i=Ft(n,s);let o=t;i!=null&&(o=We(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=o.reshape(a);let d=Eoe(u,e,r);if(d=d.reshape(o.shape),i!=null){const h=Ea(i);d=We(d,h)}return d}const Aoe={kernelName:Op,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>Roe(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _oe={kernelName:Lu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Fe(n.shape,s.shape);return{a:()=>{const a=Te(t,me(s,"float32")),l=on(n.shape,r);return l.length>0?V(ke(a,l),n.shape):a},b:()=>{let a=B(t,me(n,"float32"));const l=on(s.shape,r);l.length>0&&(a=V(ke(a,l),s.shape));const c=at(s);return mt(Te(a,me(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Doe={kernelName:nd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,mt(at(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ooe={kernelName:rd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=B(Ra(n,6),Jl(n));return{x:()=>B(t,me(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Foe={kernelName:sd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,me(Jl(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Poe={kernelName:Fp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Loe={kernelName:Lp,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>P.runKernel(Fx,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Moe={kernelName:Pp,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>P.runKernel(Ox,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Boe={kernelName:Mp,gradFunc:(t,e,n)=>{const{dims:s}=n,r=ze(s,t.shape);return{x:()=>or(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zoe={kernelName:id,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe={kernelName:od,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>mt(Te(t,B(Pi(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const joe={kernelName:Bp,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>me(He(n),"float32"),t:()=>B(t,me(n,t.dtype)),e:()=>B(t,me(im(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uoe={kernelName:ad,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=ls(n,Ee(0)),r=Ee(Vw),i=Ee(jw),o=B(t,i),a=B(B(t,r),ws(me(n,"float32")));return Sn(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Woe={kernelName:dd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(n,Se(Ee(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe={kernelName:ud,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hoe={kernelName:ld,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(em(me(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe={kernelName:cd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(ow(me(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Koe={kernelName:zp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=Bw(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>Co(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xoe={kernelName:Wp,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=B(t,s);return{logits:()=>Se(o,B(ke(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe={kernelName:hd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,Jr(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HA={kernelName:jp,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>Zp(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qA={kernelName:Up,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Kt(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Joe={kernelName:fd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,B(Cn(me(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qoe={kernelName:Wx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,B(me(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe={kernelName:pd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ee(2);return{a:()=>B(t,B(r,Se(n,s))),b:()=>B(t,B(r,Se(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eae={kernelName:wd,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tae={kernelName:md,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Fe(n.shape,s.shape);return{a:()=>{let a=t;const l=on(n.shape,r);return l.length>0&&(a=ke(a,l)),V(a,n.shape)},b:()=>{let a=t;const l=on(s.shape,r);return l.length>0&&(a=ke(a,l)),V(mt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nae={kernelName:Vp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;ze(i,s.shape).forEach(c=>{r[c]=1});const a=V(t,r),l=B(a,fs(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae={kernelName:gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Te(t,at(em(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rae={kernelName:yd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(Se(Ee(1),at(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iae={kernelName:xd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=He(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=ue(o,Ge(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=ue(o,Ge(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=ue(o,Ge(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=ue(o,Ge(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oae={kernelName:ul,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=Ea(r);return{x:()=>We(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aae={kernelName:Hp,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>is(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lae={kernelName:qp,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>cae(t,n)}}};function cae(t,e){const n=Bi(e,He(e)),s=Nd(t,n);let r=ko(e,Ee(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=An(r,a+1);r=Er(r,fs(s.shape,"bool"));const o=He(s);return Sn(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae={kernelName:Kp,gradFunc:t=>({x:()=>He(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dae=[GB,lie,cie,uie,die,hie,fie,pie,mie,gie,yie,xie,vie,Cie,Nie,Tie,Iie,$ie,Eie,Rie,Aie,_ie,Oie,Die,Lie,Mie,Bie,zie,Vie,jie,_oe,Uie,Wie,Gie,Hie,qie,Xie,Kie,Yie,Jie,Qie,Zie,eoe,toe,noe,soe,roe,ioe,ooe,coe,WA,WA,uoe,foe,goe,yoe,xoe,woe,boe,voe,Soe,koe,Coe,Noe,Toe,GA,GA,Ioe,$oe,Aoe,Doe,Ooe,Foe,Poe,Loe,Moe,Boe,zoe,Voe,joe,Uoe,Woe,Goe,Hoe,qoe,Koe,Xoe,Yoe,HA,HA,qA,qA,Joe,Zoe,Qoe,eae,tae,nae,sae,rae,iae,oae,aae,lae,uae];for(const t of dae)g3(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.abs=function(){return this.throwIfDisposed(),en(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.acos=function(){return this.throwIfDisposed(),cN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.acosh=function(){return this.throwIfDisposed(),uN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.add=function(t){return this.throwIfDisposed(),ue(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.all=function(t,e){return this.throwIfDisposed(),sw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.any=function(t,e){return this.throwIfDisposed(),yf(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.argMax=function(t){return this.throwIfDisposed(),Nl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.argMin=function(t){return this.throwIfDisposed(),dN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asScalar=function(){return this.throwIfDisposed(),E(this.size===1,()=>"The array must have only 1 element."),V(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asType=function(t){return this.throwIfDisposed(),me(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as1D=function(){return this.throwIfDisposed(),V(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as2D=function(t,e){return this.throwIfDisposed(),V(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),V(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),V(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),V(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asin=function(){return this.throwIfDisposed(),hN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.asinh=function(){return this.throwIfDisposed(),fN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atan=function(){return this.throwIfDisposed(),pN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atan2=function(t){return this.throwIfDisposed(),mN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.atanh=function(){return this.throwIfDisposed(),gN(this)};oe().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),Qp(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Zp(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),bd(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.broadcastTo=function(t){return this.throwIfDisposed(),dl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cast=function(t){return this.throwIfDisposed(),me(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.ceil=function(){return this.throwIfDisposed(),kN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),xs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Xe&&(t=[t]),Kt([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),rw(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),iw(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),ho(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cos=function(){return this.throwIfDisposed(),em(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cosh=function(){return this.throwIfDisposed(),ow(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),bf(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),aw(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),AN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),vd(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),_N(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.divNoNan=function(t){return this.throwIfDisposed(),DN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.div=function(t){return this.throwIfDisposed(),Te(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.dot=function(t){return this.throwIfDisposed(),ON(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.elu=function(){return this.throwIfDisposed(),Sd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.equal=function(t){return this.throwIfDisposed(),Bs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.erf=function(){return this.throwIfDisposed(),lw(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),PN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.exp=function(){return this.throwIfDisposed(),ws(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.expandDims=function(t){return this.throwIfDisposed(),An(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.expm1=function(){return this.throwIfDisposed(),LN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.fft=function(){return this.throwIfDisposed(),fm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.flatten=function(){return this.throwIfDisposed(),V(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.floor=function(){return this.throwIfDisposed(),Cd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.floorDiv=function(t){return this.throwIfDisposed(),nw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Nd(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.greaterEqual=function(t){return this.throwIfDisposed(),ko(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.greater=function(t){return this.throwIfDisposed(),ls(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.ifft=function(){return this.throwIfDisposed(),ou(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.irfft=function(){return this.throwIfDisposed(),kw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isFinite=function(){return this.throwIfDisposed(),MN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isInf=function(){return this.throwIfDisposed(),BN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.isNaN=function(){return this.throwIfDisposed(),zN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.leakyRelu=function(t){return this.throwIfDisposed(),nm(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.lessEqual=function(t){return this.throwIfDisposed(),Ra(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.less=function(t){return this.throwIfDisposed(),nu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),VN(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSigmoid=function(){return this.throwIfDisposed(),jN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSoftmax=function(t){return this.throwIfDisposed(),dw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),rm(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.log=function(){return this.throwIfDisposed(),zs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.log1p=function(){return this.throwIfDisposed(),sm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Er(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalNot=function(){return this.throwIfDisposed(),im(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalOr=function(t){return this.throwIfDisposed(),hw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.logicalXor=function(t){return this.throwIfDisposed(),UN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Be(this,t,e,n)};oe().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),om(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.max=function(t,e){return this.throwIfDisposed(),rr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.maximum=function(t){return this.throwIfDisposed(),Bi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mean=function(t,e){return this.throwIfDisposed(),At(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.min=function(t,e){return this.throwIfDisposed(),tu(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.minimum=function(t){return this.throwIfDisposed(),fa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),GN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mod=function(t){return this.throwIfDisposed(),HN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.mul=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.neg=function(){return this.throwIfDisposed(),mt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.norm=function(t,e,n){return this.throwIfDisposed(),kd(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.notEqual=function(t){return this.throwIfDisposed(),$l(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),su(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.onesLike=function(){return this.throwIfDisposed(),Vs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.pad=function(t,e){return this.throwIfDisposed(),Co(this,t,e)};oe().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),qN(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.pow=function(t){return this.throwIfDisposed(),Pi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.prelu=function(t){return this.throwIfDisposed(),cm(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.prod=function(t,e){return this.throwIfDisposed(),KN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reciprocal=function(){return this.throwIfDisposed(),r2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.relu=function(){return this.throwIfDisposed(),li(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.relu6=function(){return this.throwIfDisposed(),mw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reshapeAs=function(t){return this.throwIfDisposed(),V(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reshape=function(t){return this.throwIfDisposed(),V(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),KM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),XM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.reverse=function(t){return this.throwIfDisposed(),or(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.rfft=function(){return this.throwIfDisposed(),pm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.round=function(){return this.throwIfDisposed(),gw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.rsqrt=function(){return this.throwIfDisposed(),yw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.selu=function(){return this.throwIfDisposed(),xw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),ww(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sigmoid=function(){return this.throwIfDisposed(),Jr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sign=function(){return this.throwIfDisposed(),i2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sin=function(){return this.throwIfDisposed(),bw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sinh=function(){return this.throwIfDisposed(),vw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.slice=function(t,e){return this.throwIfDisposed(),Ge(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.softmax=function(t){return this.throwIfDisposed(),hm(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.softplus=function(){return this.throwIfDisposed(),Xl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),lm(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.split=function(t,e){return this.throwIfDisposed(),ms(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sqrt=function(){return this.throwIfDisposed(),Cn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.square=function(){return this.throwIfDisposed(),at(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Cw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.squeeze=function(t){return this.throwIfDisposed(),_a(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Xe?[this,t]:[this,...t];return is(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.step=function(t){return this.throwIfDisposed(),Jl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),o2(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sub=function(t){return this.throwIfDisposed(),Se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.sum=function(t,e){return this.throwIfDisposed(),ke(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tan=function(){return this.throwIfDisposed(),a2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tanh=function(){return this.throwIfDisposed(),ha(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.tile=function(t){return this.throwIfDisposed(),Qs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toBool=function(){return this.throwIfDisposed(),me(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toFloat=function(){return this.throwIfDisposed(),me(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.toInt=function(){return this.throwIfDisposed(),me(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.topk=function(t,e){return this.throwIfDisposed(),u2(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.transpose=function(t){return this.throwIfDisposed(),We(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unique=function(t){return this.throwIfDisposed(),d2(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Iw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.unstack=function(t){return this.throwIfDisposed(),ar(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.where=function(t,e){return this.throwIfDisposed(),Sn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oe().prototype.zerosLike=function(){return this.throwIfDisposed(),He(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mi extends Error{constructor(e){super(e),Object.setPrototypeOf(this,mi.prototype)}}class Cr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Cr.prototype)}}class j extends Error{constructor(e){super(e),Object.setPrototypeOf(this,j.prototype)}}class Pe extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Pe.prototype)}}class eT extends Error{constructor(e){super(e),Object.setPrototypeOf(this,eT.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qB{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Al(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function gi(t,e){if(!t)throw new eT(e)}function KA(t,e){let n=0;for(const s of t)s===e&&n++;return n}function ds(t){return t.length===1?t[0]:t}function st(t){return Array.isArray(t)?t:[t]}function Gi(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Ha(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let dr={};function tT(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function NS(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>NS(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:NS(s))}}}function xm(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in dr)o=dr[i];else if(o=e[i],o==null)throw new j(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new j(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in dr?[a,l]=dr.className:o in e&&([a,l]=e[o]),a==null)throw new j(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(dr))c[f]=dr[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const d=Object.assign({},dr);for(const f of Object.keys(n))dr[f]=n[f];NS(i.config);const h=l(a,i.config,n,r);return dr=Object.assign({},d),h}else{const c=Object.assign({},dr);for(const d of Object.keys(n))dr[d]=n[d];const u=new a(i.config);return dr=Object.assign({},c),u}}}function hae(t,e){return t<e?-1:t>e?1:0}function cg(t,e){return-1*hae(t,e)}function na(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function fae(t){if(t==null)throw new j(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Zl(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new j(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function nT(t,e,n=0,s=1/0){return gi(n>=0),gi(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function vn(t,e){Array.isArray(t)?(E(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>vn(n,`element ${s+1} of ${e}`))):E(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${KB(t)}.`)}function KB(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>KB(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function pae(t,e,n){let s=n!=null?n():Rn(),r;return(...o)=>{const a=n!=null?n():Rn();return a-s<e||(s=a,r=t(...o)),r}}function XB(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let mae=0;function YB(){return mae++}const ug={};function Uw(t=""){return t in ug||(ug[t]=0),ug[t]+=1,t+ug[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const gae=["channelsFirst","channelsLast"],yae=["nearest","bilinear"],xae=["valid","same","causal"],wae=["max","avg"],bae=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ac=new Map;function Jt(t){Zl(gae,"DataFormat",t)}function vae(t){Zl(yae,"InterpolationFormat",t)}function ur(t){Zl(xae,"PaddingMode",t)}function JB(t){Zl(wae,"PoolMode",t)}const Ph=[],XA="/";function hl(t,e){Ph.push(t);try{const n=e();return Ph.pop(),n}catch(n){throw Ph.pop(),n}}function Sae(){return Ph.length===0?"":Ph.join(XA)+XA}function QB(t){if(!ez(t))throw new Error("Not a valid tensor name: '"+t+"'");return Sae()+t}function ZB(t){if(!ez(t))throw new Error("Not a valid tensor name: '"+t+"'");ac.has(t)||ac.set(t,0);const e=ac.get(t);if(ac.set(t,ac.get(t)+1),e>0){const n=`${t}_${e}`;return ac.set(n,1),n}else return t}const kae=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function ez(t){return!!t.match(kae)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cae(t){return t===parseInt(t.toString(),10)}function sa(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function au(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function pa(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ti(t,e){if(e<t)throw new j(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let g1;function hn(){return g1==null&&(g1=sN().epsilon()),g1}function ni(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ai(t,e){return me(t,e)}function wm(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),V(t,n)}function Nae(t,e){return G(()=>{if(t.shape.length!==2)throw new j(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=wm(t,1);return TS(n,[1,e,1])})}function Tae(t){const e=[sa(t.shape)];return V(t,e)}function Iae(t){if(t.rank<=1)throw new j(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],sa(t.shape,1)];return V(t,e)}function fl(t,e,n){return G(()=>{switch(t.rank){case 1:return um(t,e,n);case 2:return Sw(t,[e,0],[n,t.shape[1]]);case 3:return dm(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return iu(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Ge(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Ge(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new j(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function y1(t,e,n){return G(()=>{switch(t.rank){case 1:return um(t,e,n);case 2:return Sw(t,[0,e],[t.shape[0],n]);case 3:return dm(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return iu(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new j(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function dg(t,e,n,s){return G(()=>{switch(t.rank){case 1:return um(t,e,n);case 2:switch(s){case 1:return fl(t,e,n);case 2:return y1(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return fl(t,e,n);case 2:return dm(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return y1(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return fl(t,e,n);case 2:return iu(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return iu(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return y1(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}default:throw new j(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function sT(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Kt(t,e)}function YA(t,e){switch(t.rank){case 1:return CN([t,e]);case 2:return NN([t,e],0);case 3:return TN([t,e],0);case 4:return IN([t,e],0);default:throw new j(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function TS(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new j(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Qs(t,e)}function Ww(t,e=0,n=1,s,r){return pw(t,e,n,s,r)}function _i(t,e,n,s){if(t.rank<2||e.rank<2)throw new Pe(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new Pe(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return bS({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?IS(t.rank,s,ni()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=V(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=V(We(e,u),[l,-1]);const d=[...r,...c];return V(bS({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?IS(t.rank,s,ni()):null,activation:n}),d)}}function tz(t,e,n){return G(()=>(Array.isArray(e)?e=On(e,"int32"):e=me(e,"int32"),Nd(t,e,n)))}function bm(t){return B(t,t)}function IS(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new j(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?V(e,[1,s[0],1,1,1]):V(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?V(e,[1,1,1,1,s[0]]):V(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?V(e,[1,s[0],1,1]):V(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?V(e,[1,1,1,s[0]]):V(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?V(e,[1,s[0],1]):V(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?V(e,[1,1,s[0]]):V(e,[1].concat(s))}else if(t<3)return e;throw new j(`Unsupported input rank by biasAdd: ${e.rank}`)}function ci(t,e,n){return G(()=>(n==null&&(n=ni()),Jt(n),ue(t,IS(t.rank,e,n))))}function $ae(t,e=1){if(e!==1)throw new Pe(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Sd(t)}function Eae(t){return G(()=>Te(t,ue(en(t),1)))}function nz(t,e,n,s){return G(()=>p2(t,e,n,s))}function Rae(t){return G(()=>{const e=ue(.5,B(.2,t));return xs(e,0,1)})}function vm(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Aae=["fanIn","fanOut","fanAvg"],_ae=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dae(t){Zl(Aae,"FanMode",t)}function Oae(t){Zl(_ae,"Distribution",t)}class Ar extends Ql{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class rT extends Ar{apply(e,n){return Ht(e,n)}}rT.className="Zeros";he(rT);class Gw extends Ar{apply(e,n){return fs(e,n)}}Gw.className="Ones";he(Gw);class iT extends Ar{constructor(e){if(super(),typeof e!="object")throw new j(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new j(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return G(()=>B(Ee(this.value),fs(e,n)))}getConfig(){return{value:this.value}}}iT.className="Constant";he(iT);class oT extends Ar{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Aa(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}oT.className="RandomUniform";he(oT);class aT extends Ar{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Pe(`randomNormal does not support dType ${n}.`);return Ww(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}aT.className="RandomNormal";he(aT);class lT extends Ar{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Pe(`truncatedNormal does not support dType ${n}.`);return Tw(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}lT.className="TruncatedNormal";he(lT);class cT extends Ar{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return G(()=>{if(e.length!==2||e[0]!==e[1])throw new j("Identity matrix initializer can only be used for 2D square matrices.");return B(this.gain,cw(e[0]))})}getConfig(){return{gain:this.gain}}}cT.className="Identity";he(cT);function Fae(t,e="channelsLast"){let n,s;if(Jt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=sa(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=sa(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=sa(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class bs extends Ar{constructor(e){if(super(),e.scale<0)throw new j(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Dae(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Oae(this.distribution),this.seed=e.seed}apply(e,n){const s=Fae(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Pe(`${this.getClassName()} does not support dType ${n}.`);return Tw(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Aa(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}bs.className="VarianceScaling";he(bs);class Hw extends bs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bs.className}}Hw.className="GlorotUniform";he(Hw);class qw extends bs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bs.className}}qw.className="GlorotNormal";he(qw);class Kw extends bs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bs.className}}Kw.className="HeNormal";he(Kw);class Xw extends bs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bs.className}}Xw.className="HeUniform";he(Xw);class Yw extends bs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return bs.className}}Yw.className="LeCunNormal";he(Yw);class Jw extends bs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return bs.className}}Jw.className="LeCunUniform";he(Jw);class uT extends Ar{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return G(()=>{if(e.length<2)throw new Pe("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=se(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=Ww(o,0,1,n,this.seed),l=x2.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=B(c,d.sign()),s<r&&(c=c.transpose()),B(Ee(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}uT.className="Orthogonal";he(uT);const JA={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function QA(t,e={}){return xm(t,Ys.getMap().classNameMap,e,"initializer")}function Dt(t){return tT(t)}function Ct(t){if(typeof t=="string"){const e=t in JA?JA[t]:t;if(e==="GlorotNormal")return new qw;if(e==="GlorotUniform")return new Hw;if(e==="HeNormal")return new Kw;if(e==="HeUniform")return new Xw;if(e==="LeCunNormal")return new Yw;if(e==="LeCunUniform")return new Jw;{const n={};return n.className=e,n.config={},QA(n)}}else return t instanceof Ar?t:QA(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $S(t){return Array.isArray(t)&&Array.isArray(t[0])}function Yy(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function _e(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new j(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ze(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new j(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jy(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ZA="Variable";class sz{constructor(e,n="float32",s=ZA,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=YB(),s=s??ZA,this.originalName=QB(s),this.name=ZB(this.originalName),this.trainable_=r,this.constraint=i,this.val=h2(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Pae(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Pae(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function ES(t){return t.map(e=>e.read())}function dT(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class si{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=YB(),o!=null&&(this.originalName=QB(o),this.name=ZB(this.originalName)),this.rank=n.length}}let Lae=0;class Qw{constructor(e,n){this.callArgs=n,this.id=Lae++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Mae=0;class Ve extends Ql{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Mae++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=Gi(s)+"_"+Uw(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Cr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new j(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return ds(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return ds(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new mi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new mi(`Layer ${this.name} is not connected, no input to return.`);return ds(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new mi(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new mi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return ds(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=st(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=st(this.inputSpec);if(n.length!==s.length)throw new j(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new j(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),d=o.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=st(e),r=Vae(e),i=jae(e);if(r===i)throw new j("Arguments to apply() must be all SymbolicTensors or all Tensors");return hl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of st(e))o.push(a.shape);this.build(ds(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=st(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=ds(l),this.activityRegularizer!=null)throw new Pe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=Bae(e),a=this.computeOutputShape(o);let l;const c=zae(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new si(c,u,this,st(e),n,this.name,d)):l=new si(c,a,this,st(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Pe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new mi(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new mi(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Cr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Jy(this.weights)}build(e){this.built=!0}getWeights(e=!1){return ES(e?this.trainableWeights:this.weights)}setWeights(e){G(()=>{const n=this.weights;if(n.length!==e.length)throw new j(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=ES(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!Ue(o.shape,l.shape))throw new j(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}dT(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new j(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Ct("zeros"));const c=r.apply(n,s),u=new sz(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=st(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=st(n),o=st(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,s,r,i,o,a=null){const l=st(e);n=st(n),s=st(s),r=st(r),i=Yy(i),o=Yy(o);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new Qw({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Bae(t){t=st(t);const e=[];for(const n of t)e.push(n.shape);return ds(e)}function zae(t){return"float32"}function rz(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=rz(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function Vae(t){let e=!0;for(const n of st(t))if(!(n instanceof si)){e=!1;break}return e}function jae(t){let e=!0;for(const n of st(t))if(n instanceof si){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $d extends Ve{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Uw("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new j("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new j("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new j("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new si(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Qw({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new j(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}$d.className="InputLayer";he($d);function iz(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new j("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new $d({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uae(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return me(e,t.dtype)}catch{throw new j(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Vo{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Vo)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Uae(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new j(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof si){if(this.id2Value[e.id]==null)throw new j(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new j(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof si){if(this.id2Value[e.id]==null)throw new j(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new j(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Oe(this.id2Mask)}}const Qy=new qB,Zy=new qB;function Wae(t){Qy!=null&&Qy.setMaxEntries(t),Zy!=null&&Zy.setMaxEntries(t)}function mh(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let d=Qy.get(u),h;if(d==null){const p=Gae(o,e);d=p.sorted,h=p.recipientCounts,Qy.put(u,d),Zy.put(u,h)}h={},r||Object.assign(h,Zy.get(u));const f=new Vo(e);for(let p=0;p<d.length;++p){const m=d[p],g=m.sourceLayer;if(g instanceof $d)continue;const y=[],x=[],w=[];let b=!1;for(const _ of m.inputs){const D=f.getValue(_),z=f.getMask(_);y.push(D),x.push(z),z!=null&&(b=!0),r||(h[_.name]--,h[_.name]===0&&!e.hasKey(_)&&a.indexOf(_.name)===-1&&!D.isDisposed&&_.sourceLayer.stateful!==!0&&w.push(D))}b&&(n=n||{},n.mask=x[0]);const S=st(g.apply(y,n));let T=null;g.supportsMasking&&(T=g.computeMask(y,x));const I=qae(m),$=Array.isArray(I)?I:[I];for(let _=0;_<$.length;++_){f.hasKey($[_])||f.add($[_],S[_],Array.isArray(T)?T[0]:T);const D=a.indexOf($[_].name);D!==-1&&(l[D]=S[_])}r||Oe(w)}return f.disposeMasks(),i?l:l[0]}function Gae(t,e){E(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=e_(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=e_(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:Hae(s)}}function Hae(t){const e={};for(const n in t)e[n]=t[n].size;return e}function e_(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function qae(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae=K();Kae.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Wae);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hT(t,e){return G(()=>Cn(ke(B(t,t),e,!0)))}class Sm extends Ql{getConfig(){return{}}}class fT extends Sm{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>{const n=hT(e,this.axis),s=xs(n,0,this.maxValue);return B(e,Te(s,ue(hn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}fT.className="MaxNorm";he(fT);class pT extends Sm{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>Te(e,ue(hn(),hT(e,this.axis))))}getConfig(){return{axis:this.axis}}}pT.className="UnitNorm";he(pT);class mT extends Sm{apply(e){return li(e)}}mT.className="NonNeg";he(mT);class gT extends Sm{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return G(()=>{const n=hT(e,this.axis),s=ue(B(this.rate,xs(n,this.minValue,this.maxValue)),B(1-this.rate,n));return B(e,Te(s,ue(hn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}gT.className="MinMaxNorm";he(gT);const t_={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function fn(t){return tT(t)}function n_(t,e={}){return xm(t,Ys.getMap().classNameMap,e,"constraint")}function pn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in t_?t_[t]:t,config:{}};return n_(n)}else return t instanceof Sm?t:n_(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xae(t){return new fT(t)}function Yae(t){return new pT(t)}function Jae(){return new mT}function Qae(t){return new gT(t)}const Zae=Object.freeze(Object.defineProperty({__proto__:null,maxNorm:Xae,minMaxNorm:Qae,nonNeg:Jae,unitNorm:Yae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ele(){return new rT}function tle(){return new Gw}function nle(t){return new iT(t)}function sle(t){return new oT(t)}function rle(t){return new aT(t)}function ile(t){return new lT(t)}function ole(t){return new cT(t)}function ale(t){return new bs(t)}function lle(t){return new Hw(t)}function cle(t){return new qw(t)}function ule(t){return new Kw(t)}function dle(t){return new Xw(t)}function hle(t){return new Yw(t)}function fle(t){return new Jw(t)}function ple(t){return new uT(t)}const mle=Object.freeze(Object.defineProperty({__proto__:null,constant:nle,glorotNormal:cle,glorotUniform:lle,heNormal:ule,heUniform:dle,identity:ole,leCunNormal:hle,leCunUniform:fle,ones:tle,orthogonal:ple,randomNormal:rle,randomUniform:sle,truncatedNormal:ile,varianceScaling:ale,zeros:ele},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Ro(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];Oe(s)}}function oz(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var s_;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(s_||(s_={}));const gle=125;class lu{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class az{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class yle extends lu{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=G(()=>ue(this.totals[r],B(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:G(()=>{const r=B(Te(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),dn(n[s])}))}}class lz extends lu{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class cz extends lu{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||O2,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=gle),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");zy(this.yieldEvery)&&(this.maybeWait=pae(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await Ro(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await Ro(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await Ro(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await Ro(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await Ro(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):zy(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Ro(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Ro(e),await this.trainEnd(e))}}function uz(t,e){return t==null&&(t={}),t instanceof lu?[t]:Array.isArray(t)&&t[0]instanceof lu?t:st(t).map(s=>new cz(s,e))}class qs{constructor(){}static registerCallbackConstructor(e,n){E(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),qs.checkForDuplicate(n),qs.constructors[e]==null&&(qs.constructors[e]=[]),qs.constructors[e].push(n)}static checkForDuplicate(e){for(const n in qs.constructors)qs.constructors[+n].forEach(r=>{if(r===e)throw new j("Duplicate callback constructor.")})}static clear(){qs.constructors={}}static createCallbacks(e){const n=[];for(const s in qs.constructors){const r=+s;e>=r&&n.push(...qs.constructors[r])}return n.map(s=>new s)}}qs.constructors={};function dz(t,e,n,s,r,i,o,a,l){const c=new lz,u=[new yle,...qs.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new az(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qr(t,e={},n=!1){return xm(t,Ys.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function e0(t,e){return G(()=>{t.dtype!=="float32"&&(t=me(t,"float32"));const n=ke(bm(t),e,!0),s=Kl(n.shape,hn()),r=Cn(Bi(n,s));return Te(t,r)})}function ec(t,e){return G(()=>At(bm(Se(e,t)),-1))}function Zw(t,e){return G(()=>At(en(Se(e,t)),-1))}function Ed(t,e){return G(()=>{const n=Se(t,e),s=xs(en(t),hn(),Number.MAX_VALUE),r=en(Te(n,s));return B(100,At(r,-1))})}function xle(t,e){return G(()=>{const n=xs(e,hn(),Number.MAX_VALUE),s=zs(ue(1,n)),r=xs(t,hn(),Number.MAX_VALUE),i=zs(ue(1,r));return At(bm(Se(s,i)),-1)})}function wle(t,e){return G(()=>{const n=Bi(0,Se(1,B(t,e)));return At(bm(n),-1)})}function ble(t,e){return G(()=>{const n=Bi(0,Se(1,B(t,e)));return At(n,-1)})}function vle(t,e){return G(()=>{const n=ke(B(t,e),-1),s=rr(B(Se(1,t),e),-1);return Bi(0,ue(1,Se(s,n)))})}function Sle(t,e){return G(()=>{const n=Math.log(2),s=Se(e,t),r=Se(ue(s,Xl(B(-2,s))),n);return At(r,-1)})}function vf(t,e,n=!1){return G(()=>{if(n)e=hm(e);else{const s=ke(e,e.shape.length-1,!0);e=Te(e,s)}return e=xs(e,hn(),1-hn()),mt(ke(B(me(t,"float32"),zs(e)),e.shape.length-1))})}function t0(t,e,n=!1){return G(()=>{const s=me(Cd(Tae(t)),"int32");e=xs(e,hn(),1-hn());const r=e.shape,i=V(su(s,r[r.length-1]),r);return vf(i,e,n)})}function kle(t,e){if(!Ue(t.shape,e.shape))throw new j(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return G(()=>{const n=li(e),s=mt(en(e));return ue(Se(n,B(e,t)),sm(ws(s)))})}function eb(t,e){return G(()=>{let n;return n=xs(e,hn(),1-hn()),n=zs(Te(n,Se(1,n))),At(kle(t,n),-1)})}function Cle(t,e){return G(()=>{const n=xs(t,hn(),1),s=xs(e,hn(),1);return ke(B(t,zs(Te(n,s))),-1)})}function Nle(t,e){return G(()=>{const n=zs(ue(hn(),e));return At(Se(e,B(t,n)),-1)})}function yT(t,e){return G(()=>{const n=e0(t,-1),s=e0(e,-1),r=B(n,s);return mt(ke(r,-1))})}const n0={meanSquaredError:ec,meanAbsoluteError:Zw,meanAbsolutePercentageError:Ed,meanSquaredLogarithmicError:xle,squaredHinge:wle,hinge:ble,categoricalHinge:vle,logcosh:Sle,categoricalCrossentropy:vf,sparseCategoricalCrossentropy:t0,binaryCrossentropy:eb,kullbackLeiblerDivergence:Cle,poisson:Nle,cosineProximity:yT};function x1(t){if(typeof t=="string"){if(t in n0)return n0[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new j(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xT(t,e){return G(()=>{const n=B(.5,Vs(e)),s=Ai(ls(e,n),t.dtype);return At(Bs(t,s),-1)})}function wT(t,e){return G(()=>Ai(Bs(Nl(t,-1),Nl(e,-1)),"float32"))}function hz(t,e){return G(()=>me(ke(Er(Bs(t,1),Bs(e,1))),"float32"))}function Tle(t,e){return G(()=>me(ke(Er(Bs(t,1),Bs(e,0))),"float32"))}function Ile(t,e){return G(()=>me(ke(Er(Bs(t,0),Bs(e,1))),"float32"))}function fz(t,e){return G(()=>{const n=hz(t,e),s=Ile(t,e),r=ue(n,s);return me(Sn(ls(r,0),Te(n,r),0),"float32")})}function $le(t,e){return G(()=>{const n=hz(t,e),s=Tle(t,e),r=ue(n,s);return me(Sn(ls(r,0),Te(n,r),0),"float32")})}function pz(t,e){return eb(t,e)}function mz(t,e){return t.rank===e.rank&&(t=_a(t,[t.rank-1])),e=Nl(e,-1),e.dtype!==t.dtype&&(e=me(e,t.dtype)),me(Bs(t,e),"float32")}function Ele(t,e){return G(()=>{const n=t.sub(e).square().sum(),s=t.sub(t.mean()).square().sum();return Ee(1).sub(n.div(s))})}const Rle=ec,Ale=ec,_le=Zw,Dle=Zw,Ole=Ed,Fle=Ed,bT=vf,Ple=yT,gz=t0,s0={binaryAccuracy:xT,categoricalAccuracy:wT,precision:fz,categoricalCrossentropy:bT,sparseCategoricalCrossentropy:gz,mse:Rle,MSE:Ale,mae:_le,MAE:Dle,mape:Ole,MAPE:Fle,cosine:Ple};function Lle(t){if(typeof t=="string"&&t in s0)return s0[t];if(typeof t!="string"&&t!=null)return t;throw new j(`Unknown metric ${t}`)}function hg(t){if(gi(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(n0))if(n0[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(s0))if(s0[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mle(t){const e={Adagrad:()=>Ua.adagrad(.01),Adadelta:()=>Ua.adadelta(1,.95,hn()),Adam:()=>Ua.adam(.001,.9,.999,hn()),Adamax:()=>Ua.adamax(.002,.9,.999,hn(),0),RMSProp:()=>Ua.rmsprop(.001,.9,0,hn()),SGD:()=>Ua.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new j(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const r_=1*1024*1024;function i_(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!RS(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>r_&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${r_}.`)}}function RS(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!RS(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!RS(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ble(t,e,n,s=console.log){const r=Vle(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),r0(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?jle(a[u],n,s):Ule(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=zle(t),c=Jy(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function zle(t){let e;return t.collectedTrainableWeights!=null?e=Jy(t.collectedTrainableWeights):e=Jy(t.trainableWeights),e}function Vle(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function r0(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function jle(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];r0(a,e,n)}function Ule(t,e,n,s){let r,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];o.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];r0(u,e,s);for(let d=1;d<o.length;++d)r0(["","","","",o[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yz(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Sf(t,e){if(t===null)return null;if(typeof t=="string")return Ha(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];yz(e,r,i)?n.push(i):n.push(Sf(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=Ha(s);n[i]=Sf(r,i)}}return n}}function AS(t,e){if(t==null)return null;if(typeof t=="string")return Gi(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];yz(e,r,i)?n.push(i):n.push(AS(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=Gi(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=AS(r,s)}return n}}/** @license See the LICENSE file. */const tb="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Wle=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Br extends Ve{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const x=this.getClassName().toLowerCase();this.name=Uw(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],na(this.inputs).length!==this.inputs.length)throw new j(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);na(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const w=x.sourceLayer,b=x.nodeIndex,S=x.tensorIndex;this.outputLayers.push(w),this.outputLayersNodeIndices.push(b),this.outputLayersTensorIndices.push(S)}for(const x of this.inputs){const w=x.sourceLayer,b=x.nodeIndex,S=x.tensorIndex;gi(b===0,"input layer has >1 nodes"),gi(S===0,"input layer has >1 tensors"),this.inputLayers.push(w),this.inputLayersNodeIndices.push(b),this.inputLayersTensorIndices.push(S)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const w=this.inputLayers[x];if(!(w instanceof $d))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${x} (0-based) originates from layer type ${w.getClassName()}.`);this.inputNames.push(w.name),this.feedInputShapes.push(w.batchInputShape),this.feedInputNames.push(w.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);const n={},s={},r={},i={},o={},a=[],l=(x,w,b,S,T,I)=>{(S==null||T==null||I==null)&&(S=x.sourceLayer,T=x.nodeIndex,I=x.tensorIndex);const $=S.inboundNodes[T];if(b.indexOf($)!==-1)throw new Cr(`The tensor ${x.name} at layer "${S.name}" is part of a cycle.`);if(w.indexOf($)!==-1)return;this.containerNodes.add(Br.nodeKey(S,T)),S.id in o||(o[S.id]=Object.keys(o).length),b.indexOf($)===-1&&b.push($);const _=$.inboundLayers.length;for(let D=0;D<_;D++){const z=$.inputTensors[D],H=$.inboundLayers[D],X=$.nodeIndices[D],Y=$.tensorIndices[D];l(z,w,b,H,X,Y)}for(w.push($);b.indexOf($)>=0;)b.splice(b.indexOf($),1);a.push($)},c=[],u=[];for(const x of this.outputs)l(x,c,u);const d=a.slice().reverse();for(const x of d){s[x.id]=x,x.id in n||(n[x.id]=0);let w=n[x.id];const b=r[x.outboundLayer.id]==null?0:r[x.outboundLayer.id];w=Math.max(w,b),r[x.outboundLayer.id]=w,i[x.outboundLayer.id]=x.outboundLayer,n[x.id]=w;for(let S=0;S<x.inboundLayers.length;S++){const T=x.inboundLayers[S],I=x.nodeIndices[S],$=T.inboundNodes[I],_=n[$.id]==null?0:n[$.id];n[$.id]=Math.max(w+1,_),s[$.id]=$}}const h={};for(const x in n){const w=n[x];w in h||(h[w]=[]),h[w].push(s[x])}const f={};for(const x in r){const w=r[x];w in f||(f[w]=[]),f[w].push(i[x])}let p=Object.keys(f).map(x=>parseInt(x,10)).sort(cg);this.layers=[];for(const x of p){const w=f[x];w.sort((b,S)=>{const T=o[b.id],I=o[S.id];return T<I?-1:T>I?1:0});for(const b of w)b instanceof Br&&this.internalContainerRefs.push(b),this.layers.push(b)}this.layersByDepth=f,p=Object.keys(h).map(x=>parseInt(x,10)).sort(cg);const m=this.inputs.slice(),g=[];for(const x of p)for(const w of h[x]){const b=w.outboundLayer;if(b!=null){for(const S of w.inputTensors)if(m.indexOf(S)===-1)throw new Cr(`Graph disconnected: cannot obtain value for tensor ${S} at layer "${b.name}". The following previous layers were accessed without issue: ${g}`);for(const S of w.outputTensors)m.push(S);g.push(b.name)}}this.nodesByDepth=h;const y=this.layers.map(x=>x.name);for(const x of y){const w=y.filter(b=>b===x).length;if(w!==1)throw new Cr(`The name "${x}" is used ${w} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new Qw({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new j("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const i=Wle(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new j(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(n)throw new j(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new j(`${a.length} of ${r} weights are not set: ${a}`)}dT(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${tb}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=AS(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return G(()=>{e=st(e);const s=new Vo;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return mh(this.outputs,s,n)})}computeMask(e,n){return G(()=>{e=st(e);let s;return n==null?s=Al(null,e.length):s=st(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=Yy(e);if(n.length!==this.inputLayers.length)throw new j(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(cg);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const g=c.inboundLayers[m],y=c.nodeIndices[m],x=c.tensorIndices[m],w=`${g.name}_${y}_${x}`,b=s[w];d.push(b)}const h=u.computeOutputShape(ds(d)),f=Yy(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const g=`${u.name}_${p}_${m}`;s[g]=f[m]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];gi(l in s),i.push(s[l])}return ds(i)}runInternalGraph(e,n){n==null&&(n=Al(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(cg);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in s&&p.push(s[m.id]);if(p.length===h.length){let m={},g,y,x,w;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[b,S]=p[0];m.mask==null&&(m.mask=S),x=st(d.call(b,m)),w=st(d.computeMask(b,S)),g=[b],y=[S]}else g=p.map(b=>b[0]),y=p.map(b=>b[1]),m.mask==null&&(m.mask=y),x=st(d.call(g,m)),w=st(d.computeMask(g,y));if(d.activityRegularizer)throw new Pe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let b=0;b<f.length;++b){const S=f[b],T=x[b],I=w[b];s[S.id]=[T,I]}}}}const i=[],o=[],a=[];for(const l of this.outputs){gi(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Br?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=Br.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new j("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new j(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new j(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return G(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Br.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],f=Br.nodeKey(o,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let g=0;g<h.inboundLayers.length;g++){const y=h.inboundLayers[g],x=h.nodeIndices[g],w=h.tensorIndices[g],b=Br.nodeKey(y,x);let S=n[b];S==null&&(S=0),m.push([y.name,S,w,p])}c.push(m)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Br.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[o];r.push([a.name,u,d])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Br.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(g,y){g.name in o?o[g.name].push(y):o[g.name]=[y]}function l(g,y){const x=[];let w;for(const b of y){const S=b[0],T=b[1],I=b[2];if(w=b[3]==null?{}:b[3],!(S in i)){a(g,y);return}const $=i[S];if($.inboundNodes.length<=T){a(g,y);return}const _=$.inboundNodes[T];x.push(_.outputTensors[I])}x.length>0&&g.apply(ds(x),w)}function c(g){const y=g.name,x=Qr(g,n.customObjects!=null?n.customObjects:{});x.setFastWeightInitDuringBuild(r),i[y]=x,g.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new j(`Corrupted configuration, expected array for nodeData: ${b}`);a(x,b)})}const u=n.name,d=n.layers;for(const g of d)c(g);for(;!fae(o);)for(const g of d){const y=i[g.name];if(y.name in o){const x=o[y.name];delete o[y.name];for(const w of x)l(y,w)}}const h=[],f=[],p=n.inputLayers;for(const g of p){const y=g[0],x=g[1],w=g[2];gi(y in i);const S=i[y].inboundNodes[x].outputTensors;h.push(S[w])}const m=n.outputLayers;for(const g of m){const y=g[0],x=g[1],w=g[2];gi(y in i);const S=i[y].inboundNodes[x].outputTensors;f.push(S[w])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new j("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){G(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gle(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function xz(t,e){return Gle(t,e,"classWeight")}async function wz(t,e,n,s){if(n!=null){const r=G(()=>{if(t.shape.length===1)return Ei(t);if(t.shape.length===2){if(t.shape[1]>1)return Nl(t,1);if(t.shape[1]===1)return V(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());Oe(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),On(o,"float32")}else return null}function Hle(t,e){return B(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const qle=32;function bz(t,e){let n,s;const r=e;n=r.xs,s=r.ys,E(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=o_("input",t.inputNames,n),o=o_("output",t.outputNames,s),a=i[0].shape[0];E(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),E(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)E(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)E(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function o_(t,e,n){if(n instanceof Xe)return[n];if(Array.isArray(n))return E(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new j(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function Kle(t){if(t.length===3)throw new Pe("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Xle(t,e,n){const s=n.batchesPerEpoch!=null;if(E(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),E(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),E(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),E(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),E(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(a_(n.validationData))E(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=Kle(n.validationData);i=g.xs,o=g.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();const u=uz(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=dz(u,d,n.epochs,null,null,Yle(e,n),null,r,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const g={};await h.onEpochBegin(p);let y=0,x=0;for(s||(m=await e.iterator());!s||y<n.batchesPerEpoch;){const w=await m.next();if(s&&w.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(w.value!=null){const{xs:b,ys:S}=bz(t,w.value),T={};T.batch=x,T.size=b[0].shape[0],await h.onBatchBegin(x,T);const I=[];if(n.classWeight!=null){const D=xz(n.classWeight,t.outputNames);for(let z=0;z<D.length;++z)I.push(await wz(S[z],null,D[z]))}const $=b.concat(S).concat(I),_=a($);Oe($);for(let D=0;D<l.length;++D){const z=l[D],H=_[D];T[z]=H,dn(H)}await h.onBatchEnd(x,T),oz(T),x++,y++}if(s?y>=n.batchesPerEpoch:w.done){if(r){let b;a_(n.validationData)?b=st(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):b=st(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?qle:n.validationBatchSize,verbose:0}));for(let S=0;S<t.metricsNames.length;++S)g[`val_${t.metricsNames[S]}`]=b[S]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,g),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Yle(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function a_(t){return typeof t.iterator=="function"}function Jle(t){return typeof t.next=="function"}async function Qle(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new Pe("Verbose mode is not implemented yet.");E(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=Jle(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=G(()=>{if(c.value){const{xs:u,ys:d}=bz(t,c.value),h=u.concat(d),f=G(()=>r(h));if(Oe(h),l===0)for(let m=0;m<f.length;++m)i.push(Ee(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const g=f[m],y=i[m];i[m]=G(()=>ue(i[m],B(p,g))),l>0&&Oe(y)}Oe(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=Te(i[c],a),Oe(u)}return ds(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function w1(t){E(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function sh(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>fl(s,e,n-e)):fl(t,e,n-e)}function _S(t,e){return G(()=>t==null?null:Array.isArray(t)?t.map(n=>_S(n,e)):tz(t,e.dtype==="int32"?e:me(e,"int32")))}function b1(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function vz(t){const e=[];t instanceof Xe&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(wm(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Lr(t,e){if(t==null)return;const n=[];if(e instanceof Xe)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof Xe)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zle(t){return t instanceof Xe}function DS(t){return Array.isArray(t)}function l_(t){return!Zle(t)&&!DS(t)}function c_(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(DS(t)&&t.length>0)o=!0;else if(l_(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new j(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(l_(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new j(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(DS(t)){if(t=t,t.length!==e.length)throw new j(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new j(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=vz(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new j(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new j(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function ece(t,e,n){const s=na(t.map(i=>i.shape[0]));s.sort();const r=na(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new j(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new j(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!Ue(s,r))throw new j(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function tce(t,e,n){const s=[ec,eb,vf];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===vf&&i.shape[i.shape.length-1]===1)throw new j(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new j(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function u_(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new j(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new j(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new j(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new j(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function nce(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const sce="layers-model";class Zi extends Br{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new j("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Ble(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Mle(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof To))throw new j("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new j(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(x1(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new j(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>x1(a))}else{const o=x1(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],hl("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=nce(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};hl("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[o];g[g.length-1]===1||this.lossFunctions[o]===eb?["accuracy","acc"].indexOf(p)!==-1?h=xT:["crossentropy","ce"].indexOf(p)!==-1&&(h=pz):this.lossFunctions[o]===t0?["accuracy","acc"].indexOf(p)!==-1?h=mz:["crossentropy","ce"].indexOf(p)!==-1&&(h=gz):["accuracy","acc"].indexOf(p)!==-1?h=wT:["crossentropy","ce"].indexOf(p)!==-1&&(h=bT);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),f=h,d=u+y}else f=Lle(p),d=u+hg(p);let m;hl(d,()=>{m=f}),i(o,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;w1(r);const o=this.standardizeUserDataXY(e,n,!0,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return ds(c)}finally{Lr(o[0],e),Lr(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Qle(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new j(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new j(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new j("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new Vo;if(e instanceof Xe&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new j(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new j(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=mh(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=Al(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new j(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return G(()=>{const r=this.checkNumSamples(e);if(s)throw new Pe("Verbose predictLoop() is not implemented yet.");const i=b1(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)G(()=>{const c=i[a][0],u=i[a][1],d=sh(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new Vo(h);return mh(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return ds(o.map(a=>Kt(a,0)))})}predict(e,n={}){const s=vz(e);u_(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return w1(r),this.predictLoop(s,r)}finally{Lr(s,e)}}predictOnBatch(e){u_(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Cr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===t0?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=c_(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=c_(n,this.feedOutputNames,i,!1,"target"),ece(e,n),tce(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new j(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=xz(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await wz(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return G(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new Pe("Verbose mode is not implemented yet.");if(i!=null)throw new Pe("steps mode in testLoop() is not implemented yet");{const l=b1(o,s),c=On(ti(0,o));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=fl(c,d,h-d),p=_S(n,f),m=e(p);if(u===0)for(let g=0;g<m.length;++g)a.push(Ee(0));for(let g=0;g<m.length;++g){const y=m[g];a[g]=ue(a[g],B(h-d,y))}}for(let u=0;u<a.length;++u)a[u]=Te(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(KA(e,r)>1){const o=KA(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const h=new Vo(d),f=mh(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let y=g(r[m],f[m]);i[m]!=null&&(y=Hle(y,i[m]));const x=At(y);n.push(x),m===0?p=y:p=ue(p,y)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const y=this.metricsTensors[m][0],x=this.metricsTensors[m][1];g=At(y(r[x],f[x]))}dn(g),o.push(g)}return p=At(p),this.calculateLosses().forEach(m=>{p=ue(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>G(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new Vo(o),l=mh(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=At(u(i[c],l[c]));c===0?s=d:s=ue(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=At(u(i[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,d,h;try{const f=s.batchSize==null?32:s.batchSize;w1(f);const m=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,f);r=m[0],i=m[1],h=m[2];let g=!1,y;if(s.validationData!=null&&s.validationData.length>0){if(g=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Pe("validationData including sample weights is not supported yet."):new j(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const D=await this.standardizeUserData(l,c,null,null,!0,f);u=D[0],d=D[1],y=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){g=!0;const _=Math.floor(r[0].shape[0]*(1-s.validationSplit)),D=r[0].shape[0];u=sh(r,_,D),o=r,r=sh(r,0,_),d=sh(i,_,D),a=i,i=sh(i,0,_),y=u.concat(d)}else s.validationSteps!=null&&(g=!0);const x=r.concat(i).concat(h);this.checkTrainableWeightsConsistency();const w=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let S,T;g?(this.makeTestFunction(),S=this.testFunction,T=b.slice().concat(b.map(_=>"val_"+_))):(S=null,y=[],T=b.slice());const I=uz(s.callbacks,s.yieldEvery);return await this.fitLoop(w,x,b,f,s.epochs,s.verbose,I,S,y,s.shuffle,T,s.initialEpoch,null,null)}finally{this.isTraining=!1,Lr(r,e),Lr(i,n),Lr(o,e),Lr(a,n),Lr(u,l),Lr(d,c),h!=null&&Oe(h)}}async fitLoop(e,n,s,r,i,o,a,l,c,u,d,h,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new j("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(n,r,f,"steps_per_epoch");let y;g!=null&&(y=ti(0,g)),o==null&&(o=1);const{callbackList:x,history:w}=dz(a,o,i,h,g,f,r,m,d);x.setModel(this),this.history=w,await x.onTrainBegin(),this.stopTraining_=!1;for(let b=h;b<i;++b){await x.onEpochBegin(b);const S={};if(f!=null)throw new Pe("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Pe("batch shuffling is not implemneted yet");u&&GC(y);const T=On(y),I=b1(g,r);for(let $=0;$<I.length;++$){const _={};if(await x.onBatchBegin($,_),G(()=>{const D=I[$][0],z=I[$][1],H=fl(T,D,z-D);_.batch=$,_.size=z-D;const X=_S(n,H),Y=e(X);for(let J=0;J<s.length;++J){const Q=s[J],ee=Y[J];_[Q]=ee,dn(ee)}if($===I.length-1&&m){const J=this.testLoop(l,c,r);for(let Q=0;Q<s.length;++Q){const ee=s[Q],M=J[Q];dn(M),S["val_"+ee]=M}}}),await x.onBatchEnd($,_),oz(_),this.stopTraining_)break}T.dispose()}if(await x.onEpochEnd(b,S),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return Xle(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Oe(a),Lr(s[0],e),Lr(s[1],n),ds(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=fS().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-fS().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Gi(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Gi(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=Gi(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Gi(hg(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Gi(hg(e)));{const e={};for(const n in this.metrics)e[n]=Gi(hg(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Sf(e.optimizer_config),s=Qr(n);let r;if(typeof e.loss=="string")r=Ha(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>Ha(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=Ha(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>Ha(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=Ha(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=z3(e);if(c.length===0)throw new j(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new j(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new j("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await pS(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:sce,generatedBy:`TensorFlow.js tfjs-layers v${tb}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await pS(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=M3([s.data,u])}return this.userDefinedMetadata!=null&&(i_(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){i_(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Zi.className="Model";he(Zi);class Sz extends Zi{}Sz.className="Functional";he(Sz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function rce(t,e){"modelTopology"in t||(t={modelTopology:t}),t=t;let n=t.modelTopology;n.model_config!=null&&(n=n.model_config);const s=Sf(n),r=Qr(s,e);if(t.weightsManifest!=null){const i=await nB(t.weightsManifest,t.pathPrefix,r.weights.map(a=>a.originalName)),o={};for(const a of r.weights)o[a.originalName]=i[a.originalName];r.loadWeights(o),Oe(i)}return r}async function kz(t,e){if(e==null&&(e={}),typeof t=="string"){const n=V3(t,e);if(n.length===0)n.push(iB(t,e));else if(n.length>1)throw new j(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return ice(t,void 0,e)}async function ice(t,e,n){if(n==null&&(n={}),t.load==null)throw new j("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const i=n.strict==null?!0:n.strict,o=s.weightData!=null&&s.weightSpecs!=null&&i,a=Qr(Sf(r),e,o),l=s.trainingConfig;if(l!=null&&a.loadTrainingConfig(l),s.userDefinedMetadata!=null&&a.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new j("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:u}=oce(s.weightData,s.weightSpecs);a.loadWeights(c,i),a.optimizer!=null&&u.length>0&&await a.optimizer.setWeights(u),Oe(c),Oe(u.map(d=>d.tensor))}return a}function oce(t,e){const n=rN(t,e),s={},r=[];return e.forEach(i=>{i.group==="optimizer"?r.push({name:i.name,tensor:n[i.name]}):s[i.name]=n[i.name]}),{modelWeights:s,optimizerWeights:r}}class _l extends Zi{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Uw("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new j(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof _l||e instanceof Zi;let s;if(n){if(s=e,s.outputs.length!==1)throw new j("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new j("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new j("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=iz({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new j(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new j("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=rz(this.outputs[0])}this.inboundNodes=[],new Qw({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Al(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ze(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Zi({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Cr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Cr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Cr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Cr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new j("Legacy serialization format not supported yet.");i=n}else E(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof _l))throw new Pe(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=Qr(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new j("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new j("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}_l.className="Sequential";he(_l);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cz(t){return new Zi(t)}function ace(t){return new _l(t)}function Nz(t){return iz(t)}function lce(t,e){qs.registerCallbackConstructor(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let qn=class extends Ql{getConfig(){return{}}};class Tz extends qn{apply(e,n=1){return $ae(e,n)}}Tz.className="elu";he(Tz);class Iz extends qn{apply(e){return xw(e)}}Iz.className="selu";he(Iz);class $z extends qn{apply(e){return li(e)}}$z.className="relu";he($z);class Ez extends qn{apply(e){return G(()=>fa(6,li(e)))}}Ez.className="relu6";he(Ez);class Rz extends qn{apply(e){return e}}Rz.className="linear";he(Rz);class Az extends qn{apply(e){return Jr(e)}}Az.className="sigmoid";he(Az);class _z extends qn{apply(e){return Rae(e)}}_z.className="hardSigmoid";he(_z);class Dz extends qn{apply(e){return Xl(e)}}Dz.className="softplus";he(Dz);class Oz extends qn{apply(e){return Eae(e)}}Oz.className="softsign";he(Oz);class Fz extends qn{apply(e){return ha(e)}}Fz.className="tanh";he(Fz);let vT=class extends qn{apply(e,n=-1){return hm(e,n)}};vT.className="softmax";he(vT);class Pz extends qn{apply(e,n=-1){return dw(e,n)}}Pz.className="logSoftmax";he(Pz);class Lz extends qn{apply(e){return G(()=>G(()=>{const n=Math.sqrt(2),s=B(.5,ue(1,lw(Te(e,n))));return B(e,s)}))}}Lz.className="gelu";he(Lz);class Mz extends qn{apply(e){return G(()=>B(.5,B(e,ue(1,ha(B(Cn(Te(2,Math.PI)),ue(e,B(.044715,Pi(e,3)))))))))}}Mz.className="gelu_new";he(Mz);class Bz extends qn{apply(e){return G(()=>B(e,ha(Xl(e))))}}Bz.className="mish";he(Bz);class zz extends qn{apply(e,n=1){return G(()=>B(Jr(B(e,n)),e))}}zz.className="swish";he(zz);function ma(t){return t.getClassName()}function v1(t,e={}){return xm(t,Ys.getMap().classNameMap,e,"activation")}function ga(t){if(t==null){const e={};return e.className="linear",e.config={},v1(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},v1(e)}else return t instanceof qn?t:v1(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ST(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class Vz extends Ql{}class km extends Vz{constructor(e){super(),ST(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return G(()=>{let n=Ht([1]);return this.hasL1&&(n=ue(n,ke(B(this.l1,en(e))))),this.hasL2&&(n=ue(n,ke(B(this.l2,bm(e))))),V(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}km.className="L1L2";he(km);function cce(t){return ST(t),new km({l1:t!=null?t.l1:null,l2:0})}function uce(t){return ST(t),new km({l2:t!=null?t.l2:null,l1:0})}const d_={l1l2:"L1L2"};function dt(t){return tT(t)}function h_(t,e={}){return xm(t,Ys.getMap().classNameMap,e,"regularizer")}function Nt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in d_?d_[t]:t,config:{}};return h_(n)}else return t instanceof Vz?t:h_(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kT extends Ve{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=_e(e);let s=li(e);return this.maxValue!=null&&(s=xs(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}kT.className="ReLU";he(kT);class CT extends Ve{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=_e(e);return nm(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}CT.className="LeakyReLU";he(CT);class NT extends Ve{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Ct(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Nt(e.alphaRegularizer),this.alphaConstraint=pn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new j(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ze(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new nn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=_e(e),cm(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Dt(this.alphaInitializer),alphaRegularizer:dt(this.alphaRegularizer),alphaConstraint:fn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}NT.className="PReLU";he(NT);let TT=class extends Ve{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Pe(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=_e(e);return Sd(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};TT.className="ELU";he(TT);class IT extends Ve{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=_e(e);return B(s,me(ls(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}IT.className="ThresholdedReLU";he(IT);class $T extends Ve{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new vT().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return G(()=>{let s=_e(e);const r=n.mask;if(r!=null){const i=B(Se(fs(s.shape),me(r,s.dtype)),Ee(-1e9));s=ue(s,i)}return this.axis instanceof Array?this.axis.length>1?ws(Se(s,rm(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}$T.className="Softmax";he($T);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zc(t,e,n){if(typeof t=="number")return Al(t,e);if(t.length!==e)throw new j(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!Cae(r))throw new j(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function Zr(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function yi(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+pa([n-e,0]);else if(s==="same")t=t*e;else throw new j(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ET(t,e){return G(()=>(Jt(e),e==="channelsFirst"?We(t,[0,2,3,1]):t))}function jz(t,e){return G(()=>(Jt(e),e==="channelsFirst"?We(t,[0,2,3,4,1]):t))}function dce(t,e,n,s=1,r="valid",i,o=1){return G(()=>{if(i==null&&(i=ni()),Jt(i),t.shape.length!==3)throw new j(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new j(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new j(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=We(t,[0,2,1])),r==="causal")throw new Pe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=rw(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=ci(a,n)),a})}function f_(t,e,n,s=[1,1],r="valid",i,o,a=null){return G(()=>{if(i==null&&(i=ni()),Jt(i),t.rank!==3&&t.rank!==4)throw new j(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new j(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=ET(t,i);if(r==="causal")throw new Pe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=jM({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=We(l,[0,3,1,2])),l})}function hce(t,e,n,s=[1,1,1],r="valid",i,o){return G(()=>{if(i==null&&(i=ni()),Jt(i),t.rank!==4&&t.rank!==5)throw new j(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new j(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=jz(t,i);if(r==="causal")throw new Pe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=EN(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=ci(a,n)),i==="channelsFirst"&&(a=We(a,[0,4,1,2,3])),a})}class nb extends Ve{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",nb.verifyArgs(n),this.rank=e,vn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Pe(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=zc(n.kernelSize,e,"kernelSize"),this.strides=zc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,ur(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Jt(this.dataFormat),this.activation=ga(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Ct(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=pn(n.biasConstraint),this.biasRegularizer=Nt(n.biasRegularizer),this.activityRegularizer=Nt(n.activityRegularizer),this.dilationRate=zc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new j(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new j(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new j(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(gi("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!nT(e.kernelSize,"number",1,3))throw new j(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:ma(this.activation),useBias:this.useBias,biasInitializer:Dt(this.biasInitializer),biasRegularizer:dt(this.biasRegularizer),activityRegularizer:dt(this.activityRegularizer),biasConstraint:fn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Rd extends nb{constructor(e,n){super(e,n),this.kernel=null,Rd.verifyArgs(n),this.filters=n.filters,vn(this.filters,"filters"),this.kernelInitializer=Ct(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=pn(n.kernelConstraint),this.kernelRegularizer=Nt(n.kernelRegularizer)}build(e){e=Ze(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return G(()=>{e=_e(e);let s;const r=this.bias==null?null:this.bias.read(),i=XB(this.activation.getClassName());if(i!=null&&this.rank===2)s=f_(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=dce(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=f_(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=hce(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Pe("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Ze(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=Zr(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Dt(this.kernelInitializer),kernelRegularizer:dt(this.kernelRegularizer),kernelConstraint:fn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new j(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Ad extends Rd{constructor(e){super(2,e),Ad.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!nT(e.kernelSize,"number",1,2))throw new j(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Ad.className="Conv2D";he(Ad);class _d extends Rd{constructor(e){super(3,e),_d.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new j(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}_d.className="Conv3D";he(_d);class RT extends Ad{constructor(e){if(super(e),this.inputSpec=[new nn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new j(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ze(e),e.length!==4)throw new j("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new nn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return G(()=>{let s=_e(e);if(s.shape.length!==4)throw new j(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=yi(l,h,u,this.padding),m=yi(c,f,d,this.padding),g=[i,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=We(s,[0,2,3,1]));let y=iw(s,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=We(y,[0,3,1,2])),this.bias!=null&&(y=ci(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=Ze(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=yi(n[r],l,o,this.padding),n[i]=yi(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}RT.className="Conv2DTranspose";he(RT);class AT extends _d{constructor(e){if(super(e),this.inputSpec=[new nn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new j(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ze(e),e.length!==5)throw new j("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new nn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return G(()=>{let s=_e(e);if(s.shape.length!==5)throw new j(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],y=this.strides[2],x=yi(c,m,h,this.padding),w=yi(u,g,f,this.padding),b=yi(d,y,p,this.padding),S=[i,x,w,b,this.filters];this.dataFormat!=="channelsLast"&&(s=We(s,[0,2,3,4,1]));let T=RN(s,this.kernel.read(),S,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(T=We(T,[0,4,1,2,3])),this.bias!==null&&(T=ci(T,this.bias.read(),this.dataFormat)),this.activation!==null&&(T=this.activation.apply(T)),T})}computeOutputShape(e){e=Ze(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=yi(n[r],u,a,this.padding),n[i]=yi(n[i],d,l,this.padding),n[o]=yi(n[o],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}AT.className="Conv3DTranspose";he(AT);class Uz extends Rd{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new j("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new j("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new j(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Ct(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Nt(n.depthwiseRegularizer),this.depthwiseConstraint=pn(n.depthwiseConstraint),this.pointwiseInitializer=Ct(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Nt(n.pointwiseRegularizer),this.pointwiseConstraint=pn(n.pointwiseConstraint)}build(e){if(e=Ze(e),e.length<this.rank+2)throw new j(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new j(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new nn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return G(()=>{e=_e(e);let s;if(this.rank===1)throw new Pe("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=We(e,[0,2,3,1])),s=ww(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ci(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=We(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Dt(this.depthwiseInitializer),e.pointwiseInitializer=Dt(this.pointwiseInitializer),e.depthwiseRegularizer=dt(this.depthwiseRegularizer),e.pointwiseRegularizer=dt(this.pointwiseRegularizer),e.depthwiseConstraint=fn(this.depthwiseConstraint),e.pointwiseConstraint=fn(this.pointwiseConstraint),e}}Uz.className="SeparableConv";class _T extends Uz{constructor(e){super(2,e)}}_T.className="SeparableConv2D";he(_T);class Cm extends Rd{constructor(e){super(1,e),Cm.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!nT(e.kernelSize,"number",1,1))throw new j(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Cm.className="Conv1D";he(Cm);class DT extends Ve{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return G(()=>{if(e=_e(e),this.dataFormat==="channelsLast"){const s=dg(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return dg(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=dg(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return dg(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}DT.className="Cropping2D";he(DT);class OT extends Ve{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,vae(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return G(()=>{let s=_e(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=We(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?Zs.resizeNearestNeighbor(s,[i,o]):Zs.resizeBilinear(s,[i,o]);return We(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?Zs.resizeNearestNeighbor(s,[i,o]):Zs.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}OT.className="UpSampling2D";he(OT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fce(t,e,n=[1,1],s="valid",r,i){return G(()=>{r==null&&(r=ni()),Jt(r);let o=ET(t,r);if(t.rank!==4)throw new j(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new j(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=vd(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=We(o,[0,3,1,2])),o})}class FT extends nb{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Ct(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=pn(e.depthwiseConstraint),this.depthwiseRegularizer=Nt(e.depthwiseRegularizer)}build(e){if(e=Ze(e),e.length<4)throw new j(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new j(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return G(()=>{e=_e(e);let s=fce(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ci(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Ze(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=Zr(n,this.kernelSize[0],this.padding,this.strides[0]),o=Zr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Dt(this.depthwiseInitializer),e.depthwiseRegularizer=dt(this.depthwiseRegularizer),e.depthwiseConstraint=fn(this.depthwiseRegularizer),e}}FT.className="DepthwiseConv2D";he(FT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wz(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new j("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function Gz(t,e,n,s=!1,r,i,o=!1,a=!1){return G(()=>{const l=e.shape.length;if(l<3)throw new j(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(ti(2,l));e=We(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=me(me(r,"bool"),"float32"),r.rank===l-1&&(r=An(r,-1)),r=We(r,c)),s&&(e=or(e,0),r!=null&&(r=or(r,0)));const u=[];let d,h=n;const f=e.shape[0],p=ar(e);let m;r!=null&&(m=ar(r));for(let y=0;y<f;++y){const x=p[y],w=G(()=>t(x,h));if(r==null)d=w[0],h=w[1];else{const b=G(()=>{const S=m[y],T=Se(Vs(S),S),I=ue(B(w[0],S),B(h[0],T)),$=h.map((_,D)=>ue(B(w[1][D],S),B(_,T)));return{output:I,newStates:$}});d=b.output,h=b.newStates}a&&u.push(d)}let g;return a&&(g=is(u,1)),[d,g,h]})}class ui extends Ve{constructor(e){super(e);let n;if(e.cell==null)throw new j("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new ib({cells:e.cell}):n=e.cell,n.stateSize==null)throw new j("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new nn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ti(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){$S(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return G(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Pe("Constants support is not implemented in RNN yet.");$S(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new nn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Ue(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new j(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new nn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){G(()=>{if(!this.stateful)throw new mi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new j("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Ht([s,r])):this.states_=[Ht([s,this.cell.stateSize])];else if(e==null)Oe(this.states_),this.keptStates!=null&&(Oe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Ht([s,r])):this.states_[0]=Ht([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new j(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Oe(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!Ue(i.shape,a))throw new j(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>dn(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=Wz(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new nn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof si){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return G(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=_e(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new j(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=Gz((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return G(()=>{let n=Ht(e.shape);return n=ke(n,[1,2]),n=wm(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?TS(n,[1,s]):n):this.cell.stateSize>1?[TS(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===ui.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,i=Qr(r,s);return new e(Object.assign(n,{cell:i}))}}ui.className="RNN";he(ui);class Nm extends Ve{}class sb extends Nm{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,vn(this.units,"units"),this.activation=ga(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ct(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Nt(e.kernelRegularizer),this.recurrentRegularizer=Nt(e.recurrentRegularizer),this.biasRegularizer=Nt(e.biasRegularizer),this.kernelConstraint=pn(e.kernelConstraint),this.recurrentConstraint=pn(e.recurrentConstraint),this.biasConstraint=pn(e.biasConstraint),this.dropout=au([1,pa([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=au([1,pa([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ze(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return G(()=>{if(e=e,e.length!==2)throw new j(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ya({ones:()=>Vs(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ya({ones:()=>Vs(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=_i(B(e,o),this.kernel.read()):i=_i(e,this.kernel.read()),this.bias!=null&&(i=ci(i,this.bias.read())),a!=null&&(s=B(s,a));let l=ue(i,_i(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ma(this.activation),useBias:this.useBias,kernelInitializer:Dt(this.kernelInitializer),recurrentInitializer:Dt(this.recurrentInitializer),biasInitializer:Dt(this.biasInitializer),kernelRegularizer:dt(this.kernelRegularizer),recurrentRegularizer:dt(this.recurrentRegularizer),biasRegularizer:dt(this.biasRegularizer),activityRegularizer:dt(this.activityRegularizer),kernelConstraint:fn(this.kernelConstraint),recurrentConstraint:fn(this.recurrentConstraint),biasConstraint:fn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}sb.className="SimpleRNNCell";he(sb);class PT extends ui{constructor(e){e.cell=new sb(e),super(e)}call(e,n){return G(()=>{this.cell.dropoutMask!=null&&(Oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}PT.className="SimpleRNN";he(PT);class rb extends Nm{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new j("GRUCell does not support reset_after parameter set to true.");this.units=e.units,vn(this.units,"units"),this.activation=ga(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ga(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ct(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Nt(e.kernelRegularizer),this.recurrentRegularizer=Nt(e.recurrentRegularizer),this.biasRegularizer=Nt(e.biasRegularizer),this.kernelConstraint=pn(e.kernelConstraint),this.recurrentConstraint=pn(e.recurrentConstraint),this.biasConstraint=pn(e.biasConstraint),this.dropout=au([1,pa([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=au([1,pa([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ze(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return G(()=>{if(e=e,e.length!==2)throw new j(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ya({ones:()=>Vs(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ya({ones:()=>Vs(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=B(e,i[0]));let u=_i(e,this.kernel.read());this.useBias&&(u=ci(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=B(r,o[0]));const d=this.recurrentKernel.read(),[h,f]=ms(d,[2*this.units,this.units],d.rank-1),p=_i(r,h),[m,g,y]=ms(u,3,u.rank-1),[x,w]=ms(p,2,p.rank-1);a=this.recurrentActivation.apply(ue(m,x)),l=this.recurrentActivation.apply(ue(g,w));const b=_i(B(l,r),f);c=this.activation.apply(ue(y,b));const S=ue(B(a,r),B(ue(1,mt(a)),c));return[S,S]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ma(this.activation),recurrentActivation:ma(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Dt(this.kernelInitializer),recurrentInitializer:Dt(this.recurrentInitializer),biasInitializer:Dt(this.biasInitializer),kernelRegularizer:dt(this.kernelRegularizer),recurrentRegularizer:dt(this.recurrentRegularizer),biasRegularizer:dt(this.biasRegularizer),activityRegularizer:dt(this.activityRegularizer),kernelConstraint:fn(this.kernelConstraint),recurrentConstraint:fn(this.recurrentConstraint),biasConstraint:fn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}rb.className="GRUCell";he(rb);class LT extends ui{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new rb(e),super(e)}call(e,n){return G(()=>{this.cell.dropoutMask!=null&&(Oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}LT.className="GRU";he(LT);class Tm extends Nm{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,vn(this.units,"units"),this.activation=ga(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ga(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ct(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Nt(e.kernelRegularizer),this.recurrentRegularizer=Nt(e.recurrentRegularizer),this.biasRegularizer=Nt(e.biasRegularizer),this.kernelConstraint=pn(e.kernelConstraint),this.recurrentConstraint=pn(e.recurrentConstraint),this.biasConstraint=pn(e.biasConstraint),this.dropout=au([1,pa([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=au([1,pa([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ze(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends Ar{apply(l,c){const u=i.apply([o]),d=new Gw().apply([o]),h=i.apply([o*2]);return YA(YA(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return G(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new j(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ya({ones:()=>Vs(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ya({ones:()=>Vs(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=B(e,o[0]));let h=_i(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=B(r,a[0])),h=ue(h,_i(r,this.recurrentKernel.read())),this.useBias&&(h=ci(h,this.bias.read()));const[f,p,m,g]=ms(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=ue(B(c,i),B(l,this.activation.apply(m))),d=this.recurrentActivation.apply(g);const y=B(d,this.activation.apply(u));return[y,y,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ma(this.activation),recurrentActivation:ma(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Dt(this.kernelInitializer),recurrentInitializer:Dt(this.recurrentInitializer),biasInitializer:Dt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:dt(this.kernelRegularizer),recurrentRegularizer:dt(this.recurrentRegularizer),biasRegularizer:dt(this.biasRegularizer),activityRegularizer:dt(this.activityRegularizer),kernelConstraint:fn(this.kernelConstraint),recurrentConstraint:fn(this.recurrentConstraint),biasConstraint:fn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}Tm.className="LSTMCell";he(Tm);class MT extends ui{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Tm(e),super(e)}call(e,n){return G(()=>{this.cell.dropoutMask!=null&&(Oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}MT.className="LSTM";he(MT);class ib extends Nm{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return G(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){$S(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{hl(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(Qr(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return ES(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}dT(n)}}ib.className="StackedRNNCells";he(ib);function ya(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):nz(e(),n),a=()=>vm(o,e,s);return!r||r<=1?dn(a().clone()):Array(r).fill(void 0).map(a).map(c=>dn(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var pce=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class Hz extends ui{constructor(e){if(e.unroll)throw new Pe("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Pe("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new nn({ndim:5})]}call(e,n){return G(()=>{if(this.cell.dropoutMask!=null&&(Oe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Oe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new j("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return G(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=Ht(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){G(()=>{if(!this.stateful)throw new mi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new j("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ht(i)):this.states_=[Ht(i)];else if(e==null)Oe(this.states_),this.keptStates!=null&&(Oe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Ht(i)):this.states_[0]=Ht(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new j(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Oe(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!Ue(l.shape,c))throw new j(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>dn(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=Zr(c,r[0],i,o[0],a[0]),h=Zr(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}Hz.className="ConvRNN2D";class ob extends Tm{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,vn(this.filters,"filters"),this.kernelSize=zc(s,2,"kernelSize"),this.kernelSize.forEach(l=>vn(l,"kernelSize")),this.strides=zc(r||1,2,"strides"),this.strides.forEach(l=>vn(l,"strides")),this.padding=i||"valid",ur(this.padding),this.dataFormat=o||"channelsLast",Jt(this.dataFormat),this.dilationRate=zc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>vn(l,"dilationRate"))}build(e){var n;e=Ze(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new j(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends Ar{apply(h,f){const p=c.apply([u]),m=fs([u]),g=c.apply([u*2]);return sT([p,m,g])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return G(()=>{if(e.length!==3)throw new j(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ya({ones:()=>Vs(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(te,Z,le)=>!Z||!Z[le]?te:B(Z[le],te);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ya({ones:()=>Vs(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(i,p,0),g=c(i,p,1),y=c(i,p,2),x=c(i,p,3);const w=3,[b,S,T,I]=ms(this.kernel.read(),a,w),[$,_,D,z]=this.useBias?ms(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,b,$,this.padding),d=this.inputConv(d,S,_,this.padding),h=this.inputConv(h,T,D,this.padding),f=this.inputConv(f,I,z,this.padding);const[H,X,Y,J]=ms(this.recurrentKernel.read(),a,w);m=this.recurrentConv(m,H),g=this.recurrentConv(g,X),y=this.recurrentConv(y,Y),x=this.recurrentConv(x,J);const Q=this.recurrentActivation.apply(ue(u,m)),ee=this.recurrentActivation.apply(ue(d,g)),M=ue(B(ee,o),B(Q,this.activation.apply(ue(h,y)))),q=B(this.recurrentActivation.apply(ue(f,x)),this.activation.apply(M));return[q,q,M]})}getConfig(){const e=super.getConfig(),n=pce(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const i=ho(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ci(i,s,this.dataFormat):i}recurrentConv(e,n){return ho(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}ob.className="ConvLSTM2DCell";he(ob);class BT extends Hz{constructor(e){const n=new ob(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}BT.className="ConvLSTM2D";he(BT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ab extends Ve{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return G(()=>{this.invokeCallHook(e,n);const s=_e(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return vm(()=>nz(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}ab.className="Dropout";he(ab);class zT extends ab{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}zT.className="SpatialDropout1D";he(zT);class VT extends Ve{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,vn(this.units,"units"),this.activation=ga(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Ct(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Ct(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=pn(e.kernelConstraint),this.biasConstraint=pn(e.biasConstraint),this.kernelRegularizer=Nt(e.kernelRegularizer),this.biasRegularizer=Nt(e.biasRegularizer),this.activityRegularizer=Nt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ze(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ze(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return G(()=>{this.invokeCallHook(e,n);const s=_e(e),r=XB(this.activation.getClassName());let i;return r!=null?i=_i(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=_i(s,this.kernel.read()),this.bias!=null&&(i=ci(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:ma(this.activation),useBias:this.useBias,kernelInitializer:Dt(this.kernelInitializer),biasInitializer:Dt(this.biasInitializer),kernelRegularizer:dt(this.kernelRegularizer),biasRegularizer:dt(this.biasRegularizer),activityRegularizer:dt(this.activityRegularizer),kernelConstraint:fn(this.kernelConstraint),biasConstraint:fn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}VT.className="Dense";he(VT);class jT extends Ve{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ze(e);for(const n of e.slice(1))if(n==null)throw new j(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],sa(e,1)]}call(e,n){return G(()=>{this.invokeCallHook(e,n);let s=_e(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=We(s,r)}return Iae(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}jT.className="Flatten";he(jT);class UT extends Ve{constructor(e){super(e),this.supportsMasking=!0,this.activation=ga(e.activation)}call(e,n){return G(()=>{this.invokeCallHook(e,n);const s=_e(e);return this.activation.apply(s)})}getConfig(){const e={activation:ma(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}UT.className="Activation";he(UT);class WT extends Ve{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return G(()=>(e=_e(e),Nae(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}WT.className="RepeatVector";he(WT);class GT extends Ve{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new j("Can only specifiy one unknown dimension.");else i*=c}const a=sa(e);if(o!==null){if(i===0||a%i!==0)throw new j(s);r[o]=a/i}else if(a!==i)throw new j(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return G(()=>{this.invokeCallHook(e,n);const s=_e(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return V(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}GT.className="Reshape";he(GT);class HT extends Ve{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ti(1,e.dims.length+1);if(!Ue(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new nn({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ze(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return We(_e(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}HT.className="Permute";he(HT);class qT extends Ve{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=_e(e);return yf($l(s,this.maskValue),-1)}call(e,n){return G(()=>{this.invokeCallHook(e,n);const s=_e(e),o=yf($l(s,this.maskValue),-1,!0);return B(s,me(o,s.dtype))})}}qT.className="Masking";he(qT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class KT extends Ve{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(st(e.inputLength))}this.inputDim=e.inputDim,vn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,vn(this.outputDim,"outputDim"),this.embeddingsInitializer=Ct(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Nt(e.embeddingsRegularizer),this.activityRegularizer=Nt(e.activityRegularizer),this.embeddingsConstraint=pn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return G(()=>this.maskZero?(e=_e(e),$l(e,He(e))):null)}computeOutputShape(e){if(e=Ze(e),this.inputLength==null)return[...e,this.outputDim];const n=st(this.inputLength);if(n.length!==e.length-1)throw new j(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new j(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return G(()=>{this.invokeCallHook(e,n);let s=_e(e);s.dtype!=="int32"&&(s=Ai(s,"int32"));const r=tz(this.embeddings.read(),V(s,[s.size]));return V(r,Ze(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Dt(this.embeddingsInitializer),embeddingsRegularizer:dt(this.embeddingsRegularizer),activityRegularizer:dt(this.activityRegularizer),embeddingsConstraint:fn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}KT.className="Embedding";he(KT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tc extends Ve{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Pe}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new j("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ze(e)]),e=e,e.length<2)throw new j(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=na(n),n.length>1)throw new j(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&na(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return G(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=pa(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=wm(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=V(l,[d].concat(sa(u.slice(1))));f=We(f,[1,0]),f=V(f,h),s.push(f),i=!0}else if(c>1){const u=ti(1,c).concat([0]);s.push(We(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));o=V(We(V(o,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(ti(0,a-1));o=We(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=na(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return G(()=>{if(n==null)return null;if(!Array.isArray(n))throw new j("`mask` should be an Array");if(!Array.isArray(e))throw new j("`inputs` should be an Array");if(n.length!==e.length)throw new j(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:An(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Er(s,n[r]);return s})}}class XT extends tc{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ue(n,e[s]);return n})}}XT.className="Add";he(XT);class YT extends tc{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=B(n,e[s]);return n})}}YT.className="Multiply";he(YT);class JT extends tc{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ue(n,e[s]);return B(1/e.length,n)})}}JT.className="Average";he(JT);class QT extends tc{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Bi(n,e[s]);return n})}}QT.className="Maximum";he(QT);class ZT extends tc{constructor(e){super(e)}mergeFunction(e){return G(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=fa(n,e[s]);return n})}}ZT.className="Minimum";he(ZT);class eI extends tc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new j("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(Ue(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new j("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return G(()=>sT(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new j("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new j("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new j("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new j(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return G(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(me(Vs(e[o]),"bool")):n[o].rank<e[o].rank?r.push(An(n[o],-1)):r.push(n[o]);const i=Kt(r,this.axis);return sw(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}eI.className="Concatenate";he(eI);function rh(t,e){for(;t<0;)t+=e;return t}function mce(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Pe("batchDot is not implemented for tensors of 4D or higher rank yet");if(E(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),E(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Pe("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return G(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=V(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=V(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=ke(B(t,e),i[0]):a=ke(B(We(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=Be(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=_a(a,c)}return a.shape.length===1&&(a=An(a,1)),a})}class tI extends tc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){E(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Pe("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new j(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new j(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>rh(i,e[o].shape.length)):r=[rh(this.axes,n.shape.length),rh(this.axes,s.shape.length)],this.normalize&&(n=e0(n,r[0]),s=e0(s,r[1])),mce(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[rh(this.axes,e.length),rh(this.axes,n.length)],s}computeOutputShape(e){E(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Pe("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}tI.className="Dot";he(tI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nI extends Ve{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return G(()=>{this.invokeCallHook(e,n);const s=_e(e);return vm(()=>ue(Ww(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}nI.className="GaussianNoise";he(nI);class sI extends Ve{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return G(()=>{this.invokeCallHook(e,n);const s=_e(e);return this.rate>0&&this.rate<1?vm(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return B(s,Ww(s.shape,1,i))},()=>s,n.training||!1):s})}}sI.className="GaussianDropout";he(sI);class rI extends Ve{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||_e(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return G(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return vm(()=>{const i=_e(e),l=-1.6732632423543772*1.0507009873554805;let c=ko(Aa(s),this.rate);c=Ai(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-u*l*this.rate,h=ue(B(i,c),B(ue(c,-1),l));return ue(B(h,u),d)},()=>_e(e),n.training||!1)}return e})}}rI.className="AlphaDropout";he(rI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kf(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=wN(t,e,n,s,r,i);else if(t.rank===3)o=bN(t,e,n,s,r,i);else if(t.rank===4)o=vN(t,e,n,s,r,i);else throw new Pe(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function gce(t,e,n,s,r=.001){return G(()=>{const i=am(t,s),o=i.mean,a=i.variance;return[kf(t,o,a,n,e,r),o,a]})}function yce(t,e,n,s,r=.001){return G(()=>{const i=am(t,s),o=i.mean,a=i.variance,l=[];for(const p of ti(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=V(o,l),u=V(a,l),d=e==null?null:V(e,l),h=n==null?null:V(n,l);return[kf(t,c,u,h,d,r),o,a]})}function xce(t,e,n,s,r=.001){return Ue(s.slice().sort(),ti(0,t.rank-1))?gce(t,e,n,s,r):yce(t,e,n,s,r)}class iI extends Ve{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Ct(e.betaInitializer||"zeros"),this.gammaInitializer=Ct(e.gammaInitializer||"ones"),this.movingMeanInitializer=Ct(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Ct(e.movingVarianceInitializer||"ones"),this.betaConstraint=pn(e.betaConstraint),this.gammaConstraint=pn(e.gammaConstraint),this.betaRegularizer=Nt(e.betaRegularizer),this.gammaRegularizer=Nt(e.gammaRegularizer)}build(e){e=Ze(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new j(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new nn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return G(()=>{const s=n.training==null?!1:n.training,r=_e(e),i=r.shape,o=i.length,a=ti(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=Al(1,o);c[l]=i[l];const u=a.slice();u.sort();const d=!Ue(u,ti(0,o).slice(0,o-1)),h=()=>{if(d){const x=V(this.movingMean.read(),c),w=V(this.movingVariance.read(),c),b=this.center?V(this.beta.read(),c):null,S=this.scale?V(this.gamma.read(),c):null;return kf(r,x,w,b,S,this.epsilon)}else return kf(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,p,m]=xce(r,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(x,w,b)=>{G(()=>{const S=1-b,T=x.read(),I=B(Se(T,w),S);x.write(Se(T,I))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Dt(this.betaInitializer),gammaInitializer:Dt(this.gammaInitializer),movingMeanInitializer:Dt(this.movingMeanInitializer),movingVarianceInitializer:Dt(this.movingVarianceInitializer),betaRegularizer:dt(this.betaRegularizer),gammaRegularizer:dt(this.gammaRegularizer),betaConstraint:fn(this.betaConstraint),gammaConstraint:fn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}iI.className="BatchNormalization";he(iI);class oI extends Ve{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Ct(e.betaInitializer||"zeros"),this.gammaInitializer=Ct(e.gammaInitializer||"ones"),this.betaRegularizer=Nt(e.betaRegularizer),this.gammaRegularizer=Nt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ze(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==na(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=_e(e),r=s.shape,i=r.length;return G(()=>{let{mean:a,variance:l}=am(s,this.axis,!0);const c=Al(1,i);for(const m of this.axis)c[m]=r[m];const u=m=>m!=null&&m.shape.length!==i?V(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<i;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=Qs(a,f),l=Qs(l,f),d!=null&&(d=Qs(d,p)),h!=null&&(h=Qs(h,p)),kf(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Dt(this.betaInitializer),gammaInitializer:Dt(this.gammaInitializer),betaRegularizer:dt(this.betaRegularizer),gammaRegularizer:dt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}oI.className="LayerNormalization";he(oI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wce(t,e,n){return G(()=>{if(t.rank!==4)throw new j(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new j("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=ni()),n!=="channelsLast"&&n!=="channelsFirst")throw new j(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Co(t,s)})}class aI extends Ve{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?ni():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new j(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new j(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new j(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new nn({ndim:4})]}computeOutputShape(e){e=Ze(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return G(()=>wce(_e(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}aI.className="ZeroPadding2D";he(aI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lb(t,e,n,s,r,i){return G(()=>{Jt(r),JB(i),ur(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=ni()),i==null&&(i="max"),t=ET(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=om(t,e,n,a):o=Qp(t,e,n,a),r==="channelsFirst"&&(o=We(o,[0,3,1,2])),o})}function qz(t,e,n,s,r,i){return G(()=>{Jt(r),JB(i),ur(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=ni()),i==null&&(i="max"),t=jz(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=WN(t,e,n,a):o=xN(t,e,n,a),r==="channelsFirst"&&(o=We(o,[0,4,1,2,3])),o})}class Kz extends Ve{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new j(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(vn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new j(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);vn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,ur(this.padding),this.inputSpec=[new nn({ndim:3})]}computeOutputShape(e){e=Ze(e);const n=Zr(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return G(()=>{this.invokeCallHook(e,n),e=wm(_e(e),2);const s=this.poolingFunction(_e(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return _a(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class lI extends Kz{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),ur(r),lb(e,n,s,r,i,"max")}}lI.className="MaxPooling1D";he(lI);class cI extends Kz{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),ur(r),lb(e,n,s,r,i,"avg")}}cI.className="AveragePooling1D";he(cI);class Xz extends Ve{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new j(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];vn(this.poolSize,"poolSize"),vn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),ur(this.padding),this.inputSpec=[new nn({ndim:4})]}computeOutputShape(e){e=Ze(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Zr(n,this.poolSize[0],this.padding,this.strides[0]),s=Zr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return G(()=>(this.invokeCallHook(e,n),this.poolingFunction(_e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class uI extends Xz{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),ur(r),lb(e,n,s,r,i,"max")}}uI.className="MaxPooling2D";he(uI);class dI extends Xz{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),ur(r),lb(e,n,s,r,i,"avg")}}dI.className="AveragePooling2D";he(dI);class Yz extends Ve{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new j(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];vn(this.poolSize,"poolSize"),vn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),ur(this.padding),this.inputSpec=[new nn({ndim:5})]}computeOutputShape(e){e=Ze(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Zr(n,this.poolSize[0],this.padding,this.strides[0]),s=Zr(s,this.poolSize[1],this.padding,this.strides[1]),r=Zr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return G(()=>(this.invokeCallHook(e,n),this.poolingFunction(_e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class hI extends Yz{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),ur(r),qz(e,n,s,r,i,"max")}}hI.className="MaxPooling3D";he(hI);class fI extends Yz{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),ur(r),qz(e,n,s,r,i,"avg")}}fI.className="AveragePooling3D";he(fI);class Jz extends Ve{constructor(e){super(e),this.inputSpec=[new nn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Pe}}class pI extends Jz{constructor(e){super(e||{})}call(e,n){return G(()=>{const s=_e(e);return At(s,1)})}}pI.className="GlobalAveragePooling1D";he(pI);class mI extends Jz{constructor(e){super(e||{})}call(e,n){return G(()=>{const s=_e(e);return rr(s,1)})}}mI.className="GlobalMaxPooling1D";he(mI);class Qz extends Ve{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),this.inputSpec=[new nn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Pe}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class gI extends Qz{call(e,n){return G(()=>{const s=_e(e);return this.dataFormat==="channelsLast"?At(s,[1,2]):At(s,[2,3])})}}gI.className="GlobalAveragePooling2D";he(gI);class yI extends Qz{call(e,n){return G(()=>{const s=_e(e);return this.dataFormat==="channelsLast"?rr(s,[1,2]):rr(s,[2,3])})}}yI.className="GlobalMaxPooling2D";he(yI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zz extends Ve{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=Qr(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class xI extends Zz{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ze(e),e.length<3)throw new j(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ze(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return G(()=>(e=_e(e),Gz((o,a)=>[_e(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}xI.className="TimeDistributed";he(xI);function bce(t){Zl(bae,"BidirectionalMergeMode",t)}const vce="concat";class wI extends Zz{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Qr(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=Qr(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?vce:e.mergeMode,bce(this.mergeMode),e.weights)throw new Pe("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):ds(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=Wz(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new j("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(d=>new nn({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Pe("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof si;for(const c of o)if(c instanceof si!==l)throw new j("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return G(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=or(i,1));let a;return this.mergeMode==="concat"?a=sT([r,i]):this.mergeMode==="sum"?a=ue(r,i):this.mergeMode==="ave"?a=B(.5,ue(r,i)):this.mergeMode==="mul"?a=B(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){hl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),hl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Qr(n.layer);if(delete n.layer,n.numConstants!=null)throw new Pe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}wI.className="Bidirectional";he(wI);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bI extends Ve{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return G(()=>(e=_e(e),e.dtype!=="float32"&&(e=Ai(e,"float32")),ue(B(e,this.scale),this.offset)))}}bI.className="Rescaling";he(bI);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Sce,cropAndResize:kce}=Zs;class vI extends Ve{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,i,o,a,l){return G(()=>{let c,u=!1;const d=n/o,h=s/a,f=(r+n)/o,p=(i+s)/a,m=[d,h,f,p],g=[];e.rank===3?(u=!0,c=is([e])):c=e;for(let S=0;S<c.shape[0];S++)g.push(m);const y=Ms(g,[g.length,4]),x=El(0,g.length,1,"int32"),b=kce(c,y,x,[r,i],"nearest");return Ai(u?_e(ar(b)):b,l)})}upsize(e,n,s,r){return G(()=>{const i=Sce(e,[n,s]);return Ai(i,r)})}call(e,n){return G(()=>{const s=_e(e),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ze(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}vI.className="CenterCrop";he(vI);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cce(t,e,n,s){let r=_e(t);if(r.dtype!=="int32"&&(r=Ai(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=An(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=An(r,-1)),r.rank>2)throw new j(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=Ky(a,s,n,o):l=Ky(a,[],n,o),e!=="tfIdf")return l;if(s)return B(l,s);throw new j("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class SI extends Ve{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ze(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return G(()=>{e=_e(e),e.dtype!=="int32"&&(e=Ai(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new j(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=_e(n.countWeights)}const r=rr(e),i=tu(e),o=ls(this.numTokens,r).bufferSync().get(0),a=ko(i,0).bufferSync().get(0);if(!(o&&a))throw new j(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Cce(e,this.outputMode,this.numTokens,s)})}}SI.className="CategoryEncoding";he(SI);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Nce=["bilinear","nearest"],p_=new Set(Nce);class kI extends Ve{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(p_.has(e.interpolation))this.interpolation=e.interpolation;else throw new j(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ze(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return G(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Zs.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Zs.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...p_]} are supported`)})}}kI.className="Resizing";he(kI);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class e4{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}e4.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class t4 extends Ve{constructor(e){super(e),this.randomGenerator=new e4(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}t4.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Tce=["bilinear","nearest"],m_=new Set(Tce);class CI extends t4{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new j(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new j(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new j(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(m_.has(s))this.interpolation=s;else throw new j(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ze(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return G(()=>{const s=_e(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Aa([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Zs.resizeBilinear(e,o);case"nearest":return Zs.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...m_]} are supported`)}})}}CI.className="RandomWidth";he(CI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ice(t){return new $d(t)}function $ce(t){return new TT(t)}function Ece(t){return new kT(t)}function Rce(t){return new CT(t)}function Ace(t){return new NT(t)}function _ce(t){return new $T(t)}function Dce(t){return new IT(t)}function Oce(t){return new Cm(t)}function Fce(t){return new Ad(t)}function Pce(t){return new RT(t)}function Lce(t){return new _d(t)}function Mce(t){return new AT(t)}function Bce(t){return new _T(t)}function zce(t){return new DT(t)}function Vce(t){return new OT(t)}function jce(t){return new FT(t)}function Uce(t){return new UT(t)}function Wce(t){return new VT(t)}function Gce(t){return new ab(t)}function Hce(t){return new zT(t)}function qce(t){return new jT(t)}function Kce(t){return new WT(t)}function Xce(t){return new GT(t)}function Yce(t){return new HT(t)}function Jce(t){return new KT(t)}function Qce(t){return new XT(t)}function Zce(t){return new JT(t)}function eue(t){return new eI(t)}function tue(t){return new QT(t)}function nue(t){return new ZT(t)}function sue(t){return new YT(t)}function rue(t){return new tI(t)}function iue(t){return new iI(t)}function oue(t){return new oI(t)}function aue(t){return new aI(t)}function NI(t){return new cI(t)}function lue(t){return NI(t)}function cue(t){return NI(t)}function TI(t){return new dI(t)}function uue(t){return TI(t)}function due(t){return TI(t)}function II(t){return new fI(t)}function hue(t){return II(t)}function fue(t){return II(t)}function pue(t){return new pI(t)}function mue(t){return new gI(t)}function n4(t){return new mI(t)}function s4(t){return new yI(t)}function r4(t){return new lI(t)}function i4(t){return new uI(t)}function gue(t){return new hI(t)}function yue(t){return new LT(t)}function xue(t){return new rb(t)}function wue(t){return new MT(t)}function bue(t){return new Tm(t)}function vue(t){return new PT(t)}function Sue(t){return new sb(t)}function kue(t){return new BT(t)}function Cue(t){return new ob(t)}function Nue(t){return new ui(t)}function Tue(t){return new ib(t)}function Iue(t){return new wI(t)}function $ue(t){return new xI(t)}const Eue=n4,Rue=s4,Aue=r4,_ue=i4;function Due(t){return new nI(t)}function Oue(t){return new sI(t)}function Fue(t){return new rI(t)}function Pue(t){return new qT(t)}function Lue(t){return new bI(t)}function Mue(t){return new vI(t)}function Bue(t){return new kI(t)}function zue(t){return new SI(t)}function Vue(t){return new CI(t)}const jue=Object.freeze(Object.defineProperty({__proto__:null,Layer:Ve,RNN:ui,RNNCell:Nm,activation:Uce,add:Qce,alphaDropout:Fue,average:Zce,averagePooling1d:NI,averagePooling2d:TI,averagePooling3d:II,avgPool1d:lue,avgPool2d:uue,avgPool3d:hue,avgPooling1d:cue,avgPooling2d:due,avgPooling3d:fue,batchNormalization:iue,bidirectional:Iue,categoryEncoding:zue,centerCrop:Mue,concatenate:eue,conv1d:Oce,conv2d:Fce,conv2dTranspose:Pce,conv3d:Lce,conv3dTranspose:Mce,convLstm2d:kue,convLstm2dCell:Cue,cropping2D:zce,dense:Wce,depthwiseConv2d:jce,dot:rue,dropout:Gce,elu:$ce,embedding:Jce,flatten:qce,gaussianDropout:Oue,gaussianNoise:Due,globalAveragePooling1d:pue,globalAveragePooling2d:mue,globalMaxPool1d:Eue,globalMaxPool2d:Rue,globalMaxPooling1d:n4,globalMaxPooling2d:s4,gru:yue,gruCell:xue,input:Nz,inputLayer:Ice,layerNormalization:oue,leakyReLU:Rce,lstm:wue,lstmCell:bue,masking:Pue,maxPool1d:Aue,maxPool2d:_ue,maxPooling1d:r4,maxPooling2d:i4,maxPooling3d:gue,maximum:tue,minimum:nue,multiply:sue,permute:Yce,prelu:Ace,randomWidth:Vue,reLU:Ece,repeatVector:Kce,rescaling:Lue,reshape:Xce,resizing:Bue,rnn:Nue,separableConv2d:Bce,simpleRNN:vue,simpleRNNCell:Sue,softmax:_ce,spatialDropout1d:Hce,stackedRNNCells:Tue,thresholdedReLU:Dce,timeDistributed:$ue,upSampling2d:Vce,zeroPadding2d:aue},Symbol.toStringTag,{value:"Module"}));function Uue(t,e){return xT(t,e)}function Wue(t,e){return pz(t,e)}function Gue(t,e){return mz(t,e)}function Hue(t,e){return wT(t,e)}function que(t,e){return bT(t,e)}function Kue(t,e){return fz(t,e)}function Xue(t,e){return $le(t,e)}function Yue(t,e){return yT(t,e)}function Jue(t,e){return Zw(t,e)}function Que(t,e){return Ed(t,e)}function Zue(t,e){return Ed(t,e)}function ede(t,e){return Ed(t,e)}function tde(t,e){return ec(t,e)}function nde(t,e){return ec(t,e)}function sde(t,e){return ec(t,e)}function rde(t,e){return Ele(t,e)}const ide=Object.freeze(Object.defineProperty({__proto__:null,MAPE:Zue,MSE:nde,binaryAccuracy:Uue,binaryCrossentropy:Wue,categoricalAccuracy:Hue,categoricalCrossentropy:que,cosineProximity:Yue,mape:ede,meanAbsoluteError:Jue,meanAbsolutePercentageError:Que,meanSquaredError:tde,mse:sde,precision:Kue,r2Score:rde,recall:Xue,sparseCategoricalAccuracy:Gue},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ode=Object.freeze(Object.defineProperty({__proto__:null,modelFromJSON:rce},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ade(t){return new km(t)}function lde(t){return cce(t)}function cde(t){return uce(t)}const ude=Object.freeze(Object.defineProperty({__proto__:null,l1:lde,l1l2:ade,l2:cde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class o4 extends lu{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Zi))throw new Error("model must be a LayersModel, not some other Container");this.model=e}}function fg(t,e){return t<e}function g_(t,e){return t>e}class a4 extends o4{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new Pe("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=fg:this.mode==="max"?this.monitorFunc=g_:this.monitor.indexOf("acc")!==-1?this.monitorFunc=g_:this.monitorFunc=fg,this.monitorFunc===fg&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===fg?1/0:-1/0}async onEpochEnd(e,n){await Ro(n);const s=this.getMonitorValue(n);s!=null&&(this.monitorFunc(s-this.minDelta,this.best)?(this.best=s,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});const n=e[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),n}}function dde(t){return new a4(t)}const hde={earlyStopping:dde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fde=K();fde.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ns;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ns||(Ns={}));var y_;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(y_||(y_={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $I={};function pde(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};$I[t]=n}function l4(t){return $I[t]}function mde(t){delete $I[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C(t,e,n,s,r){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,c=a<0?e.inputNames.length+a:a;if(i.type==="tensor")return _n(e.inputNames[c],n,s,r);if(i.type==="tensors"){const h=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((p,m)=>{var g;return((g=h[m])===null||g===void 0?void 0:g.op)!=="NoOp"}).map(p=>_n(p,n,s,r))}const u=_n(e.inputNames[c],n,s,r),d=u.dataSync();return i.type==="number"?d[0]:sr(u.shape,d)}const o=e.attrParams[t];return o&&o.value}function _n(t,e,n,s){const[r,i]=Is(t,n);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[i0(r,a)]);return o!==void 0?e[i0(r,o)][i]:void 0}function x_(t,e,n){return e[i0(t,n.currentContextId)]}function Hi(t,e){const[n,s,r]=Is(t,e);return[i0(n,e&&e.currentContextId),s,r]}function i0(t,e){return e?`${t}-${e}`:t}function Is(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const i=e.parseNodeNameCache.get(t);if(i!=null)return i}const s=t.split(":");let r;if(s.length===1)r=[t,0,void 0];else{const i=s[0],o=s.length===3?s[1]:void 0,a=Number(s[s.length-1]);r=[i,a,o]}return n&&e.parseNodeNameCache.set(t,r),r}function Yg(t,e,n){let s=C("pad",t,e,n);if(s==="explicit"){s=C("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)r[i][0]=s[i*2],r[i][1]=s[i*2+1];return r}return s}function qi(t){return t.kept?t:Ei(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],yde=Object.freeze(Object.defineProperty({__proto__:null,json:gde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xde=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],wde=Object.freeze(Object.defineProperty({__proto__:null,json:xde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],vde=Object.freeze(Object.defineProperty({__proto__:null,json:bde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sde=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],kde=Object.freeze(Object.defineProperty({__proto__:null,json:Sde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Nde=Object.freeze(Object.defineProperty({__proto__:null,json:Cde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tde=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Ide=Object.freeze(Object.defineProperty({__proto__:null,json:Tde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $de=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Ede=Object.freeze(Object.defineProperty({__proto__:null,json:$de},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rde=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Ade=Object.freeze(Object.defineProperty({__proto__:null,json:Rde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _de=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Dde=Object.freeze(Object.defineProperty({__proto__:null,json:_de},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ode=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Fde=Object.freeze(Object.defineProperty({__proto__:null,json:Ode},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pde=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Lde=Object.freeze(Object.defineProperty({__proto__:null,json:Pde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mde=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Bde=Object.freeze(Object.defineProperty({__proto__:null,json:Mde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zde=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Vde=Object.freeze(Object.defineProperty({__proto__:null,json:zde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jde=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Ude=Object.freeze(Object.defineProperty({__proto__:null,json:jde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Gde=Object.freeze(Object.defineProperty({__proto__:null,json:Wde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hde=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],qde=Object.freeze(Object.defineProperty({__proto__:null,json:Hde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kde=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Xde=Object.freeze(Object.defineProperty({__proto__:null,json:Kde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yde=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Jde=Object.freeze(Object.defineProperty({__proto__:null,json:Yde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qde=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Zde=Object.freeze(Object.defineProperty({__proto__:null,json:Qde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w_{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[yde,wde,vde,kde,Nde,Ide,Ede,Ade,Dde,Fde,Lde,Bde,Vde,Ude,Gde,qde,Xde,Jde,Zde],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,n={}){const s=e.node,r=[],i=[],o=[],a=s.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op.startsWith("Placeholder")?r.push(m[g.name]):g.op==="Const"?i.push(m[g.name]):(g.input==null||g.input.length===0)&&o.push(m[g.name]),m),{});let l=[];const c=[];let u={},d={};n!=null&&(u=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(m=>{const g=a[m];g.inputNames.forEach((y,x)=>{const[w,,b]=Hi(y),S=a[w];if(S.outputs!=null){const T=S.outputs.indexOf(b);if(T!==-1){const I=`${w}:${T}`;g.inputNames[x]=I}}g.inputs.push(S),S.children.push(g)})}),Object.keys(d).length===0?h.forEach(m=>{const g=a[m];g.children.length===0&&c.push(g)}):Object.keys(d).forEach(m=>{const[g]=Hi(m),y=a[g];y!=null&&(y.signatureKey=d[m],c.push(y))}),Object.keys(u).length>0?Object.keys(u).forEach(m=>{const[g]=Hi(m),y=a[g];y&&(y.signatureKey=u[m],l.push(y))}):l=r;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((m,g)=>(m[g.signature.name]=this.mapFunction(g),m),{}));const p={nodes:a,inputs:l,outputs:c,weights:i,placeholders:r,signature:n,functions:f};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=l4(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,i)=>{const o=i.type;let a;switch(i.type){case"string":a=OS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=OS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=VS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=VS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=PS(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=PS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=zS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=zS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=FS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=FS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=US(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=US(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=BS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=BS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=jS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=jS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=LS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=LS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=MS(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=MS(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=b_(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=b_(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return r[i.name]={value:a,type:o},r},{})),s}mapFunction(e){const n=e.nodeDef,s=[],r=[];let i={};n!=null&&(i=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&r.push(d[h.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=Hi(d.name),f={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:EI(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,o.push(f),i[h]=f}),Object.keys(i).forEach(d=>{const h=i[d];h.inputNames.forEach((f,p)=>{const[m,,g]=Hi(f),y=i[m];if(y.outputs!=null){const x=y.outputs.indexOf(g);if(x!==-1){const w=`${m}:${x}`;h.inputNames[p]=w}}h.inputs.push(y),y.children.push(h)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[h,f]=Hi(c[d.name]),p=i[h];p!=null&&(p.defaultOutput=f,a.push(p))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:r,placeholders:s,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function ehe(t){const e=K().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function c4(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):ehe(t);return e?n:n.toLowerCase()}function OS(t,e,n,s=!1){const r=t[e];return r!=null?c4(r.s,s):n}function FS(t,e,n){const s=t[e];return s?s.b:n}function PS(t,e,n){const s=t[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function EI(t){switch(typeof t=="string"&&(t=Ns[t]),t){case Ns.DT_FLOAT:case Ns.DT_HALF:return"float32";case Ns.DT_INT32:case Ns.DT_INT64:case Ns.DT_INT8:case Ns.DT_UINT8:return"int32";case Ns.DT_BOOL:return"bool";case Ns.DT_DOUBLE:return"float32";case Ns.DT_STRING:return"string";case Ns.DT_COMPLEX64:case Ns.DT_COMPLEX128:return"complex64";default:return null}}function b_(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function LS(t,e,n){const s=t[e];return s&&s.type?EI(s.type):n}function MS(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(r=>EI(r)):n}function u4(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function BS(t,e,n){const s=t[e];return s&&s.shape?u4(s.shape):n}function zS(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function VS(t,e,n,s=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(i=>c4(i,s)):n}function jS(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>u4(r)):n}function US(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class the{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(e){return _n(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return _n(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return PS(this.node.rawAttrs,e,n);if(s.s!=null)return OS(this.node.rawAttrs,e,n);if(s.b!=null)return FS(this.node.rawAttrs,e,n);if(s.shape!=null)return BS(this.node.rawAttrs,e,n);if(s.type!=null)return LS(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return zS(this.node.rawAttrs,e,n);if(s.list.s!=null)return VS(this.node.rawAttrs,e,n);if(s.list.shape!=null)return jS(this.node.rawAttrs,e,n);if(s.list.b!=null)return US(this.node.rawAttrs,e,n);if(s.list.type!=null)return MS(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:tN,abs:en,acos:cN,acosh:uN,add:ue,addN:X3,all:sw,any:yf,argMax:Nl,argMin:dN,asin:hN,asinh:fN,atan:pN,atan2:mN,atanh:gN,avgPool:Qp,avgPool3d:xN,basicLSTMCell:Y3,batchNorm:bd,batchNorm2d:wN,batchNorm3d:bN,batchNorm4d:vN,batchToSpaceND:Zp,bincount:SN,bitwiseAnd:J3,booleanMaskAsync:PM,broadcastArgs:Q3,broadcastTo:dl,buffer:Le,cast:me,ceil:kN,clipByValue:xs,clone:Ei,complex:uo,concat:Kt,concat1d:CN,concat2d:NN,concat3d:TN,concat4d:IN,conv1d:rw,conv2d:ho,conv2dTranspose:iw,conv3d:EN,conv3dTranspose:RN,cos:em,cosh:ow,cosineWindow:Ew,cumprod:bf,cumsum:aw,denseBincount:Ky,depthToSpace:AN,depthwiseConv2d:vd,diag:eM,dilation2d:_N,div:Te,divNoNan:DN,dot:ON,dropout:p2,einsum:Ga,elu:Sd,enclosingPowerOfTwo:m2,ensureShape:tM,equal:Bs,erf:lw,euclideanNorm:PN,exp:ws,expandDims:An,expm1:LN,eye:cw,fft:fm,fill:Kl,floor:Cd,floorDiv:nw,fused:GM,gather:Nd,gatherND:zM,greater:ls,greaterEqual:ko,ifft:ou,imag:tm,image:Zs,inTopKAsync:VM,irfft:kw,isFinite:MN,isInf:BN,isNaN:zN,leakyRelu:nm,less:nu,lessEqual:Ra,linalg:x2,linspace:rM,localResponseNormalization:VN,log:zs,log1p:sm,logSigmoid:jN,logSoftmax:dw,logSumExp:rm,logicalAnd:Er,logicalNot:im,logicalOr:hw,logicalXor:UN,losses:QM,lowerBound:oM,matMul:Be,max:rr,maxPool:om,maxPool3d:WN,maxPoolWithArgmax:aM,maximum:Bi,mean:At,meshgrid:lM,min:tu,minimum:fa,mirrorPad:GN,mod:HN,moments:am,movingAverage:LM,mul:B,multiRNNCell:cM,multinomial:uM,neg:mt,norm:kd,notEqual:$l,oneHot:su,ones:fs,onesLike:Vs,op:L,outerProduct:dM,pad:Co,pad1d:hM,pad2d:fM,pad3d:pM,pad4d:mM,pool:qN,pow:Pi,prelu:cm,print:lN,prod:KN,raggedGather:gM,raggedRange:yM,raggedTensorToTensor:xM,rand:wM,randomGamma:kM,randomNormal:pw,randomStandardNormal:CM,randomUniform:Aa,randomUniformInt:NM,range:El,real:ru,reciprocal:r2,relu:li,relu6:mw,reshape:V,reverse:or,reverse1d:TM,reverse2d:IM,reverse3d:$M,reverse4d:EM,rfft:pm,round:gw,rsqrt:yw,scalar:Ee,scatterND:MM,searchSorted:fw,selu:xw,separableConv2d:ww,setdiff1dAsync:RM,sigmoid:Jr,sign:i2,signal:JM,sin:bw,sinh:vw,slice:Ge,slice1d:um,slice2d:Sw,slice3d:dm,slice4d:iu,softmax:hm,softplus:Xl,spaceToBatchND:lm,sparse:ZM,sparseToDense:BM,spectral:YM,split:ms,sqrt:Cn,square:at,squaredDifference:Cw,squeeze:_a,stack:is,step:Jl,stridedSlice:o2,string:eB,sub:Se,sum:ke,tan:a2,tanh:ha,tensor:Ms,tensor1d:On,tensor2d:ta,tensor3d:l2,tensor4d:AM,tensor5d:_M,tensor6d:DM,tensorScatterUpdate:OM,tile:Qs,topk:u2,transpose:We,truncatedNormal:Tw,unique:d2,unsortedSegmentSum:Iw,unstack:ar,upperBound:FM,variable:h2,where:Sn,whereAsync:f2,zeros:Ht,zerosLike:He},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nhe=(t,e,n,s=zn)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(C("a",t,e,n),C("b",t,e,n))];case"AddN":return[s.addN(C("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(C("a",t,e,n),C("b",t,e,n))];case"Mul":return[s.mul(C("a",t,e,n),C("b",t,e,n))];case"RealDiv":case"Div":return[s.div(C("a",t,e,n),C("b",t,e,n))];case"DivNoNan":return[s.divNoNan(C("a",t,e,n),C("b",t,e,n))];case"FloorDiv":return[s.floorDiv(C("a",t,e,n),C("b",t,e,n))];case"Sub":return[s.sub(C("a",t,e,n),C("b",t,e,n))];case"Minimum":return[s.minimum(C("a",t,e,n),C("b",t,e,n))];case"Maximum":return[s.maximum(C("a",t,e,n),C("b",t,e,n))];case"Pow":return[s.pow(C("a",t,e,n),C("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(C("a",t,e,n),C("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const she=(t,e,n,s=zn)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(C("x",t,e,n))];case"Acos":return[s.acos(C("x",t,e,n))];case"Acosh":return[s.acosh(C("x",t,e,n))];case"Asin":return[s.asin(C("x",t,e,n))];case"Asinh":return[s.asinh(C("x",t,e,n))];case"Atan":return[s.atan(C("x",t,e,n))];case"Atan2":return[s.atan2(C("x",t,e,n),C("y",t,e,n))];case"Atanh":return[s.atanh(C("x",t,e,n))];case"Ceil":return[s.ceil(C("x",t,e,n))];case"Complex":return[s.complex(C("real",t,e,n),C("imag",t,e,n))];case"Cos":return[s.cos(C("x",t,e,n))];case"Cosh":return[s.cosh(C("x",t,e,n))];case"Elu":return[s.elu(C("x",t,e,n))];case"Erf":return[s.erf(C("x",t,e,n))];case"Exp":return[s.exp(C("x",t,e,n))];case"Expm1":return[s.expm1(C("x",t,e,n))];case"Floor":return[s.floor(C("x",t,e,n))];case"Log":return[s.log(C("x",t,e,n))];case"Log1p":return[s.log1p(C("x",t,e,n))];case"Imag":return[s.imag(C("x",t,e,n))];case"Neg":return[s.neg(C("x",t,e,n))];case"Reciprocal":return[s.reciprocal(C("x",t,e,n))];case"Real":return[s.real(C("x",t,e,n))];case"Relu":return[s.relu(C("x",t,e,n))];case"Round":return[s.round(C("x",t,e,n))];case"Selu":return[s.selu(C("x",t,e,n))];case"Sigmoid":return[s.sigmoid(C("x",t,e,n))];case"Sin":return[s.sin(C("x",t,e,n))];case"Sign":return[s.sign(C("x",t,e,n))];case"Sinh":return[s.sinh(C("x",t,e,n))];case"Softplus":return[s.softplus(C("x",t,e,n))];case"Sqrt":return[s.sqrt(C("x",t,e,n))];case"Square":return[s.square(C("x",t,e,n))];case"Tanh":return[s.tanh(C("x",t,e,n))];case"Tan":return[s.tan(C("x",t,e,n))];case"ClipByValue":return[s.clipByValue(C("x",t,e,n),C("clipValueMin",t,e,n),C("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(C("x",t,e,n))];case"Rsqrt":return[s.rsqrt(_n(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(C("x",t,e,n),C("alpha",t,e,n))];case"Prelu":return[s.prelu(C("x",t,e,n),C("alpha",t,e,n))];case"IsNan":return[s.isNaN(_n(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(_n(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(_n(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mr(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){E(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const r=t[s],i=e[s];E(r<0||i<0||r===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function v_(t){return!(typeof t=="number"||t.some(e=>e<0))}function ih(t,e,n){let s=WS(t,n);const r=!v_(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(i=>{s=WS(i.shape,s)}),!v_(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function WS(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const r=t[s],i=e[s];if(r>=0&&i>=0&&r!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=r>=0?r:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rhe{constructor(e,n,s,r,i,o,a){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Ee(0),dn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),mr(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,dn(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,r)=>this.write(s,n[r]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Ms([],[0].concat(this.elementShape));const s=this.readMany(e);return mr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),is(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Ms([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return mr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Kt(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,ar(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=s===0?0:n.size/s,o=[];G(()=>{n=V(n,[1,s,i]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:r[l-1],0],d=[1,e[l],i];o[l]=V(Ge(n,u,d),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dl{get id(){return this.idTensor.id}constructor(e,n,s,r=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(i=>{if(s!==i.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${i.dtype}`);mr(n,i.shape,"TensorList shape mismatch: "),dn(i)}),this.idTensor=Ee(0),this.maxNumElements=r,dn(this.idTensor)}copy(){return new Dl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);mr(e,this.elementShape,"TensorList shape mismatch: ");const r=ih(this.elementShape,this.tensors,e);return G(()=>{const i=this.tensors.map(o=>V(o,r));return is(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=ih(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,mr(r.shape,e,"TensorList shape mismatch: "),V(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(mr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");dn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Dl([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);mr(this.tensors[e].shape,n,"TensorList shape mismatch: ");const r=ih(this.elementShape,this.tensors,n);return V(this.tensors[e],r)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);mr(this.elementShape,n.shape,"TensorList shape mismatch: "),dn(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);mr(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=ih(this.elementShape,this.tensors,s);return e.length===0?Ms([],[0].concat(r)):G(()=>{const i=e.map(o=>V(this.tensors[o],r));return is(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);mr(this.elementShape,n,"TensorList shape mismatch: ");const s=ih(this.elementShape,this.tensors,n);return this.size()===0?Ms([],[0].concat(s)):G(()=>{const r=this.tensors.map(i=>V(i,s));return Kt(r,0)})}}function ihe(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const r=t.shape.slice(1);mr(r,e,"TensorList shape mismatch: ");const i=ar(t);return new Dl(i,e,s)}function ohe(t,e,n,s){return new Dl([],t,e,s)}function ahe(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const i=new Dl([],n,t.dtype,s),o=ar(t,0);return e.forEach((a,l)=>{i.setItem(a,o[l])}),i}function lhe(t,e,n){let s=0;const r=e.map(u=>(s+=u,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=WS(i,n),a=s===0?0:t.size/s,l=G(()=>{const u=[];t=V(t,[1,s,a]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:r[d-1],0],p=[1,e[d],a];u[d]=V(Ge(t,f,p),o)}return t.dispose(),u}),c=new Dl([],n,t.dtype,e.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const che=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=C("thenBranch",t,e,n),r=C("elseBranch",t,e,n),i=C("cond",t,e,n),o=C("args",t,e,n);return(await i.data())[0]?n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=C("body",t,e,n),r=C("cond",t,e,n),i=C("args",t,e,n),o=await n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(u=>u.id);let l=await o[0].data();o.forEach(u=>{!u.kept&&a.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){const u=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const d=c.map(f=>f.id);u.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const h=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{const s=C("pred",t,e,n);return[qi(s)]}case"Switch":{const s=C("pred",t,e,n);let r=C("data",t,e,n);return r.kept||(r=qi(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=t.inputNames.find(r=>_n(r,e,n)!==void 0);if(s){const r=_n(s,e,n);return[qi(r)]}return}case"Enter":{const s=C("frameName",t,e,n),r=C("tensor",t,e,n);return n.enterFrame(s),[qi(r)]}case"Exit":{const s=C("tensor",t,e,n);return n.exitFrame(),[qi(s)]}case"NextIteration":{const s=C("tensor",t,e,n);return n.nextIteration(),[qi(s)]}case"TensorArrayV3":{const s=C("size",t,e,n),r=C("dtype",t,e,n),i=C("elementShape",t,e,n),o=C("dynamicSize",t,e,n),a=C("clearAfterRead",t,e,n),l=C("identicalElementShapes",t,e,n),c=C("name",t,e,n),u=new rhe(c,r,s,i,l,o,a);return n.addTensorArray(u),[u.idTensor,Ee(1)]}case"TensorArrayWriteV3":{const s=C("tensorArrayId",t,e,n),r=C("index",t,e,n),i=C("tensor",t,e,n),o=n.getTensorArray(s.id);return o.write(r,i),[o.idTensor]}case"TensorArrayReadV3":{const s=C("tensorArrayId",t,e,n),r=C("index",t,e,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=C("tensorArrayId",t,e,n),r=C("indices",t,e,n),i=C("dtype",t,e,n);return[n.getTensorArray(s.id).gather(r,i)]}case"TensorArrayScatterV3":{const s=C("tensorArrayId",t,e,n),r=C("indices",t,e,n),i=C("tensor",t,e,n),o=n.getTensorArray(s.id);return o.scatter(r,i),[o.idTensor]}case"TensorArrayConcatV3":{const s=C("tensorArrayId",t,e,n),r=n.getTensorArray(s.id),i=C("dtype",t,e,n);return[r.concat(i)]}case"TensorArraySplitV3":{const s=C("tensorArrayId",t,e,n),r=C("tensor",t,e,n),i=C("lengths",t,e,n),o=n.getTensorArray(s.id);return o.split(i,r),[o.idTensor]}case"TensorArraySizeV3":{const s=C("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return[Ee(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=C("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=C("tensorListId",t,e,n),r=C("index",t,e,n),i=C("tensor",t,e,n),o=n.getTensorList(s.id);return o.setItem(r,i),[o.idTensor]}case"TensorListGetItem":{const s=C("tensorListId",t,e,n),r=C("index",t,e,n),i=C("elementShape",t,e,n),o=C("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(r,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=C("indices",t,e,n),r=C("tensor",t,e,n),i=C("elementShape",t,e,n),o=C("numElements",t,e,n),a=ahe(r,s,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=C("elementShape",t,e,n),r=C("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=C(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,l=ohe(s,r,o,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=C("tensorListId",t,e,n),r=C("indices",t,e,n),i=C("elementShape",t,e,n),o=C("elementDType",t,e,n);return[n.getTensorList(s.id).gather(r,o,i)]}case"TensorListStack":{const s=C("tensorListId",t,e,n),r=C("elementShape",t,e,n),i=C("elementDType",t,e,n),o=C("numElements",t,e,n);return[n.getTensorList(s.id).stack(r,i,o)]}case"TensorListFromTensor":{const s=C("tensor",t,e,n),r=C("elementShape",t,e,n),i=C("elementDType",t,e,n),o=ihe(s,r,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=C("tensorListId",t,e,n),r=n.getTensorList(s.id),i=C("dtype",t,e,n),o=C("elementShape",t,e,n);return[r.concat(i,o)]}case"TensorListPushBack":{const s=C("tensorListId",t,e,n),r=C("tensor",t,e,n),i=n.getTensorList(s.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{const s=C("tensorListId",t,e,n),r=C("elementShape",t,e,n),i=C("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(r,i)]}case"TensorListSplit":{const s=C("tensor",t,e,n),r=C("elementShape",t,e,n),i=C("lengths",t,e,n),o=lhe(s,i,r);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=C("tensorListId",t,e,n),r=n.getTensorList(s.id);return[Ee(r.size(),"int32")]}case"TensorListResize":{const s=C("tensorListId",t,e,n),r=C("size",t,e,n),o=n.getTensorList(s.id).resize(r);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_(t,e,n){const[s,r]=C("fusedOps",t,e,n),i=s==="biasadd",o=!i,a=r==="prelu",l=s==="fusedbatchnorm",c=C("numArgs",t,e,n);if(i){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=C("strides",t,e,n),d=Yg(t,e,n),h=C("dataFormat",t,e,n).toUpperCase(),f=C("dilations",t,e,n);let[p,m]=C("args",t,e,n);o&&(m=p,p=void 0);const g=C("leakyreluAlpha",t,e,n);return{stride:u,pad:d,dataFormat:h,dilations:f,biasArg:p,preluArg:m,activationFunc:r,leakyreluAlpha:g}}const uhe=(t,e,n,s=zn)=>{switch(t.op){case"Conv1D":{const r=C("stride",t,e,n),i=C("pad",t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),a=C("dilation",t,e,n);return[s.conv1d(C("x",t,e,n),C("filter",t,e,n),r,i,o,a)]}case"Conv2D":{const r=C("strides",t,e,n),i=Yg(t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),a=C("dilations",t,e,n);return[s.conv2d(C("x",t,e,n),C("filter",t,e,n),[r[1],r[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=S_(t,e,n);return[s.fused.conv2d({x:C("x",t,e,n),filter:C("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=S_(t,e,n);return[s.fused.depthwiseConv2d({x:C("x",t,e,n),filter:C("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=C("outputShape",t,e,n),i=C("strides",t,e,n),o=Yg(t,e,n);return[s.conv2dTranspose(C("x",t,e,n),C("filter",t,e,n),r,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=C("strides",t,e,n),i=Yg(t,e,n),o=C("dilations",t,e,n),a=C("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(C("input",t,e,n),C("filter",t,e,n),[r[1],r[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("dataFormat",t,e,n).toUpperCase(),a=C("dilations",t,e,n);return[s.conv3d(C("x",t,e,n),C("filter",t,e,n),[r[1],r[2],r[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.avgPool(C("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.maxPool(C("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n),a=C("includeBatchInIndex",t,e,n),{result:l,indexes:c}=s.maxPoolWithArgmax(C("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i,a);return[l,c]}case"AvgPool3D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.avgPool3d(C("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("kernelSize",t,e,n);return[s.maxPool3d(C("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=C("strides",t,e,n),i=C("pad",t,e,n),o=C("dilations",t,e,n),a=r[1],l=r[2],c=o[1],u=o[2];return[s.dilation2d(C("x",t,e,n),C("filter",t,e,n),[a,l],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dhe=(t,e,n,s=zn)=>{switch(t.op){case"Fill":{const r=C("shape",t,e,n),i=C("dtype",t,e,n),o=C("value",t,e,n);return[s.fill(r,o,i)]}case"LinSpace":{const r=C("start",t,e,n),i=C("stop",t,e,n),o=C("num",t,e,n);return[s.linspace(r,i,o)]}case"Multinomial":{const r=C("logits",t,e,n),i=C("numSamples",t,e,n),o=C("seed",t,e,n);return[s.multinomial(r,i,o)]}case"OneHot":{const r=C("indices",t,e,n),i=C("depth",t,e,n),o=C("onValue",t,e,n),a=C("offValue",t,e,n),l=C("dtype",t,e,n);return[s.oneHot(r,i,o,a,l)]}case"Ones":return[s.ones(C("shape",t,e,n),C("dtype",t,e,n))];case"OnesLike":return[s.onesLike(C("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(C("shape",t,e,n),C("dtype",t,e,n),C("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(C("shape",t,e,n),C("minval",t,e,n),C("maxval",t,e,n),C("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(C("shape",t,e,n),C("minval",t,e,n),C("maxval",t,e,n),C("seed",t,e,n))];case"Range":{const r=C("start",t,e,n),i=C("stop",t,e,n),o=C("step",t,e,n);return[s.range(r,i,o,C("dtype",t,e,n))]}case"TruncatedNormal":{const r=C("shape",t,e,n),i=C("mean",t,e,n),o=C("stdDev",t,e,n),a=C("seed",t,e,n);return[s.truncatedNormal(r,i,o,C("dtype",t,e,n),a)]}case"Zeros":return[s.zeros(C("shape",t,e,n),C("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1(t,e,n){const s=C("boxes",t,e,n),r=C("scores",t,e,n),i=C("maxOutputSize",t,e,n),o=C("iouThreshold",t,e,n),a=C("scoreThreshold",t,e,n),l=C("softNmsSigma",t,e,n);return{boxes:s,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const hhe=async(t,e,n,s,r=zn)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=S1(t,e,n),d=await r.image.nonMaxSuppressionWithScoreAsync(i,o,a,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=S1(t,e,n),u=C("padToMaxOutputSize",t,e,n),d=await r.image.nonMaxSuppressionPaddedAsync(i,o,a,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=S1(t,e,n);return[await r.image.nonMaxSuppressionAsync(i,o,a,l,c)]}case"Where":{const i=r.cast(C("condition",t,e,n),"bool"),o=[await r.whereAsync(i)];return i.dispose(),o}case"ListDiff":return r.setdiff1dAsync(C("x",t,e,n),C("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fhe=(t,e,n,s=zn)=>{switch(t.op){case"LowerBound":{const r=C("sortedSequence",t,e,n),i=C("values",t,e,n);return[s.lowerBound(r,i)]}case"TopKV2":{const r=C("x",t,e,n),i=C("k",t,e,n),o=C("sorted",t,e,n),a=s.topk(r,i,o);return[a.values,a.indices]}case"UpperBound":{const r=C("sortedSequence",t,e,n),i=C("values",t,e,n);return[s.upperBound(r,i)]}case"Unique":{const r=C("x",t,e,n),i=s.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=C("x",t,e,n),i=C("axis",t,e,n),o=s.unique(r,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const phe=(t,e,n,s=zn)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=C("default",t,e,n);return[_n(t.name,e,n)||r];case"Placeholder":return[_n(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=C("x",t,e,n);return[qi(u)]}case"IdentityN":return C("x",t,e,n).map(u=>qi(u));case"Snapshot":const i=C("x",t,e,n);return[qi(i)];case"Shape":return[s.tensor1d(C("x",t,e,n).shape,"int32")];case"ShapeN":return C("x",t,e,n).map(u=>s.tensor1d(u.shape));case"Size":return[s.scalar(C("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(C("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=C("x",t,e,n),a=C("data",t,e,n),l=C("message",t,e,n),c=C("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mhe{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Ee(0),this.tensorMap=new Map,dn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ee(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),G(()=>{const r=ar(n),i=s.length,o=r.length;E(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const l=s[a],c=r[a];dn(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return G(()=>{const r=[];for(let i=0;i<s.length;i++){const o=s[i],a=this.findWithDefault(o,n);r.push(a)}return is(r)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ghe=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(t.name);if(r!=null)return[r];{const i=C("keyDType",t,e,n),o=C("valueDType",t,e,n),a=new mhe(i,o);return s.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=C("tableHandle",t,e,n,s),i=C("keys",t,e,n),o=C("values",t,e,n);return[await s.getHashTableById(r.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=C("tableHandle",t,e,n,s),i=C("keys",t,e,n),o=C("defaultValue",t,e,n);return[await s.getHashTableById(r.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=C("tableHandle",t,e,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yhe=(t,e,n,s=zn)=>{switch(t.op){case"ResizeBilinear":{const r=C("images",t,e,n),i=C("size",t,e,n),o=C("alignCorners",t,e,n),a=C("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(r,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const r=C("images",t,e,n),i=C("size",t,e,n),o=C("alignCorners",t,e,n),a=C("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(r,[i[0],i[1]],o,a)]}case"CropAndResize":{const r=C("image",t,e,n),i=C("boxes",t,e,n),o=C("boxInd",t,e,n),a=C("cropSize",t,e,n),l=C("method",t,e,n),c=C("extrapolationValue",t,e,n);return[s.image.cropAndResize(r,i,o,a,l,c)]}case"ImageProjectiveTransformV3":{const r=C("images",t,e,n),i=C("transforms",t,e,n),o=C("outputShape",t,e,n),a=C("fillValue",t,e,n),l=C("interpolation",t,e,n),c=C("fillMode",t,e,n);return[s.image.transform(r,i,l.toLowerCase(),c.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xhe=(t,e,n,s=zn)=>{switch(t.op){case"Equal":return[s.equal(C("a",t,e,n),C("b",t,e,n))];case"NotEqual":return[s.notEqual(C("a",t,e,n),C("b",t,e,n))];case"Greater":return[s.greater(C("a",t,e,n),C("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(C("a",t,e,n),C("b",t,e,n))];case"Less":return[s.less(C("a",t,e,n),C("b",t,e,n))];case"LessEqual":return[s.lessEqual(C("a",t,e,n),C("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(C("a",t,e,n),C("b",t,e,n))];case"LogicalNot":return[s.logicalNot(C("a",t,e,n))];case"LogicalOr":return[s.logicalOr(C("a",t,e,n),C("b",t,e,n))];case"Select":case"SelectV2":return[s.where(C("condition",t,e,n),C("a",t,e,n),C("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(C("a",t,e,n),C("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whe=(t,e,n,s=zn)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(C("a",t,e,n),C("b",t,e,n),C("transposeA",t,e,n),C("transposeB",t,e,n))];case"Einsum":return[s.einsum(C("equation",t,e,n),...C("tensors",t,e,n))];case"Transpose":return[s.transpose(C("x",t,e,n),C("perm",t,e,n))];case"_FusedMatMul":const[r,i]=C("fusedOps",t,e,n),o=r==="biasadd",a=i==="prelu",l=C("numArgs",t,e,n),c=C("leakyreluAlpha",t,e,n);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=C("args",t,e,n);return[s.fused.matMul({a:C("a",t,e,n),b:C("b",t,e,n),transposeA:C("transposeA",t,e,n),transposeB:C("transposeB",t,e,n),bias:u,activation:i,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(C("a",t,e,n),C("numLower",t,e,n),C("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bhe=(t,e,n,s=zn)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(C("x",t,e,n),C("axis",t,e,n),C("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(C("x",t,e,n),C("mean",t,e,n),C("variance",t,e,n),C("offset",t,e,n),C("scale",t,e,n),C("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(C("x",t,e,n),C("mean",t,e,n),C("variance",t,e,n),C("offset",t,e,n),C("scale",t,e,n),C("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(C("x",t,e,n),C("radius",t,e,n),C("bias",t,e,n),C("alpha",t,e,n),C("beta",t,e,n))];case"Softmax":return[s.softmax(C("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vhe=(t,e,n,s=zn)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:i}=s.raggedGather(C("paramsNestedSplits",t,e,n),C("paramsDenseValues",t,e,n),C("indices",t,e,n),C("outputRaggedRank",t,e,n));return r.concat(i)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:i}=s.raggedRange(C("starts",t,e,n),C("limits",t,e,n),C("splits",t,e,n));return[r,i]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(C("shape",t,e,n),C("values",t,e,n),C("defaultValue",t,e,n),C("rowPartitionTensors",t,e,n),C("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const She=(t,e,n,s=zn)=>{switch(t.op){case"Max":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.max(C("x",t,e,n),a,l)]}case"Mean":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.mean(C("x",t,e,n),a,l)]}case"Min":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.min(C("x",t,e,n),a,l)]}case"Sum":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.sum(C("x",t,e,n),a,l)]}case"All":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.all(C("x",t,e,n),a,l)]}case"Any":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.any(C("x",t,e,n),a,l)]}case"ArgMax":{const a=C("axis",t,e,n);return[s.argMax(C("x",t,e,n),a)]}case"ArgMin":{const a=C("axis",t,e,n);return[s.argMin(C("x",t,e,n),a)]}case"Prod":{const a=C("axis",t,e,n),l=C("keepDims",t,e,n);return[s.prod(C("x",t,e,n),a,l)]}case"Cumprod":{const a=C("axis",t,e,n),l=C("exclusive",t,e,n),c=C("reverse",t,e,n);return[s.cumprod(C("x",t,e,n),a,l,c)]}case"Cumsum":{const a=C("axis",t,e,n),l=C("exclusive",t,e,n),c=C("reverse",t,e,n);return[s.cumsum(C("x",t,e,n),a,l,c)]}case"Bincount":const r=C("x",t,e,n),i=C("weights",t,e,n),o=C("size",t,e,n);return[s.bincount(r,i,o)];case"DenseBincount":{const a=C("x",t,e,n),l=C("weights",t,e,n),c=C("size",t,e,n),u=C("binaryOutput",t,e,n);return[s.denseBincount(a,l,c,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const khe=(t,e,n,s=zn)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=C("n",t,e,n),i=C("axis",t,e,n);let o=C("tensors",t,e,n);return o=o.slice(0,r),[s.concat(o,i)]}case"Gather":{const r=C("x",t,e,n),i=C("indices",t,e,n);return[s.gather(r,s.cast(i,"int32"),0)]}case"GatherV2":{const r=C("axis",t,e,n),i=C("batchDims",t,e,n),o=C("x",t,e,n),a=C("indices",t,e,n);return[s.gather(o,s.cast(a,"int32"),r,i)]}case"Reverse":{const r=C("dims",t,e,n),i=[];for(let a=0;a<r.length;a++)r[a]&&i.push(a);const o=C("x",t,e,n);return[s.reverse(o,i)]}case"ReverseV2":{const r=C("axis",t,e,n),i=C("x",t,e,n);return[s.reverse(i,r)]}case"Slice":{const r=C("begin",t,e,n),i=C("size",t,e,n);return[s.slice(C("x",t,e,n),r,i)]}case"StridedSlice":{const r=C("begin",t,e,n),i=C("end",t,e,n),o=C("strides",t,e,n),a=C("beginMask",t,e,n),l=C("endMask",t,e,n),c=C("ellipsisMask",t,e,n),u=C("newAxisMask",t,e,n),d=C("shrinkAxisMask",t,e,n),h=C("x",t,e,n);return[s.stridedSlice(h,r,i,o,a,l,c,u,d)]}case"Pack":return G(()=>{const r=C("axis",t,e,n),i=C("tensors",t,e,n),o=i[0].shape,a=s.squeeze(i[0]).shape,l=i.map(c=>{const u=Ue(c.shape,o);if(!u&&!Ue(s.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return u?c:s.reshape(c,o)});return[s.stack(l,r)]});case"Unpack":{const r=C("axis",t,e,n),i=C("tensor",t,e,n);return s.unstack(i,r)}case"Tile":{const r=C("reps",t,e,n);return[s.tile(C("x",t,e,n),r)]}case"Split":case"SplitV":{const r=C("axis",t,e,n),i=C("numOrSizeSplits",t,e,n),o=C("x",t,e,n);return s.split(o,i,r)}case"ScatterNd":{const r=C("indices",t,e,n),i=C("values",t,e,n),o=C("shape",t,e,n);return[s.scatterND(r,i,o)]}case"GatherNd":{const r=C("x",t,e,n),i=C("indices",t,e,n);return[s.gatherND(r,i)]}case"SparseToDense":{const r=C("sparseIndices",t,e,n),i=C("outputShape",t,e,n),o=C("sparseValues",t,e,n),a=C("defaultValue",t,e,n);return[s.sparseToDense(r,o,i,o.dtype===a.dtype?a:s.cast(a,o.dtype))]}case"TensorScatterUpdate":{const r=C("indices",t,e,n),i=C("values",t,e,n),o=C("tensor",t,e,n);return[s.tensorScatterUpdate(o,r,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Che=(t,e,n,s=zn)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(C("indices",t,e,n),C("values",t,e,n),C("denseShape",t,e,n),C("defaultValue",t,e,n));return[r,i,o,a]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=s.sparse.sparseReshape(C("inputIndices",t,e,n),C("inputShape",t,e,n),C("newShape",t,e,n));return[r,i]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(C("data",t,e,n),C("indices",t,e,n),C("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(C("data",t,e,n),C("indices",t,e,n),C("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe=(t,e,n,s=zn)=>{switch(t.op){case"FFT":return[s.fft(C("x",t,e,n))];case"IFFT":return[s.ifft(C("x",t,e,n))];case"RFFT":return[s.rfft(C("x",t,e,n))];case"IRFFT":return[s.irfft(C("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The=(t,e,n,s=zn)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(C("input",t,e,n),C("pattern",t,e,n),C("rewrite",t,e,n),C("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=s.string.stringNGrams(C("data",t,e,n),C("dataSplits",t,e,n),C("separator",t,e,n),C("nGramWidths",t,e,n),C("leftPad",t,e,n),C("rightPad",t,e,n),C("padWidth",t,e,n),C("preserveShortSequences",t,e,n));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:o}=s.string.stringSplit(C("input",t,e,n),C("delimiter",t,e,n),C("skipEmpty",t,e,n));return[r,i,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(C("input",t,e,n),C("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ihe=(t,e,n,s=zn)=>{switch(t.op){case"Cast":return[s.cast(C("x",t,e,n),C("dtype",t,e,n))];case"ExpandDims":{const r=C("axis",t,e,n);return[s.expandDims(C("x",t,e,n),r)]}case"Squeeze":{const r=C("axis",t,e,n);return[s.squeeze(C("x",t,e,n),r)]}case"Reshape":return[s.reshape(C("x",t,e,n),C("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(C("x",t,e,n),C("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(C("x",t,e,n),C("padding",t,e,n),C("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(C("x",t,e,n),C("padding",t,e,n),C("constantValue",t,e,n))];case"SpaceToBatchND":{const r=C("blockShape",t,e,n),i=C("paddings",t,e,n);return[s.spaceToBatchND(C("x",t,e,n),r,i)]}case"BatchToSpaceND":{const r=C("blockShape",t,e,n),i=C("crops",t,e,n);return[s.batchToSpaceND(C("x",t,e,n),r,i)]}case"DepthToSpace":{const r=C("blockSize",t,e,n),i=C("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(C("x",t,e,n),r,i)]}case"BroadcastTo":return[s.broadcastTo(C("x",t,e,n),C("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(C("s0",t,e,n),C("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_(t,e,n,s,r=G){const i=((o,a,l)=>{switch(o.category){case"arithmetic":return r(()=>nhe(o,a,l));case"basic_math":return r(()=>she(o,a,l));case"control":return che(o,a,l);case"convolution":return r(()=>uhe(o,a,l));case"creation":return r(()=>dhe(o,a,l));case"dynamic":return hhe(o,a,l);case"evaluation":return r(()=>fhe(o,a,l));case"image":return r(()=>yhe(o,a,l));case"graph":return r(()=>phe(o,a,l));case"logical":return r(()=>xhe(o,a,l));case"matrices":return r(()=>whe(o,a,l));case"normalization":return r(()=>bhe(o,a,l));case"ragged":return r(()=>vhe(o,a,l));case"reduction":return r(()=>She(o,a,l));case"slice_join":return r(()=>khe(o,a,l));case"sparse":return r(()=>Che(o,a,l));case"spectral":return r(()=>Nhe(o,a,l));case"string":return r(()=>The(o,a,l));case"transformation":return r(()=>Ihe(o,a,l));case"hash_table":return ghe(o,a,l,s);case"custom":const c=l4(o.op);if(c&&c.customExecutor)return c.customExecutor(new the(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return ao(i)?i.then(o=>[].concat(o)):[].concat(i)}class C_{constructor(e={},n={},s={},r={},i){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_(t,e,n,s){const r=new Set,i=[];let o=null,a=null;const l=new Set,c=new Set(Object.keys(t).map(h=>Is(h)[0]));s=s||[];const u=new Set(s.map(h=>Is(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((qa(h)||Fhe(h)||Phe(h))&&o==null&&(o=h,a=o.children.map(f=>f.name).filter(f=>r.has(f))),r.add(h.name),n[h.name]==null&&!c.has(h.name)&&!u.has(h.name)){if(h.inputs.length===0){i.push(h.name);continue}h.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}function $he(t,e){const{usedNodes:n,inputs:s}=e,r=Object.keys(s).map(g=>Is(g)[0]).map(g=>t.nodes[g]),i=t.initNodes||[],o=g=>n.has(typeof g=="string"?g:g.name);function a(g){return[...new Map(g.map(y=>[y.name,y])).values()]}const l=a([...r,...t.weights,...i]).filter(o),c=a([...l,...Object.values(t.nodes)]).filter(o),u=new Map(c.map(g=>[g.name,g])),d={};for(const g of c){d[g.name]=d[g.name]||0;for(const y of g.children)o(y)||(d[y.name]=Number.POSITIVE_INFINITY),d[y.name]=(d[y.name]||0)+1}const h=Object.entries(d).filter(([,g])=>g===0).map(([g])=>g),f=[...h];for(;h.length>0;){const g=h.pop(),y=u.get(g);for(const x of y.children.filter(o))--d[x.name]===0&&(f.push(x.name),h.push(x.name))}const p=f.map(g=>u.get(g)),m=Ehe(p,l);return Rhe(m,l),m}function Ehe(t,e){const n=new Map(t.map(o=>[o.name,o])),s=e.map(o=>o.name),r=new Set(s);for(;s.length>0;){const o=s.pop(),a=n.get(o);for(const l of a.children)!n.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return t.filter(o=>r.has(o.name))}class pg extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function Rhe(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),s=new Set(e.map(a=>a.name)),r=a=>s.has(typeof a=="string"?a:a.name),i=new Set(t.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(o)){if(!n.has(l.name))throw new pg(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new pg(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!r(a))for(const l of a.inputs){if(!n.has(l.name))throw new pg(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new pg(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function Ahe(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,s=t.map((a,l)=>qa(a)?n:l),r=a=>{const l=s[e.get(a.name)];return l??-1},i=t.map((a,l)=>a.children.map(r).reduce((c,u)=>Math.max(c,u),s[l])),o=new Map;for(let a=0;a<t.length;++a){const l=i[a];if(l===n)continue;const c=t[a],u=t[l];o.has(u.name)||o.set(u.name,[]),o.get(u.name).push(c)}return o}const _he=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Dhe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),Ohe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function qa(t){return _he.has(t.op)}function Fhe(t){return Dhe.has(t.op)}function Phe(t){return Ohe.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o0{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new o0(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(i=>i.name).sort(),r=n.map(i=>i.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,n){const s=N_(e,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=s;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const c=n.map(d=>d.name),u=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${u}]. Missing the following inputs: [${r}]`)}const a=$he(this.graph,s),l=Ahe(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return dn(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(h=>this.graph.nodes[Is(h)[0]]),i=n.map(h=>Is(h)[0]),o=new Set(i);let a=i.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(r,a);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,a),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=K().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const u={},d={};return G(()=>{const h=new C_(this.weightMap,u,d,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(y=>{const[x,w]=Is(y,h),b=[];b[w]=e[y],f[x]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[x]=this.cloneTensorList(b))});const p=this.getFrozenTensorIds(f),{orderedNodes:m,nodeLiveUntilMap:g}=c;for(const y of m){if(f[y.name])continue;const x=k_(y,f,h,this._resourceManager);if(ao(x))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);f[y.name]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[y.name]=this.cloneTensorList(x)),this.checkTensorForDisposalWithNodeLiveUntilInfo(y,f,h,p,o,g.get(y.name))}return this.parent==null&&h.dispose(p),n.map(y=>_n(y,f,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(e,n,s,r,i,o,a){if(!(qa(n)||o.has(e))){for(const l of s[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(qa(l))continue;const c=x_(l.name,s,r);if(c!=null)for(const u of c){if(!u||u.kept||i.has(u.id))continue;const d=a[u.id];d===1?(u.dispose(),delete a[u.id]):d!=null&&a[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,r,i,o){function a(l){return qa(l)||i.has(l.name)}if(!(qa(e)||o==null))for(const l of o){if(a(l))continue;const c=x_(l.name,n,s);for(const u of c)!u||u.kept||r.has(u.id)||u.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,r={},i={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=K().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const o=new C_(this.weightMap,r,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,n,s),l=n.map(h=>_n(h,a,o)),c=l.map(h=>h.id),u=Object.keys(e).map(h=>e[h].id),d=new Set([...c,...u,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(f=>{f&&!f.isDisposed&&!d.has(f.id)&&f.dispose()})}),this.parent==null&&o.dispose(d),l}async executeFunctionAsync(e,n,s){const r=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,r){const i=Object.keys(e),o=i.map(b=>this.graph.nodes[Is(b)[0]]),a=s.map(b=>Is(b)[0]),l=new Set(a);let c=a.map(b=>this.graph.nodes[b]);c.length===0&&(c=this._outputs);const{usedNodes:u,missingInputs:d,dynamicNode:h,syncInputs:f}=N_(e,c,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(b=>({node:b,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(b=>{const[S,T]=Is(b),I=[];I[T]=e[b],m[S]=I});const g={},y=this.getFrozenTensorIds(m),x={};for(;p.length>0;){const b=this.processStack(o,p,n,m,x,y,l,g,u);await Promise.all(b)}h==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const w=c.filter(b=>!qa(b)&&!_n(b.name,m,n)).map(b=>b.name);if(w.length>0){let b="";throw h!=null&&(b=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${w}] from the provided inputs [${i}]. Consider providing the following inputs: [${d}]. ${b}`)}return m}processStack(e,n,s,r,i,o,a,l,c){const u=[];for(;n.length>0;){const d=n.pop();s.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&C("isConstant",d.node,r,s)&&([h]=Hi(d.node.name,s)),r[d.node.name]==null){const f=k_(d.node,r,s,this._resourceManager);h||([h]=Hi(d.node.name,s));const p=s.currentContext;ao(f)?u.push(f.then(m=>(r[h]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(m)),s.currentContext=p,this.checkTensorForDisposal(h,d.node,r,s,o,a,l),this.processChildNodes(d.node,n,s,r,i,c),m))):(r[h]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(f)),this.checkTensorForDisposal(h,d.node,r,s,o,a,l),this.processChildNodes(d.node,n,s,r,i,c))}else this.processChildNodes(d.node,n,s,r,i,c)}return u}processChildNodes(e,n,s,r,i,o){e.children.forEach(a=>{const[l]=Hi(a.name,s);i[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!_n(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})):a.inputNames.every(c=>!!_n(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[r]=Is(n),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===s.shape.length&&s.shape.every((l,c)=>o[c]===-1||o[c]===l);E(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&E(s.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const r={};for(const i in e){const o=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[i];o!=null?r[o.name]=e[i]:r[i]=e[i]}return r}checkInputs(e){const n=Object.keys(e).filter(s=>{const[r]=Is(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,r;const i=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return i!=null?i.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=Is(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class Lhe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mhe="?tfjs-format=file",Bhe="model.json";class RI{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=I2){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new Lhe}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return ao(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await L3(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new o0(w_.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=w_.Instance.transformGraph(e.modelInitializer);this.initializer=new o0(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof Xe?[e]:e,s={};return n.forEach((r,i)=>s[this.structuredOutputKeys[i]]=r),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof Xe)&&!Array.isArray(e)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((i,o)=>{var a,l,c;const u=(c=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||c===void 0?void 0:c.resourceId;return u!=null?i[o]=this.resourceIdToCapturedInput[u]:i[o]=e[r++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const i=s[r],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=e[r]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Oe(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function d4(t,e={},n=I2){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Vhe(t));const s=new RI(t,e,n);return await s.load(),s}function zhe(t){if(t==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[s,r]=t;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const i=qy(s.weightsManifest),o=oN(s,i,r);e=Xy(o)}else if("load"in t)e=t;else if("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t)e=Xy(t);else throw new Error("Unknown model format");const n=new RI(e);return n.load(),n}function Vhe(t){return t.endsWith("/")||(t=t+"/"),`${t}${Bhe}${Mhe}`}/** @license See the LICENSE file. */const h4="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function jhe(t,e){return a0(t,e)}function a0(t,e,n=new Map,s=new Set){if(t==null)return null;if(typeof Blob=="function"&&t instanceof Blob)return t.slice();if(s.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse)if(cu(t)){const i=Array.isArray(t)?[]:{};s.add(t);for(const o in t){const a=t[o],l=a0(a,e,n,s);i[o]=l}return s.delete(t),t.__proto__&&(i.__proto__=t.__proto__),i}else throw new Error(`Can't recurse into non-iterable type: ${t}`);else return n.set(t,r.value),r.value}function Uhe(t,e=p4){return f4(t,e)}function f4(t,e,n=new Set){const s=t[0];if(n.has(s))throw new Error("Circular references are not supported.");const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse)if(cu(s)){const i=Array.isArray(s)?[]:{};n.add(s);for(const o in s){const a=t.map(c=>c[o]),l=f4(a,e,n);i[o]=l}return n.delete(s),i}else throw new Error(`Can't recurse into non-iterable type: ${s}`);else return r.value}function p4(t){return t===null?null:cu(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function m4(t,e){const n=new Map;a0(t,e,n);for(const r of Array.from(n.keys())){const i=n.get(r);if(ao(i)){const o=await i;n.set(r,o)}}return a0(t,e,n)}function cu(t){let e=!1;if(K().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");e=t instanceof n}return t!=null&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||typeof t=="object"&&!(t instanceof Xe)&&!(t instanceof Promise)&&!e)}function Whe(t){return t==null||Ghe(t)||Array.isArray(t)||typeof t=="object"&&t instanceof Xe||ln(t)}function Ghe(t){return t===null||typeof t!="object"&&typeof t!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function Hhe(t){return jhe(t,qhe)}function qhe(t){return t instanceof Xe?{value:t.clone(),recurse:!1}:cu(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class g4{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,n){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=n}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const n of e)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+e),s=this.get(n);return this.set(n,this.pop()),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class cb extends g4{constructor(){super(cb.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=this.capacity*2,n=new Array(e),s=this.length();for(let r=0;r<s;r++)n[r]=this.get(this.wrap(this.begin+r));this.data=n,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=s}}cb.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function y4(t){return new Yhe(t)}function AI(t){return new Jhe(t)}function Khe(t,e){return new x4(t,e)}function Xhe(t,e=jo.FAIL){return new ofe(t,e)}class Nn{async toArray(){const e=[];let n=await this.next();for(;!n.done;)e.push(n.value),n=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),n=[];let s=await e.next();for(;!s.done;)n.push(s.value),s=await e.next();return n}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let n=await this.next(),s=e(n.value);for(;!n.done&&s;)n=await this.next(),s=e(n.value)}handleErrors(e){return new rfe(this,e)}filter(e){return new nfe(this,e)}map(e){return new sfe(this,e)}mapAsync(e){return new T_(this,e)}serialMapAsync(e){return new T_(this,e).serial()}flatmap(e){return new ife(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(n=>n===!0)}rowMajorBatch(e,n=!0){return new tfe(this,e,n)}columnMajorBatch(e,n=!0,s=p4){return this.rowMajorBatch(e,n).map(i=>Uhe(i,s))}concatenate(e,n){return new x4(y4([this,e]),n)}take(e){return e<0||e==null?this:new efe(this,e)}skip(e){return e<0||e==null?this:new Zhe(this,e)}prefetch(e){return new w4(this,e)}shuffle(e,n){return new afe(this,e,n)}serial(){return new Qhe(this)}}class Yhe extends Nn{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:Hhe(e),done:!1}}}class Jhe extends Nn{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}}class Qhe extends Nn{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class Zhe extends Nn{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;Oe(e.value)}return this.upstream.next()}}class efe extends Nn{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class tfe extends Nn{constructor(e,n,s=!0){super(),this.upstream=e,this.batchSize=n,this.enableSmallLastBatch=s,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(n.value)}return{value:e,done:!1}}}class nfe extends Nn{constructor(e,n){super(),this.upstream=e,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Oe(e.value)}}}class sfe extends Nn{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=co(e.value),s=this.transform(e.value),r=co(s);for(const i of n)tw(i,r)||i.dispose();return{value:s,done:!1}}}class rfe extends Nn{constructor(e,n){super(),this.upstream=e,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class T_ extends Nn{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=co(e.value),s=await this.transform(e.value),r=co(s);for(const i of n)tw(i,r)||i.dispose();return{value:s,done:!1}}}class _I extends Nn{constructor(){super(),this.outputQueue=new cb,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class ife extends _I{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const n=co(e.value),s=this.transform(e.value),r=co(s);this.outputQueue.pushAll(s);for(const i of n)tw(i,r)||i.dispose();return!0}}class x4 extends Nn{constructor(e,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){const s=await this.moreIterators.next();if(s.done)return{value:null,done:!0};this.iterator=s.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(e)):n}}var jo;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(jo||(jo={}));class ofe extends Nn{constructor(e,n=jo.FAIL){super(),this.iterators=e,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let n=0,s=0;function r(o){return o instanceof Nn?{value:o.next().then(l=>(n++,l.done&&s++,l.value)),recurse:!1}:{value:null,recurse:!0}}const i=await m4(this.iterators,r);if(n===s)return{value:null,done:!0};if(s>0)switch(this.mismatchMode){case jo.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case jo.SHORTEST:return{value:null,done:!0};case jo.LONGEST:}return this.count++,{value:i,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class w4 extends Nn{constructor(e,n){super(),this.upstream=e,this.bufferSize=n,this.buffer=new g4(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class afe extends w4{constructor(e,n,s){super(e,n),this.upstream=e,this.windowSize=n,this.upstreamExhausted=!1,this.random=Td.alea(s||Rn().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),n=await this.buffer.shuffleExcise(e);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Dd{constructor(){this.size=null}batch(e,n=!0){const s=this;E(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:n?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),Ts(async()=>(await s.iterator()).columnMajorBatch(e,n,ufe),r)}concatenate(e){const n=this;let s;return this.size===1/0||e.size===1/0?s=1/0:this.size!=null&&e.size!=null?s=this.size+e.size:s=null,Ts(async()=>(await n.iterator()).concatenate(await e.iterator()),s)}filter(e){const n=this;let s;return this.size===1/0?s=1/0:s=null,Ts(async()=>(await n.iterator()).filter(r=>G(()=>e(r))),s)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const n=this;return Ts(async()=>(await n.iterator()).map(s=>G(()=>e(s))),this.size)}mapAsync(e){const n=this;return Ts(async()=>(await n.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return Ts(async()=>(await n.iterator()).prefetch(e),this.size)}repeat(e){const n=this;let s;return this.size!=null&&e>0?s=this.size*e:e===0?s=0:this.size!=null&&(e===void 0||e<0)?s=1/0:s=null,Ts(async()=>{const r=AI(async()=>({value:await n.iterator(),done:!1}));return Khe(r.take(e))},s)}skip(e){const n=this;let s;return this.size!=null&&e>=0&&this.size>=e?s=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?s=0:s=null,Ts(async()=>(await n.iterator()).skip(e),s)}shuffle(e,n,s=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,i=Td.alea(n||Rn().toString());return Ts(async()=>{let o=i.int32();return s&&(o+=i.int32()),(await r.iterator()).shuffle(e,o.toString())},this.size)}take(e){const n=this;let s;return this.size!=null&&this.size>e?s=e:this.size!=null&&this.size<=e?s=this.size:s=null,Ts(async()=>(await n.iterator()).take(e),s)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}Dd.MAX_BUFFER_SIZE=1e4;function Ts(t,e=null){return new class extends Dd{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function lfe(t){return Ts(async()=>y4(t),t.length)}function cfe(t){if(!cu(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=e==null?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=e==null?t[n].size:Math.min(e,t[n].size);return Ts(async()=>{const n=await m4(t,s=>{if(s instanceof Dd)return{value:s.iterator(),recurse:!1};if(cu(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Xhe(n,jo.SHORTEST)},e)}function ufe(t){if(t===null)return null;const e=t[0];return Whe(e)?{value:dfe(t),recurse:!1}:{value:null,recurse:!0}}function dfe(t){if(t.length===0)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof Xe?is(t):Ms(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class b4 extends Dd{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(r=>(r.endsWith("\r")&&(r=r.slice(0,-1)),r))}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const mg='"',oh=Symbol("out"),I_=Symbol("field"),gg=Symbol("quote"),k1=Symbol("quoteafterquote"),$_=Symbol("quoteinquote");class v4 extends Dd{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&E(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);const n=this.fullColumnNames.reduce((r,i)=>(r[i]=r[i]+1||1,r),{}),s=Object.keys(n).filter(r=>n[r]>1);if(E(s.length===0,()=>"Duplicate column names found: "+s.toString()),this.columnConfigs){for(const r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const n=await(await this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const s=n.value;return this.parseRow(s,!1)}else return null}constructor(e,n){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new b4(e),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(E(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(n=>this.makeDataElement(n))}makeDataElement(e){const n=this.parseRow(e),s={},r={};for(let i=0;i<this.fullColumnNames.length;i++){const o=this.fullColumnNames[i],a=this.columnConfigs?this.columnConfigs[o]:null;if(!(this.configuredColumnsOnly&&!a)){const l=n[i];let c=null;if(l==="")if(a&&a.default!==void 0)c=a.default;else{if(a&&(a.required||a.isLabel))throw new Error(`Required column ${o} is empty in this line: ${e}`);c=void 0}else{const u=Number(l);if(isNaN(u))a&&a.dtype==="bool"?c=this.getBoolean(l):c=l;else if(!a||!a.dtype)c=u;else switch(a.dtype){case"float32":c=u;break;case"int32":c=Math.floor(u);break;case"bool":c=this.getBoolean(l);break;default:c=u}}a&&a.isLabel?r[o]=c:s[o]=c}}return Object.keys(r).length===0?s:{xs:s,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,n=!0){const s=[];let r=0;const i=e.length;let o=oh;for(let a=0;a<i;a++)switch(o){case oh:switch(e.charAt(a)){case mg:r=a+1,o=gg;break;case this.delimiter:if(r=a+1,this.delimiter===" "&&this.delimWhitespace)break;s.push(""),o=oh;break;default:o=I_,r=a;break}break;case I_:switch(e.charAt(a)){case this.delimiter:s.push(e.substring(r,a)),o=oh,r=a+1;break}break;case gg:switch(e.charAt(a)){case mg:o=k1;break}break;case k1:switch(e.charAt(a)){case this.delimiter:s.push(e.substring(r,a-1)),o=oh,r=a+1;break;case mg:o=gg;break;default:o=$_;break}break;case $_:switch(e.charAt(a)){case mg:o=gg;break}break}if(o===k1?s.push(e.substring(r,i-1)):s.push(e.substring(r)),n&&s.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${s}`);return s}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class DI extends Nn{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=e.includeSpectrogram!==!1,this.includeWaveform=e.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!K().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const n=new DI(e);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(s){throw new Error(`Error thrown while initializing video stream: ${s.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,n;const s=await this.getAudioData();if(this.includeSpectrogram){const r=this.flattenQueue(s.freqDataQueue);e=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const r=this.flattenQueue(s.timeDataQueue);n=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const e=[],n=[];let s=0;return new Promise(r=>{const i=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:n}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++s===this.numFrames&&(clearInterval(i),r({freqDataQueue:e,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){const n=e[0].length,s=new Float32Array(e.length*n);return e.forEach((r,i)=>s.set(r,i*n)),s}getTensorFromAudioDataArray(e,n){const s=new Float32Array(se(n));return s.set(e,s.length-e.length),Ms(s,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class OI extends Nn{constructor(e,n){if(super(),this.webcamVideoElement=e,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=On([0],"int32"),this.webcamConfig.centerCrop){const s=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,i=(1-s)/2,o=(1-r)/2,a=i+s,l=r+o;this.cropBox=ta([o,i,l,a],[1,4])}else this.cropBox=ta([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,n={}){if(!K().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=n.resizeWidth,e.height=n.resizeHeight}const s=new OI(e,n);return await s.start(),s}async start(){this.webcamConfig.facingMode&&E(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=$2(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return G(()=>{const n=An(me(e,"float32"),0);let s;s=Zs.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=s.shape;return V(s,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class S4{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class k4 extends Nn{split(e){return new hfe(this,e)}}class hfe extends k4{constructor(e,n){super(),this.upstream=e,this.impl=new ffe(e,n)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class ffe extends _I{constructor(e,n){super(),this.upstream=e,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=e.value.split(this.separator);n[0]=this.carryover+n[0];for(const s of n.slice(0,-1))this.outputQueue.push(s);return this.carryover=n[n.length-1],!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class pfe extends Nn{decodeUTF8(){return new mfe(this)}}class mfe extends k4{constructor(e){super(),this.upstream=e,this.impl=new gfe(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class gfe extends _I{constructor(e){if(super(),this.upstream=e,K().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=require("string_decoder");this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const e=await this.upstream.next();let n;if(e.done)return!1;n=e.value;let s;return K().get("IS_BROWSER")?s=this.decoder.decode(n,{stream:!0}):s=this.decoder.write(Buffer.from(n.buffer)),this.outputQueue.push(s),!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class C4 extends pfe{constructor(e,n={}){super(),this.file=e,this.options=n,E(e instanceof Uint8Array||(K().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((n,s)=>{const r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,r)));else{const i=new FileReader;i.onload=a=>{let l=i.result;if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),!(l instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));n(l)},i.onabort=a=>s(new Error("Aborted")),i.onerror=a=>s(new Error(a.type));const o=this.file.slice(this.offset,r);i.readAsArrayBuffer(o)}this.offset=r}),done:!1}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function yfe(t,e={},n){let s,r;typeof t=="string"?s=t:(s=t.url,r=xfe(t));const i=await I3(s,r);if(i.ok){const o=new Uint8Array(await i.arrayBuffer());return new C4(o,e)}else throw new Error(i.statusText)}const xfe=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function N4(t){return typeof t=="string"&&t.slice(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class T4 extends S4{constructor(e,n={}){super(),this.input=e,this.options=n}async iterator(){if(N4(this.input)&&K().get("IS_NODE")){const e=require("fs");this.input=e.readFileSync(this.input.slice(7))}return new C4(this.input,this.options)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class I4 extends S4{constructor(e,n={}){super(),this.url=e,this.fileOptions=n}async iterator(){return N4(this.url)?new T4(this.url,this.fileOptions).iterator():yfe(this.url,this.fileOptions)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function wfe(t,e={}){return new v4(new I4(t),e)}function bfe(t){const e=AI(t);return Ts(async()=>e)}function vfe(t){return Ts(async()=>{const e=await t();return AI(()=>e.next())})}async function Sfe(t,e){return OI.create(t,e)}async function kfe(t){return DI.create(t)}/** @license See the LICENSE file. */const $4="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cfe=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:v4,Dataset:Dd,FileDataSource:T4,TextLineDataset:b4,URLDataSource:I4,array:lfe,csv:wfe,func:bfe,generator:vfe,microphone:kfe,version_data:$4,webcam:Sfe,zip:cfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ne(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&E(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nfe=$w;class Im extends G0{nextDataId(){return Im.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new WC(this,Vr())}write(e,n,s){this.firstUse&&(this.firstUse=!1,K().get("IS_NODE")&&Xs(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&vi(s[0])){const i=s.map(o=>$i(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return fo(r,i)}return d3(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>lo(r));return Le(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Le(e.shape,e.dtype,n)}makeOutput(e,n,s){return Vr().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Rn();return e(),{kernelMs:Rn()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ne([e],"where");const n=this.readSync(e.dataId);return Nfe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Im.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Tfe=t=>{const{x:e}=t.inputs,n=t.backend;Ne(e,"abs");let s=new Float32Array(se(e.shape));const r=n.data.get(e.dataId).values;return s=E4(r),n.makeOutput(s,e.shape,e.dtype)},Ife={kernelName:Hf,backendName:"cpu",kernelFunc:Tfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(t){return(e,n,s,r,i)=>{const o=Fe(e,n),a=o.length,l=Re(o),c=se(o),u=kn(i,c),d=e.length,h=n.length,f=Re(e),p=Re(n),m=Il(e,o),g=Il(n,o);if(m.length+g.length===0)for(let y=0;y<u.length;++y)u[y]=t(s[y%s.length],r[y%r.length]);else for(let y=0;y<u.length;++y){const x=Gl(y,a,l),w=x.slice(-d);m.forEach(I=>w[I]=0);const b=Yr(w,d,f),S=x.slice(-h);g.forEach(I=>S[I]=0);const T=Yr(S,h,p);u[y]=t(s[b],r[T])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Es(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const $fe={kernelName:ex,backendName:"cpu",kernelFunc:Es};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0(t,e,n="float32"){if(n==="complex64"){const r=l0(t,e,"float32"),i=l0(t,e,"float32");return Es({inputs:{real:r,imag:i},backend:t})}const s=Pn(se(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mi(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Efe={kernelName:Gu,backendName:"cpu",kernelFunc:Mi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Rfe={kernelName:Dx,backendName:"cpu",kernelFunc:Ol};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Ta([0],n),[i,o]=Qt((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function xa(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Mi({inputs:{x:r},backend:n});const u=l0(n,r.shape,r.dtype),d=xa({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=Es({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=Ol({inputs:{input:r},backend:n}),d=xa({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!qC(r.dtype,i)){const u=Mi({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=R4(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const Afe={kernelName:_u,backendName:"cpu",kernelFunc:xa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gn(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;Ne([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=o.dtype==="string"?po(c):c,h=o.dtype==="string"?po(u):u,f=s||o.dtype,[p,m]=e(o.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=xa({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=xa({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,x=g.complexTensorInfos.imag,w=l.data.get(y.dataId).values,b=l.data.get(x.dataId).values,[S,T,I]=n(o.shape,a.shape,f,p,w,b),$=l.makeTensorInfo(I,"float32",S),_=l.makeTensorInfo(I,"float32",T),D=Es({inputs:{real:$,imag:_},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo($),l.disposeIntermediateTensorInfo(_),D}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=s||o.dtype,[h,f]=e(o.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function FI(t){return(e,n,s,r,i,o)=>{const a=Fe(e,n),l=se(a),c=a.length,u=Re(a),d=kn("float32",l),h=kn("float32",l),f=Il(e,a),p=Il(n,a),m=fo(s,r),g=fo(i,o),y=e.length,x=Re(e),w=n.length,b=Re(n);if(f.length+p.length===0)for(let S=0;S<d.length;S++){const T=S%m.length,I=S%g.length,$=t(m[T*2],m[T*2+1],g[I*2],g[I*2+1]);d[S]=$.real,h[S]=$.imag}else for(let S=0;S<d.length;S++){const T=Gl(S,c,u),I=T.slice(-y);f.forEach(H=>I[H]=0);const $=Yr(I,y,x),_=T.slice(-w);p.forEach(H=>_[H]=0);const D=Yr(_,w,b),z=t(m[$*2],m[$*2+1],g[D*2],g[D*2+1]);d[S]=z.real,h[S]=z.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A4=Qt((t,e)=>t+e),_fe=FI((t,e,n,s)=>({real:t+n,imag:e+s})),uu=gn(Hl,A4,_fe),Dfe={kernelName:Hl,backendName:"cpu",kernelFunc:uu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PI(t,e,n,s,r){const i=se(s),o=Pn(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function _4(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=Le([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4=Qt((t,e)=>t&e),Ofe=gn(ep,D4),Ffe={kernelName:ep,backendName:"cpu",kernelFunc:Ofe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(t){return(e,n,s)=>{const r=Bt(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rt(t,e,n){const s=zi(e);return Oa(t,s,n)}function Oa(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;Ne(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=po(l)}else c=l;const u=n||o.dtype,d=e(c,u,r);return a.makeTensorInfo(o.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O4=zi(t=>Math.ceil(t)),Pfe=Oa(Du,O4),Lfe={kernelName:Du,backendName:"cpu",kernelFunc:Pfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4(t,e,n,s){const r=Bt(n,se(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=se(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?po(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let d=0;d<o.shape[1];++d)r[u+d]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P4=Qt((t,e)=>t===e?1:0),L4=gn(cp,P4,null,"bool"),Mfe={kernelName:cp,backendName:"cpu",kernelFunc:L4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M4=zi(t=>Math.exp(t)),B4=Oa(zu,M4,"float32"),Bfe={kernelName:zu,backendName:"cpu",kernelFunc:B4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z4=zi(t=>Math.expm1(t)),zfe=Oa(Vu,z4),Vfe={kernelName:Vu,backendName:"cpu",kernelFunc:zfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V4=zi(t=>Math.floor(t)),jfe=Oa(ju,V4),Ufe={kernelName:ju,backendName:"cpu",kernelFunc:jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j4=Qt((t,e)=>Math.floor(t/e)),Wfe=gn(Uu,j4,null,"int32"),Gfe={kernelName:Uu,backendName:"cpu",kernelFunc:Wfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U4(t,e,n,s,r,i,o,a,l){const c=Le([s,i],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let f=0;f<r;f++){const p=t[u*r+f];h+=p*o[f],d.push(p)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(h*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4(t,e,n){const s=Le(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G4=Qt((t,e)=>t>e?1:0),Hfe=gn(fp,G4,null,"bool"),qfe={kernelName:fp,backendName:"cpu",kernelFunc:Hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H4=Qt((t,e)=>t>=e?1:0),Kfe=gn(Wu,H4,null,"bool"),Xfe={kernelName:Wu,backendName:"cpu",kernelFunc:Kfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q4=Qt((t,e)=>t<e?1:0),Yfe=gn(mp,q4,null,"bool"),Jfe={kernelName:mp,backendName:"cpu",kernelFunc:Yfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K4=Qt((t,e)=>t<=e?1:0),Qfe=gn(gp,K4,null,"bool"),Zfe={kernelName:gp,backendName:"cpu",kernelFunc:Qfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4(t,e,n){const s=(e-t)/(n-1),r=Pn(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y4=zi(t=>Math.log(t)),epe=Oa(Xu,Y4),tpe={kernelName:Xu,backendName:"cpu",kernelFunc:epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J4(t,e,n,s){const r=kn(s,se(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4=Qt((t,e)=>Math.max(t,e)),npe=gn(Ju,Q4),spe={kernelName:Ju,backendName:"cpu",kernelFunc:npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z4=Qt((t,e)=>Math.min(t,e)),rpe=gn(Qu,Z4),ipe={kernelName:Qu,backendName:"cpu",kernelFunc:rpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LI=Qt((t,e)=>t*e),ope=FI((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),ub=gn(ed,LI,ope),ape={kernelName:ed,backendName:"cpu",kernelFunc:ub};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(t,e,n){const s=bo(-1,n);return LI([],e,s,t,n)}function lpe(t){const{inputs:e,backend:n}=t,{x:s}=e;Ne(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=eV(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const cpe={kernelName:Ip,backendName:"cpu",kernelFunc:lpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tV=Qt((t,e)=>t!==e?1:0),upe=gn($p,tV,null,"bool"),dpe={kernelName:$p,backendName:"cpu",kernelFunc:upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MI(t,e,n,s,r){const i=e.length,o=se(e),a=Re(e),l=Re(r),c=kn(n,se(r));for(let u=0;u<o;++u){const d=Gl(u,i,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[s[p]];const f=Yr(h,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;Ne(r,"transpose");const o=r.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=r.shape[i[d]];const l=s.data.get(r.dataId).values,c=MI(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const hpe={kernelName:ul,backendName:"cpu",kernelFunc:vs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(t,e,n,s){const[r,i]=In(t,s),o=gs(e,"int32"),a=Pn(se(r),o),l=se(i);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:o}}function fpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"prod");const a=r.shape.length,l=ze(i,r.shape),c=Ft(l,a);let u=l,d=r;const h=[];c!=null&&(d=vs({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=Yt(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:g}=nV(d.shape,d.dtype,f,u);let y=m;return o&&(y=Xt(m,l)),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(y,g,p)}const ppe={kernelName:Op,backendName:"cpu",kernelFunc:fpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpe(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=Gl(r,e.length,Re(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function gpe(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function ype(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);gpe(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-f[u];for(let y=u;y<d;++y)a[p].push(f[y+1]+g)}u=f[u],d=f[d]}d!==u&&(r.push([u,d]),i+=d-u)}return{outSplits:a,valueSlices:r,numValues:i}}function xpe(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Bt("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function E_(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function wpe(t,e,n,s,r,i){const o=E_(e,2)[1],a=E_(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=t[u*o+d];++l}}function bpe(t,e,n,s,r){const i=e.slice();i[0]=r;const o=Bt(n,se(i)),a=t.length,l=a===0?0:a/e[0];return wpe(t,e,s,l,o,i),[o,i]}function sV(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(mpe(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=ype(i,o,t,c),f=xpe(u),p=bpe(n,s,r,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R_=2147483647;function rV(t,e,n,s,r,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(o[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=Bt("int32",d+1);h[0]=0;for(let g=0;g<d;++g){const y=a?t[0]:t[g],x=l?s[0]:s[g],w=c?i[0]:i[g];if(w===0)throw new Error("Requires delta != 0");let b;if(w>0&&x<y||w<0&&x>y)b=0;else if(b=Math.ceil(Math.abs((x-y)/w)),b>R_)throw new Error(`Requires ((limit - start) / delta) <= ${R_}`);h[g+1]=h[g]+b}const f=h[d],p=Bt(n,f);let m=0;for(let g=0;g<d;++g){const y=h[g+1]-h[g];let x=a?t[0]:t[g];const w=c?i[0]:i[g];for(let b=0;b<y;++b)p[m++]=x,x+=w}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var hr=Hr;class c0{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=vB(u),this.raggedRank=SB(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===hr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===hr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case hr.VALUE_ROWIDS:return c0.getMaxWidthValueRowID(n);case hr.ROW_SPLITS:return c0.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${hr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return __(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;kB(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=bB(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return E(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=s;for(let d=0;d<l-c;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const d=e[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case hr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case hr.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${hr[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case hr.FIRST_DIM_SIZE:return e[0];case hr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case hr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${hr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=__(s,!1),o=Bt(this.valuesDType,se(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=se(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;G(()=>{const m=V(u,p);u=dl(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const g=i.subarray(d*l),y=o.subarray(h*l),x=(f-h)*l;A_(y,g,x)}if(p>=c){const g=s.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)o.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const g=o.slice(f*l);A_(g,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function A_(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function __(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function iV(t,e,n,s,r,i,o,a,l,c){return new c0(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return Pn(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Pn(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aV=zi(t=>1/Math.sqrt(t)),vpe=Oa(od,aV),Spe={kernelName:od,backendName:"cpu",kernelFunc:vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sl(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],d=t.values,h=e.values;if(s===0)return Le(n,e.dtype);const f=l instanceof rn?l:Le(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const m=[];let g=0;for(let y=0;y<o;y++){const x=d[p*o+y];m.push(x),g+=x*a[y]}if(g<0||g>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let y=0;y<r;y++)c?f.values[g*r+y]+=h[p*r+y]:f.values[g*r+y]=e.rank===0?h[0]:h[p*r+y]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kpe=zi(t=>1/(1+Math.exp(-t))),lV=rt(dd,t=>1/(1+Math.exp(-t))),Cpe={kernelName:dd,backendName:"cpu",kernelFunc:lV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(t,e,n,s,r){const i=A2(s,e,n),o=se(n),a=Re(s);if(i){const d=_2(e,a);return r==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=r==="string"?po(t):t,c=Le(s,r,l),u=Le(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+e[m]);u.set(c.get(...f),...h)}return r==="string"?UB(u.values):u.values}function Fl(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;Ne(r,"slice");const[a,l]=Bw(r,i,o);E2(r,a,l);const c=n.data.get(r.dataId).values,u=cV(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const Npe={kernelName:zp,backendName:"cpu",kernelFunc:Fl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uV(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(RB(a));const g=Bt(n,0),y=Bt(r,0);return[g,[0,d],y,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const y=t[g*d];if(y<0)throw new Error(AB(g,y));if(y>=l)throw new Error(_B(g,y,l));++p[y],h=h&&y>=f,f=y}let m=!0;for(let g=0;g<l;++g){const y=p[g]===0;c[g]=y,m=m&&!y,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=t,y=s;for(let x=0;x<a;++x)u[x]=x;return[g,[a,d],y,c,u]}else{const g=p[l-1],y=Bt(n,g*d),x=Bt(r,g),w=new Array(l).fill(0);for(let b=0;b<a;++b){const S=t[b*d],T=w[S],I=(S===0?0:p[S-1])+T;w[S]++;for(let $=0;$<d;++$)y[I*d+$]=t[b*d+$];x[I]=s[b],u[b]=I}for(let b=0;b<l;++b)if(w[b]===0){const T=b===0?0:p[b-1];y[T*d+0]=b;for(let I=1;I<d;++I)y[T*d+I]=0;x[T]=o}return[y,[g,d],x,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(t,e,n,s,r){const i=se(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let g=0;g<a;++g){const y=r[g];if(y===-1){if(u!==-1)throw new Error(DB(u,g));u=g,l.push(1)}else{if(y<0)throw new Error(OB(g,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(FB());const g=Math.trunc(i/c);if(c*g!==i)throw new Error(PB(s,l));l[u]=g}if(se(l)!==i)throw new Error(LB(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let g=h-2;g>=0;--g)f[g]=f[g+1]*s[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=Bt(n,o*a);for(let g=0;g<o;++g){let y=0;for(let x=0;x<h;++x)y+=t[g*h+x]*f[x];for(let x=0;x<a;++x)m[g*a+x]=Math.trunc(y/p[x]),y%=p[x]}return[m,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BI(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(CS());const h=e.slice();h[0]=d;const f=h.reduce((w,b)=>w*b,1),p=Bt(n,f);if(a===0)return d>0&&p.fill(o),[p,h];if(d<=0)throw new Error(CS());let m=0,g=1,y=0,x=r[m];for(;;){let w=0;if(g<a){if(w=r[g],x===w){++g;continue}if(x>=w)throw new Error(MB())}if(x<0||x>=d)throw new Error(BB(x,d));x>y&&p.fill(o,y*c,x*c);for(let b=m;b<g;++b){const S=s[b];if(S<0||S>=l[0])throw new Error(zB(b,s[b],l[0]));for(let T=0;T<c;T++)p[x*c+T]+=t[S*c+T]}if(i)for(let b=0;b<c;b++)p[x*c+b]/=g-m;if(m=g,++g,y=x+1,x=w,g>a)break}return y<d&&p.fill(o,y*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe=zi(t=>Math.sqrt(t)),Ipe=rt(fd,t=>Math.sqrt(t)),$pe={kernelName:fd,backendName:"cpu",kernelFunc:Ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hV=Qt((t,e)=>{const n=t-e;return n*n}),Epe=gn(pd,hV),Rpe={kernelName:pd,backendName:"cpu",kernelFunc:Epe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fV=zi((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),Ape=Oa(Gp,fV),_pe={kernelName:Gp,backendName:"cpu",kernelFunc:Ape};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pV(t,e,n,s){const r=Le(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dpe{constructor(e,n,s,r,i,o){this.separator=$i(e),this.nGramWidths=n,this.leftPad=$i(s),this.rightPad=$i(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),d=o-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let x=0;x<d;++x)f+=e[h+x].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let g=0;const y=x=>x.forEach(w=>m[g++]=w);for(let x=0;x<c;++x)y(this.leftPad),y(this.separator);for(let x=0;x<d-1;++x)y(e[h+x]),y(this.separator);if(d>0){y(e[h+d-1]);for(let x=0;x<u;++x)y(this.separator),y(this.rightPad)}else{for(let x=0;x<u-1;++x)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=Bt("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,a,u,1,h)}}return[a,o]}}function mV(t,e,n,s,r,i,o,a){return new Dpe(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ope(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function gV(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;Ope(t[h],e,n,r);const p=r.length-f;a[h]=p,i+=p,o=Math.max(o,p)}const l=Bt("int32",i*2),c=new Array(i),u=[s,o];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(t,e){const n=Bt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=T3(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xV=Qt((t,e)=>t-e),Fpe=FI((t,e,n,s)=>({real:t-n,imag:e-s})),zI=gn(md,xV,Fpe),Ppe={kernelName:md,backendName:"cpu",kernelFunc:zI};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Le(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gh=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function bV(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(s,Math.floor(e+(a-l)*u/a+d));bV(t,e,h,f)}const r=t[e];let i=n,o=s;for(Ki(t,n,e),gh(t[s],r)>0&&Ki(t,n,s);i<o;){for(Ki(t,i,o),i++,o--;gh(t[i],r)<0;)i=i+1;for(;gh(t[o],r)>0;)o=o-1}gh(t[n],r)===0?Ki(t,n,o):(o=o+1,Ki(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function vV(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=kn(n,o*s),c=kn("int32",o*s);for(let d=0;d<o;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((x,w)=>p[w]={value:x,index:w}),s<p.length&&(bV(p,s),p=p.slice(0,s)),r&&p.sort(gh);const m=d*s,g=l.subarray(m,m+s),y=c.subarray(m,m+s);for(let x=0;x<s;x++)g[x]=p[x].value,y[x]=p[x].index}const u=e.slice();return u[u.length-1]=s,[Le(u,n,l),Le(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(t,e,n,s){const r=ze(e,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[r]),l=new rn(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let m;if(u)m=t[p].toString();else{const y=[];for(let x=0;x<i[0];x++)for(let w=0;w<i[2];w++)y.push(l.get(x,p,w));m=y.join(",")}const g=o.get(m);if(g!=null)a[p]=g;else{const y=o.size;o.set(m,y),a[p]=y,c.push(p)}}const d=i.slice();d[1]=o.size;const h=new rn(d,s);c.forEach((p,m)=>{for(let g=0;g<i[0];g++)for(let y=0;y<i[2];y++)h.set(l.get(g,p,y),g,m,y)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kV=Object.freeze(Object.defineProperty({__proto__:null,addImpl:A4,bincountImpl:PI,bincountReduceImpl:_4,bitwiseAndImpl:D4,castImpl:R4,ceilImpl:O4,concatImpl:F4,equalImpl:P4,expImpl:M4,expm1Impl:z4,floorDivImpl:j4,floorImpl:V4,gatherNdImpl:U4,gatherV2Impl:W4,greaterEqualImpl:H4,greaterImpl:G4,lessEqualImpl:K4,lessImpl:q4,linSpaceImpl:X4,logImpl:Y4,maxImpl:J4,maximumImpl:Q4,minimumImpl:Z4,multiplyImpl:LI,negImpl:eV,notEqualImpl:tV,prodImpl:nV,raggedGatherImpl:sV,raggedRangeImpl:rV,raggedTensorToTensorImpl:iV,rangeImpl:oV,rsqrtImpl:aV,scatterImpl:sl,sigmoidImpl:kpe,simpleAbsImpl:E4,sliceImpl:cV,sparseFillEmptyRowsImpl:uV,sparseReshapeImpl:dV,sparseSegmentReductionImpl:BI,sqrtImpl:Tpe,squaredDifferenceImpl:hV,staticRegexReplaceImpl:fV,stridedSliceImpl:pV,stringNGramsImpl:mV,stringSplitImpl:gV,stringToHashBucketFastImpl:yV,subImpl:xV,tileImpl:wV,topKImpl:vV,transposeImpl:MI,uniqueImpl:SV},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const CV="4.22.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */nN("cpu",()=>new Im,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NV=rt(Mu,t=>t>=0?t:Math.exp(t)-1),Lpe={kernelName:Mu,backendName:"cpu",kernelFunc:NV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;Ne([r],"leakyRelu");const o=se(r.shape),a=n.data.get(r.dataId).values,l=kn("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const Mpe={kernelName:pp,backendName:"cpu",kernelFunc:TV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bpe=Qt((t,e)=>t<0?e*t:t);function IV(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Ne([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=Bpe(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const zpe={kernelName:Dp,backendName:"cpu",kernelFunc:IV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $V=rt(sd,t=>Math.max(0,t)),Vpe={kernelName:sd,backendName:"cpu",kernelFunc:$V};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EV=rt(rd,t=>Math.min(Math.max(0,t),6)),jpe={kernelName:rd,backendName:"cpu",kernelFunc:EV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0(t,e,n,s,r){if(n==="linear")return Mi({inputs:{x:e},backend:t});if(n==="relu")return $V({inputs:{x:e},backend:t});if(n==="elu")return NV({inputs:{x:e},backend:t});if(n==="relu6")return EV({inputs:{x:e},backend:t});if(n==="prelu")return IV({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return TV({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return lV({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gt(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=se(r.shape),a=HC(i,o),l=se(a);E(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const Upe={kernelName:Fp,backendName:"cpu",kernelFunc:gt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RV(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;Ne([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],d=a?i.shape[c-1]:i.shape[c-2],h=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),m=i.shape.slice(0,-2),g=se(p),y=se(m),w=Fe(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,f]);E(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const b=o?[g,u,h]:[g,h,u],S=a?[y,f,d]:[y,d,f],T=gt({inputs:{x:r},backend:n,attrs:{shape:b}}),I=gt({inputs:{x:i},backend:n,attrs:{shape:S}}),$=o?T.shape[1]:T.shape[2],_=o?T.shape[2]:T.shape[1],D=a?I.shape[1]:I.shape[2],z=Math.max(g,y),H=n.data.get(T.dataId).values,X=n.data.get(I.dataId).values,Y=Re(T.shape),J=Re(I.shape),[Q,ee,M]=o?[Y[0],1,Y[1]]:[Y[0],Y[1],1],[q,te,Z]=a?[1,J[1],J[0]]:[J[1],1,J[0]],le=_*D,de=Le([z,_,D],T.dtype),fe=de.values,ne=n.blockSize;for(let U=0;U<z;U++){const ae=U%g,ge=U%y;for(let be=0;be<_;be+=ne){const $e=Math.min(be+ne,_);for(let Ae=0;Ae<D;Ae+=ne){const et=Math.min(Ae+ne,D);for(let Qe=0;Qe<$;Qe+=ne){const it=Math.min(Qe+ne,$);for(let ot=be;ot<$e;ot++)for(let nt=Ae;nt<et;nt++){let ut=0;for(let ht=Qe;ht<it;ht++){const Dr=H[ae*Q+ot*ee+ht*M],Zt=X[ht*q+nt*te+ge*Z];ut+=Dr*Zt}fe[U*le+(ot*D+nt)]+=ut}}}}}return n.disposeIntermediateTensorInfo(T),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(w,de.dtype,de.values)}const Wpe={kernelName:Qf,backendName:"cpu",kernelFunc:RV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,f,p;const m=[];h=RV({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=uu({inputs:{a:h,b:o},backend:n}),m.push(h),h=f),u&&(p=u0(n,h,u,a,d),m.push(h),h=p);for(const y of m)n.disposeIntermediateTensorInfo(y);return h}const Hpe={kernelName:uf,backendName:"cpu",kernelFunc:Gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe=rt(Nu,t=>Math.acos(t)),Kpe={kernelName:Nu,backendName:"cpu",kernelFunc:qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe=rt(Tu,t=>Math.acosh(t)),Ype={kernelName:Tu,backendName:"cpu",kernelFunc:Xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpe(t){const{inputs:e,backend:n}=t,s=e;Ne(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=Le(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Qpe={kernelName:qf,backendName:"cpu",kernelFunc:Jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"all");const a=ze(i,r.shape);let l=a;const c=Ft(l,r.shape.length);let u=r;c!=null&&(u=vs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Yt(l.length,r.shape.length)),Bn("all",l,u.shape.length);const[d,h]=In(u.shape,l),f=se(h),p=Pn(se(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let w=m[x];for(let b=0;b<f;++b){const S=m[x+b];w=w&&S}p[y]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const y=Xt(d,a),x=gt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),x}return g}const eme={kernelName:K0,backendName:"cpu",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"any");const a=ze(i,r.shape);let l=a;const c=Ft(l,r.shape.length);let u=r;c!=null&&(u=vs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Yt(l.length,r.shape.length)),Bn("any",l,u.shape.length);const[d,h]=In(u.shape,l),f=se(h),p=Pn(se(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let w=m[x];for(let b=0;b<f;++b){const S=m[x+b];w=w||S}p[y]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const y=Xt(d,a),x=gt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),x}return g}const nme={kernelName:X0,backendName:"cpu",kernelFunc:tme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Ne(r,"argMax");let o=ze(i,r.shape);const a=Ft(o,r.shape.length);let l=r;const c=[];a!=null&&(l=vs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),o=[o[0]],Bn("argMax",o,l.shape.length);const[u,d]=In(l.shape,o),h=se(u),f=Pn(h,"int32"),p=se(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let x=m[y],w=0;for(let b=0;b<p;++b){const S=m[y+b];S>x&&(x=S,w=b)}f[g]=w}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const rme={kernelName:Kf,backendName:"cpu",kernelFunc:sme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ime(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Ne(r,"argMin");let o=ze(i,r.shape);const a=Ft(o,r.shape.length);let l=r;const c=[];a!=null&&(l=vs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),o=[o[0]],Bn("argMin",o,l.shape.length);const[u,d]=In(l.shape,o),h=se(u),f=Pn(h,"int32"),p=se(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let x=m[y],w=0;for(let b=0;b<p;++b){const S=m[y+b];S<x&&(x=S,w=b)}f[g]=w}return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(u,"int32",f)}const ome={kernelName:Xf,backendName:"cpu",kernelFunc:ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame=rt(Iu,t=>Math.asin(t)),lme={kernelName:Iu,backendName:"cpu",kernelFunc:ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cme=rt($u,t=>Math.asinh(t)),ume={kernelName:$u,backendName:"cpu",kernelFunc:cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme=rt(Eu,t=>Math.atan(t)),hme={kernelName:Eu,backendName:"cpu",kernelFunc:dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme=Qt((t,e)=>Math.atan2(t,e)),pme=gn(Au,fme),mme={kernelName:Au,backendName:"cpu",kernelFunc:pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme=rt(Ru,t=>Math.atanh(t)),yme={kernelName:Ru,backendName:"cpu",kernelFunc:gme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VI(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Le(r.outShape,n),g=m.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],x=r.outShape[2]*r.outShape[3],w=r.outShape[3];for(let b=0;b<r.batchSize;++b){const S=b*y,T=b*s[0];for(let I=0;I<r.inChannels;++I)for(let $=0;$<r.outHeight;++$){const _=$*o-h,D=Math.max(0,_),z=Math.min(r.inHeight,u+_),H=S+$*x;for(let X=0;X<r.outWidth;++X){const Y=X*a-f,J=Math.max(0,Y),Q=Math.min(r.inWidth,d+Y);let ee=p,M=0,q=0;for(let Z=D;Z<z;Z+=l){const le=T+Z*s[1];for(let de=J;de<Q;de+=c){const fe=le+de*s[2],ne=t[fe+I];i==="max"&&ne>ee?ee=ne:i==="avg"&&(M+=ne,q++)}if(isNaN(ee))break}const te=H+X*w+I;g[te]=i==="avg"?M/q:ee}}}return m}function AV(t,e,n,s,r=!1,i=!1){const o=Le(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=Le(e,n,t);for(let g=0;g<s.batchSize;++g)for(let y=0;y<s.inChannels;++y)for(let x=0;x<s.outHeight;++x){const w=x*a-f;let b=w;for(;b<0;)b+=c;const S=Math.min(s.inHeight,d+w);for(let T=0;T<s.outWidth;++T){const I=T*l-p;let $=I;for(;$<0;)$+=u;const _=Math.min(s.inWidth,h+I);let D=Number.NEGATIVE_INFINITY,z=-1;for(let H=b;H<S;H+=c){const X=H-w;for(let Y=$;Y<_;Y+=u){const J=Y-I,Q=m.get(g,H,Y,y);Q>D&&(D=Q,r?z=i?((g*s.inHeight+H)*s.inWidth+Y)*s.inChannels+y:(H*s.inWidth+Y)*s.inChannels+y:z=X*h+J)}}o.set(z,g,x,T,y)}}return o}function _V(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,x=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=Le(r.outShape,n),b=w.values,S=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],T=r.outShape[2]*r.outShape[3]*r.outShape[4],I=r.outShape[3]*r.outShape[4],$=r.outShape[4];for(let _=0;_<r.batchSize;++_){const D=_*S,z=_*s[0];for(let H=0;H<r.inChannels;++H)for(let X=0;X<r.outDepth;++X){const Y=X*o-m;let J=Y;for(;J<0;)J+=c;const Q=Math.min(r.inDepth,h+Y),ee=D+X*T;for(let M=0;M<r.outHeight;++M){const q=M*a-g;let te=q;for(;te<0;)te+=u;const Z=Math.min(r.inHeight,f+q),le=ee+M*I;for(let de=0;de<r.outWidth;++de){const fe=de*l-y;let ne=fe;for(;ne<0;)ne+=d;const U=Math.min(r.inWidth,p+fe),ae=le+de*$;let ge=x,be=0,$e=0;for(let et=J;et<Q;et+=c){const Qe=z+et*s[1];for(let it=te;it<Z;it+=u){const ot=Qe+it*s[2];for(let nt=ne;nt<U;nt+=d){const ut=ot+nt*s[3],ht=t[ut+H];if(i==="max"&&ht>ge?ge=ht:i==="avg"&&(be+=ht,$e++),isNaN(ge))break}if(isNaN(ge))break}if(isNaN(ge))break}const Ae=ae+H;b[Ae]=i==="avg"?be/Math.max($e,1):ge}}}}return w}function xme(t,e){const n=Le(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const x=y*s-h;let w=x;for(;w<0;)w+=o;const b=Math.min(e.inDepth,c+x);for(let S=0;S<e.outHeight;++S){const T=S*r-f;let I=T;for(;I<0;)I+=a;const $=Math.min(e.inHeight,u+T);for(let _=0;_<e.outWidth;++_){const D=_*i-p;let z=D;for(;z<0;)z+=l;const H=Math.min(e.inWidth,d+D);let X=Number.NEGATIVE_INFINITY,Y=-1;for(let J=w;J<b;J+=o){const Q=J-x;for(let ee=I;ee<$;ee+=a){const M=ee-T;for(let q=z;q<H;q+=l){const te=q-D,Z=t.get(m,J,ee,q,g);Z>=X&&(X=Z,Y=Q*u*d+M*u+te)}}}n.set(Y,m,y,S,_,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ne(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;E(Mn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Rr(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Ue(u.inShape,u.outShape))d=Mi({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Re(r.shape),p=VI(h,r.shape,r.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const bme={kernelName:Yf,backendName:"cpu",kernelFunc:wme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ne(r,"avgPool3d");const u=vo(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=_V(d,r.shape,r.dtype,Re(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const Sme={kernelName:Jf,backendName:"cpu",kernelFunc:vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Ne([r,i],"avgPool3DGrad");const u=vo(i.shape,o,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,x=u.dilationHeight,w=u.dilationWidth,b=u.effectiveFilterDepth,S=u.effectiveFilterHeight,T=u.effectiveFilterWidth,I=b-1-u.padInfo.front,$=T-1-u.padInfo.left,_=S-1-u.padInfo.top,D=Le(i.shape,"float32"),z=1/(p*m*g),H=n.bufferSync(r);for(let X=0;X<u.batchSize;++X)for(let Y=0;Y<u.inChannels;++Y)for(let J=0;J<u.inDepth;++J)for(let Q=0;Q<u.inHeight;++Q)for(let ee=0;ee<u.inWidth;++ee){const M=J-I,q=Q-_,te=ee-$;let Z=0;for(let le=0;le<b;le+=y){const de=(M+le)/d;if(!(de<0||de>=u.outDepth||Math.floor(de)!==de))for(let fe=0;fe<S;fe+=x){const ne=(q+fe)/h;if(!(ne<0||ne>=u.outHeight||Math.floor(ne)!==ne))for(let U=0;U<T;U+=w){const ae=(te+U)/f;if(ae<0||ae>=u.outWidth||Math.floor(ae)!==ae)continue;const ge=H.get(X,de,ne,ae,Y);Z+=ge}}}D.set(Z*z,X,J,Q,ee,Y)}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const Cme={kernelName:J0,backendName:"cpu",kernelFunc:kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Ne([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Rr(o.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,x=u.effectiveFilterWidth,w=x-1-u.padInfo.left,b=y-1-u.padInfo.top,S=Le(o.shape,"float32"),T=1/(f*p),I=n.data.get(r.dataId).values,$=Le(r.shape,"float32",I);for(let _=0;_<u.batchSize;++_)for(let D=0;D<u.inChannels;++D)for(let z=0;z<u.inHeight;++z)for(let H=0;H<u.inWidth;++H){const X=z-b,Y=H-w;let J=0;for(let Q=0;Q<y;Q+=m){const ee=(X+Q)/d;if(!(ee<0||ee>=u.outHeight||Math.floor(ee)!==ee))for(let M=0;M<x;M+=g){const q=(Y+M)/h;if(q<0||q>=u.outWidth||Math.floor(q)!==q)continue;const te=$.get(_,ee,q,D);J+=te}}S.set(J*T,_,z,H,D)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Tme={kernelName:Y0,backendName:"cpu",kernelFunc:Nme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ime(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;E(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ne([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=p.length,y=f.length,x=h.length,w=d.length;let b=0,S=0,T=0,I=0;for(let $=0;$<u.length;++$)m[$]=p[b++]+(u[$]-d[S++])*f[T++]/Math.sqrt(h[I++]+c),b>=g&&(b=0),S>=w&&(S=0),T>=y&&(T=0),I>=x&&(I=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const $me={kernelName:dp,backendName:"cpu",kernelFunc:Ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;Ne([r],"batchToSpaceND");const a=i.reduce((y,x)=>y*x),l=mm(r.shape,i,a),c=gm(l.length,i.length),u=ym(r.shape,i,a),d=M2(o,i.length),h=B2(u,o,i.length),f=gt({inputs:{x:r},backend:n,attrs:{shape:l}}),p=vs({inputs:{x:f},backend:n,attrs:{perm:c}}),m=gt({inputs:{x:p},backend:n,attrs:{shape:u}}),g=Fl({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const Rme={kernelName:Zf,backendName:"cpu",kernelFunc:Eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ame(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=PI(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const _me={kernelName:Q0,backendName:"cpu",kernelFunc:Ame};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dme(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=Fe(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Ome={kernelName:Z0,backendName:"cpu",kernelFunc:Dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fme=rt(Ou,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Pme={kernelName:Ou,backendName:"cpu",kernelFunc:Fme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lme=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(se(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,e.shape,"float32")},Mme={kernelName:tp,backendName:"cpu",kernelFunc:Lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function du(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Bme={kernelName:wx,backendName:"cpu",kernelFunc:du};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hu(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=ze(r,e[0].shape)[0],o=e.map(m=>m.shape);F2(o,i);let a=Ri(e.map(m=>m.shape),i);if(se(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>se(m.shape)>0);if(l.length===1)return Mi({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(b=>Ol({inputs:{input:b},backend:n})),g=l.map(b=>du({inputs:{input:b},backend:n})),y=hu({inputs:m,backend:n,attrs:{axis:i}}),x=hu({inputs:g,backend:n,attrs:{axis:i}}),w=Es({inputs:{real:y,imag:x},backend:n});return m.forEach(b=>n.disposeIntermediateTensorInfo(b)),g.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),w}const c=l.map(m=>{const y=[-1,se(m.shape.slice(i))];return gt({inputs:{x:m},backend:n,attrs:{shape:y}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=Ri(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=F4(u,a,e[0].dtype,d),f=Ri(l.map(m=>m.shape),i),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const zme={kernelName:np,backendName:"cpu",kernelFunc:hu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;Ne([r,i],"conv2d");const d=So(l),h=Tn(r.shape,i.shape,o,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo.left,x=h.padInfo.top,w=h.dataFormat==="channelsLast",b=new rn(h.outShape,r.dtype),S=Re(r.shape),T=Re(i.shape),I=S[0],$=w?S[1]:S[2],_=w?S[2]:1,D=w?1:S[1],z=b.strides[0],H=w?b.strides[1]:b.strides[2],X=w?b.strides[2]:1,Y=w?1:b.strides[1],J=n.data.get(r.dataId).values,Q=n.data.get(i.dataId).values,ee=b.values;for(let M=0;M<h.batchSize;++M){const q=M*I,te=M*z;for(let Z=0;Z<h.outHeight;++Z){const le=te+Z*H,de=Z*h.strideHeight-x;for(let fe=0;fe<f;++fe){const ne=de+fe*m;if(ne<0||ne>=h.inHeight)continue;const U=fe*T[0],ae=q+ne*$;for(let ge=0;ge<h.outWidth;++ge){const be=le+ge*X,$e=ge*h.strideWidth-y;for(let Ae=0;Ae<p;++Ae){const et=$e+Ae*g;if(et<0||et>=h.inWidth)continue;const Qe=U+Ae*T[1],it=ae+et*_;let ot=Qe;for(let nt=0;nt<h.inChannels;++nt){const ut=J[it+nt*D];for(let ht=0;ht<h.outChannels;++ht)ee[be+ht*Y]+=ut*Q[ot+ht];ot+=h.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,ee)}const Vme={kernelName:sp,backendName:"cpu",kernelFunc:DV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;Ne([r,i],"conv2dBackpropFilter");const d=So(l),h=Tn(r.shape,u,o,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=h,y=h.dataFormat==="channelsLast",x=new rn(h.filterShape,"float32"),w=h.padInfo.left,b=h.padInfo.top,S=n.data.get(r.dataId).values,T=n.data.get(i.dataId).values,I=new rn(r.shape,r.dtype,S),$=new rn(i.shape,i.dtype,T);for(let _=0;_<m;++_){const D=Math.max(0,Math.ceil((b-_)/f)),z=Math.min(h.outHeight,(h.inHeight+b-_)/f);for(let H=0;H<g;++H){const X=Math.max(0,Math.ceil((w-H)/p)),Y=Math.min(h.outWidth,(h.inWidth+w-H)/p);for(let J=0;J<h.inChannels;++J)for(let Q=0;Q<h.outChannels;++Q){let ee=0;for(let M=0;M<h.batchSize;++M)for(let q=D;q<z;++q){const te=_+q*f-b;for(let Z=X;Z<Y;++Z){const le=H+Z*p-w;y?ee+=I.get(M,te,le,J)*$.get(M,q,Z,Q):ee+=I.get(M,J,te,le)*$.get(M,Q,q,Z)}}x.set(ee,_,H,J,Q)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Ume={kernelName:tx,backendName:"cpu",kernelFunc:jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;Ne([r,i],"conv2dBackpropInput");const d=Re(i.shape),h=Re(r.shape);let f=So(c);const p=Tn(o,i.shape,a,1,l,u,!1,f),m=new rn(p.inShape,"float32"),g=m.values,y=n.data.get(r.dataId).values,x=n.data.get(i.dataId).values,[w,b,S]=d,{batchSize:T,filterHeight:I,filterWidth:$,inChannels:_,inHeight:D,inWidth:z,outChannels:H,outHeight:X,outWidth:Y,strideHeight:J,strideWidth:Q}=p;f=p.dataFormat;const ee=I-1-p.padInfo.top,M=$-1-p.padInfo.left,q=f==="channelsLast",te=m.strides[0],Z=q?m.strides[1]:m.strides[2],le=q?m.strides[2]:1,de=q?1:m.strides[1],fe=h[0],ne=q?h[1]:h[2],U=q?h[2]:1,ae=q?1:h[1];for(let ge=0;ge<T;++ge)for(let be=0;be<_;++be)for(let $e=0;$e<D;++$e){const Ae=$e-ee,et=Math.max(0,Math.ceil(Ae/J)),Qe=Math.min(X,(I+Ae)/J);for(let it=0;it<z;++it){const ot=it-M,nt=Math.max(0,Math.ceil(ot/Q)),ut=Math.min(Y,($+ot)/Q);let ht=0;for(let Zt=et;Zt<Qe;++Zt){const Gs=Zt*J-Ae;for(let Tt=nt;Tt<ut;++Tt){const Or=Tt*Q-ot,Hs=fe*ge+ne*Zt+U*Tt,$n=w*(I-1-Gs)+b*($-1-Or)+S*be;for(let di=0;di<H;++di){const A=y[Hs+ae*di],k=x[$n+di];ht+=A*k}}}const Dr=te*ge+Z*$e+le*it+de*be;g[Dr]=ht}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Gme={kernelName:rp,backendName:"cpu",kernelFunc:Wme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;Ne([r,i],"conv3d");const c=$a(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=c,y=g.front,x=g.left,w=g.top,b=new rn(c.outShape,r.dtype),S=n.data.get(r.dataId).values,T=n.data.get(i.dataId).values,I=b.values,$=Re(r.shape),_=Re(i.shape);for(let D=0;D<c.batchSize;++D){const z=D*$[0],H=D*b.strides[0];for(let X=0;X<c.outDepth;++X){const Y=H+X*b.strides[1],J=X*c.strideDepth-y;for(let Q=0;Q<u;++Q){const ee=J+Q*f;if(ee<0||ee>=c.inDepth)continue;const M=Q*_[0],q=z+ee*$[1];for(let te=0;te<c.outHeight;++te){const Z=Y+te*b.strides[2],le=te*c.strideHeight-w;for(let de=0;de<d;++de){const fe=le+de*p;if(fe<0||fe>=c.inHeight)continue;const ne=M+de*_[1],U=q+fe*$[2];for(let ae=0;ae<c.outWidth;++ae){const ge=Z+ae*c.outChannels,be=ae*c.strideWidth-x;for(let $e=0;$e<h;++$e){const Ae=be+$e*m;if(Ae<0||Ae>=c.inWidth)continue;const et=ne+$e*_[2],Qe=U+Ae*c.inChannels;let it=et;for(let ot=0;ot<c.inChannels;++ot){const nt=S[Qe+ot];for(let ut=0;ut<c.outChannels;++ut)I[ge+ut]+=nt*T[it+ut];it+=c.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const qme={kernelName:ip,backendName:"cpu",kernelFunc:Hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;Ne([r,i],"conv3dBackpropFilterV2");const c=Re(r.shape),u=Re(i.shape),d=$a(r.shape,l,o,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,x=new rn(d.filterShape,"float32"),w=x.values,[b,S,T,I]=x.strides,$=n.data.get(i.dataId).values,[_,D,z,H]=u,X=n.data.get(r.dataId).values,[Y,J,Q,ee]=c,M=d.padInfo.front,q=d.padInfo.left,te=d.padInfo.top;for(let Z=0;Z<m;++Z){const le=Math.max(0,Math.ceil((M-Z)/h)),de=Math.min(d.outDepth,(d.inDepth+M-Z)/h),fe=Z*b;for(let ne=0;ne<g;++ne){const U=Math.max(0,Math.ceil((te-ne)/f)),ae=Math.min(d.outHeight,(d.inHeight+te-ne)/f),ge=ne*S+fe;for(let be=0;be<y;++be){const $e=Math.max(0,Math.ceil((q-be)/p)),Ae=Math.min(d.outWidth,(d.inWidth+q-be)/p),et=be*T+ge;for(let Qe=0;Qe<d.inChannels;++Qe){const it=Qe*I+et;for(let ot=0;ot<d.outChannels;++ot){let nt=0;for(let ut=0;ut<d.batchSize;++ut){const ht=ut*Y,Dr=ut*_;for(let Zt=le;Zt<de;++Zt){const Tt=(Z+Zt*h-M)*J+ht,Or=Zt*D+Dr;for(let Hs=U;Hs<ae;++Hs){const di=(ne+Hs*f-te)*Q+Tt,A=Hs*z+Or;for(let k=$e;k<Ae;++k){const O=(be+k*p-q)*ee+di,W=k*H+A;nt+=X[O+Qe]*$[W+ot]}}}}w[it+ot]=nt}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Xme={kernelName:nx,backendName:"cpu",kernelFunc:Kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;Ne([r],"conv3dBackpropInputV2");const c=Re(r.shape),u=Re(i.shape),d=$a(l,i.shape,a,1,o),h=new rn(d.inShape,"float32"),f=h.values,[p,m,g,y]=h.strides,x=n.data.get(r.dataId).values,[w,b,S,T]=c,I=n.data.get(i.dataId).values,[$,_,D,z]=u,{batchSize:H,filterDepth:X,filterHeight:Y,filterWidth:J,inChannels:Q,inDepth:ee,inHeight:M,inWidth:q,outChannels:te,outDepth:Z,outHeight:le,outWidth:de,strideDepth:fe,strideHeight:ne,strideWidth:U}=d,ae=X-1-d.padInfo.front,ge=Y-1-d.padInfo.top,be=J-1-d.padInfo.left;for(let $e=0;$e<H;++$e)for(let Ae=0;Ae<Q;++Ae)for(let et=0;et<ee;++et){const Qe=et-ae,it=Math.max(0,Math.ceil(Qe/fe)),ot=Math.min(Z,(X+Qe)/fe);for(let nt=0;nt<M;++nt){const ut=nt-ge,ht=Math.max(0,Math.ceil(ut/ne)),Dr=Math.min(le,(Y+ut)/ne);for(let Zt=0;Zt<q;++Zt){const Gs=Zt-be,Tt=Math.max(0,Math.ceil(Gs/U)),Or=Math.min(de,(J+Gs)/U);let Hs=0;for(let $n=it;$n<ot;++$n){const di=$n*fe-Qe;for(let A=ht;A<Dr;++A){const k=A*ne-ut;for(let N=Tt;N<Or;++N){const O=N*U-Gs,W=w*$e+b*$n+S*A+T*N,re=$*(X-1-di)+_*(Y-1-k)+D*(J-1-O)+z*Ae;for(let ce=0;ce<te;++ce){const je=x[W+ce],It=I[re+ce];Hs+=je*It}}}}f[p*$e+m*et+g*nt+y*Zt+Ae]=Hs}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const Jme={kernelName:sx,backendName:"cpu",kernelFunc:Yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qme=rt(Fu,t=>Math.cos(t)),Zme={kernelName:Fu,backendName:"cpu",kernelFunc:Qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ege=rt(Pu,t=>Math.cosh(t)),tge={kernelName:Pu,backendName:"cpu",kernelFunc:ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nge(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,f]=r.shape,p=i.shape[0],[m,g]=a,y=Le([p,m,g,f],"float32"),x=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,b=n.data.get(r.dataId).values,S=Re(r.shape),T=Re(y.shape);for(let I=0;I<p;I++){const $=I*4,_=x[$],D=x[$+1],z=x[$+2],H=x[$+3],X=w[I];if(X>=u)continue;const Y=m>1?(z-_)*(d-1)/(m-1):0,J=g>1?(H-D)*(h-1)/(g-1):0;for(let Q=0;Q<m;Q++){const ee=m>1?_*(d-1)+Q*Y:.5*(_+z)*(d-1);if(ee<0||ee>d-1){for(let M=0;M<g;M++)for(let q=0;q<f;q++){const te=q+M*T[2]+Q*T[1]+I*T[0];y.values[te]=c}continue}if(l==="bilinear"){const M=Math.floor(ee),q=Math.ceil(ee),te=ee-M;for(let Z=0;Z<g;Z++){const le=g>1?D*(h-1)+Z*J:.5*(D+H)*(h-1);if(le<0||le>h-1){for(let U=0;U<f;U++){const ae=U+Z*T[2]+Q*T[1]+I*T[0];y.values[ae]=c}continue}const de=Math.floor(le),fe=Math.ceil(le),ne=le-de;for(let U=0;U<f;U++){let ae=U+de*S[2]+M*S[1]+X*S[0];const ge=b[ae];ae=U+fe*S[2]+M*S[1]+X*S[0];const be=b[ae];ae=U+de*S[2]+q*S[1]+X*S[0];const $e=b[ae];ae=U+fe*S[2]+q*S[1]+X*S[0];const Ae=b[ae],et=ge+(be-ge)*ne,Qe=$e+(Ae-$e)*ne;ae=U+Z*T[2]+Q*T[1]+I*T[0],y.values[ae]=et+(Qe-et)*te}}}else for(let M=0;M<g;++M){const q=g>1?D*(h-1)+M*J:.5*(D+H)*(h-1);if(q<0||q>h-1){for(let le=0;le<f;le++){const de=le+M*T[2]+Q*T[1]+I*T[0];y.values[de]=c}continue}const te=Math.round(q),Z=Math.round(ee);for(let le=0;le<f;le++){const de=le+te*S[2]+Z*S[1]+X*S[0],fe=le+M*T[2]+Q*T[1]+I*T[0];y.values[fe]=b[de]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const sge={kernelName:ix,backendName:"cpu",kernelFunc:nge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Ne(r,"cumprod");const l=Ft([i],r.shape.length);let c=r;l!=null&&(c=vs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Yt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=gs(c.dtype,"int32"),h=q0(se(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(y,x)=>y+p-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=p)for(let x=0;x<p;x++){const w=m(y,x);if(x===0)h[w]=o?1:f[w];else{const b=m(y,x-1);h[w]=o?f[b]*h[b]:f[w]*h[b]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const y=Ea(l),x=vs({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),x}return g}const ige={kernelName:rx,backendName:"cpu",kernelFunc:rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Ne(r,"cumsum");const l=Ft([i],r.shape.length);let c=r;l!=null&&(c=vs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Yt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=gs(c.dtype,"int32"),h=Pn(se(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(y,x)=>y+p-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=p)for(let x=0;x<p;x++){const w=m(y,x);if(x===0)h[w]=o?0:f[w];else{const b=m(y,x-1);h[w]=o?f[b]+h[b]:f[w]+h[b]}}const g=n.makeTensorInfo(c.shape,d,h);if(l!=null){const y=Ea(l),x=vs({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(c),x}return g}const age={kernelName:op,backendName:"cpu",kernelFunc:oge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=PI(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=_4(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const cge={kernelName:ox,backendName:"cpu",kernelFunc:lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;E(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*i,h=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,m=new Float32Array(a*d*h*f);let g=0;for(let y=0;y<a;++y)for(let x=0;x<d;++x){const w=Math.floor(x/i),b=x%i;for(let S=0;S<h;++S){const T=Math.floor(S/i),I=S%i,$=(b*i+I)*f;for(let _=0;_<f;++_){const z=_+$+u*(T+c*(w+l*y));m[g++]=p[z]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,m)}const dge={kernelName:ax,backendName:"cpu",kernelFunc:uge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;Ne([r,i],"depthwiseConv2DNative");const u=Re(r.shape),d=Re(i.shape);let h=l;h==null&&(h=[1,1]),E(Mn(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=Tn(r.shape,i.shape,o,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:x}=f,w=x.left,b=x.top,S=f.outChannels/f.inChannels,T=new rn(f.outShape,r.dtype),I=n.data.get(r.dataId).values,$=n.data.get(i.dataId).values,_=T.values;for(let D=0;D<f.batchSize;++D){const z=D*u[0],H=D*T.strides[0];for(let X=0;X<f.outHeight;++X){const Y=H+X*T.strides[1],J=X*f.strideHeight-b;for(let Q=0;Q<p;++Q){const ee=J+Q*g;if(ee<0||ee>=f.inHeight)continue;const M=Q*d[0],q=z+ee*u[1];for(let te=0;te<f.outWidth;++te){const Z=Y+te*T.strides[2],le=te*f.strideWidth-w;for(let de=0;de<m;++de){const fe=le+de*y;if(fe<0||fe>=f.inWidth)continue;const ne=M+de*d[1],U=q+fe*f.inChannels;let ae=Z,ge=ne;for(let be=0;be<f.inChannels;++be){const $e=I[U+be];for(let Ae=0;Ae<S;++Ae)_[ae+Ae]+=$e*$[ge+Ae];ae+=S,ge+=S}}}}}}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const hge={kernelName:ap,backendName:"cpu",kernelFunc:OV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;Ne([r,i],"depthwiseConv2dNativeBackpropFilter");const d=Tn(r.shape,u,o,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,g=new rn(d.filterShape,"float32"),y=d.padInfo.left,x=d.padInfo.top,w=d.outChannels/d.inChannels,b=n.data.get(r.dataId).values,S=new rn(r.shape,r.dtype,b),T=n.data.get(i.dataId).values,I=new rn(i.shape,i.dtype,T);for(let $=0;$<p;++$){const _=Math.max(0,Math.ceil((x-$)/h)),D=Math.min(d.outHeight,(d.inHeight+x-$)/h);for(let z=0;z<m;++z){const H=Math.max(0,Math.ceil((y-z)/f)),X=Math.min(d.outWidth,(d.inWidth+y-z)/f);for(let Y=0;Y<d.outChannels;++Y){const J=Math.trunc(Y/w),Q=Y%w;let ee=0;for(let M=0;M<d.batchSize;++M)for(let q=_;q<D;++q){const te=$+q*h-x;for(let Z=H;Z<X;++Z){const le=z+Z*f-y;ee+=S.get(M,te,le,J)*I.get(M,q,Z,Y)}}g.set(ee,$,z,J,Q)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const pge={kernelName:lx,backendName:"cpu",kernelFunc:fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;Ne([r,i],"depthwiseConv2DNativeBackpropInput");const d=Re(r.shape),h=Re(i.shape),f=Tn(u,i.shape,o,a,l,c,!0),p=new rn(f.inShape,"float32"),m=p.values,[g,y,x]=p.strides,w=n.data.get(r.dataId).values,[b,S,T]=d,I=n.data.get(i.dataId).values,[$,_,D]=h,{batchSize:z,filterHeight:H,filterWidth:X,inChannels:Y,inHeight:J,inWidth:Q,outChannels:ee,outHeight:M,outWidth:q,strideHeight:te,strideWidth:Z}=f,le=H-1-f.padInfo.top,de=X-1-f.padInfo.left,fe=ee/Y;for(let ne=0;ne<z;++ne)for(let U=0;U<Y;++U)for(let ae=0;ae<J;++ae){const ge=ae-le,be=Math.max(0,Math.ceil(ge/te)),$e=Math.min(M,(H+ge)/te);for(let Ae=0;Ae<Q;++Ae){const et=Ae-de,Qe=Math.max(0,Math.ceil(et/Z)),it=Math.min(q,(X+et)/Z);let ot=0;for(let nt=be;nt<$e;++nt){const ut=nt*te-ge;for(let ht=Qe;ht<it;++ht){const Dr=ht*Z-et,Zt=b*ne+S*nt+T*ht,Gs=$*(H-1-ut)+_*(X-1-Dr)+D*U;for(let Tt=0;Tt<fe;++Tt){const Or=U*fe+Tt,Hs=w[Zt+Or],$n=I[Gs+Tt];ot+=Hs*$n}}}m[g*ne+y*ae+x*Ae+U]=ot}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const gge={kernelName:cx,backendName:"cpu",kernelFunc:mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yge(t){const{inputs:e,backend:n}=t,{x:s}=e,r=se(s.shape),i=n.data.get(s.dataId).values,o=Le([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const xge={kernelName:ux,backendName:"cpu",kernelFunc:yge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wge={kernelName:lp,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:x,padInfo:w,strideHeight:b,strideWidth:S,filterHeight:T,filterWidth:I,dilationHeight:$,dilationWidth:_,outShape:D}=Jp(s.shape,r.shape,i,o,"NHWC",a),z=se(D),H=D.length,X=Bt(s.dtype,z);for(let J=0;J<f;++J)for(let Q=0;Q<y;++Q){const ee=Q*b-w.top;for(let M=0;M<x;++M){const q=M*S-w.left;for(let te=0;te<g;++te){let Z=Number.MIN_SAFE_INTEGER;for(let de=0;de<T;++de){const fe=ee+de*$;if(fe>=0&&fe<p)for(let ne=0;ne<I;++ne){const U=q+ne*_;if(U>=0&&U<m){const ae=Yr([J,fe,U,te],u,Re(s.shape)),ge=Yr([de,ne,te],h,Re(r.shape)),be=c[ae]+d[ge];be>Z&&(Z=be)}}}const le=Yr([J,Q,M,te],H,Re(D));X[le]=Z}}}return{dataId:l.write(Ta(X,s.dtype),D,s.dtype),shape:D,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge={kernelName:Uy,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=sr(s.shape,c.data.get(s.dataId).values),d=sr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:w,strideWidth:b,filterHeight:S,filterWidth:T,dilationHeight:I,dilationWidth:$,outShape:_}=Jp(s.shape,r.shape,o,a,"NHWC",l);E(i.rank===_.length,()=>`Error in ${Uy}, dy must have the same rank as output ${_.length}, but got ${i.rank}`);const D=sr(_,c.data.get(i.dataId).values),z=KC(r.shape,r.dtype);for(let X=0;X<h;++X)for(let Y=0;Y<g;++Y){const J=Y*w-x.top;for(let Q=0;Q<y;++Q){const ee=Q*b-x.left;for(let M=0;M<m;++M){let q=Number.MIN_SAFE_INTEGER,te=0,Z=0;for(let le=0;le<S;++le){const de=J+le*I;if(de>=0&&de<f)for(let fe=0;fe<T;++fe){const ne=ee+fe*$;if(ne>=0&&ne<p){const U=u[X][de][ne][M]+d[le][fe][M];U>q&&(q=U,te=le,Z=fe)}}}z[te][Z][M]+=D[X][Y][Q][M]}}}return{dataId:c.write(Ta(z,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge={kernelName:jy,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=sr(s.shape,c.data.get(s.dataId).values),d=sr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:w,strideWidth:b,filterHeight:S,filterWidth:T,dilationHeight:I,dilationWidth:$,outShape:_}=Jp(s.shape,r.shape,o,a,"NHWC",l);E(i.rank===_.length,()=>`Error in ${jy}, dy must have the same rank as output ${_.length}, but got ${i.rank}`);const D=sr(_,c.data.get(i.dataId).values),z=KC(s.shape,s.dtype);for(let X=0;X<h;++X)for(let Y=0;Y<g;++Y){const J=Y*w-x.top;for(let Q=0;Q<y;++Q){const ee=Q*b-x.left;for(let M=0;M<m;++M){let q=Number.MIN_SAFE_INTEGER,te=J<0?0:J,Z=ee<0?0:ee;for(let le=0;le<S;++le){const de=J+le*I;if(de>=0&&de<f)for(let fe=0;fe<T;++fe){const ne=ee+fe*$;if(ne>=0&&ne<p){const U=u[X][de][ne][M]+d[le][fe][M];U>q&&(q=U,te=de,Z=ne)}}}z[X][te][Z][M]+=D[X][Y][Q][M]}}}return{dataId:c.write(Ta(z,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],m=n.data.get(r.dataId).values,g=r.dtype==="float32"?255:1,y=new Uint8ClampedArray(f*h*4);for(let w=0;w<h*f;++w){const b=[0,0,0,255*c];for(let T=0;T<p;T++){const I=m[w*p+T];if(r.dtype==="float32"){if(I<0||I>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${I}.`)}else if(r.dtype==="int32"&&(I<0||I>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${I}.`);p===1?(b[0]=I*g,b[1]=I*g,b[2]=I*g):b[T]=I*g}const S=w*4;y[S+0]=Math.round(b[0]),y[S+1]=Math.round(b[1]),y[S+2]=Math.round(b[2]),y[S+3]=Math.round(b[3])}i.width=f,i.height=h;const x=new ImageData(y,f,h);return d.putImageData(x,0,0),r}const kge={kernelName:dx,backendName:"cpu",kernelFunc:Sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $m(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"sum");let a;r.dtype==="bool"?a=xa({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=Mi({inputs:{x:r},backend:n});const l=a.shape.length,c=ze(i,a.shape),u=Ft(c,l);let d=c,h=a;u!=null&&(h=vs({inputs:{x:a},backend:n,attrs:{perm:u}}),d=Yt(d.length,l)),Bn("sum",d,h.shape.length);const[f,p]=In(h.shape,d),m=gs(h.dtype,"int32");let g=l0(n,f,m);const y=se(p),x=n.data.get(g.dataId).values,w=n.data.get(h.dataId).values;for(let b=0;b<x.length;++b){const S=b*y;let T=0;for(let I=0;I<y;++I)T+=w[S+I];x[b]=T}if(o){const b=Xt(g.shape,c),S=g;g=gt({inputs:{x:g},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(S)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),g}const Cge={kernelName:Vp,backendName:"cpu",kernelFunc:$m};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=q2(r,i.length);X2(o.length,l,i);const{path:c,steps:u}=Y2(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:y,expandDims:x}=K2(f,l[g]);let w;J2(y)?w=i[g]:(w=vs({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),p.push(w));const b=w.shape.slice();for(let S=0;S<x.length;++S)b.splice(x[S],0,1);Ue(w.shape,b)||(w=gt({inputs:{x:w},backend:n,attrs:{shape:b}}),p.push(w)),h===null?h=w:(h=ub({inputs:{a:w,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=$m({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const Tge={kernelName:hx,backendName:"cpu",kernelFunc:Nge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ige(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Ne([s,r],"eluGrad");const i=new Float32Array(se(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const $ge={kernelName:fx,backendName:"cpu",kernelFunc:Ige};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ege=z2,Rge=V2,Age=j2,_ge=U2,Dge=W2,Oge=G2,Fge=rt(Bu,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+Ege*n);return e*(1-((((Oge*s+Dge)*s+_ge)*s+Age)*s+Rge)*s*Math.exp(-n*n))}),Pge={kernelName:Bu,backendName:"cpu",kernelFunc:Fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(E(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),gt({inputs:{x:r},backend:n,attrs:{shape:a}})}const Lge={kernelName:up,backendName:"cpu",kernelFunc:d0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mge=Qt((t,e)=>t/e),jI=gn(Lu,Mge),GS={kernelName:Lu,backendName:"cpu",kernelFunc:jI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=se(c),d=kn("float32",u),h=kn("float32",u);for(let g=0;g<r;g++){const y=Fl({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,i]}}),x=Fl({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,i]}}),w=Es({inputs:{real:y,imag:x},backend:n}),{real:b,imag:S}=Bge(w,e,n),T=fo(b,S);for(let I=0;I<i;I++){const $=H2(T,I);d[g*i+I]=$.real,h[g*i+I]=$.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=Es({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function Bge(t,e,n){const s=se(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(zge(s)){const a=HS(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",bo(s,"float32")),h=Mi({inputs:{x:d},backend:n}),f=GS.kernelFunc({inputs:{a:c,b:d},backend:n}),p=GS.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=fo(i,o),l=Vge(a,s,e);return CB(l)}}function zge(t){return(t&t-1)===0}function HS(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=fo(t,e),o=n/2,a=NB(i),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),f=Es({inputs:{real:d,imag:h},backend:r}),p=TB(i),m=p.real,g=p.imag,y=[m.length],x=r.makeTensorInfo(y,"float32",m),w=r.makeTensorInfo(y,"float32",g),b=Es({inputs:{real:x,imag:w},backend:r}),S=HS(l,c,o,s,r),T=S.real,I=S.imag,$=[T.length],_=r.makeTensorInfo($,"float32",T),D=r.makeTensorInfo($,"float32",I),z=Es({inputs:{real:_,imag:D},backend:r}),H=HS(m,g,o,s,r),X=H.real,Y=H.imag,J=[X.length],Q=r.makeTensorInfo(J,"float32",X),ee=r.makeTensorInfo(J,"float32",Y),M=Es({inputs:{real:Q,imag:ee},backend:r}),q=$B(n,s),te=[q.real.length],Z=r.makeTensorInfo(te,"float32",q.real),le=r.makeTensorInfo(te,"float32",q.imag),de=Es({inputs:{real:Z,imag:le},backend:r}),fe=ub({inputs:{a:de,b:M},backend:r}),ne=uu({inputs:{a:z,b:fe},backend:r}),U=zI({inputs:{a:z,b:fe},backend:r}),ae=Ol({inputs:{input:ne},backend:r}),ge=Ol({inputs:{input:U},backend:r}),be=du({inputs:{input:ne},backend:r}),$e=du({inputs:{input:U},backend:r}),Ae=hu({inputs:[ae,ge],backend:r,attrs:{axis:0}}),et=hu({inputs:[be,$e],backend:r,attrs:{axis:0}}),Qe=r.data.get(Ae.dataId).values,it=r.data.get(et.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(le),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(fe),r.disposeIntermediateTensorInfo(ne),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(ae),r.disposeIntermediateTensorInfo(be),r.disposeIntermediateTensorInfo(ge),r.disposeIntermediateTensorInfo($e),r.disposeIntermediateTensorInfo(Ae),r.disposeIntermediateTensorInfo(et),{real:Qe,imag:it}}function Vge(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=EB(r*a,e,n),c=H2(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),IB(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jge(t){const{inputs:e,backend:n}=t,{input:s}=e,r=se(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=gt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=FV(a,!1,n),c=gt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Uge={kernelName:px,backendName:"cpu",kernelFunc:jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UI(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||Wl(r),a=Bt(o,se(s));return Gge(a,r,o),e.makeTensorInfo(s,o,a)}const Wge={kernelName:mx,backendName:"cpu",kernelFunc:UI};function Gge(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hge={kernelName:gx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=kn(s.dtype,se(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let g=0;g<l;g++){const y=g*c;for(let x=0;x<c;x++){const w=Math.round(l-g-1),b=f+m+y+x;let S=u[b];if(w>=0&&w<l){const T=w*c,I=f+m+T+x;S=u[I]}i[b]=S}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=DV({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const g=m;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const y=gt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=uu({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=uu({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(f){const g=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const y=gt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=u0(n,m,f,y,p),n.disposeIntermediateTensorInfo(y)}else m=u0(n,m,f,a,p);n.disposeIntermediateTensorInfo(g)}return m}const Kge={kernelName:df,backendName:"cpu",kernelFunc:qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=OV({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const g=m;m=uu({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}if(f){const g=m;m=u0(n,m,f,a,p),n.disposeIntermediateTensorInfo(g)}return m}const Yge={kernelName:hf,backendName:"cpu",kernelFunc:Xge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jge(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=se(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,d]=Mw(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),p=U4(h,f,s.dtype,c,a,u,d,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const Qge={kernelName:yx,backendName:"cpu",kernelFunc:Jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;Ne([r,i],"gatherV2");const l=ze(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let b=0;b<c.length;++b){const S=c[b];E(S<=u-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=se(i.shape),f=Z2(r,i,l,d),p=gt({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=gt({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),g=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],y=n.bufferSync(m),x=n.bufferSync(p),w=W4(x,y,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,w.dtype,w.values)}const eye={kernelName:hp,backendName:"cpu",kernelFunc:Zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tye(t){const{inputs:e,backend:n}=t,{input:s}=e,r=se(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=gt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=FV(a,!0,n),c=gt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const nye={kernelName:xx,backendName:"cpu",kernelFunc:tye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sye=rt(Hu,t=>Number.isFinite(t)?1:0,"bool"),rye={kernelName:Hu,backendName:"cpu",kernelFunc:sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iye=rt(qu,t=>Math.abs(t)===1/0?1:0,"bool"),oye={kernelName:qu,backendName:"cpu",kernelFunc:iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aye=rt(Ku,t=>Number.isNaN(t)?1:0,"bool"),lye={kernelName:Ku,backendName:"cpu",kernelFunc:aye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cye(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=X4(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const uye={kernelName:bx,backendName:"cpu",kernelFunc:cye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dye=rt(Yu,t=>Math.log1p(t)),hye={kernelName:Yu,backendName:"cpu",kernelFunc:dye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fye=Qt((t,e)=>t&&e),pye=gn(yp,fye,null,"bool"),mye={kernelName:yp,backendName:"cpu",kernelFunc:pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gye=rt(xp,t=>t?0:1,"bool"),yye={kernelName:xp,backendName:"cpu",kernelFunc:gye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xye=Qt((t,e)=>t||e),wye=gn(wp,xye,null,"bool"),bye={kernelName:wp,backendName:"cpu",kernelFunc:wye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;Ne(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=se(r.shape),f=new Float32Array(h);function p(m){const g=m%c;let y=m-g+Math.max(0,g-i);const x=m-g+Math.min(g+i,u);let w=0;for(;y<=x;y++){const b=d[y];w+=b*b}return w}for(let m=0;m<h;m++){const g=p(m),y=d[m]*Math.pow(o+a*g,-l);f[m]=y}return n.makeTensorInfo(r.shape,r.dtype,f)}const Sye={kernelName:bp,backendName:"cpu",kernelFunc:vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;Ne(o,"LRNGrad");const d=se(o.shape),h=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(d),y=d;for(let x=0;x<y;x++){const w=x%h,b=x-w+Math.max(0,w-a),S=x-w+Math.min(h,w+a+1);let T=0;for(let I=b;I<S;I++)T+=Math.pow(p[I],2);T=c*T+l;for(let I=b;I<S;I++){let $=-2*c*u*p[I]*m[x]/T;x===I&&($+=Math.pow(T,-u)),$*=f[x],g[I]+=$}}return n.makeTensorInfo(o.shape,r.dtype,g)}const Cye={kernelName:vx,backendName:"cpu",kernelFunc:kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=ze(i,l);let d=u;const h=Ft(d,c);let f=a.data.get(r.dataId).values;if(h!=null){const b=new Array(c);for(let S=0;S<b.length;S++)b[S]=l[h[S]];f=MI(f,l,r.dtype,h,b),d=Yt(d.length,c),l=b}Ne(r,"max"),Bn("max",d,c);const[p,m]=In(l,d),g=se(m),y=J4(f,g,p,r.dtype),x=a.write(y,p,r.dtype);let w=p;return o&&(w=Xt(p,u)),{dataId:x,shape:w,dtype:r.dtype}}const Nye={kernelName:vp,backendName:"cpu",kernelFunc:PV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ne(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;E(Mn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Rr(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Ue(u.inShape,u.outShape))d=Mi({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Re(r.shape),p=VI(h,r.shape,r.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const Iye={kernelName:Sp,backendName:"cpu",kernelFunc:Tye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ne(r,"maxPool3d");const u=vo(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=_V(d,r.shape,r.dtype,Re(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Eye={kernelName:kp,backendName:"cpu",kernelFunc:$ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Ne([r,i],"maxPool3DGrad");const u=vo(i.shape,o,a,1,l,c),d=n.bufferSync(i),h=xme(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,y=u.dilationHeight,x=u.dilationWidth,w=u.effectiveFilterDepth,b=u.effectiveFilterHeight,S=u.effectiveFilterWidth,T=w-1-u.padInfo.front,I=S-1-u.padInfo.left,$=b-1-u.padInfo.top,_=Le(i.shape,"float32"),D=n.bufferSync(r);for(let z=0;z<u.batchSize;++z)for(let H=0;H<u.inChannels;++H)for(let X=0;X<u.inDepth;++X)for(let Y=0;Y<u.inHeight;++Y)for(let J=0;J<u.inWidth;++J){const Q=X-T,ee=Y-$,M=J-I;let q=0;for(let te=0;te<w;te+=g){const Z=(Q+te)/f;if(!(Z<0||Z>=u.outDepth||Math.floor(Z)!==Z))for(let le=0;le<b;le+=y){const de=(ee+le)/p;if(!(de<0||de>=u.outHeight||Math.floor(de)!==de))for(let fe=0;fe<S;fe+=x){const ne=(M+fe)/m;if(ne<0||ne>=u.outWidth||Math.floor(ne)!==ne)continue;const U=w*b*S-1-h.get(z,Z,de,ne,H),ae=te*b*S+le*S+fe,ge=U===ae?1:0;if(ge===0)continue;const be=D.get(z,Z,de,ne,H);q+=be*ge}}}_.set(q,z,X,Y,J,H)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const Aye={kernelName:kx,backendName:"cpu",kernelFunc:Rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Ne([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=Rr(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=Le(h.outShape,a.dtype,AV(f,a.shape,a.dtype,h).values),m=h.strideHeight,g=h.strideWidth,y=h.dilationHeight,x=h.dilationWidth,w=h.effectiveFilterHeight,b=h.effectiveFilterWidth,S=b-1-h.padInfo.left,T=w-1-h.padInfo.top,I=Le(a.shape,"float32"),$=n.data.get(r.dataId).values,_=Le(r.shape,"float32",$);for(let D=0;D<h.batchSize;++D)for(let z=0;z<h.inChannels;++z)for(let H=0;H<h.inHeight;++H)for(let X=0;X<h.inWidth;++X){const Y=H-T,J=X-S;let Q=0;for(let ee=0;ee<w;ee+=y){const M=(Y+ee)/m;if(!(M<0||M>=h.outHeight||Math.floor(M)!==M))for(let q=0;q<b;q+=x){const te=(J+q)/g;if(te<0||te>=h.outWidth||Math.floor(te)!==te)continue;const Z=w*b-1-p.get(D,M,te,z),le=ee*b+q,de=Z===le?1:0;if(de===0)continue;const fe=_.get(D,M,te,z);Q+=fe*de}}I.set(Q,D,H,X,z)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Dye={kernelName:Sx,backendName:"cpu",kernelFunc:_ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oye(t,e,n,s,r){const i=Re(e),o=VI(t,e,n,i,r,"max"),a=AV(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fye={kernelName:Cx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;Ne(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=Rr(s.shape,r,i,[1,1],o),[d,h]=Oye(c,s.shape,s.dtype,a,u),f=l.write(d,u.outShape,s.dtype),p=l.write(h,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=ze(i,r.shape),c=In(r.shape,a)[1],u=se(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=xa({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=jI({inputs:{a:f,b:h},backend:n});d.push(p);const m=$m({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const Lye={kernelName:Cp,backendName:"cpu",kernelFunc:Pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"min");const a=ze(i,r.shape);let l=a;const c=Ft(l,r.shape.length);let u=r;c!=null&&(u=vs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Yt(l.length,r.shape.length)),Bn("min",l,u.shape.length);const[d,h]=In(u.shape,l),f=se(h),p=Pn(se(d),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let w=m[x];for(let b=0;b<f;++b){const S=m[x+b];(Number.isNaN(S)||S<w)&&(w=S)}p[y]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(d,u.dtype,p);if(o){const y=Xt(d,a),x=gt({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),x}return g}const Bye={kernelName:Np,backendName:"cpu",kernelFunc:Mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;Ne(r,"mirrorPad");const a=i.map((w,b)=>w[0]+r.shape[b]+w[1]),l=i.map(w=>w[0]),c=i.map((w,b)=>w[0]+r.shape[b]),u=o==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=Re(r.shape),p=se(a),m=a.length,g=Re(a),y=kn(r.dtype,p);for(let w=0;w<p;w++){let b=Gl(w,m,g);for(let T=0;T<m;T++)b[T]<l[T]?b[T]=l[T]*2-b[T]-u:b[T]>=c[T]&&(b[T]=(c[T]-1)*2-b[T]+u);b=b.map((T,I)=>T-l[I]);const S=Yr(b,h,f);y[w]=d[S]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const Vye={kernelName:Tp,backendName:"cpu",kernelFunc:zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jye=Qt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Uye=gn(Zu,jye),Wye={kernelName:Zu,backendName:"cpu",kernelFunc:Uye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LV(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=ze([a],r.shape),c=PV({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Xt(c.shape,l),d=gt({inputs:{x:c},backend:n,attrs:{shape:u}}),h=zI({inputs:{a:r,b:d},backend:n}),f=B4({inputs:{x:h},backend:n}),p=$m({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=gt({inputs:{x:p},backend:n,attrs:{shape:u}}),g=jI({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const Gye={kernelName:Wp,backendName:"cpu",kernelFunc:LV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hye(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;Ne(r,"multinomial");const l=a?r:LV({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,i],f=Pn(se(h),"int32");for(let p=0;p<c;++p){const m=p*u,g=new Float32Array(u-1);g[0]=d[m];for(let w=1;w<g.length;++w)g[w]=g[w-1]+d[m+w];const y=Td.alea(o.toString()),x=p*i;for(let w=0;w<i;++w){const b=y();f[x+w]=g.length;for(let S=0;S<g.length;S++)if(b<g[S]){f[x+w]=S;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const qye={kernelName:Nx,backendName:"cpu",kernelFunc:Hye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kye=Ow;function Xye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;Ne(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=Kye(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Yye={kernelName:Tx,backendName:"cpu",kernelFunc:Xye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jye=Fw;function Qye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;Ne(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:f}=Jye(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Zye={kernelName:Ix,backendName:"cpu",kernelFunc:Qye};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e0e=Pw;function t0e(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;Ne(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,h=o,f=a,p=l,m=c,{selectedIndices:g,selectedScores:y}=e0e(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const n0e={kernelName:$x,backendName:"cpu",kernelFunc:t0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;Ne(r,"oneHot");const c=se(r.shape),u=new Float32Array(c*o);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const r0e={kernelName:Rp,backendName:"cpu",kernelFunc:s0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Ol({inputs:{input:s},backend:n}),i=h0({inputs:{x:r},backend:n}),o=du({inputs:{input:s},backend:n}),a=h0({inputs:{x:o},backend:n}),l=Es({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return UI({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const i0e={kernelName:Kp,backendName:"cpu",kernelFunc:h0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Ol({inputs:{input:s},backend:n}),i=MV({inputs:{x:r},backend:n}),o=du({inputs:{input:s},backend:n}),a=h0({inputs:{x:o},backend:n}),l=Es({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return UI({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const o0e={kernelName:Ep,backendName:"cpu",kernelFunc:MV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BV(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return d0({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Ln(i,u.shape,"All tensors passed to stack must have matching shapes"),E(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=d0({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=hu({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const a0e={kernelName:Ap,backendName:"cpu",kernelFunc:BV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;Ne(r,"pad");const a=i.map((x,w)=>x[0]+r.shape[w]+x[1]),l=i.map(x=>x[0]),c=n.data.get(r.dataId).values,u=se(r.shape),d=r.shape.length,h=Re(r.shape),f=se(a),p=a.length,m=Re(a),g=kn(r.dtype,f);o!==0&&g.fill(o);for(let x=0;x<u;x++){const b=Gl(x,d,h).map((T,I)=>T+l[I]),S=Yr(b,p,m);g[S]=c[x]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}const zV={kernelName:_p,backendName:"cpu",kernelFunc:l0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c0e=Qt((t,e)=>Math.pow(t,e)),u0e=gn(td,c0e),d0e={kernelName:td,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,a=r.map(g=>n.data.get(g.dataId).values),l=r.map(g=>g.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[d,h,f]=sV(a,l,c,i.shape,i.dtype,u,o.shape),p=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(f,i.dtype,h);return p.concat([m])}const f0e={kernelName:Ex,backendName:"cpu",kernelFunc:h0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=rV(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const m0e={kernelName:Rx,backendName:"cpu",kernelFunc:p0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(g=>n.data.get(g.dataId).values),f=a.map(g=>g.shape),[p,m]=iV(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const y0e={kernelName:Ax,backendName:"cpu",kernelFunc:g0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x0e(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=oV(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const w0e={kernelName:_x,backendName:"cpu",kernelFunc:x0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b0e=rt(nd,t=>1/t),v0e={kernelName:nd,backendName:"cpu",kernelFunc:b0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Ne(r,"resizeBilinear");const l=Re(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(se([d,c,u,p])),y=[i&&c>1?h-1:h,i&&u>1?f-1:f],x=[i&&c>1?c-1:c,i&&u>1?u-1:u];let w=0;const b=y[0]/x[0],S=y[1]/x[1];for(let T=0;T<d;T++)for(let I=0;I<c;I++){let $;o?$=b*(I+.5)-.5:$=b*I;const _=Math.max(0,Math.floor($)),D=$-_,z=Math.min(h-1,Math.ceil($)),H=T*l[0]+_*l[1],X=T*l[0]+z*l[1];for(let Y=0;Y<u;Y++){let J;o?J=S*(Y+.5)-.5:J=S*Y;const Q=Math.max(0,Math.floor(J)),ee=J-Q,M=Math.min(f-1,Math.ceil(J)),q=H+Q*l[2],te=X+Q*l[2],Z=H+M*l[2],le=X+M*l[2];for(let de=0;de<p;de++){const fe=m[q+de],ne=m[te+de],U=m[Z+de],ae=m[le+de],ge=fe+(U-fe)*ee,be=ne+(ae-ne)*ee,$e=ge+(be-ge)*D;g[w++]=$e}}}return n.makeTensorInfo([d,c,u,p],"float32",g)}const k0e={kernelName:Lp,backendName:"cpu",kernelFunc:S0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Ne([i,r],"resizeBilinearGrad");const a=Re(r.shape),[l,c,u,d]=r.shape,[,h,f]=i.shape,p=new Float32Array(l*c*u*d),m=[o&&h>1?c-1:c,o&&f>1?u-1:u],g=[o&&h>1?h-1:h,o&&f>1?f-1:f],y=m[0]/g[0],x=m[1]/g[1],w=n.data.get(i.dataId).values;let b=0;for(let S=0;S<l;S++){const T=S*a[0];for(let I=0;I<h;I++){const $=I*y,_=Math.floor($),D=Math.min(Math.ceil($),c-1),z=T+_*a[1],H=T+D*a[1],X=$-_,Y=1-X;for(let J=0;J<f;J++){const Q=J*x,ee=Math.floor(Q),M=Math.min(Math.ceil(Q),u-1),q=Q-ee,te=1-q,Z=z+ee*a[2],le=z+M*a[2],de=H+ee*a[2],fe=H+M*a[2],ne=Y*te,U=Y*q,ae=X*te,ge=X*q;for(let be=0;be<d;be++){const $e=w[b++];p[Z+be]+=$e*ne,p[le+be]+=$e*U,p[de+be]+=$e*ae,p[fe+be]+=$e*ge}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const N0e={kernelName:Fx,backendName:"cpu",kernelFunc:C0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Ne(r,"resizeNearestNeighbor");const l=Re(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(d*c*u*p),y=[i&&c>1?h-1:h,i&&u>1?f-1:f],x=[i&&c>1?c-1:c,i&&u>1?u-1:u],w=y[0]/x[0],b=y[1]/x[1];let S=0;for(let T=0;T<d;T++){const I=T*l[0];for(let $=0;$<c;$++){const _=o?w*($+.5):w*$;let D=Math.min(h-1,i?Math.round(_):Math.floor(_));o&&(D=Math.max(0,D));const z=I+D*l[1];for(let H=0;H<u;H++){const X=o?b*(H+.5):b*H;let Y=Math.min(f-1,i?Math.round(X):Math.floor(X));o&&(Y=Math.max(0,Y));const J=z+Y*l[2];for(let Q=0;Q<p;Q++){const ee=m[J+Q];g[S++]=ee}}}}return n.makeTensorInfo([d,c,u,p],r.dtype,g)}const I0e={kernelName:Pp,backendName:"cpu",kernelFunc:T0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Ne([i,r],"resizeNearestNeighborGrad");const a=Re(r.shape),l=Re(i.shape),[c,u,d,h]=r.shape,[,f,p]=i.shape,m=new Float32Array(c*u*d*h),g=n.data.get(i.dataId).values,y=[o&&f>1?u-1:u,o&&p>1?d-1:d],x=[o&&f>1?f-1:f,o&&p>1?p-1:p],w=y[0]/x[0],b=y[1]/x[1],S=1/w,T=1/b,I=Math.ceil(S)*2+2,$=Math.ceil(T)*2+2;for(let _=0;_<c;_++){const D=_*a[0];for(let z=0;z<u;z++){const H=D+z*a[1],X=Math.floor(z*S),Y=Math.floor(X-I/2);for(let J=0;J<d;J++){const Q=H+J*a[2],ee=Math.floor(J*T),M=Math.floor(ee-$/2);for(let q=0;q<h;q++){let te=0;for(let Z=0;Z<I;Z++){const le=Z+Y;if(le<0||le>=f)continue;const de=D+le*l[1],fe=le*w,ne=Math.min(u-1,o?Math.round(fe):Math.floor(fe));if(z===ne)for(let U=0;U<$;U++){const ae=U+M;if(ae<0||ae>=p)continue;const ge=de+ae*l[2],be=ae*b,$e=Math.min(d-1,o?Math.round(be):Math.floor(be));J===$e&&(te+=g[ge+q])}}m[Q+q]=te}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const E0e={kernelName:Ox,backendName:"cpu",kernelFunc:$0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;Ne(r,"reverse");const o=r.shape.length,a=ze(i,r.shape);if(o===0)return Mi({inputs:{x:r},backend:n});const l=new rn(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const A0e={kernelName:Mp,backendName:"cpu",kernelFunc:R0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _0e={kernelName:Qx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=kn(s.dtype,se(s.shape)),[c,u,d,h]=s.shape,[f,p]=L2(o,u,d),m=255,g=Math.sin(r),y=Math.cos(r),x=a.data.get(s.dataId).values;for(let b=0;b<c;b++){const S=b*d*u*h;for(let T=0;T<u;T++){const I=T*(d*h);for(let $=0;$<d;$++){const _=$*h;for(let D=0;D<h;D++){const z=[c,T,$,D],H=z[2],X=z[1];let Y=(H-f)*y-(X-p)*g,J=(H-f)*g+(X-p)*y;Y=Math.round(Y+f),J=Math.round(J+p);let Q=i;if(typeof i!="number"&&(D===3?Q=m:Q=i[D]),Y>=0&&Y<d&&J>=0&&J<u){const M=J*(d*h),q=Y*h,te=S+M+q+D;Q=x[te]}const ee=S+I+_+D;l[ee]=Q}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D0e=rt(id,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),O0e={kernelName:id,backendName:"cpu",kernelFunc:D0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Da(i,r,o),h=!0,f=n.bufferSync(r),p=n.bufferSync(i),m=sl(f,p,o,d,c,l,a,u,0,h);return n.makeTensorInfo(o,m.dtype,m.values)}const P0e={kernelName:Px,backendName:"cpu",kernelFunc:F0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L0e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function M0e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function B0e(t,e,n,s,r,i){const o=Bt("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?L0e(l,e[u+c]):M0e(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=B0e(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const V0e={kernelName:Mx,backendName:"cpu",kernelFunc:z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0e(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;Ne([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=gs(r.dtype,i.dtype),d=Pn(se(r.shape),u);let h=0;const f=o===0||o>1||r.shape.length===1?1:se(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(r.shape,u,d)}const U0e={kernelName:Bp,backendName:"cpu",kernelFunc:j0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W0e=Vw,G0e=jw,H0e=rt(ad,t=>t>=0?G0e*t:W0e*(Math.exp(t)-1)),q0e={kernelName:ad,backendName:"cpu",kernelFunc:H0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K0e=rt(ud,t=>t<0?-1:t>0?1:0),X0e={kernelName:ud,backendName:"cpu",kernelFunc:K0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y0e=rt(ld,t=>Math.sin(t)),J0e={kernelName:ld,backendName:"cpu",kernelFunc:Y0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q0e=rt(cd,t=>Math.sinh(t)),Z0e={kernelName:cd,backendName:"cpu",kernelFunc:Q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const exe=11920928955078125e-23,D_=Math.log(exe)+2,txe=rt(hd,t=>{const e=t>-D_,n=t<D_,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),nxe={kernelName:hd,backendName:"cpu",kernelFunc:txe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;Ne([r],"spaceToBatchND");const a=se(i),l=[[0,0]];l.push(...o);for(let T=1+i.length;T<r.shape.length;++T)l.push([0,0]);const c=zV.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=mm(c.shape,i,a,!1),d=gm(u.length,i.length,!1),h=ym(c.shape,i,a,!1),m=gt({inputs:{x:c},backend:n,attrs:{shape:u}}),x=vs({inputs:{x:m},backend:n,attrs:{perm:d}}),S=gt({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),S}const rxe={kernelName:jp,backendName:"cpu",kernelFunc:sxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ixe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[d,h,f,p,m]=uV(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const oxe={kernelName:Bx,backendName:"cpu",kernelFunc:ixe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function axe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=dV(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const lxe={kernelName:zx,backendName:"cpu",kernelFunc:axe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cxe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=BI(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const uxe={kernelName:Vx,backendName:"cpu",kernelFunc:cxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dxe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=BI(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const hxe={kernelName:jx,backendName:"cpu",kernelFunc:dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fxe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Da(i,r,a),f=!1,p=n.bufferSync(r);let m;switch(i.dtype){case"bool":{const g=n.bufferSync(i),y=!!n.data.get(o.dataId).values[0];m=sl(p,g,a,h,u,c,l,d,y,f);break}case"float32":{const g=n.bufferSync(i),y=n.data.get(o.dataId).values[0];m=sl(p,g,a,h,u,c,l,d,y,f);break}case"int32":{const g=n.bufferSync(i),y=n.data.get(o.dataId).values[0];m=sl(p,g,a,h,u,c,l,d,y,f);break}case"string":{const g=n.bufferSync(i),y=lo(n.data.get(o.dataId).values[0]);m=sl(p,g,a,h,u,c,l,d,y,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const pxe={kernelName:Ux,backendName:"cpu",kernelFunc:fxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=ze(o,r.shape)[0],l=Q2(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=Fl({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const gxe={kernelName:Up,backendName:"cpu",kernelFunc:mxe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yxe={kernelName:Wx,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Ne(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xxe=rt(wd,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),wxe={kernelName:wd,backendName:"cpu",kernelFunc:xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;Ne(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:w,strides:b}=D2(r.shape,i,o,a,l,c,u,d,h);let S;if(m)S=gt({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||y){E(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const T=R2(x,w,b),I=Fl({inputs:{x:r},backend:n,attrs:{begin:x,size:T}});S=gt({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else{const T=n.bufferSync(r),I=pV(f,T,b,x);S=n.makeTensorInfo(p,I.dtype,I.values)}return S}const vxe={kernelName:Gx,backendName:"cpu",kernelFunc:bxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sxe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=mV(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const kxe={kernelName:Hx,backendName:"cpu",kernelFunc:Sxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cxe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,d]=gV(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Nxe={kernelName:qx,backendName:"cpu",kernelFunc:Cxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Txe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=yV(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const Ixe={kernelName:Kx,backendName:"cpu",kernelFunc:Txe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $xe=rt(gd,t=>Math.tan(t)),Exe={kernelName:gd,backendName:"cpu",kernelFunc:$xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rxe=rt(yd,t=>Math.tanh(t)),Axe={kernelName:yd,backendName:"cpu",kernelFunc:Rxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _xe(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=Da(i,r,s.shape),d=!1,h=n.bufferSync(r),f=n.bufferSync(i),p=n.bufferSync(s),m=sl(h,f,s.shape,u,l,a,o,c,p,d);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const Dxe={kernelName:Lx,backendName:"cpu",kernelFunc:_xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;Ne(r,"tile");const o=wV(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Fxe={kernelName:xd,backendName:"cpu",kernelFunc:Oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;Ne(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=vV(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const Lxe={kernelName:Xx,backendName:"cpu",kernelFunc:Pxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],y=Re(r.shape),x=y[0],w=y[1],b=y[2],S=Re(g),T=S[0],I=S[1],$=S[2],_=kn(r.dtype,se(g));_.fill(l);const D=s.data.get(r.dataId).values,z=s.data.get(i.dataId).values;for(let X=0;X<u;++X){const Y=i.shape[0]===1?z:z.subarray(X*8,X*8+8);for(let J=0;J<p;++J)for(let Q=0;Q<m;++Q)for(let ee=0;ee<f;++ee){let M;const q=Y[6]*Q+Y[7]*J+1;if(q===0)continue;const te=(Y[0]*Q+Y[1]*J+Y[2])/q,Z=(Y[3]*Q+Y[4]*J+Y[5])/q,le=O_(te,h,a),de=O_(Z,d,a);switch(o){case"nearest":M=Wxe(D,d,h,x,w,b,X,de,le,ee,l);break;case"bilinear":M=Gxe(D,d,h,x,w,b,X,de,le,ee,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const fe=X*T+J*I+Q*$+ee;_[fe]=M}return s.makeTensorInfo(g,r.dtype,_)}return{dataId:s.write(_,g,r.dtype),shape:r.shape,dtype:r.dtype}}const Bxe={kernelName:Yx,backendName:"cpu",kernelFunc:Mxe};function O_(t,e,n){switch(n){case"reflect":return zxe(t,e);case"wrap":return Vxe(t,e);case"nearest":return Uxe(t,e);case"constant":default:return jxe(t)}}function zxe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return la(0,n,e-1)}function Vxe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return la(0,n,e-1)}function jxe(t,e){return t}function Uxe(t,e){return la(0,t,e-1)}function yh(t,e,n,s,r,i,o,a,l,c,u){const d=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function Wxe(t,e,n,s,r,i,o,a,l,c,u){const d=Math.round(a),h=Math.round(l);return yh(t,e,n,s,r,i,o,d,h,c,u)}function Gxe(t,e,n,s,r,i,o,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*yh(t,e,n,s,r,i,o,d,h,c,u)+(l-h)*yh(t,e,n,s,r,i,o,d,p,c,u),g=(p-l)*yh(t,e,n,s,r,i,o,f,h,c,u)+(l-h)*yh(t,e,n,s,r,i,o,f,p,c,u);return(f-a)*m+(a-d)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Ne(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=SV(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const qxe={kernelName:Jx,backendName:"cpu",kernelFunc:Hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kxe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),d=r.shape.slice();d[i]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[i]=f;const p=Fl({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[f]=gt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const Xxe={kernelName:Hp,backendName:"cpu",kernelFunc:Kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;Ne(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],d=a-l;let h=i;for(let p=0;p<d;++p){const m=d0({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<o;++p){const m=bo(p,"int32"),g=n.makeTensorInfo([],"int32",m),y=L4({inputs:{a:g,b:h},backend:n}),x=xa({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),w=ub({inputs:{a:x,b:r},backend:n}),b=$m({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});c.push(b),u.push(g),u.push(y),u.push(x),u.push(w),u.push(b)}const f=BV({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const Jxe={kernelName:qp,backendName:"cpu",kernelFunc:Yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qxe=[Hpe,Ife,Kpe,Ype,Dfe,Qpe,eme,nme,rme,ome,lme,ume,hme,mme,yme,bme,Sme,Cme,Tme,Wpe,$me,Rme,_me,Ffe,Ome,Afe,Lfe,Pme,$fe,Mme,zme,Vme,Ume,Gme,qme,Xme,Jme,Zme,tge,sge,ige,age,cge,dge,hge,pge,gge,xge,wge,bge,vge,kge,Tge,Lpe,$ge,Mfe,Pge,Bfe,Lge,Vfe,Uge,Wge,Hge,Ufe,Gfe,Kge,Yge,Qge,eye,qfe,Xfe,Efe,nye,Bme,rye,oye,lye,Mpe,Jfe,Zfe,uye,tpe,hye,mye,yye,bye,Sye,Cye,Nye,spe,Iye,Eye,Aye,Dye,Fye,Lye,Bye,ipe,Vye,Wye,qye,ape,cpe,Yye,Zye,n0e,dpe,r0e,o0e,a0e,zV,d0e,zpe,ppe,f0e,m0e,y0e,w0e,Rfe,GS,v0e,Vpe,jpe,Upe,k0e,N0e,I0e,E0e,A0e,_0e,O0e,Spe,P0e,V0e,U0e,q0e,Cpe,X0e,J0e,Z0e,Npe,Gye,nxe,rxe,oxe,lxe,uxe,hxe,pxe,gxe,$pe,yxe,Rpe,_pe,wxe,vxe,kxe,Nxe,Ixe,Ppe,Cge,Exe,Axe,Dxe,Fxe,Lxe,Bxe,hpe,qxe,Xxe,Jxe,i0e];for(const t of Qxe)Zx(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ka={},yg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function VV(t,e){Ka[t]=e}function ri(t,e){if(!(t in Ka)||e!=null){const s=ewe(t,e);if(s!==null)Ka[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Ka[t];return n==null||n.isContextLost()?(delete Ka[t],ri(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ka[t])}function Zxe(t){if(!K().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function ewe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Zxe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Ka[t]},!1),K().getBool("SOFTWARE_WEBGL_ENABLED")&&(yg.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",yg)||n.getContext("experimental-webgl",yg):n.getContext("webgl2",yg)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Cf;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Cf||(Cf={}));var er;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(er||(er={}));var Dn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Dn||(Dn={}));function Em(t,e){return[e,t]}function twe(t,e){return t*e}function xg(t){const e=se(t),n=Math.ceil(e/4);return By(n)}function Od(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function nwe(t,e){const[n,s]=Od(t,e);return n*s*4}function WI(t,e){const n=t;let s,r,i,o,a,l,c,u,d,h;return K().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xe(t,e){const n=e();return K().getBool("DEBUG")&&swe(t),n}function swe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+UV(t,e))}const rwe=596e-10,iwe=65504;function jV(t){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||rwe<Math.abs(t)&&Math.abs(t)<iwe)}function UV(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function xh(t,e){return Io(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function WV(t,e){const n=Io(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(xe(t,()=>t.shaderSource(n,e)),xe(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function GV(t,e){const n=Io(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(xe(t,()=>t.shaderSource(n,e)),xe(t,()=>t.compileShader(n)),K().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw GI(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const owe=/ERROR: [0-9]+:([0-9]+):/g;function GI(t,e){const n=owe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((d,h)=>cl((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${cl(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function HV(t){return Io(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function qV(t,e){if(xe(t,()=>t.linkProgram(e)),!K().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Jg(t,e){if(xe(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function KV(t,e){const n=Io(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),xe(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function XV(t,e){const n=Io(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return xe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),xe(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function awe(){return K().getNumber("WEBGL_VERSION")===2?1:4}function YV(t){return Io(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function JV(t,e){const n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function QV(t){return Io(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function qS(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),xe(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),xe(t,()=>t.enableVertexAttribArray(a)),!0)}function ZV(t,e,n){rj(t,n),xe(t,()=>t.activeTexture(t.TEXTURE0+n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function lwe(t,e){rj(t,e),xe(t,()=>t.activeTexture(t.TEXTURE0+e)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function ej(t,e,n){return Io(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function tj(t,e,n){return t.getUniformLocation(e,n)}function nj(t,e,n,s){xe(t,()=>ZV(t,e,s)),xe(t,()=>t.uniform1i(n,s))}function cwe(t){xe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),xe(t,()=>t.viewport(0,0,t.canvas.width,t.canvas.height)),xe(t,()=>t.scissor(0,0,t.canvas.width,t.canvas.height))}function Qg(t,e,n){xe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),xe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function KS(t,e){xe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),xe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function wh(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+sj(t,e))}function sj(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Io(t,e,n){const s=xe(t,()=>e());if(s==null)throw new Error(n);return s}function rj(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Pl(t,e=2){return se(t.slice(0,t.length-e))}function Ll(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function bh(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Pl(t),...Ll(t)]),e}function ij(t,e=!1){let n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=K().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&K().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?H0(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=wo(t).newShape);let r=se(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=Pl(t);let l=2,c=2;t.length&&([l,c]=Ll(t)),r=a*(l/2)*(c/2),i=By(r).map(u=>u*2)}else i=By(r);return i}function wg(t){return t%2===0}function Nf(t,e){if(t=t.slice(-2),e=e.slice(-2),Ue(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||wg(n)&&wg(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&wg(t[0])&&wg(e[0])}let Zg,ey;function oj(t){if(Zg==null){const e=ri(t);Zg=e.getParameter(e.MAX_TEXTURE_SIZE)}return Zg}function uwe(){Zg=null}function dwe(){ey=null}function aj(t){if(ey==null){const e=ri(t);ey=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ey)}function lj(t){if(t===0)return 0;let e;const n=ri(t);return tr(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:tr(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function tr(t,e){return t.getExtension(e)!=null}function XS(t){try{if(ri(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function cj(t){if(t===0)return!1;const e=ri(t);if(t===1){if(!tr(e,"OES_texture_float"))return!1}else if(!tr(e,"EXT_color_buffer_float"))return!1;return YS(e)}function uj(t){if(t===0)return!1;const e=ri(t);if(t===1){if(!tr(e,"OES_texture_float")||!tr(e,"WEBGL_color_buffer_float"))return!1}else{if(tr(e,"EXT_color_buffer_float"))return YS(e);const s="EXT_color_buffer_half_float";if(tr(e,s)){const r=e.getExtension(s);return hwe(e,r)}return!1}return YS(e)}function YS(t){const e=WI(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function hwe(t,e){const n=WI(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function dj(t){return t!==2?!1:ri(t).fenceSync!=null}function Fd(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&E(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}const fwe=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:Fd,bindCanvasToFramebuffer:cwe,bindColorTextureToFramebuffer:Qg,bindTextureToProgramUniformSampler:nj,bindTextureUnit:ZV,bindVertexBufferToProgramAttribute:qS,callAndCheck:xe,canBeRepresented:jV,createFragmentShader:GV,createFramebuffer:QV,createProgram:HV,createStaticIndexBuffer:XV,createStaticVertexBuffer:KV,createTexture:YV,createVertexShader:WV,getBatchDim:Pl,getExtensionOrThrow:xh,getFramebufferErrorMessage:sj,getMaxTexturesInShader:aj,getNumChannels:awe,getProgramUniformLocation:tj,getProgramUniformLocationOrThrow:ej,getRowsCols:Ll,getShapeAs3D:bh,getTextureShapeFromLogicalShape:ij,getWebGLDisjointQueryTimerVersion:lj,getWebGLErrorMessage:UV,getWebGLMaxTextureSize:oj,hasExtension:tr,isCapableOfRenderingToFloatTexture:cj,isDownloadFloatTextureEnabled:uj,isReshapeFree:Nf,isWebGLFenceEnabled:dj,isWebGLVersionEnabled:XS,linkProgram:qV,logShaderSourceAndInfoLog:GI,resetMaxTextureSize:uwe,resetMaxTexturesInShader:dwe,unbindColorTextureFromFramebuffer:KS,unbindTextureUnit:lwe,validateFramebuffer:wh,validateProgram:Jg,validateTextureSize:JV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ie=K();Ie.registerFlag("HAS_WEBGL",()=>Ie.getNumber("WEBGL_VERSION")>0);Ie.registerFlag("WEBGL_VERSION",()=>XS(2)?2:XS(1)?1:0);Ie.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ie.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ie.get("WEBGL_VERSION")===2);Ie.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ie.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ie.registerFlag("WEBGL_PACK",()=>Ie.getBool("HAS_WEBGL"));Ie.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_CLIP",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_REDUCE",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_CONV_IM2COL",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ie.getBool("WEBGL_PACK"));Ie.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>oj(Ie.getNumber("WEBGL_VERSION")));Ie.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>aj(Ie.getNumber("WEBGL_VERSION")));Ie.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ie.getNumber("WEBGL_VERSION");return t===0?0:lj(t)});Ie.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ie.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!ZC());Ie.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>cj(Ie.getNumber("WEBGL_VERSION")));Ie.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ie.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ie.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ie.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>uj(Ie.getNumber("WEBGL_VERSION")));Ie.registerFlag("WEBGL_FENCE_API_ENABLED",()=>dj(Ie.getNumber("WEBGL_VERSION")));Ie.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ie.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ie.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ie.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>ZC()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ie.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ie.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ie.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ie.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ie.registerFlag("WEBGL_EXP_CONV",()=>!1);Ie.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ie.getBool("IS_TEST"));Ie.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ie.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ie.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ie.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(){let t,e,n,s,r,i,o,a,l,c;return K().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=K().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nc(t,e,n="index"){const s=Re(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function db(t,e,n="index"){const s=Re(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function pwe(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function mwe(t,e,n="index"){const s=t.map((i,o)=>o),r=pwe(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function HI(t){const e=Re(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function qI(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const hj=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:fj}=WB;function gwe(t,e,n){const s=[];if(t.forEach(f=>{const p=se(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=KI(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(f=>ywe(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=cs(),l=bwe(a);let c,u,d=kwe(a);return e.isPacked?(c=xwe(e.logicalShape,o,n.enableShapeUniforms),u=Swe(a)):(c=wwe(e.logicalShape,o,n.enableShapeUniforms),u=vwe(a)),n.packedInputs&&(d+=Iwe),[d,l,u,r,c,i,n.userCode].join(`
`)}function Pd(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return Bwe(t,e);case 1:return Vwe(t,e);case 2:return Uwe(t,e);case 3:return Gwe(t,e);case 4:return qwe(t,e);case 5:return Kwe(t);case 6:return Xwe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function pj(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return Mwe(t);case 1:return zwe(t,e);case 2:return jwe(t,e);case 3:return Wwe(t,e);default:return Hwe(t,e)}}function ywe(t,e,n=!1,s){let r="";n?r+=pj(t,s):r+=Pd(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=Ywe(t,e):r+=Jwe(t,e)),r}function xwe(t,e,n){switch(t.length){case 0:return mj();case 1:return $we(t,e,n);case 2:return Pwe(t,e,n);case 3:return Rwe(t,e,n);default:return _we(t,e,n)}}function wwe(t,e,n){switch(t.length){case 0:return mj();case 1:return Ewe(t,e,n);case 2:return Lwe(t,e,n);case 3:return Awe(t,e,n);case 4:return Dwe(t,e,n);case 5:return Owe(t,e);case 6:return Fwe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function bwe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function vwe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Swe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function kwe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Cwe}
    ${Nwe}
    ${Twe}
  `}const Cwe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Nwe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Twe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Iwe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function mj(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function $we(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Ewe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Rwe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Awe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${db(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=nc(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function _we(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Dwe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${db(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=nc(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Owe(t,e){const n=nc(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Fwe(t,e){const n=nc(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Pwe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Ue(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function Lwe(t,e,n){return Ue(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function sc(t){return`offset${t}`}function Mwe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=cs();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function Bwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=sc(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function zwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=cs();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function Vwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Ld(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=sc(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function jwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=cs();if(i!=null&&Ue(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Uwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&Ue(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=wo(n),l=o;if(l.length<n.length){const h=Md(t,l),f=["row","col"];return`
      ${Pd(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${Bd(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Ld(t)}
      }
    `;const c=i[0],u=i[1],d=sc(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function Wwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=Md(t,h),m=["b","row","col"];return`
        ${pj(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Bd(m,f)});
        }
      `}const a=cs();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function Gwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=wo(n),c=a;if(c.length<n.length){const m=Md(t,c),g=["row","col","depth"];return`
        ${Pd(m,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Bd(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Ld(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=sc(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function Hwe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=cs();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<o-1;m++)f=`int b${m}, `+f,h*=i[o-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function qwe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=wo(n);if(l.length<n.length){const x=Md(t,l),w=["row","col","depth","depth2"];return`
      ${Pd(x,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Bd(w,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Ld(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,g=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const y=sc(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${y});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${y});
      return sampleTexture(${s}, uv);
    }
  `}function Kwe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=wo(e);if(l.length<e.length){const m=Md(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${Pd(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Bd(g,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${Ld(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=sc(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Xwe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=wo(e);if(r.length<e.length){const g=Md(t,r),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Pd(g)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Bd(y,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Ld(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=sc(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ld(t){const e=t.name,n=se(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Ywe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=fj(t.shapeInfo.logicalShape,e.logicalShape),l=ct(o),c=o-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(x=>`coords.${d[x+c]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((x,w)=>`coords.${d[w+c]}`).join(", ");let f="return outputValue;";const m=se(t.shapeInfo.logicalShape)===1,y=se(e.logicalShape)===1;if(i===1&&!m&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const x=i-2,w=i-1;a.indexOf(x)>-1&&a.indexOf(w)>-1?f="return vec4(outputValue.x);":a.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(w)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function Jwe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Ue(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=ct(l),u=fj(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${p});
    }
  `}function ct(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function KI(t,e,n){const{newShape:s,keptDims:r}=wo(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!Ue(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function Md(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Bd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qwe(t,e,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=gwe(r,o,e),l=GV(t.gl,a),c=t.createProgram(l);return K().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},gj(t,e,c)))}function gj(t,e,n){const s=[],r=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),K().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),s.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function F_(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!Ue(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!Ue(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Zwe(t,e,n,s,r){e.program.enableShapeUniforms||(F_(e.inShapeInfos,n),F_([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),K().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:p}=KI(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(se(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Re(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=r[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function ebe(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=KI(t.packedInputs,o.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const S=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${S[0]>1}_${S[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const S=Re(u);p=`${S[0]===l[1]}_${S[S.length-1]===l[1]}`}const m=o.shape.length,g=u.length===2&&Ue(o.shape,l),y=se(o.shape)===1,x=Il(o.shape,n.shape),w=!t.packedInputs&&m===n.shape.length&&Ue(l,n.texData.texShape),b=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${w}_${c?d:""}_${u.length}_${y}_${x}_${g}_${h}_${f}_${p}_${b}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${K().getNumber("WEBGL_VERSION")}`,i}function Kn(t){return K().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tbe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Cf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=cs();this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?db(["r","c","d"],e):nc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nbe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Cf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=cs();this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?db(["r","c","d"],e):nc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sbe{constructor(e){this.variableNames=["A"],this.outTexUsage=er.DOWNLOAD;const n=cs();this.outputShape=e,this.userCode=`
      ${hj}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rbe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=er.DOWNLOAD;const n=cs();this.outputShape=e,this.userCode=`
      ${hj}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ibe={R:0,G:1,B:2,A:3};class P_{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=cs();this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${ibe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?qI():HI(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class obe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=cs();this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?qI():HI(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yj(t){const e=cs(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return WV(t,n)}function xj(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return KV(t,e)}function wj(t){const e=new Uint16Array([0,1,2,2,1,3]);return XV(t,e)}function Rm(t,e,n,s,r,i){JV(e,n);const o=YV(t),a=t.TEXTURE_2D;return xe(t,()=>t.bindTexture(a,o)),xe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),xe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),xe(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),xe(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),K().getNumber("WEBGL_VERSION")===1?xe(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):xe(t,()=>t.texStorage2D(a,1,s,e,n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function XI(t){return t.internalFormatFloat}function bj(t,e,n,s){const[r,i]=Em(e,n);return Rm(t,r,i,XI(s),s.textureFormatFloat,t.FLOAT)}function YI(t){return t.internalFormatHalfFloat}function vj(t,e,n,s){const[r,i]=Em(e,n);return Rm(t,r,i,YI(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function JI(t){return t.downloadTextureFormat}function Sj(t,e,n,s){const[r,i]=Em(e,n);return Rm(t,r,i,JI(s),t.RGBA,t.UNSIGNED_BYTE)}function QI(t){return t.internalFormatPackedFloat}function kj(t,e,n,s){const[r,i]=Od(e,n);return Rm(t,r,i,QI(s),t.RGBA,t.FLOAT)}function ZI(t){return t.internalFormatPackedHalfFloat}function Cj(t,e,n,s){const[r,i]=Od(e,n);return Rm(t,r,i,ZI(s),t.RGBA,s.textureTypeHalfFloat)}function Nj(t,e,n){return xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),qS(t,e,"clipSpacePos",n,3,20,0)&&qS(t,e,"uv",n,2,20,12)}function Tj(t,e,n,s,r,i){xe(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),K().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Ij(t,e,n){xe(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?K().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):K().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function $j(t,e,n,s){const r=t.createBuffer();xe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return xe(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),xe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),xe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Ej(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Rj(t,e,n,s){const[r,i]=Em(e,n),o=4,a=new Uint8Array(twe(e*n,o));return xe(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Aj(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(nwe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function _j(t,e,n){const s=new Float32Array(e*n*4);return xe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}const abe=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:Nj,createBufferFromOutputTexture:$j,createFloat16MatrixTexture:vj,createFloat16PackedMatrixTexture:Cj,createFloat32MatrixTexture:bj,createIndexBuffer:wj,createPackedMatrixTexture:kj,createUnsignedBytesMatrixTexture:Sj,createVertexBuffer:xj,createVertexShader:yj,downloadByteEncodedFloatMatrixFromOutputTexture:Rj,downloadFloat32MatrixFromBuffer:Ej,downloadMatrixFromPackedOutputTexture:_j,downloadPackedMatrixFromBuffer:Aj,getInternalFormatForFloat16MatrixTexture:YI,getInternalFormatForFloat16PackedMatrixTexture:ZI,getInternalFormatForFloat32MatrixTexture:XI,getInternalFormatForPackedMatrixTexture:QI,getInternalFormatForUnsignedBytesMatrixTexture:JI,uploadDenseMatrixToTexture:Tj,uploadPixelDataToTexture:Ij},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ty{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=K().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,VV(n,e)):this.gl=ri(n),e=this.gl,K().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>xe(i,()=>i.createVertexArray()),this.bindVertexArray=o=>xe(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>xe(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>xe(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>xe(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>xe(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>xe(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>xe(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),K().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=xh(this.gl,i),tr(this.gl,o))this.textureHalfFloatExtension=xh(this.gl,o);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),tr(this.gl,r))this.colorBufferHalfFloatExtension=xh(this.gl,r);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",tr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(tr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=xj(this.gl),this.indexBuffer=wj(this.gl),this.framebuffer=QV(this.gl),this.textureConfig=WI(this.gl,this.textureHalfFloatExtension)}get debug(){return K().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;xe(e,()=>e.finish()),xe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),xe(e,()=>e.deleteFramebuffer(this.framebuffer)),xe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),xe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),xe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),bj(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),vj(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Sj(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Ij(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Tj(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Cj(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),kj(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(KS(this.gl,this.framebuffer),this.outputTexture=null),xe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Rj(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return Aj(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Ej(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=$j(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(K().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>_j(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=yj(n));const s=HV(n);xe(n,()=>n.attachShader(s,this.vertexShader)),xe(n,()=>n.attachShader(s,e)),qV(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Jg(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;xe(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Nj(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(xe(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Jg(this.gl,this.program),xe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?ej(this.gl,e,n):tj(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),xe(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),nj(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=Od(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Jg(this.gl,this.program),wh(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}xe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),xe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=xh(this.gl,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await sS(()=>this.disposed||this.isQueryAvailable(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=lbe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in K().platform&&(s=K().platform.setTimeoutCustom.bind(K().platform)),sS(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Qg(this.gl,e,this.framebuffer),this.debug&&wh(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Qg(this.gl,this.outputTexture,this.framebuffer),this.debug&&wh(this.gl)):KS(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;Qg(r,e,this.framebuffer),this.debug&&wh(r),this.outputTexture=e,xe(r,()=>r.viewport(0,0,n,s)),xe(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),xe(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function lbe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:cbe,bincountImpl:Dj,bincountReduceImpl:ube,bitwiseAndImpl:dbe,castImpl:hbe,ceilImpl:fbe,concatImpl:pbe,equalImpl:mbe,expImpl:gbe,expm1Impl:ybe,floorImpl:xbe,gatherNdImpl:wbe,gatherV2Impl:bbe,greaterImpl:vbe,greaterEqualImpl:Sbe,lessImpl:kbe,lessEqualImpl:Cbe,linSpaceImpl:Nbe,logImpl:Tbe,maxImpl:Ibe,maximumImpl:$be,minimumImpl:Ebe,multiplyImpl:Rbe,negImpl:Abe,notEqualImpl:_be,prodImpl:Dbe,raggedGatherImpl:Obe,raggedRangeImpl:Fbe,raggedTensorToTensorImpl:Pbe,rangeImpl:Lbe,rsqrtImpl:Mbe,scatterImpl:Bbe,sigmoidImpl:zbe,simpleAbsImpl:Oj,sliceImpl:Vbe,sparseFillEmptyRowsImpl:jbe,sparseReshapeImpl:Ube,sparseSegmentReductionImpl:Fj,sqrtImpl:Wbe,staticRegexReplaceImpl:Gbe,stridedSliceImpl:Hbe,stringNGramsImpl:qbe,stringSplitImpl:Kbe,stringToHashBucketFastImpl:Xbe,subImpl:Ybe,tileImpl:Jbe,topKImpl:Qbe,transposeImpl:e$,uniqueImpl:Zbe}=kV;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pj(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ns(t,e){return e===1?[t]:Pj(t,e)}function e1e(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t1e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Kn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ns("rc",this.rank),s=ct(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lj{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${n1e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?qI():HI(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function n1e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?mwe(["r","c","d"],"inputShape"):nc(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s1e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=M_(n,s),i=B_(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=L_(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===Dn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Dn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Dn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Dn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Dn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=M_(s,r),o=B_(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=L_(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=K().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function r1e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function L_(t,e,n,s,r){const i=i1e(e,s);let o;if(r){const[l,c]=Od(t[0],t[1]);o=l*c}else{const[l,c]=Em(t[0],t[1]);o=l*c}const a=r1e(n,i);return o*a}function i1e(t,e){switch(t){case Dn.PACKED_2X2_FLOAT32:return QI(e);case Dn.PACKED_2X2_FLOAT16:return ZI(e);case Dn.UNPACKED_FLOAT32:return XI(e);case Dn.UNPACKED_FLOAT16:return YI(e);case Dn.PACKED_4X1_UNSIGNED_BYTE:return JI(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function o1e(t){return K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Dn.PACKED_2X2_FLOAT32:Dn.UNPACKED_FLOAT32:t?Dn.PACKED_2X2_FLOAT16:Dn.UNPACKED_FLOAT16}function M_(t,e){if(t===er.UPLOAD)return Dn.PACKED_2X2_FLOAT32;if(t===er.RENDER||t==null)return o1e(e);if(t===er.DOWNLOAD||t===er.PIXELS)return Dn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function B_(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Si{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const _r="if (isnan(x)) return x;",a1e="return x;",z_="return abs(x);",l1e="return (x >= 0.0) ? x : (exp(x) - 1.0);",c1e=_r+`
  return (x < 0.0) ? 0.0 : x;
`,u1e=_r+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Do="return x;",d1e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1e="return x;",f1e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,p1e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,m1e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,g1e="return 1.0 / (1.0 + exp(-1.0 * x));";class Uo{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y1e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length);const n=e.length,s=ns("rc",n),r=ct(n),i=e1e(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x1e=$w,w1e=1e-7,b1e=1e-4,bg={};function v1e(t){return t in bg||(bg[t]={}),bg[t]}const S1e=K().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),k1e=600;function C1e(){return K().global.screen==null?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*k1e/1024/1024}class Am extends G0{nextDataId(){return Am.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof ty)n=e;else{const s=ri(K().getNumber("WEBGL_VERSION"),e);n=new ty(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=ri(K().getNumber("WEBGL_VERSION"));n=new ty(s),this.binaryCache=v1e(K().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new s1e(this.gpgpu),this.numMBBeforeWarning=C1e(),this.texData=new WC(this,Vr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=bh(n),u=new P_(c,!1,o),d=this.runWebGLProgram(u,[a],s,[[r,i]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((K().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||K().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:er.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(K().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:er.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let h;l?h=new Uo(a,Do):h=new Si(a,Do);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=Rn());let d;if(r==="complex64"){const h=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=fo(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Rn()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new Uo(r,Do):p=new Si(r,Do);const m=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:o}],o),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(s!=null)return this.convertAndCacheOnCPU(e);if(K().getBool("DEBUG")&&!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&K().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&K().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...xg(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];d=fo(m,g)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=se(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;xe(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Vr().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new Uo(i,Do):f=new Si(i,Do);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=Vr().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>lo(r));return Le(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Le(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!jV(s))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=se(n);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...xg(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),p}const o=K().getBool("WEBGL_PACK")&&r===!0,a=o?bh(n):n,l=o?new rbe(a):new sbe(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=Oi(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Oi(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=r3(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Rn(),endMs:null}}endTimer(e){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Rn(),e)}async getQueryTime(e){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=S1e){return K().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&se(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Xs("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return x1e(e.shape,n)}packedUnaryOp(e,n,s){const r=new Uo(e.shape,n),i=this.compileAndRun(r,[e],s);return Vr().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=Oj(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,z_,e.dtype);const n=new Si(e.shape,z_),s=this.compileAndRun(n,[e]);return Vr().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&vi(s[0])){const i=s.map(o=>$i(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return Vr().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new y1e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new t1e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Pl(e.shape),...Ll(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[Pl(n),...Ll(n)],o=new Lj(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const h=se(i),f=n[0]*n[1]*4;E(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=bh(i);let l;r?l=new nbe(a):l=new tbe(a);const c=!0,u=[n??xg(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Cf.DENSE){const y=o??xg(e.outputShape);l.texShape=y.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),se(a.shape)===0)return l.values=kn(a.dtype,0),a;const c=[],u=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(y.dataId);if(x.texture==null){if(!e.packedInputs&&se(y.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!x.isPacked!=!!e.packedInputs)y=x.isPacked?this.unpackTensor(y):this.packTensor(y),c.push(y),x=this.texData.get(y.dataId);else if(x.isPacked&&!Nf(x.shape,y.shape)){const w=y,b=y.shape;y.shape=x.shape,y=this.packedReshape(y,b),c.push(y),x=this.texData.get(y.dataId),w.shape=b}return{shape:y.shape,texData:x,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=ebe(e,u,d),f=this.getAndSaveBinary(h,()=>Qwe(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),K().get("ENGINE_COMPILE_ONLY")||Zwe(this.gpgpu,f,u,d,r),c.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=K().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const y=Rn();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!K().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const y=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),y}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=G(()=>{if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=K().getBool("DEBUG");K().set("DEBUG",!1);const n=this.abs(Ee(1e-8)).dataSync()[0];if(K().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?w1e:b1e}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=Rn());let d=n.texShape;if(d==null&&(d=ij(s,l),n.texShape=d),i!=null){const h=bh(s);let f,p=d[1],m=d[0];const g=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!g)&&([p,m]=Od(d[0],d[1])),l?f=new obe(h,g):f=new P_(h,g);const y=g?[m,p]:d,x=this.makeTensorInfo(y,r),w=this.texData.get(x.dataId);g?w.usage=er.PIXELS:w.usage=er.UPLOAD,w.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),p,m,i);const b=[[m,p]],T=this.runWebGLProgram(f,[x],r,b,!0),I=this.texData.get(T.dataId);n.texShape=I.texShape,n.isPacked=I.isPacked,n.usage=I.usage,K().get("ENGINE_COMPILE_ONLY")?this.disposeData(T.dataId):(n.texture=I.texture,n.values=null,this.texData.delete(T.dataId)),this.disposeIntermediateTensorInfo(x),c&&(this.uploadWaitMs+=Rn()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=N1e(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*cf(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await O2(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(GI(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=gj(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,l=Vr().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return Vr().makeTensorFromDataId(c,n,s,l)}}Am.nextDataId=0;function N1e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/** @license See the LICENSE file. */const Mj="4.22.0";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bj(){K().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */eN()&&nN("webgl",()=>new Am,2);const T1e={forceHalfFloat:Bj};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Ml{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Fe(n,s),this.enableShapeUniforms=Kn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rc=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class zd{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Fe(n,s);const i=this.outputShape.length;this.enableShapeUniforms=Kn(i);let o="";if(r)if(i===0||se(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${ct(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ns("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function js(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const I1e={kernelName:Gu,backendName:"webgl",kernelFunc:js};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=js({inputs:{x:s},backend:n}),l=js({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const $1e={kernelName:ex,backendName:"webgl",kernelFunc:Fa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zj="return (a < 0.) ? b * a : a;",Vj=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function E1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",bo(i,"float32")),a=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zd(Vj,r.shape,o.shape):new Ml(zj,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const R1e={kernelName:pp,backendName:"webgl",kernelFunc:E1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jj="return (a < 0.) ? b * a : a;",Uj=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function A1e(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zd(Uj,s.shape,r.shape):new Ml(jj,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const _1e={kernelName:Dp,backendName:"webgl",kernelFunc:A1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vd="if (isnan(x)) return x;";function Je({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,l);return a.makeTensorInfo(o.shape,l,h)}const c=K().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Uo(o.shape,e):u=new Si(o.shape,t),a.runWebGLProgram(u,[o],l)}}function Vn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,y]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(w=>{const[b,S]=w,T={dataId:b.dataId,dtype:b.dtype,shape:l.shape},I={dataId:S.dataId,dtype:S.dtype,shape:c.shape},$=new Ml(t,l.shape,c.shape);return u.runWebGLProgram($,[T,I],gs(b.dtype,S.dtype))}),x=Fa({inputs:{real:g,imag:y},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(y),x}const d=i||gs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?po(p):p,y=l.dtype==="string"?po(m):m,[x,w]=r(l.shape,c.shape,g,y,d),b=u.makeTensorInfo(w,d),S=u.texData.get(b.dataId);return S.values=x,b}const h=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new zd(e,l.shape,c.shape,n):f=new Ml(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function Tf(t,e=!1){if(t==="linear")return e?h1e:a1e;if(t==="relu")return e?p1e:c1e;if(t==="elu")return e?f1e:l1e;if(t==="relu6")return e?m1e:u1e;if(t==="prelu")return e?Uj:jj;if(t==="leakyrelu")return e?Vj:zj;if(t==="sigmoid")return e?g1e:d1e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wj{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Kn(this.outputShape.length);const u=r?e[1]:e[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",y="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");const x=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let w="rc.x",b="rc.x";e[0]<n[0]?w=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(b=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${w};
        int batchB = ${b};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V_={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class j_{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Fe(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_="return a * b;";function n$(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=gs(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new j_(V_.REAL,s.shape,r.shape),u=new j_(V_.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=Fa({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=Rbe(s.shape,r.shape,a.values,l.values,i),d=n.makeTensorInfo(u,i),h=n.texData.get(d.dataId);return h.values=c,d}let o;return K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new zd(U_,s.shape,r.shape):o=new Ml(U_,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const D1e={kernelName:ed,backendName:"webgl",kernelFunc:n$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1e(t,e,n){const s=[Pl(t.shape),...Ll(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[Pl(e),...Ll(e)],o=new Lj(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=se(r.shape),l=HC(i,a),c=se(l);E(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!Nf(r.shape,l)&&!(u.texture!==null&&Nf(u.shape,l))?O1e(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const F1e={kernelName:Fp,backendName:"webgl",kernelFunc:ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W_{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${vl(d)?d.toPrecision(2):d}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P1e{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=zw(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function ic(t,e,n,s){const r=L1e(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,d;n==="mean"?u=o===0?new W_({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new W_({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new P1e({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=i,i=s.runWebGLProgram(u,[i],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M1e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=ct(this.rank),i=B1e(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function B1e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z1e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=ct(this.rank),i=Pj("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hb(t,e,n){const s=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z1e(t.shape,e):new M1e(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(t,e,n,s){const r=e,i=t.shape.length,o=ze(r,t.shape);let a=o;const l=Ft(a,i),c=l!=null;let u=t;c&&(u=hb(t,l,s),a=Yt(a.length,i)),Bn("sum",a,i);const[d,h]=In(u.shape,a);let f=d;n&&(f=Xt(d,o));const p=se(h),g=se(t.shape)/p,y=ye({inputs:{x:u},attrs:{shape:[g,p]},backend:s}),x=ew(t.dtype),w=ic(y,x,"sum",s),b=ye({inputs:{x:w},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(w),c&&s.disposeIntermediateTensorInfo(u),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fb(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return V1e(r,i,o,n)}const j1e={kernelName:Vp,backendName:"webgl",kernelFunc:fb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function os(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const d=o.texData.get(r.dataId).values,h=e$(d,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=h}else c=hb(r,i,o);return c}const U1e={kernelName:ul,backendName:"webgl",kernelFunc:os};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gj=1e3;function f0({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),g=e.shape.slice(0,-2),y=se(m),x=se(g),b=Fe(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);E(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const S=n?[y,d,f]:[y,f,d],T=s?[x,p,h]:[x,h,p],I=ye({inputs:{x:t},backend:r,attrs:{shape:S}}),$=ye({inputs:{x:e},backend:r,attrs:{shape:T}}),_=[I,$],D=Math.max(y,x),z=n?I.shape[1]:I.shape[2],H=i!=null,X=o!=null,Y=l==="leakyrelu",J=l!=null?Tf(l,!0):null,Q=H||X||Y||J!=null;let ee;if((f===1||p===1)&&z>Gj&&Q===!1){let q=I,te=$;n&&(q=os({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),_.push(q)),s&&(te=os({inputs:{x:$},backend:r,attrs:{perm:[0,2,1]}}),_.push(te));const Z=p!==1,le=p===1;let de=q;Z&&(de=ye({inputs:{x:q},backend:r,attrs:{shape:[D,z,1]}}),_.push(de));const fe=p===1?2:1;let ne=te;le&&(ne=ye({inputs:{x:te},backend:r,attrs:{shape:[D,1,z]}}),_.push(ne));const U=n$({inputs:{a:de,b:ne},backend:r});ee=fb({inputs:{x:U},backend:r,attrs:{axis:fe,keepDims:!0}}),_.push(U)}else{const q=gs(t.dtype,e.dtype),te=new Wj(S,T,[D,f,p],n,s,H,J,X,Y),Z=[I,$];if(i!=null&&Z.push(i),X&&Z.push(o),Y){const le=r.makeTensorInfo([],"float32",bo(a,"float32"));Z.push(le),_.push(le)}ee=r.runWebGLProgram(te,Z,q)}const M=ye({inputs:{x:ee},backend:r,attrs:{shape:b}});_.push(ee);for(const q of _)r.disposeIntermediateTensorInfo(q);return M}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return f0({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const G1e={kernelName:uf,backendName:"webgl",kernelFunc:W1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_="return abs(x);";function H1e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=Oj(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Uo(s.shape,G_):r=new Si(s.shape,G_),n.runWebGLProgram(r,[s],s.dtype)}const q1e={kernelName:Hf,backendName:"webgl",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K1e=_r+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,X1e=Je({opSnippet:K1e}),Y1e={kernelName:Nu,backendName:"webgl",kernelFunc:X1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J1e=_r+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Q1e=Je({opSnippet:J1e}),Z1e={kernelName:Tu,backendName:"webgl",kernelFunc:Q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H_="return a + b;",eve=Vn({opSnippet:H_,packedOpSnippet:H_,supportsComplex:!0,cpuKernelImpl:cbe}),tve={kernelName:Hl,backendName:"webgl",kernelFunc:eve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nve{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sve{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return js({inputs:{x:s[0]},backend:n});if(s.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=ny({inputs:s.slice(0,l),backend:n}),u=ny({inputs:s.slice(l),backend:n});return ny({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>gs(l,c)),i=s.map(l=>l.shape),a=K().getBool("WEBGL_PACK")?new sve(s[0].shape,i):new nve(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const rve={kernelName:qf,backendName:"webgl",kernelFunc:ny};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=ze(i,r.shape);let c=l;const u=Ft(c,a);let d=r;u!=null&&(d=os({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Yt(c.length,a)),Bn("all",c,a);const[h,f]=In(d.shape,c),p=se(f),m=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=ic(m,m.dtype,"all",n);let y;if(o){const x=Xt(h,l);y=ye({inputs:{x:g},backend:n,attrs:{shape:x}})}else y=ye({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}const ove={kernelName:K0,backendName:"webgl",kernelFunc:ive};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ave(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=ze(i,r.shape);let c=l;const u=Ft(c,a);let d=r;u!=null&&(d=os({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Yt(c.length,a)),Bn("any",c,a);const[h,f]=In(d.shape,c),p=se(f),m=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=ic(m,m.dtype,"any",n);let y;if(o){const x=Xt(h,l);y=ye({inputs:{x:g},backend:n,attrs:{shape:x}})}else y=ye({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}const lve={kernelName:X0,backendName:"webgl",kernelFunc:ave};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cve{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uve{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,E(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=ct(l),u=ns("coords",l);let d,h;if(o===1){h=l+1;const $=ct(h);d=`
        ${$} sourceLocR = ${$}(${u.join()}, 0);
        ++${u[l-1]};
        ${$} sourceLocG = ${$}(${u.join()}, 0);
        ++${u[l-2]};
        ${$} sourceLocA = ${$}(${u.join()}, 0);
        --${u[l-1]};
        ${$} sourceLocB = ${$}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map($=>"int "+$),g=ns("sourceLocR",h-1).concat("inIdx.r"),y=ns("sourceLocG",h-1).concat("inIdx.g"),x=ns("sourceLocB",h-1).concat("inIdx.b"),w=ns("sourceLocA",h-1).concat("inIdx.a"),b=s==="max"?"greaterThan":"lessThan",S=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${w.join()})));`,T=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,I=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${I}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${T};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${S}
          vec4 candidate = ${T};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hj(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=zw(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new cve(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=Hj(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function qj(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=zw(i),a=new uve(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=qj(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function Kj(t,e,n,s){const r=[n];if(Bn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!K().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=In(l.shape,r),d=se(u),h=ye({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(h);const f=Hj(t,h,s);i.push(f);const p=ye({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return qj(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=ze(i,r.shape);const a=Ft(o,r.shape.length);let l=r;const c=[];a!=null&&(l=os({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),Bn("argMax",[o[0]],l.shape.length);const u=Kj(n,l,o[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const hve={kernelName:Kf,backendName:"webgl",kernelFunc:dve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=ze(i,r.shape);const a=Ft(o,r.shape.length);let l=r;const c=[];a!=null&&(l=os({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Yt(o.length,l.shape.length)),Bn("argMin",[o[0]],l.shape.length);const u=Kj(n,l,o[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const pve={kernelName:Xf,backendName:"webgl",kernelFunc:fve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mve=_r+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,gve=Je({opSnippet:mve}),yve={kernelName:Iu,backendName:"webgl",kernelFunc:gve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xve=_r+"return log(x + sqrt(x * x + 1.0));",wve=Je({opSnippet:xve}),bve={kernelName:$u,backendName:"webgl",kernelFunc:wve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vve=_r+`
  return atan(x);
`,Sve=Je({opSnippet:vve}),kve={kernelName:Eu,backendName:"webgl",kernelFunc:Sve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cve=t$+`
  return atan(a, b);
`,Nve=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+rc+`
  return result;
`,Tve=Vn({opSnippet:Cve,packedOpSnippet:Nve}),Ive={kernelName:Au,backendName:"webgl",kernelFunc:Tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ve=_r+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Eve=Je({opSnippet:$ve}),Rve={kernelName:Ru,backendName:"webgl",kernelFunc:Eve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class If{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(m||(x="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${$} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?g:y:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / max(count, 1.0)");const S=Math.floor(o/4)*4,T=o%4,I=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${S}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${I}
          }

          int xC = xCCorner + ${S};
          if (${T===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${T===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${T===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${I}
          }
        }
        setOutput(${b});
      }
    `}}class s${constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,y=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let b="0.0";if(w||(b="-1.0 / 1e-20"),s){const D=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${g}, ${y}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${D} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let T=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(T="avgValue / max(count, 1.0)");const I=Math.floor(o/4)*4,$=o%4,_=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${g}, ${y}, ${x});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${I}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${_}
            }

            int xC = xCCorner + ${I};
            if (${$===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${$===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${$===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${_}
            }
          }
        }
        setOutput(${T});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Fd(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;E(Mn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Rr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Ue(u.inShape,u.outShape))return js({inputs:{x:r},backend:n});const d=new If(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const _ve={kernelName:Yf,backendName:"webgl",kernelFunc:Ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=vo(r.shape,i,o,u,a,l,c),h=new s$(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const Ove={kernelName:Jf,backendName:"webgl",kernelFunc:Dve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fve{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Pve{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,g=f-1-e.padInfo.left,y=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=vo(o.shape,a,l,d,c,u),f=new Pve(h);return n.runWebGLProgram(f,[r],o.dtype)}const Mve={kernelName:J0,backendName:"webgl",kernelFunc:Lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Fd([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Rr(o.shape,a,l,1,c),d=new Fve(u);return n.runWebGLProgram(d,[r],o.dtype)}const zve={kernelName:Y0,backendName:"webgl",kernelFunc:Bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return f0({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const jve={kernelName:Qf,backendName:"webgl",kernelFunc:Vve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uve{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Fe(e,n),Fe(e,s);let a="0.0";r!=null&&(Fe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Fe(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wve{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Fe(e,n),Fe(e,s);let a="vec4(0.0)";r!=null&&(Fe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Fe(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gve=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;E(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),E(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),E(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let d=null;a!=null&&(d=a.shape,c.push(a));const h=K().getBool("WEBGL_PACK_NORMALIZATION")?new Wve(s.shape,r.shape,i.shape,u,d,l):new Uve(s.shape,r.shape,i.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},Hve={kernelName:dp,backendName:"webgl",kernelFunc:Gve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qve{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=ct(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Kve(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${JS[a]} = start[${a}] + coords.${JS[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const JS=["x","y","z","w","u","v"];function Kve(t){if(t===1)return"sourceLoc";if(t<=6)return JS.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xve{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=ct(this.rank),s=ns("coords",this.rank),r=ns("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yve(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=_2(e,Re(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function jd(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=Bw(r,i,o);if(E2(r,a,l),se(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=Vbe(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=A2(r.shape,a,l);if(c||!u){const d=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Xve(l):new qve(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),Yve(r,a,l,n)}const Jve={kernelName:zp,backendName:"webgl",kernelFunc:jd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qve=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;E(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,w)=>x*w),l=mm(r.shape,i,a),c=gm(l.length,i.length),u=ym(r.shape,i,a),d=M2(o,i.length),h=B2(u,o,i.length),f=[],p=ye({inputs:{x:r},backend:n,attrs:{shape:l}}),m=os({inputs:{x:p},backend:n,attrs:{perm:c}}),g=ye({inputs:{x:m},backend:n,attrs:{shape:u}}),y=jd({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(g),f.forEach(x=>n.disposeIntermediateTensorInfo(x)),y},Zve={kernelName:Zf,backendName:"webgl",kernelFunc:Qve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=Dj(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const tSe={kernelName:Q0,backendName:"webgl",kernelFunc:eSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nSe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,sSe=`
  return float(int(a.r) & int(b.r));
`;function rSe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=K().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=K().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,d]=dbe(s.shape,r.shape,l,c,s.dtype),h=n.makeTensorInfo(d,s.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let a;return i?a=new zd(nSe,s.shape,r.shape,!1):a=new Ml(sSe,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const iSe={kernelName:ep,backendName:"webgl",kernelFunc:rSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oSe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=Fe(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const aSe={kernelName:Z0,backendName:"webgl",kernelFunc:oSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lSe="return float(a != b);",Xj=Vn({opSnippet:lSe,cpuKernelImpl:_be,dtype:"bool"}),cSe={kernelName:$p,backendName:"webgl",kernelFunc:Xj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _m(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return js({inputs:{x:r.complexTensorInfos.real},backend:n})}const uSe={kernelName:Dx,backendName:"webgl",kernelFunc:_m};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dSe="return float(int(x));";function hSe(t,e){const n=new Si(t.shape,dSe),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QS(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return js({inputs:{x:r},backend:n});const o=Ht(r.shape),a=QS({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=Fa({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=_m({inputs:{input:r},backend:n}),a=QS({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!qC(r.dtype,i)){const o=js({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=hbe(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return hSe(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",kn("bool",1)),l=Xj({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const fSe={kernelName:_u,backendName:"webgl",kernelFunc:QS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q_="return ceil(x);",pSe=Je({opSnippet:q_,packedOpSnippet:q_,cpuKernelImpl:fbe}),mSe={kernelName:Du,backendName:"webgl",kernelFunc:pSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gSe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ySe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;K().getBool("WEBGL_PACK_CLIP")?a=new ySe(r.shape):a=new gSe(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const wSe={kernelName:Ou,backendName:"webgl",kernelFunc:xSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bSe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function vSe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new bSe(s.shape),o=[K_(s,r.complexTensorInfos.real),K_(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const SSe={kernelName:tp,backendName:"webgl",kernelFunc:vSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kSe{constructor(e){this.outputShape=[],this.outputShape=Ri(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CSe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ri(e,n);const s=this.outputShape,r=s.length,i=ct(r),o=ns("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${vg(a,c,g)}),
            vec2(${vg(u,c,g)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${vg(a,c,p)}),
          vec2(${vg(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function vg(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pb(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return js({inputs:{x:r.complexTensorInfos.imag},backend:n})}const NSe={kernelName:wx,backendName:"webgl",kernelFunc:pb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vh(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(x=>_m({inputs:{input:x},backend:n})),p=t.map(x=>pb({inputs:{input:x},backend:n})),m=vh(f,e,n),g=vh(p,e,n),y=Fa({inputs:{real:m,imag:g},backend:n});return f.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(b=>{const T=[-1,se(b.shape.slice(e))];return ye({inputs:{x:b},backend:n,attrs:{shape:T}})}),p=f.map(b=>({vals:n.readSync(b.dataId),shape:b.shape})),m=Ri(f.map(b=>b.shape),1),g=f[0].shape[0]===1,y=pbe(p,m,s,g),x=Ri(t.map(b=>b.shape),e),w=n.makeTensorInfo(x,s,y);return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),w}const i=t.filter(f=>se(f.shape)>0),o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new Si(t[0].shape,Do):new Uo(t[0].shape,Do);return n.runWebGLProgram(f,t,s)}const a=K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let m=0;m<i.length;m+=a){const g=i.slice(m,m+a);f.push(vh(g,e,n))}const p=vh(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(o){const f=new CSe(i.map(p=>p.shape),e);return n.runWebGLProgram(f,i,s)}const{tensors2D:l,outShape:c}=TSe(i,e,n),u=new kSe(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=ye({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function TSe(t,e,n){const s=Ri(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>ye({inputs:{x:i},attrs:{shape:[-1,se(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yj(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=ze(r,e[0].shape)[0],o=e.map(c=>c.shape);F2(o,i);const a=Ri(e.map(c=>c.shape),i);if(se(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>se(c.shape)>0);return l.length===1?js({inputs:{x:l[0]},backend:n}):vh(l,i,n)}const ISe={kernelName:np,backendName:"webgl",kernelFunc:Yj};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jj{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",y=g?1:2,x=g?2:3,w=g?3:1;let b="",S="";s&&(r?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`
          float activation(float x) {
            ${s}
          }
        `,S="result = activation(result);");const T=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${T}
        ${S}
        setOutput(result);
      }
    `}}class $Se{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qj{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Kn(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(d+1)/2;g++){const y=g*2;if(h+=`
           xC = xCCorner + ${y*l};
           `,a===1){if(y<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?h+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<u)){const x=o%2===0?H0(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:h+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):x===1?h+=`
                     xC${y+1} = xTexelC${y};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<u&&(h+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<u&&(h+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<u&&(h+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ESe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Kn(this.outputShape.length);const{dataFormat:s}=n,r=cs(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function Zj({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const y=[];if(i!=null){const b=p0(i.shape,f);b!=null&&(i=ye({inputs:{x:i},backend:s,attrs:{shape:b}}),y.push(i))}if(r!=null){const b=p0(r.shape,f);b!=null&&(r=ye({inputs:{x:r},backend:s,attrs:{shape:b}}),y.push(r))}if(!((d===1||h===1)&&u>Gj)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Ue(c.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),S={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},T=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,E(Nf(c.shape,S.shape),()=>`packed reshape ${c.shape} to ${S.shape} isn't free`);const I=ye({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(I);const $=f0({a:S,b:I,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),_=s.texData.get($.dataId);E(_.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=T,_.shape=n.outShape,g=js({inputs:{x:$},backend:s}),g.shape=n.outShape,y.push($)}else{const b=n.outHeight*n.outWidth,S=ye({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),T=ye({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),I=f0({a:f?S:T,b:f?T:S,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});g=ye({inputs:{x:I},backend:s,attrs:{shape:n.outShape}}),y.push(S),y.push(T),y.push(I)}for(const b of y)s.disposeIntermediateTensorInfo(b);return g}function eU({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,g=h*d,y=[n.batchSize,m,g],x=!0,w=!1,b=[];if(i!=null){const M=p0(i.shape,p);M!=null&&(i=ye({inputs:{x:i},backend:s,attrs:{shape:M}}),b.push(i))}if(r!=null){const M=p0(r.shape,p);M!=null&&(r=ye({inputs:{x:r},backend:s,attrs:{shape:M}}),b.push(r))}const S=ye({inputs:{x:e},backend:s,attrs:{shape:[1,m,se(e.shape)/m]}});b.push(S);const T=new ESe(y,n),I=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],$=s.runWebGLProgram(T,[t],"float32",I),_=ye({inputs:{x:$},backend:s,attrs:{shape:y}});b.push($),b.push(_);const D=r!=null,z=i!=null,H=a==="leakyrelu",X=a?Tf(a,!0):null,Y=new Wj(p?_.shape:S.shape,p?S.shape:_.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],x,w,D,X,z,H),J=p?[_,S]:[S,_];if(r&&J.push(r),z&&J.push(i),H){const M=s.makeTensorInfo([],"float32",bo(o,"float32"));J.push(M),b.push(M)}const Q=s.runWebGLProgram(Y,J,"float32"),ee=ye({inputs:{x:Q},backend:s,attrs:{shape:n.outShape}});b.push(Q);for(const M of b)s.disposeIntermediateTensorInfo(M);return ee}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=So(l),h=Tn(r.shape,i.shape,o,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=Zj({x:r,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const m=new Qj(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[r,i],"float32",g)}else if(K().getBool("WEBGL_CONV_IM2COL"))f=eU({x:r,filter:i,convInfo:h,backend:n});else{const m=new Jj(h);f=n.runWebGLProgram(m,[r,i],"float32")}const p=ye({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const ASe={kernelName:sp,backendName:"webgl",kernelFunc:RSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Se{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class DSe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class OSe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class FSe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=So(l),h=Tn(r.shape,u,o,1,a,c,!1,d),f=new _Se(h);return n.runWebGLProgram(f,[r,i],"float32")}const LSe={kernelName:tx,backendName:"webgl",kernelFunc:PSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MSe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Kn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=So(c),h=Tn(o,i.shape,a,1,l,u,!1,d);if(K().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new MSe(h);return n.runWebGLProgram(p,[r,i],"float32",f)}else{const f=new DSe(h);return n.runWebGLProgram(f,[r,i],"float32")}}const zSe={kernelName:rp,backendName:"webgl",kernelFunc:BSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=$a(r.shape,i.shape,o,l,a),u=new $Se(c);return n.runWebGLProgram(u,[r,i],"float32")}const jSe={kernelName:ip,backendName:"webgl",kernelFunc:VSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function USe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=$a(r.shape,l,o,1,a),u=new OSe(c);return n.runWebGLProgram(u,[r,i],"float32")}const WSe={kernelName:nx,backendName:"webgl",kernelFunc:USe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=$a(l,i.shape,a,1,o),u=new FSe(c);return n.runWebGLProgram(u,[r,i],"float32")}const HSe={kernelName:sx,backendName:"webgl",kernelFunc:GSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qSe=Vd+`
  return cos(x);
`,KSe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${rc}
  return result;
`,XSe=Je({opSnippet:qSe,packedOpSnippet:KSe}),YSe={kernelName:Fu,backendName:"webgl",kernelFunc:XSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JSe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,QSe=Je({opSnippet:JSe}),ZSe={kernelName:Pu,backendName:"webgl",kernelFunc:QSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eke{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[g,y,x]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[w,b,S]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${b};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${S};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tke=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new eke(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},nke={kernelName:ix,backendName:"webgl",kernelFunc:tke};var $f;(function(t){t.Prod="*",t.Sum="+"})($f||($f={}));class X_{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===$f.Prod?"1.0":"0.0",a=s?o:`getX(${Y_(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${ct(i)} coords = getOutputCoords();
        int end = ${J_(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${J_(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${Y_(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Y_(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function J_(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e,n,s,r,i){const o=e.shape.length,a=Ft([s],o);let l=e;a!=null&&(l=os({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Yt(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=js({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new X_(t,l.shape,!1,i),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const h=new X_(t,l.shape,r,i),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=Ea(a),f=os({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ske(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return tU($f.Prod,r,n,i,o,a)}const rke={kernelName:rx,backendName:"webgl",kernelFunc:ske};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ike(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return tU($f.Sum,r,n,i,o,a)}const oke={kernelName:op,backendName:"webgl",kernelFunc:ike};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ake(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=Dj(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=ube(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const lke={kernelName:ox,backendName:"webgl",kernelFunc:ake};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cke{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],d=l*i,h=c*i,f=u/(i*i),p=o==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new cke(p,i,o);return n.runWebGLProgram(m,[r],r.dtype)}const dke={kernelName:ax,backendName:"webgl",kernelFunc:uke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nU{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Kn(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sU{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Kn(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<d;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let y=0;y<d;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(h+1)/2;y++){const x=y*2;if(f+=`
          xC = xCCorner + ${x*c};
          `,l===1){if(x<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,c===1&&x>0?f+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const w=a%2===0?H0(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:f+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):w===1?f+=`
                    xC${x+1} = xTexelC${x};
                    `:f+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(f+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(f+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(f+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),E(Mn(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=Tn(r.shape,i.shape,o,u,a,c,!0);let h;K().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new sU(d):h=new nU(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,i],"float32",f)}const fke={kernelName:ap,backendName:"webgl",kernelFunc:hke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class mke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=Tn(r.shape,u,o,a,l,c,!0),h=new pke(d);return n.runWebGLProgram(h,[r,i],"float32")}const yke={kernelName:lx,backendName:"webgl",kernelFunc:gke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=Tn(u,i.shape,o,a,l,c,!0),h=new mke(d);return n.runWebGLProgram(h,[r,i],"float32")}const wke={kernelName:cx,backendName:"webgl",kernelFunc:xke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bke{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vke(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=se(s.shape),o=ye({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new bke(i),l=n.runWebGLProgram(a,[o],o.dtype),c=ye({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const Ske={kernelName:ux,backendName:"webgl",kernelFunc:vke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Jp(r.shape,i.shape,o,a,"NHWC",l);let u;const d=new kke(c);u=n.runWebGLProgram(d,[r,i],"float32");const h=ye({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const Nke={kernelName:lp,backendName:"webgl",kernelFunc:Cke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tke(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=q2(r,i.length);X2(o.length,l,i);const{path:c,steps:u}=Y2(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const g of u[m]){const{permutationIndices:y,expandDims:x}=K2(f,l[g]);let w;J2(y)?w=i[g]:(w=os({inputs:{x:i[g]},backend:n,attrs:{perm:y}}),p.push(w));const b=w.shape.slice();for(let S=0;S<x.length;++S)b.splice(x[S],0,1);Ue(w.shape,b)||(w=ye({inputs:{x:w},backend:n,attrs:{shape:b}}),p.push(w)),h===null?h=w:(h=n$({inputs:{a:w,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=fb({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const Ike={kernelName:hx,backendName:"webgl",kernelFunc:Tke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ke="return (x >= 0.0) ? x : (exp(x) - 1.0);",Eke=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Rke=Je({opSnippet:$ke,packedOpSnippet:Eke}),Ake={kernelName:Mu,backendName:"webgl",kernelFunc:Rke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ke="return (b >= 0.0) ? a : a * (b + 1.0);",Dke=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Oke=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zd(Dke,s.shape,r.shape):new Ml(_ke,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},Fke={kernelName:fx,backendName:"webgl",kernelFunc:Oke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pke=`
  return vec4(equal(a, b));
`,Lke="return float(a == b);",Mke=Vn({opSnippet:Lke,packedOpSnippet:Pke,dtype:"bool",cpuKernelImpl:mbe}),Bke={kernelName:cp,backendName:"webgl",kernelFunc:Mke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zke=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${z2};
  float a1 = ${V2};
  float a2 = ${j2};
  float a3 = ${U2};
  float a4 = ${W2};
  float a5 = ${G2};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Vke=Je({opSnippet:zke}),jke={kernelName:Bu,backendName:"webgl",kernelFunc:Vke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uke=Vd+`
  return exp(x);
`,Wke=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,rU=Je({opSnippet:Uke,packedOpSnippet:Wke,cpuKernelImpl:gbe,dtype:"float32"}),Gke={kernelName:zu,backendName:"webgl",kernelFunc:rU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZS(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(E(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),ye({inputs:{x:i},backend:s,attrs:{shape:a}})}const Hke={kernelName:up,backendName:"webgl",kernelFunc:ZS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q_="return exp(x) - 1.0;",qke=Je({opSnippet:Q_,packedOpSnippet:Q_,cpuKernelImpl:ybe}),Kke={kernelName:Vu,backendName:"webgl",kernelFunc:qke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z_{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(t,e,n){const s=n.texData.get(t.dataId),r=se(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=ye({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new Z_("real",l,e),u=new Z_("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=Fa({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=ye({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xke(t){const{inputs:e,backend:n}=t,{input:s}=e;return iU(s,!1,n)}const Yke={kernelName:px,backendName:"webgl",kernelFunc:Xke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jke{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dm(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Wl(r),i==="string"){const o=Bt(i,se(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new Jke(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const Qke={kernelName:mx,backendName:"webgl",kernelFunc:Dm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zke{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eCe={kernelName:gx,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new Zke(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eD="return floor(x);",tCe=Je({opSnippet:eD,packedOpSnippet:eD,cpuKernelImpl:xbe}),nCe={kernelName:ju,backendName:"webgl",kernelFunc:tCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sCe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,rCe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,iCe=Vn({opSnippet:sCe,packedOpSnippet:rCe,dtype:"int32"}),oCe={kernelName:Uu,backendName:"webgl",kernelFunc:iCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aCe{constructor(e){this.variableNames=["A"];const n=cs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lCe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=cs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cCe={kernelName:Wy,backendName:"webgl",kernelFunc:uCe};let lc,C1=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function uCe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,i];if(a||o){const m=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(lc==null||m!==C1)&&(C1=m,lc=document.createElement("canvas").getContext("2d",{willReadFrequently:C1})),lc.canvas.width=l,lc.canvas.height=c,lc.drawImage(r,0,0,l,c),r=lc.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=er.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=K().getBool("WEBGL_PACK")?new lCe(d):new aCe(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s,m=So(u),g=Tn(r.shape,i.shape,l,d,c,h,!1,m);let y;const x=[],w=o!=null,b=a!=null,S=f==="leakyrelu",T=()=>{const $=[r,i],_=(D,z)=>{if(z==="NCHW"&&D.shape.length===1&&D.shape[0]!==1){const H=ye({inputs:{x:D},backend:n,attrs:{shape:[D.shape[0],1,1]}});return x.push(H),H}return D};if(w&&$.push(_(o,u)),b&&$.push(_(a,u)),S){const D=n.makeTensorInfo([],"float32",bo(p,"float32"));$.push(D),x.push(D)}return $};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=Zj({x:r,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const $=f?Tf(f,!0):null,_=new Qj(g,w,$,b,S),D=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],z=T();y=n.runWebGLProgram(_,z,"float32",D)}else if(K().getBool("WEBGL_CONV_IM2COL"))y=eU({x:r,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const $=f?Tf(f,!1):null,_=new Jj(g,w,$,b,S),D=T();y=n.runWebGLProgram(_,D,"float32")}const I=ye({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return x.push(y),x.forEach($=>n.disposeIntermediateTensorInfo($)),I}const hCe={kernelName:df,backendName:"webgl",kernelFunc:dCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,p=[];let m=u;m==null&&(m=[1,1]),E(Mn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=Tn(r.shape,i.shape,l,m,c,d,!0),y=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,x=h?Tf(h,y):null,w=[r,i],b=o!=null,S=a!=null,T=h==="leakyrelu";if(b&&w.push(o),S&&w.push(a),T){const D=n.makeTensorInfo([],"float32",bo(f,"float32"));w.push(D),p.push(D)}let I;y?I=new sU(g,b,x,S,T):I=new nU(g,b,x,S,T);const $=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],_=n.runWebGLProgram(I,w,"float32",$);return p.forEach(D=>n.disposeIntermediateTensorInfo(D)),_}const pCe={kernelName:hf,backendName:"webgl",kernelFunc:fCe};class mCe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=ct(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gCe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=se(s.shape),[l,c,u,d]=Mw(s,r),h=ye({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=ye({inputs:{x:s},backend:n,attrs:{shape:[se(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const y=n.readSync(r.dataId),x=n.bufferSync(s),w=wbe(y,x,s.dtype,c,o,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,w.values)}const p=new mCe(o,d,[c,u],s.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),g=ye({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const yCe={kernelName:yx,backendName:"webgl",kernelFunc:gCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xCe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=ct(this.rank),r=wCe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function wCe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=ze(o,r.shape)[0];if(K().get("DEBUG")){const x=n.readSync(i.dataId),w=r.shape[l];for(let b=0;b<x.length;++b){const S=x[b];E(S<=w-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${w-1}]`)}}const c=Z2(r,i,l,a),u=se(i.shape),d=[],h=ye({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ye({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const x=n.bufferSync(f),w=n.bufferSync(h),b=bbe(w,x,p);return d.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.makeTensorInfo(c.outputShape,b.dtype,b.values)}const m=new xCe(h.shape,p),g=n.runWebGLProgram(m,[h,f],h.dtype);d.push(g);const y=ye({inputs:{x:g},backend:n,attrs:{shape:c.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}const bCe={kernelName:hp,backendName:"webgl",kernelFunc:oU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vCe="return float(a > b);",SCe=`
  return vec4(greaterThan(a, b));
`,kCe=Vn({opSnippet:vCe,packedOpSnippet:SCe,cpuKernelImpl:vbe,dtype:"bool"}),CCe={kernelName:fp,backendName:"webgl",kernelFunc:kCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NCe="return float(a >= b);",TCe=`
  return vec4(greaterThanEqual(a, b));
`,ICe=Vn({opSnippet:NCe,packedOpSnippet:TCe,dtype:"bool",cpuKernelImpl:Sbe}),$Ce={kernelName:Wu,backendName:"webgl",kernelFunc:ICe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECe(t){const{inputs:e,backend:n}=t,{input:s}=e;return iU(s,!0,n)}const RCe={kernelName:xx,backendName:"webgl",kernelFunc:ECe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ACe="return float(!isnan(x) && !isinf(x));",_Ce=Je({opSnippet:ACe,dtype:"bool"}),DCe={kernelName:Hu,backendName:"webgl",kernelFunc:_Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OCe="return float(isinf(x));",FCe=Je({opSnippet:OCe,dtype:"bool"}),PCe={kernelName:qu,backendName:"webgl",kernelFunc:FCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LCe="return float(isnan(x));",MCe=Je({opSnippet:LCe,dtype:"bool"}),BCe={kernelName:Ku,backendName:"webgl",kernelFunc:MCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zCe="return float(a < b);",VCe=`
  return vec4(lessThan(a, b));
`,jCe=Vn({opSnippet:zCe,packedOpSnippet:VCe,cpuKernelImpl:kbe,dtype:"bool"}),UCe={kernelName:mp,backendName:"webgl",kernelFunc:jCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WCe="return float(a <= b);",GCe=`
  return vec4(lessThanEqual(a, b));
`,HCe=Vn({opSnippet:WCe,packedOpSnippet:GCe,cpuKernelImpl:Cbe,dtype:"bool"}),qCe={kernelName:gp,backendName:"webgl",kernelFunc:HCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KCe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=Nbe(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const XCe={kernelName:bx,backendName:"webgl",kernelFunc:KCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YCe=Vd+`
  return x < 0.0 ? 0./0. : log(x);
`,JCe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,QCe=Je({opSnippet:YCe,packedOpSnippet:JCe,cpuKernelImpl:Tbe}),ZCe={kernelName:Xu,backendName:"webgl",kernelFunc:QCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eNe=Vd+`
  return log(1.0 + x);
`,tNe=Je({opSnippet:eNe}),nNe={kernelName:Yu,backendName:"webgl",kernelFunc:tNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sNe="return float(a >= 1.0 && b >= 1.0);",rNe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,iNe=Vn({opSnippet:sNe,packedOpSnippet:rNe,dtype:"bool"}),oNe={kernelName:yp,backendName:"webgl",kernelFunc:iNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aNe="return float(!(x >= 1.0));",lNe=Je({opSnippet:aNe}),cNe={kernelName:xp,backendName:"webgl",kernelFunc:lNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uNe="return float(a >= 1.0 || b >= 1.0);",dNe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,hNe=Vn({opSnippet:uNe,packedOpSnippet:dNe,dtype:"bool"}),fNe={kernelName:wp,backendName:"webgl",kernelFunc:hNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pNe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mNe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gNe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=K().getBool("WEBGL_PACK_NORMALIZATION")?new mNe(r.shape,i,o,a,l):new pNe(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},yNe={kernelName:bp,backendName:"webgl",kernelFunc:gNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xNe{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wNe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new xNe(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,i,o],r.dtype)},bNe={kernelName:vx,backendName:"webgl",kernelFunc:wNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vNe(t,e,n,s){const r=se(e),o=se(t.shape)/r,a=ye({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=ic(a,t.dtype,"max",s),c=ye({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=ze(i,r.shape);let c=l;const u=Ft(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const w=n.texData.get(f.dataId).values,b=new Array(a);for(let I=0;I<b.length;I++)b[I]=r.shape[u[I]];const S=e$(w,r.shape,r.dtype,u,b);f=n.makeTensorInfo(b,r.dtype);const T=n.texData.get(f.dataId);T.values=S}else f=hb(r,u,n);c=Yt(c.length,a)}Bn("max",c,a);const[p,m]=In(f.shape,c);let g=p;o&&(g=Xt(p,l));let y;if(h){const w=n.texData.get(f.dataId).values,b=Ibe(w,se(m),g,r.dtype);y=n.makeTensorInfo(g,r.dtype);const S=n.texData.get(y.dataId);S.values=b}else y=vNe(f,m,g,n);return d&&n.disposeIntermediateTensorInfo(f),y}const SNe={kernelName:vp,backendName:"webgl",kernelFunc:aU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kNe=t$+`
  return max(a, b);
`,CNe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+rc+`
  return result;
`,NNe=Vn({opSnippet:kNe,packedOpSnippet:CNe,cpuKernelImpl:$be}),TNe={kernelName:Ju,backendName:"webgl",kernelFunc:NNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function INe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Fd(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;E(Mn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Rr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Ue(u.inShape,u.outShape))return js({inputs:{x:r},backend:n});const d=new If(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const $Ne={kernelName:Sp,backendName:"webgl",kernelFunc:INe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ENe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=vo(r.shape,i,o,u,a,c,l),h=new s$(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const RNe={kernelName:kp,backendName:"webgl",kernelFunc:ENe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ANe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class _Ne{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DNe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=vo(o.shape,a,l,d,c,u),f=new s$(h,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),m=new _Ne(h),g=n.runWebGLProgram(m,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),g}const ONe={kernelName:kx,backendName:"webgl",kernelFunc:DNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FNe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Fd([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=Rr(a.shape,l,c,1,u,d),f=!0,p=new If(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),g=new ANe(h),y=n.runWebGLProgram(g,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),y}const PNe={kernelName:Sx,backendName:"webgl",kernelFunc:FNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LNe(t,e,n,s){let r=new If(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new If(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MNe={kernelName:Cx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;E(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];E(Mn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Rr(s.shape,r,i,c,o),[d,h]=LNe(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BNe(t,e,n,s){const r=se(e),o=se(t.shape)/r,a=ye({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=ic(a,"float32","mean",s),c=ye({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zNe={kernelName:Cp,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=ze(i,s.shape);let c=l;const u=Ft(c,a),d=u!=null,h=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(d){if(h){const b=o.texData.get(p.dataId).values,S=new Array(a);for(let $=0;$<S.length;$++)S[$]=s.shape[u[$]];const T=e$(b,s.shape,s.dtype,u,S);p=o.makeTensorInfo(S,s.dtype);const I=o.texData.get(p.dataId);I.values=T}else p=hb(s,u,o);f.push(p),c=Yt(c.length,a)}Bn("sum",c,a);const[m,g]=In(p.shape,c);let y=m;r&&(y=Xt(m,l));const x=BNe(p,g,y,o);for(const w of f)o.disposeIntermediateTensorInfo(w);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=ze(i,r.shape);let c=l;const u=Ft(c,a);let d=r;u!=null&&(d=os({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Yt(c.length,r.shape.length)),Bn("min",c,a);const[h,f]=In(d.shape,c),p=se(f),m=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=ic(m,m.dtype,"min",n);let y;if(o){const x=Xt(h,l);y=ye({inputs:{x:g},backend:n,attrs:{shape:x}})}else y=ye({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),y}const jNe={kernelName:Np,backendName:"webgl",kernelFunc:VNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UNe=t$+`
  return min(a, b);
`,WNe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+rc+`
  return result;
`,GNe=Vn({opSnippet:UNe,packedOpSnippet:WNe,cpuKernelImpl:Ebe}),HNe={kernelName:Qu,backendName:"webgl",kernelFunc:GNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qNe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,i=ct(r),o=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KNe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const r=e.length,i=ct(r),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=ns("rc",r),c=ns("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XNe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new KNe(s.shape,r,i):new qNe(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},YNe={kernelName:Tp,backendName:"webgl",kernelFunc:XNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JNe=`if (b == 0.0) return NAN;
  return mod(a, b);`,QNe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+rc+`
  return result;
`,ZNe=Vn({opSnippet:JNe,packedOpSnippet:QNe}),e2e={kernelName:Zu,backendName:"webgl",kernelFunc:ZNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t2e{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n2e=`
if (a == b) {
  return 1.0;
};
return a / b;`,s2e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,lU=Vn({opSnippet:n2e,packedOpSnippet:s2e,checkOutOfBounds:!0}),r2e={kernelName:Lu,backendName:"webgl",kernelFunc:lU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tD="return a - b;",cU=Vn({opSnippet:tD,packedOpSnippet:tD,supportsComplex:!0,cpuKernelImpl:Ybe}),i2e={kernelName:md,backendName:"webgl",kernelFunc:cU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=ze([i],r.shape),a=aU({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=Xt(a.shape,o),c=ye({inputs:{x:a},backend:n,attrs:{shape:l}}),u=cU({inputs:{a:r,b:c},backend:n}),d=rU({inputs:{x:u},backend:n}),h=fb({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=ye({inputs:{x:h},backend:n,attrs:{shape:l}}),p=lU({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const o2e={kernelName:Wp,backendName:"webgl",kernelFunc:uU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a2e(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:uU({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new t2e(c,u,i),h=[[o]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const l2e={kernelName:Nx,backendName:"webgl",kernelFunc:a2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c2e=_r+`
  return -x;
`,u2e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function d2e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=Abe(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Uo(s.shape,u2e):r=new Si(s.shape,c2e),n.runWebGLProgram(r,[s],s.dtype)}const h2e={kernelName:Ip,backendName:"webgl",kernelFunc:d2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f2e=Ow;function p2e(t){Xs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=f2e(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const m2e={kernelName:Tx,backendName:"webgl",kernelFunc:p2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g2e=Fw;function y2e(t){Xs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:f}=g2e(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const x2e={kernelName:Ix,backendName:"webgl",kernelFunc:y2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2e=Pw;function b2e(t){Xs("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),h=o,f=a,p=l,m=c,{selectedIndices:g,selectedScores:y}=w2e(u,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const v2e={kernelName:$x,backendName:"webgl",kernelFunc:b2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S2e{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k2e=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=se(r.shape),u=new S2e(c,o,a,l),d=ye({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,o],p=ye({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},C2e={kernelName:Rp,backendName:"webgl",kernelFunc:k2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=_m({inputs:{input:s},backend:n}),i=m0({inputs:{x:r},backend:n}),o=pb({inputs:{input:s},backend:n}),a=m0({inputs:{x:o},backend:n}),l=Fa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Dm({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const N2e={kernelName:Kp,backendName:"webgl",kernelFunc:m0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dU(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=_m({inputs:{input:s},backend:n}),i=dU({inputs:{x:r},backend:n}),o=pb({inputs:{input:s},backend:n}),a=m0({inputs:{x:o},backend:n}),l=Fa({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return Dm({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const T2e={kernelName:Ep,backendName:"webgl",kernelFunc:dU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return ZS({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Ln(i,u.shape,"All tensors passed to stack must have matching shapes"),E(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=ZS({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=Yj({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const $2e={kernelName:Ap,backendName:"webgl",kernelFunc:I2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E2e{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=ct(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R2e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const r=e.length,i=ct(r),o=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=ns("rc",r),c=ns("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=r===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hU=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(se(r.shape)===0){const c=i.map((u,d)=>u[0]+r.shape[d]+u[1]);return Dm({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new R2e(r.shape,i,o):new E2e(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},A2e={kernelName:_p,backendName:"webgl",kernelFunc:hU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _2e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,D2e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+rc+`
  return result;
`,O2e=Vn({opSnippet:_2e,packedOpSnippet:D2e}),F2e={kernelName:td,backendName:"webgl",kernelFunc:O2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=ze(i,r.shape);let u=c;const d=Ft(u,a);let h=r;d!=null&&(h=os({inputs:{x:r},backend:n,attrs:{perm:d}}),u=Yt(u.length,a),l.push(h)),Bn("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:y}=Dbe(h.shape,h.dtype,p,u);f=n.makeTensorInfo(g,y,m)}else{const[p,m]=In(h.shape,u),g=se(m),y=ye({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),x=ew(r.dtype),w=ic(y,x,"prod",n);f=ye({inputs:{x:w},backend:n,attrs:{shape:p}}),l.push(y),l.push(w)}if(o){l.push(f);const p=Xt(f.shape,c);f=ye({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const L2e={kernelName:Op,backendName:"webgl",kernelFunc:P2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(y=>n.readSync(y.dataId)),c=r.map(y=>y.shape),u=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,f,p]=Obe(l,c,u,i.shape,i.dtype,d,o.shape,a),m=h.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(p,i.dtype,f);return m.concat([g])}const B2e={kernelName:Ex,backendName:"webgl",kernelFunc:M2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=Fbe(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const V2e={kernelName:Rx,backendName:"webgl",kernelFunc:z2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j2e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(g=>n.readSync(g.dataId)),f=a.map(g=>g.shape),[p,m]=Pbe(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const U2e={kernelName:Ax,backendName:"webgl",kernelFunc:j2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fU=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=Lbe(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},W2e={kernelName:_x,backendName:"webgl",kernelFunc:fU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G2e="return 1.0 / x;",H2e=Je({opSnippet:G2e}),q2e={kernelName:nd,backendName:"webgl",kernelFunc:H2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K2e=_r+`
  return (x < 0.0) ? 0.0 : x;
`,X2e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Y2e=Je({opSnippet:K2e,packedOpSnippet:X2e}),J2e={kernelName:sd,backendName:"webgl",kernelFunc:Y2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q2e=_r+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Z2e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,eTe=Je({opSnippet:Q2e,packedOpSnippet:Z2e}),tTe={kernelName:rd,backendName:"webgl",kernelFunc:eTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nTe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sTe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rTe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new sTe(r.shape,l,c,i,o):new nTe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const iTe={kernelName:Lp,backendName:"webgl",kernelFunc:rTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oTe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aTe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new oTe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const lTe={kernelName:Fx,backendName:"webgl",kernelFunc:aTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cTe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uTe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dTe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new uTe(r.shape,l,c,i,o):new cTe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const hTe={kernelName:Pp,backendName:"webgl",kernelFunc:dTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fTe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pTe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new fTe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const mTe={kernelName:Ox,backendName:"webgl",kernelFunc:pTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gTe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=ct(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yTe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=ns("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=ct(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",h(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",h(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",h(p)}function h(p){const m=e.map((x,w)=>f(w,p)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=ze(i,r.shape);if(o===0)return js({inputs:{x:r},backend:n});const l=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yTe(r.shape,a):new gTe(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const wTe={kernelName:Mp,backendName:"webgl",kernelFunc:xTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bTe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vTe={kernelName:Qx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new bTe(s.shape,i),[c,u]=L2(o,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,kTe=Je({opSnippet:STe}),CTe={kernelName:id,backendName:"webgl",kernelFunc:kTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NTe="return inversesqrt(x);",TTe=Je({opSnippet:NTe,cpuKernelImpl:Mbe}),ITe={kernelName:od,backendName:"webgl",kernelFunc:TTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r${constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=ct(i.length),u=ct(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Te{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=ct(i.length),u=ct(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ETe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Da(i,r,o),h=[d/c,c];if(d===0)return n.makeTensorInfo(o,r.dtype);const f=ye({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=ye({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;K().getBool("WEBGL_PACK")?g=new $Te(l,a,f.shape.length,p.shape.length,u,h):g=new r$(l,a,f.shape.length,p.shape.length,u,h);const y=n.runWebGLProgram(g,[p,f,m],p.dtype),x=ye({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),x}const RTe={kernelName:Px,backendName:"webgl",kernelFunc:ETe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ATe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=K().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Te(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new ATe(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const DTe={kernelName:Mx,backendName:"webgl",kernelFunc:_Te};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OTe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=ct(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FTe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new OTe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],gs(r.dtype,i.dtype))}const PTe={kernelName:Bp,backendName:"webgl",kernelFunc:FTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LTe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Vw};
  float scale = ${jw};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,MTe=Je({opSnippet:LTe}),BTe={kernelName:ad,backendName:"webgl",kernelFunc:MTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe=Vd+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,VTe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jTe=Je({opSnippet:zTe,packedOpSnippet:VTe,cpuKernelImpl:zbe}),UTe={kernelName:dd,backendName:"webgl",kernelFunc:jTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,GTe=Je({opSnippet:WTe}),HTe={kernelName:ud,backendName:"webgl",kernelFunc:GTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qTe=Vd+`
  return sin(x);
`,KTe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${rc}
  return result;
`,XTe=Je({opSnippet:qTe,packedOpSnippet:KTe}),YTe={kernelName:ld,backendName:"webgl",kernelFunc:XTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JTe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,QTe=Je({opSnippet:JTe}),ZTe={kernelName:cd,backendName:"webgl",kernelFunc:QTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eIe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,tIe=Je({opSnippet:eIe}),nIe={kernelName:hd,backendName:"webgl",kernelFunc:tIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sIe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;E(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((y,x)=>y*x),l=[[0,0]];l.push(...o);for(let y=1+i.length;y<r.shape.length;++y)l.push([0,0]);const c=[],u=hU({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=mm(u.shape,i,a,!1),h=gm(d.length,i.length,!1),f=ym(u.shape,i,a,!1),p=ye({inputs:{x:u},backend:n,attrs:{shape:d}}),m=os({inputs:{x:p},backend:n,attrs:{perm:h}}),g=ye({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},rIe={kernelName:jp,backendName:"webgl",kernelFunc:sIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[d,h,f,p,m]=jbe(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const oIe={kernelName:Bx,backendName:"webgl",kernelFunc:iIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aIe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=Ube(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const lIe={kernelName:zx,backendName:"webgl",kernelFunc:aIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=Fj(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const uIe={kernelName:Vx,backendName:"webgl",kernelFunc:cIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dIe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=Fj(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const hIe={kernelName:jx,backendName:"webgl",kernelFunc:dIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fIe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Da(i,r,a),f=!1;if(i.dtype==="string"){const y=n.bufferSync(r),x=n.bufferSync(i),w=lo(n.readSync(o.dataId)[0]),b=Bbe(y,x,a,h,u,c,l,d,w,f);return n.makeTensorInfo(a,b.dtype,b.values)}const p=new r$(c,l,r.shape.length,i.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[i,r,o],i.dtype),g=ye({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const pIe={kernelName:Ux,backendName:"webgl",kernelFunc:fIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=ze(o,r.shape)[0],l=Q2(r,i,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=jd({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const gIe={kernelName:Up,backendName:"webgl",kernelFunc:mIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nD="return sqrt(x);",yIe=Je({opSnippet:nD,packedOpSnippet:nD,cpuKernelImpl:Wbe}),xIe={kernelName:fd,backendName:"webgl",kernelFunc:yIe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wIe="return x * x;",bIe=Je({opSnippet:wIe}),vIe={kernelName:Wx,backendName:"webgl",kernelFunc:bIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sD="return (a - b) * (a - b);",SIe=Vn({opSnippet:sD,packedOpSnippet:sD}),kIe={kernelName:pd,backendName:"webgl",kernelFunc:SIe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=po(i),a=Gbe(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const NIe={kernelName:Gp,backendName:"webgl",kernelFunc:CIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=_r+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Si(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const IIe={kernelName:wd,backendName:"webgl",kernelFunc:TIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ie{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=ct(s.length),o=ct(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:w,strides:b}=D2(r.shape,i,o,a,l,c,u,d,h);let S;if(m)S=ye({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||y){E(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const I=R2(x,w,b),$=jd({inputs:{x:r},backend:n,attrs:{begin:x,size:I}});S=ye({inputs:{x:$},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo($)}else if(n.shouldExecuteOnCPU([r])){const $=n.readSync(r.dataId),_=Le(r.shape,r.dtype,$),D=Hbe(f,_,b,x);S=n.makeTensorInfo(p,r.dtype,D.values)}else{const $=new $Ie(x,b,f);S=n.runWebGLProgram($,[r],r.dtype)}const T=ye({inputs:{x:S},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(S),T}const RIe={kernelName:Gx,backendName:"webgl",kernelFunc:EIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AIe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=qbe(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const _Ie={kernelName:Hx,backendName:"webgl",kernelFunc:AIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,d]=Kbe(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const OIe={kernelName:qx,backendName:"webgl",kernelFunc:DIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=Xbe(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const PIe={kernelName:Kx,backendName:"webgl",kernelFunc:FIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LIe="return tan(x);",MIe=Je({opSnippet:LIe}),BIe={kernelName:gd,backendName:"webgl",kernelFunc:MIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zIe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,VIe=Je({opSnippet:zIe}),jIe={kernelName:yd,backendName:"webgl",kernelFunc:VIe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UIe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Da(o,i,r.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,i.dtype);const f=ye({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=ye({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=ye({inputs:{x:r},backend:n,attrs:{shape:h}}),g=new r$(l,a,f.shape.length,p.shape.length,u,h,!1,!0),y=n.runWebGLProgram(g,[p,f,m],m.dtype),x=ye({inputs:{x:y},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),x}const WIe={kernelName:Lx,backendName:"webgl",kernelFunc:UIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GIe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=ct(this.rank),i=HIe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function HIe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>lo(h)):l,u=Le(r.shape,r.dtype,c),d=Jbe(u,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new GIe(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const qIe={kernelName:xd,backendName:"webgl",kernelFunc:pU};class KIe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class XIe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function rD(t){let e=1;for(;e<t;)e*=2;return e}function YIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=K().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=K().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const D=n.readSync(r.dataId),[z,H]=Qbe(D,c,r.dtype,i,o);return[n.makeTensorInfo(z.shape,z.dtype,z.values),n.makeTensorInfo(H.shape,H.dtype,H.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,Dm({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,m=se(c)/u,g=ye({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&Ma(n,f);const y=rD(i),x=rD(u);let w=null;const b=()=>w===null?[g,g]:[g,w],S=(D,z,H)=>{const X=b(),Y=new KIe(H),Q=[[u],[w===null?1:0],[Number.NEGATIVE_INFINITY],[D],[z]],ee=w;w=n.runWebGLProgram(Y,X,"int32",Q),Ma(n,ee)};for(let D=1;D<y;D*=2){const z=D*2;for(let H=D;H>=1;H/=2)S(z,H,[m,x])}for(let D=x;D>y;D/=2){const z=b(),H=new XIe([m,D/2]),Y=[[u],[w===null?1:0],[y]],J=w;w=n.runWebGLProgram(H,z,"int32",Y),Ma(n,J);const Q=y/2,ee=Q*2;for(let M=Q;M>=1;M/=2)S(ee,M,w.shape)}let T=w;w=jd({inputs:{x:w},backend:n,attrs:{begin:0,size:[m,i]}}),Ma(n,T);let I=oU({inputs:{x:g,indices:w},backend:n,attrs:{axis:1,batchDims:1}});Ma(n,g);const $=c.slice(0,-1);$.push(i),T=w,w=ye({inputs:{x:w},attrs:{shape:$},backend:n}),Ma(n,T);const _=I;return I=ye({inputs:{x:I},attrs:{shape:$},backend:n}),Ma(n,_),[I,w]}const JIe={kernelName:Xx,backendName:"webgl",kernelFunc:YIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QIe{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,f]=r.shape,[p,m]=c??[d,h],g=[u,p,m,f],y=new QIe(d,h,o,a,l,g);return n.runWebGLProgram(y,[r,i],"float32")}const e$e={kernelName:Yx,backendName:"webgl",kernelFunc:ZIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$e(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Fd(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=Zbe(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const n$e={kernelName:Jx,backendName:"webgl",kernelFunc:t$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==i&&(c[u++]=o.shape[m]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[i]=m;const g=jd({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),y=ye({inputs:{x:g},backend:n,attrs:{shape:c}});p[m]=y,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const r$e={kernelName:Hp,backendName:"webgl",kernelFunc:s$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i$e{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=Ft([c],a);let d=r;u!=null&&(d=os({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=Yt(1,a)[0]);const h=jB(d.shape,c,o),f=se([d.shape[c]]),p=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=ew(r.dtype),g=(b,S,T,I,$)=>{const _=b.shape[0],D=b.shape[1],z=VB(D,$),H={windowSize:z,inSize:D,batchSize:_,numSegments:$},X=new i$e(H,S),Y=n.compileAndRun(X,[b,T],I);if(l.push(Y),Y.shape[1]===$)return Y;const J=fU({backend:n,attrs:{start:0,stop:$,step:1,dtype:"float32"}}),Q=pU({inputs:{x:J},backend:n,attrs:{reps:[D/z]}});return l.push(J),l.push(Q),g(Y,S,Q,I,$)},y=g(p,"unsortedSegmentSum",i,m,o),x=ye({inputs:{x:y},backend:n,attrs:{shape:h}});let w=x;if(u!=null){l.push(x);const b=Ea(u);w=os({inputs:{x:w},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),w}const a$e={kernelName:qp,backendName:"webgl",kernelFunc:o$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$e=[G1e,q1e,Y1e,Z1e,tve,rve,ove,lve,hve,pve,yve,bve,kve,Ive,Rve,_ve,Ove,Mve,zve,jve,Hve,Zve,tSe,iSe,aSe,fSe,mSe,wSe,$1e,SSe,ISe,ASe,LSe,zSe,jSe,WSe,HSe,YSe,ZSe,nke,rke,oke,lke,dke,fke,yke,wke,Ske,Nke,Ike,Ake,Fke,Bke,jke,Gke,Hke,Kke,Yke,Qke,eCe,nCe,oCe,cCe,hCe,pCe,yCe,bCe,CCe,$Ce,I1e,RCe,NSe,DCe,PCe,BCe,R1e,UCe,qCe,XCe,ZCe,nNe,oNe,cNe,fNe,yNe,bNe,SNe,TNe,$Ne,RNe,ONe,PNe,MNe,zNe,jNe,HNe,YNe,e2e,l2e,D1e,h2e,m2e,x2e,v2e,cSe,C2e,T2e,$2e,A2e,F2e,_1e,L2e,B2e,V2e,U2e,W2e,uSe,r2e,q2e,J2e,tTe,F1e,iTe,lTe,hTe,mTe,wTe,vTe,CTe,ITe,RTe,DTe,PTe,BTe,UTe,HTe,YTe,ZTe,Jve,o2e,nIe,rIe,oIe,lIe,uIe,hIe,pIe,gIe,xIe,vIe,kIe,NIe,IIe,RIe,_Ie,OIe,PIe,i2e,j1e,BIe,jIe,WIe,qIe,JIe,e$e,U1e,n$e,r$e,a$e,N2e];for(const t of l$e)Zx(t);/** @license See the LICENSE file. */const c$e="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u$e={"tfjs-core":xB,"tfjs-backend-cpu":CV,"tfjs-backend-webgl":Mj,"tfjs-data":$4,"tfjs-layers":tb,"tfjs-converter":h4,tfjs:c$e},d$e=Object.freeze(Object.defineProperty({__proto__:null,Abs:Hf,Acos:Nu,Acosh:Tu,AdadeltaOptimizer:w2,AdagradOptimizer:b2,AdamOptimizer:v2,AdamaxOptimizer:S2,Add:Hl,AddN:qf,All:K0,Any:X0,ArgMax:Kf,ArgMin:Xf,Asin:Iu,Asinh:$u,Atan:Eu,Atan2:Au,Atanh:Ru,AvgPool:Yf,AvgPool3D:Jf,AvgPool3DGrad:J0,AvgPoolGrad:Y0,BatchMatMul:Qf,BatchToSpaceND:Zf,Bincount:Q0,BitwiseAnd:ep,BroadcastArgs:Z0,BroadcastTo:p3,Callback:o4,CallbackList:az,Cast:_u,Ceil:Du,ClipByValue:Ou,Complex:ex,ComplexAbs:tp,Concat:np,Conv2D:sp,Conv2DBackpropFilter:tx,Conv2DBackpropInput:rp,Conv3D:ip,Conv3DBackpropFilterV2:nx,Conv3DBackpropInputV2:sx,Cos:Fu,Cosh:Pu,CropAndResize:ix,Cumprod:rx,Cumsum:op,CustomCallback:cz,DataStorage:WC,DenseBincount:ox,DepthToSpace:ax,DepthwiseConv2dNative:ap,DepthwiseConv2dNativeBackpropFilter:lx,DepthwiseConv2dNativeBackpropInput:cx,Diag:ux,Dilation2D:lp,Dilation2DBackpropFilter:Uy,Dilation2DBackpropInput:jy,Draw:dx,get ENV(){return XC},EarlyStopping:a4,Einsum:hx,Elu:Mu,EluGrad:fx,Environment:h3,Equal:cp,Erf:Bu,Exp:zu,ExpandDims:up,Expm1:Vu,FFT:px,Fill:mx,FlipLeftRight:gx,Floor:ju,FloorDiv:Uu,FromPixels:Wy,FusedBatchNorm:dp,FusedConv2D:df,FusedDepthwiseConv2D:hf,GPGPUContext:ty,GatherNd:yx,GatherV2:hp,GraphModel:RI,Greater:fp,GreaterEqual:Wu,History:lz,IFFT:xx,Identity:Gu,Imag:wx,InputSpec:nn,IsFinite:Hu,IsInf:qu,IsNan:Ku,KernelBackend:G0,LRN:bp,LRNGrad:vx,LayerVariable:sz,LayersModel:Zi,LeakyRelu:pp,Less:mp,LessEqual:gp,LinSpace:bx,Log:Xu,Log1p:Yu,LogSoftmax:m3,LogicalAnd:yp,LogicalNot:xp,LogicalOr:wp,LogicalXor:eJ,LowerBound:tJ,MathBackendCPU:Im,MathBackendWebGL:Am,MatrixBandPart:nJ,Max:vp,MaxPool:Sp,MaxPool3D:kp,MaxPool3DGrad:kx,MaxPoolGrad:Sx,MaxPoolWithArgmax:Cx,Maximum:Ju,Mean:Cp,Min:Np,Minimum:Qu,MirrorPad:Tp,Mod:Zu,MomentumOptimizer:k2,Multinomial:Nx,Multiply:ed,Neg:Ip,NonMaxSuppressionV3:Tx,NonMaxSuppressionV4:Ix,NonMaxSuppressionV5:$x,NotEqual:$p,OP_SCOPE_SUFFIX:tN,OneHot:Rp,OnesLike:Ep,Optimizer:To,OptimizerConstructors:wB,Pack:Ap,PadV2:_p,Pool:sJ,Pow:td,Prelu:Dp,Prod:Op,RMSPropOptimizer:C2,RNN:ui,RaggedGather:Ex,RaggedRange:Rx,RaggedTensorToTensor:Ax,Range:_x,get Rank(){return aS},Real:Dx,RealDiv:Lu,Reciprocal:nd,get Reduction(){return ts},Relu:sd,Relu6:rd,Reshape:Fp,ResizeBilinear:Lp,ResizeBilinearGrad:Fx,ResizeNearestNeighbor:Pp,ResizeNearestNeighborGrad:Ox,Reverse:Mp,RotateWithOffset:Qx,Round:id,Rsqrt:od,SGDOptimizer:Lw,ScatterNd:Px,SearchSorted:Mx,Select:Bp,Selu:ad,Sequential:_l,Sigmoid:dd,Sign:ud,Sin:ld,Sinh:cd,Slice:zp,Softmax:Wp,Softplus:hd,SpaceToBatchND:jp,SparseFillEmptyRows:Bx,SparseReshape:zx,SparseSegmentMean:Vx,SparseSegmentSum:jx,SparseToDense:Ux,SplitV:Up,Sqrt:fd,Square:Wx,SquaredDifference:pd,StaticRegexReplace:Gp,Step:wd,StridedSlice:Gx,StringNGrams:Hx,StringSplit:qx,StringToHashBucketFast:Kx,Sub:md,Sum:Vp,SymbolicTensor:si,Tan:gd,Tanh:yd,Tensor:Xe,TensorBuffer:rn,TensorScatterUpdate:Lx,Tile:xd,TopK:Xx,Transform:Yx,Transpose:ul,Unique:Jx,Unpack:Hp,UnsortedSegmentSum:qp,UpperBound:rJ,Variable:mf,ZerosLike:Kp,_FusedMatMul:uf,abs:en,acos:cN,acosh:uN,add:ue,addN:X3,all:sw,any:yf,argMax:Nl,argMin:dN,asin:hN,asinh:fN,atan:pN,atan2:mN,atanh:gN,avgPool:Qp,avgPool3d:xN,backend:sN,backend_util:WB,basicLSTMCell:Y3,batchNorm:bd,batchNorm2d:wN,batchNorm3d:bN,batchNorm4d:vN,batchToSpaceND:Zp,bincount:SN,bitwiseAnd:J3,booleanMaskAsync:PM,broadcastArgs:Q3,broadcastTo:dl,broadcast_util:FZ,browser:Jre,buffer:Le,callbacks:hde,cast:me,ceil:kN,clipByValue:xs,clone:Ei,complex:uo,concat:Kt,concat1d:CN,concat2d:NN,concat3d:TN,concat4d:IN,constraints:Zae,conv1d:rw,conv2d:ho,conv2dTranspose:iw,conv3d:EN,conv3dTranspose:RN,copyRegisteredKernels:lJ,cos:em,cosh:ow,cosineWindow:Ew,cumprod:bf,cumsum:aw,customGrad:Li,data:Cfe,denseBincount:Ky,deprecationWarn:BJ,depthToSpace:AN,depthwiseConv2d:vd,deregisterOp:mde,device_util:DJ,diag:eM,dilation2d:_N,disableDeprecationWarnings:MJ,dispose:Oe,disposeVariables:zJ,div:Te,divNoNan:DN,dot:ON,dropout:p2,einsum:Ga,elu:Sd,enableDebugMode:LJ,enableProdMode:PJ,enclosingPowerOfTwo:m2,engine:Vr,ensureShape:tM,env:K,equal:Bs,erf:lw,euclideanNorm:PN,exp:ws,expandDims:An,expm1:LN,eye:cw,fft:fm,fill:Kl,findBackend:HJ,findBackendFactory:qJ,floor:Cd,floorDiv:nw,forceHalfFloat:Bj,fused:GM,gather:Nd,gatherND:zM,gather_util:Qre,getBackend:F3,getGradient:rS,getKernel:pf,getKernelsForBackend:Gy,gpgpu_util:abe,grad:xee,grads:wee,greater:ls,greaterEqual:ko,ifft:ou,imag:tm,image:Zs,inTopKAsync:VM,initializers:mle,input:Nz,io:I2,irfft:kw,isFinite:MN,isInf:BN,isNaN:zN,keep:dn,kernel_impls:aie,layers:jue,leakyRelu:nm,less:nu,lessEqual:Ra,linalg:x2,linspace:rM,loadGraphModel:d4,loadGraphModelSync:zhe,loadLayersModel:kz,localResponseNormalization:VN,log:zs,log1p:sm,logSigmoid:jN,logSoftmax:dw,logSumExp:rm,logicalAnd:Er,logicalNot:im,logicalOr:hw,logicalXor:UN,losses:QM,lowerBound:oM,matMul:Be,math:jre,max:rr,maxPool:om,maxPool3d:WN,maxPoolWithArgmax:aM,maximum:Bi,mean:At,memory:fS,meshgrid:lM,metrics:ide,min:tu,minimum:fa,mirrorPad:GN,mod:HN,model:Cz,models:ode,moments:am,movingAverage:LM,mul:B,multiRNNCell:cM,multinomial:uM,neg:mt,nextFrame:O2,norm:kd,notEqual:$l,oneHot:su,ones:fs,onesLike:Vs,op:L,outerProduct:dM,pad:Co,pad1d:hM,pad2d:fM,pad3d:pM,pad4d:mM,pool:qN,pow:Pi,prelu:cm,print:lN,prod:KN,profile:VJ,raggedGather:gM,raggedRange:yM,raggedTensorToTensor:xM,rand:wM,randomGamma:kM,randomNormal:pw,randomStandardNormal:CM,randomUniform:Aa,randomUniformInt:NM,range:El,ready:WJ,real:ru,reciprocal:r2,registerBackend:nN,registerCallbackConstructor:lce,registerGradient:g3,registerKernel:Zx,registerOp:pde,regularizers:ude,relu:li,relu6:mw,removeBackend:GJ,reshape:V,reverse:or,reverse1d:TM,reverse2d:IM,reverse3d:$M,reverse4d:EM,rfft:pm,round:gw,rsqrt:yw,scalar:Ee,scatterND:MM,scatter_util:vne,searchSorted:fw,selu:xw,separableConv2d:ww,sequential:ace,serialization:Sre,setBackend:UJ,setPlatform:KJ,setWebGLContext:VV,setdiff1dAsync:RM,shared:kV,sigmoid:Jr,sign:i2,signal:JM,sin:bw,sinh:vw,slice:Ge,slice1d:um,slice2d:Sw,slice3d:dm,slice4d:iu,slice_util:yB,softmax:hm,softplus:Xl,spaceToBatchND:lm,sparse:ZM,sparseToDense:BM,spectral:YM,split:ms,sqrt:Cn,square:at,squaredDifference:Cw,squeeze:_a,stack:is,step:Jl,stridedSlice:o2,string:eB,sub:Se,sum:ke,sumOutType:ew,tan:a2,tanh:ha,tensor:Ms,tensor1d:On,tensor2d:ta,tensor3d:l2,tensor4d:AM,tensor5d:_M,tensor6d:DM,tensorScatterUpdate:OM,tensor_util:$J,test_util:Ote,tidy:G,tile:Qs,time:jJ,topk:u2,train:Ua,transpose:We,truncatedNormal:Tw,unique:d2,unregisterGradient:aJ,unregisterKernel:oJ,unsortedSegmentSum:Iw,unstack:ar,upcastType:gs,upperBound:FM,util:gJ,valueAndGrad:bee,valueAndGrads:vee,variable:h2,variableGrads:iM,version:u$e,version_converter:h4,version_core:xB,version_cpu:CV,version_layers:tb,version_webgl:Mj,webgl:T1e,webgl_util:fwe,where:Sn,whereAsync:f2,zeros:Ht,zerosLike:He},Symbol.toStringTag,{value:"Module"}));var mU={},mb={};mb.byteLength=p$e;mb.toByteArray=g$e;mb.fromByteArray=w$e;var bi=[],pr=[],h$e=typeof Uint8Array<"u"?Uint8Array:Array,N1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var cc=0,f$e=N1.length;cc<f$e;++cc)bi[cc]=N1[cc],pr[N1.charCodeAt(cc)]=cc;pr[45]=62;pr[95]=63;function gU(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var s=n===e?0:4-n%4;return[n,s]}function p$e(t){var e=gU(t),n=e[0],s=e[1];return(n+s)*3/4-s}function m$e(t,e,n){return(e+n)*3/4-n}function g$e(t){var e,n=gU(t),s=n[0],r=n[1],i=new h$e(m$e(t,s,r)),o=0,a=r>0?s-4:s,l;for(l=0;l<a;l+=4)e=pr[t.charCodeAt(l)]<<18|pr[t.charCodeAt(l+1)]<<12|pr[t.charCodeAt(l+2)]<<6|pr[t.charCodeAt(l+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=e&255;return r===2&&(e=pr[t.charCodeAt(l)]<<2|pr[t.charCodeAt(l+1)]>>4,i[o++]=e&255),r===1&&(e=pr[t.charCodeAt(l)]<<10|pr[t.charCodeAt(l+1)]<<4|pr[t.charCodeAt(l+2)]>>2,i[o++]=e>>8&255,i[o++]=e&255),i}function y$e(t){return bi[t>>18&63]+bi[t>>12&63]+bi[t>>6&63]+bi[t&63]}function x$e(t,e,n){for(var s,r=[],i=e;i<n;i+=3)s=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),r.push(y$e(s));return r.join("")}function w$e(t){for(var e,n=t.length,s=n%3,r=[],i=16383,o=0,a=n-s;o<a;o+=i)r.push(x$e(t,o,o+i>a?a:o+i));return s===1?(e=t[n-1],r.push(bi[e>>2]+bi[e<<4&63]+"==")):s===2&&(e=(t[n-2]<<8)+t[n-1],r.push(bi[e>>10]+bi[e>>4&63]+bi[e<<2&63]+"=")),r.join("")}var i$={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */i$.read=function(t,e,n,s,r){var i,o,a=r*8-s-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?r-1:0,h=n?-1:1,f=t[e+d];for(d+=h,i=f&(1<<-u)-1,f>>=-u,u+=a;u>0;i=i*256+t[e+d],d+=h,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=s;u>0;o=o*256+t[e+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,s),i=i-c}return(f?-1:1)*o*Math.pow(2,i-s)};i$.write=function(t,e,n,s,r,i){var o,a,l,c=i*8-r-1,u=(1<<c)-1,d=u>>1,h=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=s?0:i-1,p=s?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?e+=h/l:e+=h*Math.pow(2,1-d),e*l>=2&&(o++,l/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*l-1)*Math.pow(2,r),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,r),o=0));r>=8;t[n+f]=a&255,f+=p,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;t[n+f]=o&255,f+=p,o/=256,c-=8);t[n+f-p]|=m*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=mb,n=i$,s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=x,t.INSPECT_MAX_BYTES=50;const r=2147483647;t.kMaxLength=r,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const A=new Uint8Array(1),k={foo:function(){return 42}};return Object.setPrototypeOf(k,Uint8Array.prototype),Object.setPrototypeOf(A,k),A.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(A){if(A>r)throw new RangeError('The value "'+A+'" is invalid for option "size"');const k=new Uint8Array(A);return Object.setPrototypeOf(k,a.prototype),k}function a(A,k,N){if(typeof A=="number"){if(typeof k=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(A)}return l(A,k,N)}a.poolSize=8192;function l(A,k,N){if(typeof A=="string")return h(A,k);if(ArrayBuffer.isView(A))return p(A);if(A==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A);if(Tt(A,ArrayBuffer)||A&&Tt(A.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Tt(A,SharedArrayBuffer)||A&&Tt(A.buffer,SharedArrayBuffer)))return m(A,k,N);if(typeof A=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const O=A.valueOf&&A.valueOf();if(O!=null&&O!==A)return a.from(O,k,N);const W=g(A);if(W)return W;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof A[Symbol.toPrimitive]=="function")return a.from(A[Symbol.toPrimitive]("string"),k,N);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof A)}a.from=function(A,k,N){return l(A,k,N)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function c(A){if(typeof A!="number")throw new TypeError('"size" argument must be of type number');if(A<0)throw new RangeError('The value "'+A+'" is invalid for option "size"')}function u(A,k,N){return c(A),A<=0?o(A):k!==void 0?typeof N=="string"?o(A).fill(k,N):o(A).fill(k):o(A)}a.alloc=function(A,k,N){return u(A,k,N)};function d(A){return c(A),o(A<0?0:y(A)|0)}a.allocUnsafe=function(A){return d(A)},a.allocUnsafeSlow=function(A){return d(A)};function h(A,k){if((typeof k!="string"||k==="")&&(k="utf8"),!a.isEncoding(k))throw new TypeError("Unknown encoding: "+k);const N=w(A,k)|0;let O=o(N);const W=O.write(A,k);return W!==N&&(O=O.slice(0,W)),O}function f(A){const k=A.length<0?0:y(A.length)|0,N=o(k);for(let O=0;O<k;O+=1)N[O]=A[O]&255;return N}function p(A){if(Tt(A,Uint8Array)){const k=new Uint8Array(A);return m(k.buffer,k.byteOffset,k.byteLength)}return f(A)}function m(A,k,N){if(k<0||A.byteLength<k)throw new RangeError('"offset" is outside of buffer bounds');if(A.byteLength<k+(N||0))throw new RangeError('"length" is outside of buffer bounds');let O;return k===void 0&&N===void 0?O=new Uint8Array(A):N===void 0?O=new Uint8Array(A,k):O=new Uint8Array(A,k,N),Object.setPrototypeOf(O,a.prototype),O}function g(A){if(a.isBuffer(A)){const k=y(A.length)|0,N=o(k);return N.length===0||A.copy(N,0,0,k),N}if(A.length!==void 0)return typeof A.length!="number"||Or(A.length)?o(0):f(A);if(A.type==="Buffer"&&Array.isArray(A.data))return f(A.data)}function y(A){if(A>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return A|0}function x(A){return+A!=A&&(A=0),a.alloc(+A)}a.isBuffer=function(k){return k!=null&&k._isBuffer===!0&&k!==a.prototype},a.compare=function(k,N){if(Tt(k,Uint8Array)&&(k=a.from(k,k.offset,k.byteLength)),Tt(N,Uint8Array)&&(N=a.from(N,N.offset,N.byteLength)),!a.isBuffer(k)||!a.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(k===N)return 0;let O=k.length,W=N.length;for(let re=0,ce=Math.min(O,W);re<ce;++re)if(k[re]!==N[re]){O=k[re],W=N[re];break}return O<W?-1:W<O?1:0},a.isEncoding=function(k){switch(String(k).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(k,N){if(!Array.isArray(k))throw new TypeError('"list" argument must be an Array of Buffers');if(k.length===0)return a.alloc(0);let O;if(N===void 0)for(N=0,O=0;O<k.length;++O)N+=k[O].length;const W=a.allocUnsafe(N);let re=0;for(O=0;O<k.length;++O){let ce=k[O];if(Tt(ce,Uint8Array))re+ce.length>W.length?(a.isBuffer(ce)||(ce=a.from(ce)),ce.copy(W,re)):Uint8Array.prototype.set.call(W,ce,re);else if(a.isBuffer(ce))ce.copy(W,re);else throw new TypeError('"list" argument must be an Array of Buffers');re+=ce.length}return W};function w(A,k){if(a.isBuffer(A))return A.length;if(ArrayBuffer.isView(A)||Tt(A,ArrayBuffer))return A.byteLength;if(typeof A!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof A);const N=A.length,O=arguments.length>2&&arguments[2]===!0;if(!O&&N===0)return 0;let W=!1;for(;;)switch(k){case"ascii":case"latin1":case"binary":return N;case"utf8":case"utf-8":return ut(A).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N*2;case"hex":return N>>>1;case"base64":return Zt(A).length;default:if(W)return O?-1:ut(A).length;k=(""+k).toLowerCase(),W=!0}}a.byteLength=w;function b(A,k,N){let O=!1;if((k===void 0||k<0)&&(k=0),k>this.length||((N===void 0||N>this.length)&&(N=this.length),N<=0)||(N>>>=0,k>>>=0,N<=k))return"";for(A||(A="utf8");;)switch(A){case"hex":return q(this,k,N);case"utf8":case"utf-8":return Y(this,k,N);case"ascii":return ee(this,k,N);case"latin1":case"binary":return M(this,k,N);case"base64":return X(this,k,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,k,N);default:if(O)throw new TypeError("Unknown encoding: "+A);A=(A+"").toLowerCase(),O=!0}}a.prototype._isBuffer=!0;function S(A,k,N){const O=A[k];A[k]=A[N],A[N]=O}a.prototype.swap16=function(){const k=this.length;if(k%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let N=0;N<k;N+=2)S(this,N,N+1);return this},a.prototype.swap32=function(){const k=this.length;if(k%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let N=0;N<k;N+=4)S(this,N,N+3),S(this,N+1,N+2);return this},a.prototype.swap64=function(){const k=this.length;if(k%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let N=0;N<k;N+=8)S(this,N,N+7),S(this,N+1,N+6),S(this,N+2,N+5),S(this,N+3,N+4);return this},a.prototype.toString=function(){const k=this.length;return k===0?"":arguments.length===0?Y(this,0,k):b.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(k){if(!a.isBuffer(k))throw new TypeError("Argument must be a Buffer");return this===k?!0:a.compare(this,k)===0},a.prototype.inspect=function(){let k="";const N=t.INSPECT_MAX_BYTES;return k=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(k+=" ... "),"<Buffer "+k+">"},s&&(a.prototype[s]=a.prototype.inspect),a.prototype.compare=function(k,N,O,W,re){if(Tt(k,Uint8Array)&&(k=a.from(k,k.offset,k.byteLength)),!a.isBuffer(k))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof k);if(N===void 0&&(N=0),O===void 0&&(O=k?k.length:0),W===void 0&&(W=0),re===void 0&&(re=this.length),N<0||O>k.length||W<0||re>this.length)throw new RangeError("out of range index");if(W>=re&&N>=O)return 0;if(W>=re)return-1;if(N>=O)return 1;if(N>>>=0,O>>>=0,W>>>=0,re>>>=0,this===k)return 0;let ce=re-W,je=O-N;const It=Math.min(ce,je),$t=this.slice(W,re),jt=k.slice(N,O);for(let ft=0;ft<It;++ft)if($t[ft]!==jt[ft]){ce=$t[ft],je=jt[ft];break}return ce<je?-1:je<ce?1:0};function T(A,k,N,O,W){if(A.length===0)return-1;if(typeof N=="string"?(O=N,N=0):N>2147483647?N=2147483647:N<-2147483648&&(N=-2147483648),N=+N,Or(N)&&(N=W?0:A.length-1),N<0&&(N=A.length+N),N>=A.length){if(W)return-1;N=A.length-1}else if(N<0)if(W)N=0;else return-1;if(typeof k=="string"&&(k=a.from(k,O)),a.isBuffer(k))return k.length===0?-1:I(A,k,N,O,W);if(typeof k=="number")return k=k&255,typeof Uint8Array.prototype.indexOf=="function"?W?Uint8Array.prototype.indexOf.call(A,k,N):Uint8Array.prototype.lastIndexOf.call(A,k,N):I(A,[k],N,O,W);throw new TypeError("val must be string, number or Buffer")}function I(A,k,N,O,W){let re=1,ce=A.length,je=k.length;if(O!==void 0&&(O=String(O).toLowerCase(),O==="ucs2"||O==="ucs-2"||O==="utf16le"||O==="utf-16le")){if(A.length<2||k.length<2)return-1;re=2,ce/=2,je/=2,N/=2}function It(jt,ft){return re===1?jt[ft]:jt.readUInt16BE(ft*re)}let $t;if(W){let jt=-1;for($t=N;$t<ce;$t++)if(It(A,$t)===It(k,jt===-1?0:$t-jt)){if(jt===-1&&(jt=$t),$t-jt+1===je)return jt*re}else jt!==-1&&($t-=$t-jt),jt=-1}else for(N+je>ce&&(N=ce-je),$t=N;$t>=0;$t--){let jt=!0;for(let ft=0;ft<je;ft++)if(It(A,$t+ft)!==It(k,ft)){jt=!1;break}if(jt)return $t}return-1}a.prototype.includes=function(k,N,O){return this.indexOf(k,N,O)!==-1},a.prototype.indexOf=function(k,N,O){return T(this,k,N,O,!0)},a.prototype.lastIndexOf=function(k,N,O){return T(this,k,N,O,!1)};function $(A,k,N,O){N=Number(N)||0;const W=A.length-N;O?(O=Number(O),O>W&&(O=W)):O=W;const re=k.length;O>re/2&&(O=re/2);let ce;for(ce=0;ce<O;++ce){const je=parseInt(k.substr(ce*2,2),16);if(Or(je))return ce;A[N+ce]=je}return ce}function _(A,k,N,O){return Gs(ut(k,A.length-N),A,N,O)}function D(A,k,N,O){return Gs(ht(k),A,N,O)}function z(A,k,N,O){return Gs(Zt(k),A,N,O)}function H(A,k,N,O){return Gs(Dr(k,A.length-N),A,N,O)}a.prototype.write=function(k,N,O,W){if(N===void 0)W="utf8",O=this.length,N=0;else if(O===void 0&&typeof N=="string")W=N,O=this.length,N=0;else if(isFinite(N))N=N>>>0,isFinite(O)?(O=O>>>0,W===void 0&&(W="utf8")):(W=O,O=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const re=this.length-N;if((O===void 0||O>re)&&(O=re),k.length>0&&(O<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");W||(W="utf8");let ce=!1;for(;;)switch(W){case"hex":return $(this,k,N,O);case"utf8":case"utf-8":return _(this,k,N,O);case"ascii":case"latin1":case"binary":return D(this,k,N,O);case"base64":return z(this,k,N,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,k,N,O);default:if(ce)throw new TypeError("Unknown encoding: "+W);W=(""+W).toLowerCase(),ce=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(A,k,N){return k===0&&N===A.length?e.fromByteArray(A):e.fromByteArray(A.slice(k,N))}function Y(A,k,N){N=Math.min(A.length,N);const O=[];let W=k;for(;W<N;){const re=A[W];let ce=null,je=re>239?4:re>223?3:re>191?2:1;if(W+je<=N){let It,$t,jt,ft;switch(je){case 1:re<128&&(ce=re);break;case 2:It=A[W+1],(It&192)===128&&(ft=(re&31)<<6|It&63,ft>127&&(ce=ft));break;case 3:It=A[W+1],$t=A[W+2],(It&192)===128&&($t&192)===128&&(ft=(re&15)<<12|(It&63)<<6|$t&63,ft>2047&&(ft<55296||ft>57343)&&(ce=ft));break;case 4:It=A[W+1],$t=A[W+2],jt=A[W+3],(It&192)===128&&($t&192)===128&&(jt&192)===128&&(ft=(re&15)<<18|(It&63)<<12|($t&63)<<6|jt&63,ft>65535&&ft<1114112&&(ce=ft))}}ce===null?(ce=65533,je=1):ce>65535&&(ce-=65536,O.push(ce>>>10&1023|55296),ce=56320|ce&1023),O.push(ce),W+=je}return Q(O)}const J=4096;function Q(A){const k=A.length;if(k<=J)return String.fromCharCode.apply(String,A);let N="",O=0;for(;O<k;)N+=String.fromCharCode.apply(String,A.slice(O,O+=J));return N}function ee(A,k,N){let O="";N=Math.min(A.length,N);for(let W=k;W<N;++W)O+=String.fromCharCode(A[W]&127);return O}function M(A,k,N){let O="";N=Math.min(A.length,N);for(let W=k;W<N;++W)O+=String.fromCharCode(A[W]);return O}function q(A,k,N){const O=A.length;(!k||k<0)&&(k=0),(!N||N<0||N>O)&&(N=O);let W="";for(let re=k;re<N;++re)W+=Hs[A[re]];return W}function te(A,k,N){const O=A.slice(k,N);let W="";for(let re=0;re<O.length-1;re+=2)W+=String.fromCharCode(O[re]+O[re+1]*256);return W}a.prototype.slice=function(k,N){const O=this.length;k=~~k,N=N===void 0?O:~~N,k<0?(k+=O,k<0&&(k=0)):k>O&&(k=O),N<0?(N+=O,N<0&&(N=0)):N>O&&(N=O),N<k&&(N=k);const W=this.subarray(k,N);return Object.setPrototypeOf(W,a.prototype),W};function Z(A,k,N){if(A%1!==0||A<0)throw new RangeError("offset is not uint");if(A+k>N)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(k,N,O){k=k>>>0,N=N>>>0,O||Z(k,N,this.length);let W=this[k],re=1,ce=0;for(;++ce<N&&(re*=256);)W+=this[k+ce]*re;return W},a.prototype.readUintBE=a.prototype.readUIntBE=function(k,N,O){k=k>>>0,N=N>>>0,O||Z(k,N,this.length);let W=this[k+--N],re=1;for(;N>0&&(re*=256);)W+=this[k+--N]*re;return W},a.prototype.readUint8=a.prototype.readUInt8=function(k,N){return k=k>>>0,N||Z(k,1,this.length),this[k]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(k,N){return k=k>>>0,N||Z(k,2,this.length),this[k]|this[k+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(k,N){return k=k>>>0,N||Z(k,2,this.length),this[k]<<8|this[k+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(k,N){return k=k>>>0,N||Z(k,4,this.length),(this[k]|this[k+1]<<8|this[k+2]<<16)+this[k+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(k,N){return k=k>>>0,N||Z(k,4,this.length),this[k]*16777216+(this[k+1]<<16|this[k+2]<<8|this[k+3])},a.prototype.readBigUInt64LE=$n(function(k){k=k>>>0,Qe(k,"offset");const N=this[k],O=this[k+7];(N===void 0||O===void 0)&&it(k,this.length-8);const W=N+this[++k]*2**8+this[++k]*2**16+this[++k]*2**24,re=this[++k]+this[++k]*2**8+this[++k]*2**16+O*2**24;return BigInt(W)+(BigInt(re)<<BigInt(32))}),a.prototype.readBigUInt64BE=$n(function(k){k=k>>>0,Qe(k,"offset");const N=this[k],O=this[k+7];(N===void 0||O===void 0)&&it(k,this.length-8);const W=N*2**24+this[++k]*2**16+this[++k]*2**8+this[++k],re=this[++k]*2**24+this[++k]*2**16+this[++k]*2**8+O;return(BigInt(W)<<BigInt(32))+BigInt(re)}),a.prototype.readIntLE=function(k,N,O){k=k>>>0,N=N>>>0,O||Z(k,N,this.length);let W=this[k],re=1,ce=0;for(;++ce<N&&(re*=256);)W+=this[k+ce]*re;return re*=128,W>=re&&(W-=Math.pow(2,8*N)),W},a.prototype.readIntBE=function(k,N,O){k=k>>>0,N=N>>>0,O||Z(k,N,this.length);let W=N,re=1,ce=this[k+--W];for(;W>0&&(re*=256);)ce+=this[k+--W]*re;return re*=128,ce>=re&&(ce-=Math.pow(2,8*N)),ce},a.prototype.readInt8=function(k,N){return k=k>>>0,N||Z(k,1,this.length),this[k]&128?(255-this[k]+1)*-1:this[k]},a.prototype.readInt16LE=function(k,N){k=k>>>0,N||Z(k,2,this.length);const O=this[k]|this[k+1]<<8;return O&32768?O|4294901760:O},a.prototype.readInt16BE=function(k,N){k=k>>>0,N||Z(k,2,this.length);const O=this[k+1]|this[k]<<8;return O&32768?O|4294901760:O},a.prototype.readInt32LE=function(k,N){return k=k>>>0,N||Z(k,4,this.length),this[k]|this[k+1]<<8|this[k+2]<<16|this[k+3]<<24},a.prototype.readInt32BE=function(k,N){return k=k>>>0,N||Z(k,4,this.length),this[k]<<24|this[k+1]<<16|this[k+2]<<8|this[k+3]},a.prototype.readBigInt64LE=$n(function(k){k=k>>>0,Qe(k,"offset");const N=this[k],O=this[k+7];(N===void 0||O===void 0)&&it(k,this.length-8);const W=this[k+4]+this[k+5]*2**8+this[k+6]*2**16+(O<<24);return(BigInt(W)<<BigInt(32))+BigInt(N+this[++k]*2**8+this[++k]*2**16+this[++k]*2**24)}),a.prototype.readBigInt64BE=$n(function(k){k=k>>>0,Qe(k,"offset");const N=this[k],O=this[k+7];(N===void 0||O===void 0)&&it(k,this.length-8);const W=(N<<24)+this[++k]*2**16+this[++k]*2**8+this[++k];return(BigInt(W)<<BigInt(32))+BigInt(this[++k]*2**24+this[++k]*2**16+this[++k]*2**8+O)}),a.prototype.readFloatLE=function(k,N){return k=k>>>0,N||Z(k,4,this.length),n.read(this,k,!0,23,4)},a.prototype.readFloatBE=function(k,N){return k=k>>>0,N||Z(k,4,this.length),n.read(this,k,!1,23,4)},a.prototype.readDoubleLE=function(k,N){return k=k>>>0,N||Z(k,8,this.length),n.read(this,k,!0,52,8)},a.prototype.readDoubleBE=function(k,N){return k=k>>>0,N||Z(k,8,this.length),n.read(this,k,!1,52,8)};function le(A,k,N,O,W,re){if(!a.isBuffer(A))throw new TypeError('"buffer" argument must be a Buffer instance');if(k>W||k<re)throw new RangeError('"value" argument is out of bounds');if(N+O>A.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(k,N,O,W){if(k=+k,N=N>>>0,O=O>>>0,!W){const je=Math.pow(2,8*O)-1;le(this,k,N,O,je,0)}let re=1,ce=0;for(this[N]=k&255;++ce<O&&(re*=256);)this[N+ce]=k/re&255;return N+O},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(k,N,O,W){if(k=+k,N=N>>>0,O=O>>>0,!W){const je=Math.pow(2,8*O)-1;le(this,k,N,O,je,0)}let re=O-1,ce=1;for(this[N+re]=k&255;--re>=0&&(ce*=256);)this[N+re]=k/ce&255;return N+O},a.prototype.writeUint8=a.prototype.writeUInt8=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,1,255,0),this[N]=k&255,N+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,2,65535,0),this[N]=k&255,this[N+1]=k>>>8,N+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,2,65535,0),this[N]=k>>>8,this[N+1]=k&255,N+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,4,4294967295,0),this[N+3]=k>>>24,this[N+2]=k>>>16,this[N+1]=k>>>8,this[N]=k&255,N+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,4,4294967295,0),this[N]=k>>>24,this[N+1]=k>>>16,this[N+2]=k>>>8,this[N+3]=k&255,N+4};function de(A,k,N,O,W){et(k,O,W,A,N,7);let re=Number(k&BigInt(4294967295));A[N++]=re,re=re>>8,A[N++]=re,re=re>>8,A[N++]=re,re=re>>8,A[N++]=re;let ce=Number(k>>BigInt(32)&BigInt(4294967295));return A[N++]=ce,ce=ce>>8,A[N++]=ce,ce=ce>>8,A[N++]=ce,ce=ce>>8,A[N++]=ce,N}function fe(A,k,N,O,W){et(k,O,W,A,N,7);let re=Number(k&BigInt(4294967295));A[N+7]=re,re=re>>8,A[N+6]=re,re=re>>8,A[N+5]=re,re=re>>8,A[N+4]=re;let ce=Number(k>>BigInt(32)&BigInt(4294967295));return A[N+3]=ce,ce=ce>>8,A[N+2]=ce,ce=ce>>8,A[N+1]=ce,ce=ce>>8,A[N]=ce,N+8}a.prototype.writeBigUInt64LE=$n(function(k,N=0){return de(this,k,N,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=$n(function(k,N=0){return fe(this,k,N,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(k,N,O,W){if(k=+k,N=N>>>0,!W){const It=Math.pow(2,8*O-1);le(this,k,N,O,It-1,-It)}let re=0,ce=1,je=0;for(this[N]=k&255;++re<O&&(ce*=256);)k<0&&je===0&&this[N+re-1]!==0&&(je=1),this[N+re]=(k/ce>>0)-je&255;return N+O},a.prototype.writeIntBE=function(k,N,O,W){if(k=+k,N=N>>>0,!W){const It=Math.pow(2,8*O-1);le(this,k,N,O,It-1,-It)}let re=O-1,ce=1,je=0;for(this[N+re]=k&255;--re>=0&&(ce*=256);)k<0&&je===0&&this[N+re+1]!==0&&(je=1),this[N+re]=(k/ce>>0)-je&255;return N+O},a.prototype.writeInt8=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,1,127,-128),k<0&&(k=255+k+1),this[N]=k&255,N+1},a.prototype.writeInt16LE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,2,32767,-32768),this[N]=k&255,this[N+1]=k>>>8,N+2},a.prototype.writeInt16BE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,2,32767,-32768),this[N]=k>>>8,this[N+1]=k&255,N+2},a.prototype.writeInt32LE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,4,2147483647,-2147483648),this[N]=k&255,this[N+1]=k>>>8,this[N+2]=k>>>16,this[N+3]=k>>>24,N+4},a.prototype.writeInt32BE=function(k,N,O){return k=+k,N=N>>>0,O||le(this,k,N,4,2147483647,-2147483648),k<0&&(k=4294967295+k+1),this[N]=k>>>24,this[N+1]=k>>>16,this[N+2]=k>>>8,this[N+3]=k&255,N+4},a.prototype.writeBigInt64LE=$n(function(k,N=0){return de(this,k,N,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=$n(function(k,N=0){return fe(this,k,N,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ne(A,k,N,O,W,re){if(N+O>A.length)throw new RangeError("Index out of range");if(N<0)throw new RangeError("Index out of range")}function U(A,k,N,O,W){return k=+k,N=N>>>0,W||ne(A,k,N,4),n.write(A,k,N,O,23,4),N+4}a.prototype.writeFloatLE=function(k,N,O){return U(this,k,N,!0,O)},a.prototype.writeFloatBE=function(k,N,O){return U(this,k,N,!1,O)};function ae(A,k,N,O,W){return k=+k,N=N>>>0,W||ne(A,k,N,8),n.write(A,k,N,O,52,8),N+8}a.prototype.writeDoubleLE=function(k,N,O){return ae(this,k,N,!0,O)},a.prototype.writeDoubleBE=function(k,N,O){return ae(this,k,N,!1,O)},a.prototype.copy=function(k,N,O,W){if(!a.isBuffer(k))throw new TypeError("argument should be a Buffer");if(O||(O=0),!W&&W!==0&&(W=this.length),N>=k.length&&(N=k.length),N||(N=0),W>0&&W<O&&(W=O),W===O||k.length===0||this.length===0)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(O<0||O>=this.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("sourceEnd out of bounds");W>this.length&&(W=this.length),k.length-N<W-O&&(W=k.length-N+O);const re=W-O;return this===k&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(N,O,W):Uint8Array.prototype.set.call(k,this.subarray(O,W),N),re},a.prototype.fill=function(k,N,O,W){if(typeof k=="string"){if(typeof N=="string"?(W=N,N=0,O=this.length):typeof O=="string"&&(W=O,O=this.length),W!==void 0&&typeof W!="string")throw new TypeError("encoding must be a string");if(typeof W=="string"&&!a.isEncoding(W))throw new TypeError("Unknown encoding: "+W);if(k.length===1){const ce=k.charCodeAt(0);(W==="utf8"&&ce<128||W==="latin1")&&(k=ce)}}else typeof k=="number"?k=k&255:typeof k=="boolean"&&(k=Number(k));if(N<0||this.length<N||this.length<O)throw new RangeError("Out of range index");if(O<=N)return this;N=N>>>0,O=O===void 0?this.length:O>>>0,k||(k=0);let re;if(typeof k=="number")for(re=N;re<O;++re)this[re]=k;else{const ce=a.isBuffer(k)?k:a.from(k,W),je=ce.length;if(je===0)throw new TypeError('The value "'+k+'" is invalid for argument "value"');for(re=0;re<O-N;++re)this[re+N]=ce[re%je]}return this};const ge={};function be(A,k,N){ge[A]=class extends N{constructor(){super(),Object.defineProperty(this,"message",{value:k.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${A}]`,this.stack,delete this.name}get code(){return A}set code(W){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:W,writable:!0})}toString(){return`${this.name} [${A}]: ${this.message}`}}}be("ERR_BUFFER_OUT_OF_BOUNDS",function(A){return A?`${A} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),be("ERR_INVALID_ARG_TYPE",function(A,k){return`The "${A}" argument must be of type number. Received type ${typeof k}`},TypeError),be("ERR_OUT_OF_RANGE",function(A,k,N){let O=`The value of "${A}" is out of range.`,W=N;return Number.isInteger(N)&&Math.abs(N)>2**32?W=$e(String(N)):typeof N=="bigint"&&(W=String(N),(N>BigInt(2)**BigInt(32)||N<-(BigInt(2)**BigInt(32)))&&(W=$e(W)),W+="n"),O+=` It must be ${k}. Received ${W}`,O},RangeError);function $e(A){let k="",N=A.length;const O=A[0]==="-"?1:0;for(;N>=O+4;N-=3)k=`_${A.slice(N-3,N)}${k}`;return`${A.slice(0,N)}${k}`}function Ae(A,k,N){Qe(k,"offset"),(A[k]===void 0||A[k+N]===void 0)&&it(k,A.length-(N+1))}function et(A,k,N,O,W,re){if(A>N||A<k){const ce=typeof k=="bigint"?"n":"";let je;throw k===0||k===BigInt(0)?je=`>= 0${ce} and < 2${ce} ** ${(re+1)*8}${ce}`:je=`>= -(2${ce} ** ${(re+1)*8-1}${ce}) and < 2 ** ${(re+1)*8-1}${ce}`,new ge.ERR_OUT_OF_RANGE("value",je,A)}Ae(O,W,re)}function Qe(A,k){if(typeof A!="number")throw new ge.ERR_INVALID_ARG_TYPE(k,"number",A)}function it(A,k,N){throw Math.floor(A)!==A?(Qe(A,N),new ge.ERR_OUT_OF_RANGE("offset","an integer",A)):k<0?new ge.ERR_BUFFER_OUT_OF_BOUNDS:new ge.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${k}`,A)}const ot=/[^+/0-9A-Za-z-_]/g;function nt(A){if(A=A.split("=")[0],A=A.trim().replace(ot,""),A.length<2)return"";for(;A.length%4!==0;)A=A+"=";return A}function ut(A,k){k=k||1/0;let N;const O=A.length;let W=null;const re=[];for(let ce=0;ce<O;++ce){if(N=A.charCodeAt(ce),N>55295&&N<57344){if(!W){if(N>56319){(k-=3)>-1&&re.push(239,191,189);continue}else if(ce+1===O){(k-=3)>-1&&re.push(239,191,189);continue}W=N;continue}if(N<56320){(k-=3)>-1&&re.push(239,191,189),W=N;continue}N=(W-55296<<10|N-56320)+65536}else W&&(k-=3)>-1&&re.push(239,191,189);if(W=null,N<128){if((k-=1)<0)break;re.push(N)}else if(N<2048){if((k-=2)<0)break;re.push(N>>6|192,N&63|128)}else if(N<65536){if((k-=3)<0)break;re.push(N>>12|224,N>>6&63|128,N&63|128)}else if(N<1114112){if((k-=4)<0)break;re.push(N>>18|240,N>>12&63|128,N>>6&63|128,N&63|128)}else throw new Error("Invalid code point")}return re}function ht(A){const k=[];for(let N=0;N<A.length;++N)k.push(A.charCodeAt(N)&255);return k}function Dr(A,k){let N,O,W;const re=[];for(let ce=0;ce<A.length&&!((k-=2)<0);++ce)N=A.charCodeAt(ce),O=N>>8,W=N%256,re.push(W),re.push(O);return re}function Zt(A){return e.toByteArray(nt(A))}function Gs(A,k,N,O){let W;for(W=0;W<O&&!(W+N>=k.length||W>=A.length);++W)k[W+N]=A[W];return W}function Tt(A,k){return A instanceof k||A!=null&&A.constructor!=null&&A.constructor.name!=null&&A.constructor.name===k.name}function Or(A){return A!==A}const Hs=function(){const A="0123456789abcdef",k=new Array(256);for(let N=0;N<16;++N){const O=N*16;for(let W=0;W<16;++W)k[O+W]=A[N]+A[W]}return k}();function $n(A){return typeof BigInt>"u"?di:A}function di(){throw new Error("BigInt not supported")}})(mU);var b$e={0:"Drawing",1:"Hentai",2:"Neutral",3:"Porn",4:"Sexy"},mo=function(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(d){o(d)}}function l(u){try{c(s.throw(u))}catch(d){o(d)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})},go=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,r,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(n=0)),n;)try{if(s=1,r&&(i=c[0]&2?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],r=0}finally{s=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},v$e=function(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))},o$={MobileNetV2:{numOfWeightBundles:1},MobileNetV2Mid:{numOfWeightBundles:2,options:{type:"graph"}},InceptionV3:{numOfWeightBundles:6,options:{size:299}}},S$e="MobileNetV2",iD=224,yU=function(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self;throw new Error("Unable to locate global object")};function xU(t){return!!t&&t in o$}var k$e=function(t){return mo(void 0,void 0,void 0,function(){var e,n;return go(this,function(s){switch(s.label){case 0:return e=yU().model,e?[2,e]:t!=="MobileNetV2"?[3,2]:[4,qt(()=>import("./mobilenet_v2-BA8Qi8T_.js"),[])];case 1:return n=s.sent().modelJson,[3,6];case 2:return t!=="MobileNetV2Mid"?[3,4]:[4,qt(()=>import("./mobilenet_v2_mid-DMqvllEs.js"),[])];case 3:return n=s.sent().modelJson,[3,6];case 4:return t!=="InceptionV3"?[3,6]:[4,qt(()=>import("./inception_v3-BLTWlTDv.js"),[])];case 5:n=s.sent().modelJson,s.label=6;case 6:return[4,n()];case 7:return[2,s.sent().default]}})})},C$e=function(t){return mo(void 0,void 0,void 0,function(){var e,n,s,r,i,o,a,l,c,u;return go(this,function(d){switch(d.label){case 0:e=o$[t].numOfWeightBundles,n=[],s=0,d.label=1;case 1:return s<e?(r="group1-shard".concat(s+1,"of").concat(e),i=r.replace(/-/g,"_"),o=yU()[i],o?(n.push((c={},c[r]=o,c)),[3,10]):[3,2]):[3,11];case 2:return a=void 0,t!=="MobileNetV2"?[3,4]:[4,qt(()=>import("./mobilenet_v2-BA8Qi8T_.js"),[])];case 3:return a=d.sent().weightBundles,[3,8];case 4:return t!=="MobileNetV2Mid"?[3,6]:[4,qt(()=>import("./mobilenet_v2_mid-DMqvllEs.js"),[])];case 5:return a=d.sent().weightBundles,[3,8];case 6:return t!=="InceptionV3"?[3,8]:[4,qt(()=>import("./inception_v3-BLTWlTDv.js"),[])];case 7:a=d.sent().weightBundles,d.label=8;case 8:return[4,a[s]()];case 9:l=d.sent().default,n.push((u={},u[r]=l,u)),d.label=10;case 10:return s++,[3,1];case 11:return[2,Object.assign.apply(Object,v$e([{}],n,!1))]}})})};function N$e(t){return mo(this,void 0,void 0,function(){var e;return go(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,C$e(t)];case 1:return e=n.sent(),[2,e];case 2:throw n.sent(),new Error("Could not load the weight data. Make sure you are importing the correct shard files from the models directory. Ref: https://github.com/infinitered/nsfwjs?tab=readme-ov-file#browserify");case 3:return[2]}})})}function T$e(t){return mo(this,void 0,void 0,function(){var e,n,s;return go(this,function(r){switch(r.label){case 0:if(!xU(t))return[2,t];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,k$e(t)];case 2:return e=r.sent(),[4,N$e(t)];case 3:return n=r.sent(),s=new I$e(e,n),[2,s];case 4:throw r.sent(),new Error("Could not load the model. Make sure you are importing the model.min.js bundle. Ref: https://github.com/infinitered/nsfwjs?tab=readme-ov-file#browserify");case 5:return[2]}})})}function iEe(t){return mo(this,arguments,void 0,function(e,n){var s,r,i;return n===void 0&&(n={size:iD}),go(this,function(o){switch(o.label){case 0:if(d$e==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");return e===void 0?(e=S$e,console.info("%cBy not specifying 'modelOrUrl' parameter, you're using the default model: '".concat(e,"'. See NSFWJS docs for instructions on hosting your own model (https://github.com/infinitered/nsfwjs?tab=readme-ov-file#host-your-own-model)."),"color: lightblue")):xU(e)&&(console.info("%cYou're using the model: '".concat(e,"'. See NSFWJS docs for instructions on hosting your own model (https://github.com/infinitered/nsfwjs?tab=readme-ov-file#host-your-own-model)."),"color: lightblue"),n=(i=o$[e].options)!==null&&i!==void 0?i:n),n.size=(n==null?void 0:n.size)||iD,[4,T$e(e)];case 1:return s=o.sent(),r=new $$e(s,n),[4,r.load()];case 2:return o.sent(),[2,r]}})})}var I$e=function(){function t(e,n){this.modelJson=e,this.weightDataBase64=n}return t.prototype.arrayBufferFromBase64=function(e){for(var n=mU.Buffer.from(e,"base64").toString("binary"),s=n.length,r=new Uint8Array(s),i=0;i<s;i++)r[i]=n.charCodeAt(i);return r.buffer},t.prototype.load=function(){return mo(this,void 0,void 0,function(){var e,n,s,r,i,o,a,l,c,u,d,h,f,p;return go(this,function(m){if(e={modelTopology:this.modelJson.modelTopology,format:this.modelJson.format,generatedBy:this.modelJson.generatedBy,convertedBy:this.modelJson.convertedBy},this.modelJson.weightsManifest!=null){for(n=[],s=[],r=0,i=this.modelJson.weightsManifest;r<i.length;r++){for(o=i[r],a=0,l=o.paths;a<l.length;a++){if(c=l[a],u=this.weightDataBase64[c],!u)throw new Error("Could not find the weight data. Make sure you are importing the correct weight bundle for the model: ".concat(c,".min.js."));d=this.arrayBufferFromBase64(u),s.push(new Uint8Array(d))}n.push.apply(n,o.weights)}for(e.weightSpecs=n,h=new Uint8Array(s.reduce(function(g,y){return g+y.length},0)),f=0,p=0;p<s.length;p++)h.set(s[p],f),f+=s[p].byteLength;e.weightData=h.buffer}return this.modelJson.trainingConfig!=null&&(e.trainingConfig=this.modelJson.trainingConfig),this.modelJson.userDefinedMetadata!=null&&(e.userDefinedMetadata=this.modelJson.userDefinedMetadata),[2,e]})})},t}(),$$e=function(){function t(e,n){this.intermediateModels={},this.options=n,this.normalizationOffset=Ee(255),this.urlOrIOHandler=e,typeof e=="string"&&!e.startsWith("indexeddb://")&&!e.startsWith("localstorage://")&&!e.endsWith("model.json")?this.urlOrIOHandler="".concat(e,"model.json"):this.urlOrIOHandler=e}return t.prototype.load=function(){return mo(this,void 0,void 0,function(){var e,n,s,r,i,o,a=this;return go(this,function(l){switch(l.label){case 0:return e=this.options,n=e.size,s=e.type,s!=="graph"?[3,2]:(r=this,[4,d4(this.urlOrIOHandler)]);case 1:return r.model=l.sent(),[3,4];case 2:return i=this,[4,kz(this.urlOrIOHandler)];case 3:i.model=l.sent(),this.endpoints=this.model.layers.map(function(c){return c.name}),l.label=4;case 4:return o=G(function(){return a.model.predict(Ht([1,n,n,3]))}),[4,o.data()];case 5:return l.sent(),o.dispose(),[2]}})})},t.prototype.infer=function(e,n){var s=this;if(n!=null&&this.endpoints.indexOf(n)===-1)throw new Error("Unknown endpoint ".concat(n,". Available endpoints: ").concat(this.endpoints,"."));return G(function(){e instanceof Xe||(e=$2(e));var r=e.toFloat().div(s.normalizationOffset),i=r,o=s.options.size;if(e.shape[0]!==o||e.shape[1]!==o){var a=!0;i=Zs.resizeBilinear(r,[o,o],a)}var l=i.reshape([1,o,o,3]),c;if(n==null)c=s.model;else{if(s.model.hasOwnProperty("layers")&&s.intermediateModels[n]==null){var u=s.model.layers.find(function(d){return d.name===n});s.intermediateModels[n]=Cz({inputs:s.model.inputs,outputs:u.output})}c=s.intermediateModels[n]}return c.predict(l)})},t.prototype.classify=function(e){return mo(this,arguments,void 0,function(n,s){var r,i;return s===void 0&&(s=5),go(this,function(o){switch(o.label){case 0:return r=this.infer(n),[4,E$e(r,s)];case 1:return i=o.sent(),r.dispose(),[2,i]}})})},t}();function E$e(t,e){return mo(this,void 0,void 0,function(){var n,s,a,r,i,a,o,a;return go(this,function(l){switch(l.label){case 0:return[4,t.data()];case 1:for(n=l.sent(),s=[],a=0;a<n.length;a++)s.push({value:n[a],index:a});for(s.sort(function(c,u){return u.value-c.value}),r=new Float32Array(e),i=new Int32Array(e),a=0;a<e;a++)r[a]=s[a].value,i[a]=s[a].index;for(o=[],a=0;a<i.length;a++)o.push({className:b$e[i[a]],probability:r[a]});return[2,o]}})})}const R$e=({isOpen:t,onClose:e,callType:n,isInitiator:s,otherUser:r,onCallEnd:i})=>{const{socket:o,authUser:a}=Wt(),[l,c]=F.useState("connecting"),[u,d]=F.useState(!1),[h,f]=F.useState(!1),[p,m]=F.useState(!1),[g,y]=F.useState(0);F.useState(0),F.useRef(null),F.useRef(0);const x=F.useRef(null),w=F.useRef(null),b=F.useRef(null),S=F.useRef(null),T=F.useRef(null),I=F.useRef(null),$=F.useRef([]),_=F.useRef(null),D=F.useRef(!1),z=F.useCallback(async()=>{console.log(" Ending call..."),Y();const ne=g;if(T.current&&(console.log(" Stopping local media tracks"),T.current.getTracks().forEach(U=>{U.stop(),console.log(`Stopped ${U.kind} track`)}),T.current=null),S.current&&(console.log(" Closing peer connection"),S.current.close(),S.current=null),I.current&&(I.current=null),o&&r&&(console.log(" Notifying other user of call end"),o.emit("private:end-call",{targetUserId:r._id})),ne>0&&r)try{const{axiosInstance:U}=await qt(async()=>{const{axiosInstance:ae}=await Promise.resolve().then(()=>ZX);return{axiosInstance:ae}},void 0);await U.post("/messages/call-log",{receiverId:r._id,callType:n,duration:ne}),console.log(` Call log created: ${n} call, ${ne}s`)}catch(U){console.error("Failed to create call log:",U)}c("ended"),i&&typeof i=="function"&&i(ne),setTimeout(()=>{console.log(" Call cleanup complete, closing modal"),e()},500)},[o,r,e,i,g,n]),H=F.useCallback(()=>{console.log(`Creating peer connection for ${n} call`);const ne=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"}]});if(ne.onicecandidate=U=>{U.candidate&&o&&(console.log("Sending ICE candidate"),o.emit("private:ice-candidate",{targetUserId:r._id,candidate:U.candidate}))},ne.ontrack=U=>{console.log(" Received remote track!",U.track.kind,"readyState:",U.track.readyState),U.streams&&U.streams[0]?(console.log(" Remote stream has",U.streams[0].getTracks().length,"tracks:",U.streams[0].getTracks().map(ae=>`${ae.kind} (${ae.readyState})`)),I.current=U.streams[0],n==="video"&&w.current?(w.current.srcObject=U.streams[0],w.current.play().then(()=>{console.log(" Remote video stream playing")}).catch(ae=>{console.error(" Error playing remote video:",ae),setTimeout(()=>{var ge;(ge=w.current)==null||ge.play().catch(be=>console.error("Retry failed:",be))},1e3)})):n==="audio"&&b.current&&(b.current.srcObject=U.streams[0],b.current.play().then(()=>{console.log(" Remote audio stream playing")}).catch(ae=>{console.error(" Error playing remote audio:",ae),setTimeout(()=>{var ge;(ge=b.current)==null||ge.play().catch(be=>console.error("Retry failed:",be))},1e3)})),console.log(" Setting call status to ACTIVE and starting timer"),c("active"),X(),ve.success("Call connected!")):console.warn(" ontrack fired but no streams available")},ne.onconnectionstatechange=()=>{console.log(" Connection state changed:",ne.connectionState),ne.connectionState==="connected"?console.log(" WebRTC connection established!"):ne.connectionState==="failed"?(console.error(" Connection failed"),ve.error("Connection failed"),e()):ne.connectionState==="disconnected"&&console.log(" Connection disconnected")},ne.oniceconnectionstatechange=()=>{console.log(" ICE connection state:",ne.iceConnectionState)},T.current){const U=T.current.getTracks();console.log(`Adding ${U.length} local tracks to peer connection:`,U.map(ae=>`${ae.kind} (enabled: ${ae.enabled})`)),U.forEach(ae=>{const ge=ne.addTrack(ae,T.current);console.log(` Added ${ae.kind} track, sender:`,ge)})}else console.warn(" No local stream available when creating peer connection");return S.current=ne,ne},[o,r,e]),X=()=>{_.current=setInterval(()=>{y(ne=>ne+1)},1e3)},Y=()=>{_.current&&(clearInterval(_.current),_.current=null)},J=F.useCallback(async()=>{try{console.log(` Initializing media for ${n} call`);const ne={audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:n==="video"?{width:{ideal:640,max:1280},height:{ideal:480,max:720},facingMode:"user"}:!1};console.log(" Requesting media with constraints:",ne);const U=await navigator.mediaDevices.getUserMedia(ne);return T.current=U,console.log(` Got local stream with ${U.getTracks().length} tracks:`,U.getTracks().map(ae=>`${ae.kind} (enabled: ${ae.enabled}, label: ${ae.label})`)),x.current&&n==="video"&&(x.current.srcObject=U,x.current.muted=!0,console.log(" Local video element set and muted")),U}catch(ne){return console.error(" Error accessing media:",ne),ve.error(`Could not access ${n==="video"?"camera/microphone":"microphone"}`),e(),null}},[n,e]),Q=F.useCallback(async()=>{if(console.log(" Starting call as initiator"),!await J()){console.error(" Failed to get media stream");return}console.log(" Media stream obtained, creating peer connection");const U=H();console.log(" Creating offer");const ae=await U.createOffer();await U.setLocalDescription(ae),console.log(" Local description set"),console.log(" Sending initiate-call signal"),o.emit("private:initiate-call",{receiverId:r._id,callerInfo:{_id:a._id,nickname:a.nickname,profilePic:a.profilePic},callType:n}),c("ringing"),console.log(" Call status set to ringing, waiting for receiver to accept"),window.pendingOffer={receiverId:r._id,sdp:ae}},[J,H,o,r,a,n]),ee=F.useCallback(async()=>{console.log("Answering call - initializing media"),await J()&&(console.log("Media initialized, waiting for offer"),c("connecting"))},[J]),M=F.useCallback(async ne=>{if(console.log(" Received offer from caller, creating peer connection"),!T.current&&(console.log(" No local stream, initializing media first"),!await J())){console.error(" Failed to initialize media"),ve.error("Failed to access camera/microphone"),z();return}console.log(" Local stream ready, creating peer connection");const U=H();try{console.log(" Setting remote description (offer)"),await U.setRemoteDescription(new RTCSessionDescription(ne)),console.log(" Remote description set"),console.log(" Creating answer");const ae=await U.createAnswer();await U.setLocalDescription(ae),console.log(" Local description (answer) set"),console.log(" Sending answer back to caller"),o.emit("private:answer",{callerId:r._id,sdp:ae}),console.log(" Answer sent, waiting for ICE candidates and tracks"),console.log(` Processing ${$.current.length} queued ICE candidates`),$.current.forEach(ge=>{U.addIceCandidate(new RTCIceCandidate(ge)).catch(be=>{console.error("Error adding ICE candidate:",be)})}),$.current=[]}catch(ae){console.error(" Error handling offer:",ae),ve.error("Failed to establish connection"),z()}},[H,o,r,J,z]),q=F.useCallback(async ne=>{console.log(" Received answer from receiver");const U=S.current;if(!U){console.error(" No peer connection found when handling answer");return}try{console.log(" Setting remote description (answer)"),await U.setRemoteDescription(new RTCSessionDescription(ne)),console.log(" Remote description set successfully"),console.log(` Processing ${$.current.length} queued ICE candidates`),$.current.forEach(ae=>{U.addIceCandidate(new RTCIceCandidate(ae)).catch(ge=>{console.error("Error adding ICE candidate:",ge)})}),$.current=[],console.log(" Answer processed, waiting for tracks...")}catch(ae){console.error(" Error handling answer:",ae),ve.error("Failed to establish connection"),z()}},[z]),te=F.useCallback(ne=>{console.log(" Received ICE candidate");const U=S.current;!U||!U.remoteDescription?(console.log(" Queueing ICE candidate (no remote description yet)"),$.current.push(ne)):(console.log(" Adding ICE candidate immediately"),U.addIceCandidate(new RTCIceCandidate(ne)).catch(ae=>{console.error(" Error adding ICE candidate:",ae)}))},[]),Z=()=>{if(T.current){const ne=T.current.getAudioTracks()[0];ne&&(ne.enabled=!ne.enabled,d(!ne.enabled))}},le=()=>{if(T.current&&n==="video"){const ne=T.current.getVideoTracks()[0];ne&&(ne.enabled=!ne.enabled,f(!ne.enabled))}},de=()=>{m(!p)};if(F.useEffect(()=>{if(!t||!o||!r)return;if(D.current){console.log(" Already initialized, skipping");return}D.current=!0,s?Q():ee();const ne=({sdp:Ae})=>M(Ae),U=({sdp:Ae})=>q(Ae),ae=({candidate:Ae})=>te(Ae),ge=()=>{s&&window.pendingOffer&&(console.log(" Call accepted by receiver, sending offer now"),o.emit("private:offer",window.pendingOffer),console.log(" Offer sent to receiver"),delete window.pendingOffer)},be=()=>{console.log("Call ended by other user"),ve("Call ended",{icon:""}),Y(),T.current&&(T.current.getTracks().forEach(Ae=>Ae.stop()),T.current=null),S.current&&(S.current.close(),S.current=null),c("ended"),e()},$e=Ae=>{if(console.log(" Received call-rejected event:",Ae,"isInitiator:",s),!s){console.log(" Ignoring call-rejected event (not initiator)");return}if(Ae.rejectorId&&Ae.rejectorId!==(r==null?void 0:r._id)){console.log(" Rejection from different user, ignoring");return}console.log(" Call rejected by other user"),ve.error("Call declined"),z()};return o.on("private:offer",ne),o.on("private:answer",U),o.on("private:ice-candidate",ae),o.on("private:call-ended",be),o.on("private:call-rejected",$e),o.on("private:call-accepted",ge),()=>{o.off("private:offer",ne),o.off("private:answer",U),o.off("private:ice-candidate",ae),o.off("private:call-ended",be),o.off("private:call-rejected",$e),o.off("private:call-accepted",ge),delete window.pendingOffer,Y(),T.current&&T.current.getTracks().forEach(Ae=>Ae.stop()),D.current=!1}},[t]),!t)return null;const fe=ne=>{const U=Math.floor(ne/60),ae=ne%60;return`${U.toString().padStart(2,"0")}:${ae.toString().padStart(2,"0")}`};return v.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-gray-900 via-black to-gray-900 z-50 flex flex-col",children:[v.jsxs("div",{className:"flex items-center justify-between p-2.5 sm:p-4 md:p-6 bg-gradient-to-b from-black/90 via-black/50 to-transparent",children:[v.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[v.jsxs("div",{className:"relative",children:[v.jsx("img",{src:(r==null?void 0:r.profilePic)||"/avatar.png",alt:r==null?void 0:r.nickname,className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 rounded-full ring-2 ring-primary/50 shadow-lg object-cover"}),l==="active"&&v.jsx("span",{className:"absolute -bottom-1 -right-1 w-3 h-3 sm:w-4 sm:h-4 bg-success rounded-full ring-2 ring-black animate-pulse"})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"text-white font-bold text-sm sm:text-base md:text-lg truncate max-w-[150px] sm:max-w-none",children:(r==null?void 0:r.nickname)||(r==null?void 0:r.username)}),v.jsxs("p",{className:"text-white/70 text-xs sm:text-sm flex items-center gap-1.5 sm:gap-2",children:[l==="connecting"&&v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"inline-block w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),"Connecting..."]}),l==="ringing"&&v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"inline-block w-2 h-2 bg-blue-500 rounded-full animate-ping"}),"Ringing..."]}),l==="active"&&v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"inline-block w-2 h-2 bg-success rounded-full"}),fe(g)]}),l==="ended"&&"Call Ended"]})]})]}),v.jsx("button",{onClick:de,className:"btn btn-ghost btn-circle btn-sm sm:btn-md text-white hover:bg-white/10",children:p?v.jsx(mY,{className:"w-4 h-4 sm:w-5 sm:h-5"}):v.jsx(fY,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),v.jsxs("div",{className:"flex-1 relative flex items-center justify-center overflow-hidden",children:[n==="audio"&&v.jsx("audio",{ref:b,autoPlay:!0,playsInline:!0,className:"hidden"}),n==="video"?v.jsxs(v.Fragment,{children:[v.jsx("video",{ref:w,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),!I.current&&v.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900",children:[v.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 md:w-40 md:h-40 rounded-full bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center mb-4",children:v.jsx("img",{src:(r==null?void 0:r.profilePic)||"/avatar.png",alt:r==null?void 0:r.nickname,className:"w-20 h-20 sm:w-28 sm:h-28 md:w-36 md:h-36 rounded-full object-cover"})}),v.jsx("p",{className:"text-white/70 text-sm sm:text-base",children:"Waiting for video..."})]}),v.jsxs("div",{className:"absolute top-3 right-3 sm:top-6 sm:right-6 w-20 h-28 sm:w-28 sm:h-36 md:w-36 md:h-48 lg:w-40 lg:h-52 bg-gray-900 rounded-lg sm:rounded-2xl overflow-hidden shadow-2xl border-2 border-white/20 transition-all hover:scale-105",children:[v.jsx("video",{ref:x,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover mirror"}),h&&v.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900",children:[v.jsx(wA,{className:"w-4 h-4 sm:w-8 sm:h-8 md:w-10 md:h-10 text-white/50 mb-1 sm:mb-2"}),v.jsx("span",{className:"text-white/50 text-[10px] sm:text-xs",children:"Camera Off"})]})]})]}):v.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 sm:gap-6 p-4",children:[v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-3xl animate-pulse"}),v.jsx("img",{src:(r==null?void 0:r.profilePic)||"/avatar.png",alt:r==null?void 0:r.nickname,className:"relative w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 lg:w-56 lg:h-56 rounded-full ring-4 ring-primary/30 shadow-2xl object-cover"}),l==="active"&&v.jsx("span",{className:"absolute bottom-2 right-2 sm:bottom-4 sm:right-4 w-4 h-4 sm:w-6 sm:h-6 bg-success rounded-full ring-4 ring-black animate-pulse"})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("h2",{className:"text-white text-xl sm:text-2xl md:text-3xl font-bold mb-2",children:(r==null?void 0:r.nickname)||(r==null?void 0:r.username)}),v.jsxs("p",{className:"text-white/60 text-sm sm:text-base",children:[l==="ringing"&&"Calling...",l==="connecting"&&"Connecting...",l==="active"&&"Voice Call"]})]}),l==="active"&&v.jsx("div",{className:"flex items-center gap-1 sm:gap-2 h-12 sm:h-16",children:[...Array(5)].map((ne,U)=>v.jsx("div",{className:"w-1 sm:w-1.5 bg-primary rounded-full animate-pulse",style:{height:`${20+Math.random()*60}%`,animationDelay:`${U*.1}s`,animationDuration:`${.5+Math.random()*.5}s`}},U))})]})]}),v.jsxs("div",{className:"p-3 sm:p-6 md:p-8 bg-gradient-to-t from-black/90 via-black/50 to-transparent",children:[v.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 md:gap-6",children:[v.jsx("button",{onClick:Z,className:`btn btn-circle w-12 h-12 sm:w-14 sm:h-14 md:btn-lg transition-all ${u?"btn-error hover:btn-error":"bg-white/10 text-white hover:bg-white/20 border-white/20"}`,title:u?"Unmute":"Mute",children:u?v.jsx(pY,{className:"w-5 h-5 sm:w-6 sm:h-6"}):v.jsx(Lc,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),v.jsx("button",{onClick:z,className:"btn btn-circle w-14 h-14 sm:w-16 sm:h-16 md:btn-xl bg-error hover:bg-error/80 border-none shadow-2xl",title:"End call",children:v.jsx(ZL,{className:"w-6 h-6 sm:w-7 sm:h-7"})}),n==="video"&&v.jsx("button",{onClick:le,className:`btn btn-circle w-12 h-12 sm:w-14 sm:h-14 md:btn-lg transition-all ${h?"btn-error hover:btn-error":"bg-white/10 text-white hover:bg-white/20 border-white/20"}`,title:h?"Turn on camera":"Turn off camera",children:h?v.jsx(wA,{className:"w-5 h-5 sm:w-6 sm:h-6"}):v.jsx(Jc,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),v.jsxs("p",{className:"text-center text-white/50 text-[10px] sm:text-sm mt-3 sm:mt-4",children:[u&&"Microphone muted",h&&n==="video"&&"  Camera off"]})]}),v.jsx("style",{children:`
        .mirror {
          transform: scaleX(-1);
        }
        .btn-xl {
          width: 4rem;
          height: 4rem;
        }
        @media (min-width: 640px) {
          .btn-xl {
            width: 5rem;
            height: 5rem;
          }
        }
      `})]})},A$e=({isOpen:t,caller:e,callType:n,onAccept:s,onReject:r})=>{const[i,o]=F.useState(0),a=F.useRef(null),l=F.useRef(null),c=F.useRef(null),u=()=>{try{a.current||(a.current=new(window.AudioContext||window.webkitAudioContext));const d=a.current;d.state==="suspended"&&d.resume().catch(p=>console.log("AudioContext resume failed:",p));const h=d.createOscillator(),f=d.createGain();h.connect(f),f.connect(d.destination),h.frequency.value=800,h.type="sine",f.gain.setValueAtTime(.3,d.currentTime),f.gain.exponentialRampToValueAtTime(.01,d.currentTime+.5),h.start(d.currentTime),h.stop(d.currentTime+.5),setTimeout(()=>{const p=d.createOscillator(),m=d.createGain();p.connect(m),m.connect(d.destination),p.frequency.value=1e3,p.type="sine",m.gain.setValueAtTime(.3,d.currentTime),m.gain.exponentialRampToValueAtTime(.01,d.currentTime+.5),p.start(d.currentTime),p.stop(d.currentTime+.5)},500)}catch(d){console.error("Error playing ringtone:",d)}};return F.useEffect(()=>{if(!t){o(0),l.current&&(clearInterval(l.current),l.current=null),c.current&&(c.current.pause(),c.current.currentTime=0);return}navigator.vibrate&&navigator.vibrate([200,100,200]),u(),l.current=setInterval(()=>{u(),navigator.vibrate&&navigator.vibrate([200,100,200])},2e3);const d=setInterval(()=>{o(f=>f+1)},1e3),h=setTimeout(()=>{r()},3e4);return()=>{clearInterval(d),clearTimeout(h),l.current&&clearInterval(l.current)}},[t,r]),!t||!e?null:v.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",children:[v.jsxs("div",{className:"bg-gradient-to-br from-primary/20 to-secondary/20 backdrop-blur-md p-6 sm:p-8 rounded-2xl shadow-2xl max-w-sm w-full border border-white/10 animate-bounce-slow",children:[v.jsxs("div",{className:"flex flex-col items-center gap-4 mb-6",children:[v.jsxs("div",{className:"relative",children:[v.jsx("img",{src:e.profilePic||"/avatar.png",alt:e.nickname,className:"w-24 h-24 sm:w-32 sm:h-32 rounded-full ring-4 ring-white/20 animate-pulse-slow"}),v.jsx("div",{className:"absolute -bottom-2 -right-2 bg-primary rounded-full p-2",children:n==="video"?v.jsx(Jc,{className:"w-5 h-5 text-primary-content"}):v.jsx(My,{className:"w-5 h-5 text-primary-content"})})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("h3",{className:"text-white text-xl sm:text-2xl font-bold mb-1",children:e.nickname||e.username}),v.jsxs("p",{className:"text-white/70 text-sm sm:text-base",children:["Incoming ",n," call..."]}),v.jsxs("p",{className:"text-white/50 text-xs mt-2",children:[i,"s"]})]})]}),v.jsxs("div",{className:"flex items-center justify-center gap-4",children:[v.jsx("button",{onClick:r,className:"btn btn-circle btn-lg btn-error shadow-lg hover:scale-110 transition-transform",title:"Reject call",children:v.jsx(ZL,{className:"w-6 h-6"})}),v.jsx("button",{onClick:s,className:"btn btn-circle btn-lg btn-success shadow-lg hover:scale-110 transition-transform animate-pulse",title:"Accept call",children:n==="video"?v.jsx(Jc,{className:"w-6 h-6"}):v.jsx(My,{className:"w-6 h-6"})})]}),v.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[v.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-ping"}),v.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-ping animation-delay-200"}),v.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-ping animation-delay-400"})]})]}),v.jsx("style",{children:`
        @keyframes bounce-slow {
          0%, 100% {
            transform: translateY(0);
          }
          50% {
            transform: translateY(-10px);
          }
        }
        .animate-bounce-slow {
          animation: bounce-slow 2s ease-in-out infinite;
        }
        @keyframes pulse-slow {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.7;
          }
        }
        .animate-pulse-slow {
          animation: pulse-slow 2s ease-in-out infinite;
        }
        .animation-delay-200 {
          animation-delay: 200ms;
        }
        .animation-delay-400 {
          animation-delay: 400ms;
        }
      `})]})},_$e=()=>{const{selectedUser:t}=Na(),{socket:e,authUser:n}=Wt(),[s,r]=F.useState({isCallActive:!1,callType:null,isInitiator:!1,otherUser:null}),[i,o]=F.useState(null);F.useEffect(()=>{if(!e)return;const d=({callerInfo:h,callType:f,callerId:p})=>{if(console.log(" Incoming call from:",(h==null?void 0:h.nickname)||p,"Type:",f),console.log(" Full call data:",{callerInfo:h,callType:f,callerId:p}),!h||!h._id){console.error(" Invalid caller info received:",h),ve.error("Invalid call data received");return}r(m=>(console.log(" Current call state:",m),m.isCallActive?(console.log(" Already in a call, rejecting incoming call from:",h.nickname),e.emit("private:reject-call",{callerId:h._id}),m):(console.log(" Showing incoming call modal for:",h.nickname),o({callerInfo:h,callType:f}),m)))};return e.on("private:incoming-call",d),()=>{e.off("private:incoming-call",d)}},[e]);const a=d=>{if(!t){ve.error("No user selected");return}if(s.isCallActive){ve.error("Already in a call");return}console.log(` Starting ${d} call with:`,t.nickname||t.username),r({isCallActive:!0,callType:d,isInitiator:!0,otherUser:t})},l=()=>{!i||!e||(console.log(" Accepting call from:",i.callerInfo.nickname),e.emit("private:call-accepted",{callerId:i.callerInfo._id,acceptorInfo:{_id:n._id,nickname:n.nickname,profilePic:n.profilePic}}),r({isCallActive:!0,callType:i.callType,isInitiator:!1,otherUser:i.callerInfo}),o(null))},c=()=>{i&&e&&(console.log(" Rejecting call from:",i.callerInfo.nickname),e.emit("private:reject-call",{callerId:i.callerInfo._id,reason:"declined"})),o(null)},u=()=>{r({isCallActive:!1,callType:null,isInitiator:!1,otherUser:null})};return v.jsxs("div",{className:"fixed inset-0 bg-base-200 overflow-hidden",children:[v.jsxs("div",{className:"h-full w-full flex flex-col overflow-hidden",children:[v.jsx("div",{className:"h-14 sm:h-16 flex-shrink-0"}),v.jsx("div",{className:"flex-1 flex items-center justify-center overflow-hidden min-h-0",children:v.jsxs("div",{className:"bg-base-100 w-full h-full max-w-7xl flex overflow-hidden md:border-x border-base-300",children:[v.jsx(EY,{}),t?v.jsx(zY,{onStartCall:a}):v.jsx(RY,{})]})}),v.jsx("div",{className:"h-0 md:h-0 safe-area-bottom"})]}),v.jsx(R$e,{isOpen:s.isCallActive,onClose:u,callType:s.callType,isInitiator:s.isInitiator,otherUser:s.otherUser}),v.jsx(A$e,{isOpen:!!i,caller:i==null?void 0:i.callerInfo,callType:i==null?void 0:i.callType,onAccept:l,onReject:c})]})},wU=({title:t,subtitle:e})=>v.jsx("div",{className:"hidden lg:flex items-center justify-center bg-base-200 p-12",children:v.jsxs("div",{className:"max-w-md text-center",children:[v.jsx("div",{className:"grid grid-cols-3 gap-3 mb-8",children:[...Array(9)].map((n,s)=>v.jsx("div",{className:`aspect-square rounded-2xl bg-primary/10 ${s%2===0?"animate-pulse":""}`},s))}),v.jsx("h2",{className:"text-2xl font-bold mb-4",children:t}),v.jsx("p",{className:"text-base-content/60",children:e})]})}),D$e=()=>{const t=Of(),[e,n]=F.useState(!1),[s,r]=F.useState({fullName:"",username:"",email:"",password:""}),{signup:i,isSigningUp:o}=Wt(),a=()=>s.fullName.trim()?s.username.trim()?s.username.length<3?ve.error("Username must be at least 3 characters"):/^[a-zA-Z0-9_.]+$/.test(s.username)?s.email.trim()?/\S+@\S+\.\S+/.test(s.email)?s.password?s.password.length<6?ve.error("Password must be at least 6 characters"):!0:ve.error("Password is required"):ve.error("Invalid email format"):ve.error("Email is required"):ve.error("Username can only contain letters, numbers, underscores, and periods."):ve.error("Username is required"):ve.error("Full name is required"),l=async c=>{if(c.preventDefault(),a()===!0){const d={...s,username:s.username.toLowerCase()};await i(d)&&t("/")}};return v.jsxs("div",{className:"min-h-screen grid lg:grid-cols-2",children:[v.jsx("div",{className:"flex flex-col justify-center items-center px-4 py-8 sm:px-8 lg:px-12",children:v.jsxs("div",{className:"w-full max-w-md space-y-8",children:[v.jsx("div",{className:"text-center mb-6 sm:mb-8",children:v.jsxs("div",{className:"flex flex-col items-center gap-2 group",children:[v.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:v.jsx(QL,{className:"w-6 h-6 sm:w-7 sm:h-7 text-primary"})}),v.jsx("h1",{className:"text-xl sm:text-2xl font-bold mt-2",children:"Create Account"}),v.jsx("p",{className:"text-sm sm:text-base text-base-content/60",children:"Get started with your free account"})]})}),v.jsxs("form",{onSubmit:l,className:"space-y-5 sm:space-y-6",children:[v.jsxs("div",{className:"form-control",children:[v.jsx("label",{className:"label",children:v.jsx("span",{className:"label-text font-medium",children:"Full Name"})}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(UC,{className:"w-5 h-5 text-base-content/40"})}),v.jsx("input",{type:"text",className:"input input-bordered w-full pl-10",placeholder:"Full Name",value:s.fullName,onChange:c=>r({...s,fullName:c.target.value})})]})]}),v.jsxs("div",{className:"form-control",children:[v.jsx("label",{className:"label",children:v.jsx("span",{className:"label-text font-medium",children:"Username"})}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(aY,{className:"w-5 h-5 text-base-content/40"})}),v.jsx("input",{type:"text",className:"input input-bordered w-full pl-10",placeholder:"your_unique_username",value:s.username,onChange:c=>r({...s,username:c.target.value})})]})]}),v.jsxs("div",{className:"form-control",children:[v.jsx("label",{className:"label",children:v.jsx("span",{className:"label-text font-medium",children:"Email"})}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(hY,{className:"w-5 h-5 text-base-content/40"})}),v.jsx("input",{type:"email",className:"input input-bordered w-full pl-10",placeholder:"example@gmail.com",value:s.email,onChange:c=>r({...s,email:c.target.value})})]})]}),v.jsxs("div",{className:"form-control",children:[v.jsx("label",{className:"label",children:v.jsx("span",{className:"label-text font-medium",children:"Password"})}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(JL,{className:"w-5 h-5 text-base-content/40"})}),v.jsx("input",{type:e?"text":"password",className:"input input-bordered w-full pl-10",placeholder:"Password",value:s.password,onChange:c=>r({...s,password:c.target.value})}),v.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>n(!e),children:e?v.jsx(XL,{className:"w-5 h-5 text-base-content/40"}):v.jsx(YL,{className:"w-5 h-5 text-base-content/40"})})]})]}),v.jsx("button",{type:"submit",className:"btn btn-primary w-full text-sm sm:text-base py-2 sm:py-3",disabled:o,children:o?v.jsxs(v.Fragment,{children:[v.jsx(jC,{className:"w-5 h-5 animate-spin"}),"Loading..."]}):"Create Account"})]}),v.jsx("div",{className:"text-center text-sm sm:text-base",children:v.jsxs("p",{className:"text-base-content/60",children:["Already have an account?"," ",v.jsx(wi,{to:"/login",className:"link link-primary",children:"Sign in"})]})})]})}),v.jsx(wU,{title:"Join our community",subtitle:"Connect with friends, share moments, and stay in touch with your loved ones."})]})},O$e=()=>{const[t,e]=F.useState(!1),[n,s]=F.useState({emailOrUsername:"",password:""}),{login:r,isLoggingIn:i}=Wt(),o=async a=>{a.preventDefault(),r(n)};return v.jsxs("div",{className:"h-screen grid lg:grid-cols-2",children:[v.jsx("div",{className:"flex flex-col justify-center items-center p-6 sm:p-12",children:v.jsxs("div",{className:"w-full max-w-md space-y-8",children:[v.jsx("div",{className:"text-center mb-8",children:v.jsxs("div",{className:"flex flex-col items-center gap-2 group",children:[v.jsx("div",{className:`w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20\r
                                transition-colors`,children:v.jsx(QL,{className:"w-6 h-6 text-primary"})}),v.jsx("h1",{className:"text-2xl font-bold mt-2",children:"Welcome Back"}),v.jsx("p",{className:"text-base-content/60",children:"Sign in to your account"})]})}),v.jsxs("form",{onSubmit:o,className:"space-y-6",children:[v.jsxs("div",{className:"form-control",children:[v.jsx("label",{className:"label",children:v.jsx("span",{className:"label-text font-medium",children:"Email or Username"})}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(UC,{className:"h-5 w-5 text-base-content/40"})}),v.jsx("input",{type:"text",className:"input input-bordered w-full pl-10",placeholder:"Email or Username",value:n.emailOrUsername,onChange:a=>s({...n,emailOrUsername:a.target.value})})]})]}),v.jsxs("div",{className:"form-control",children:[v.jsx("label",{className:"label",children:v.jsx("span",{className:"label-text font-medium",children:"Password"})}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(JL,{className:"h-5 w-5 text-base-content/40"})}),v.jsx("input",{type:t?"text":"password",className:"input input-bordered w-full pl-10",placeholder:"Password",value:n.password,onChange:a=>s({...n,password:a.target.value})}),v.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>e(!t),children:t?v.jsx(XL,{className:"h-5 w-5 text-base-content/40"}):v.jsx(YL,{className:"h-5 w-5 text-base-content/40"})})]}),v.jsx("div",{className:"text-right mt-2",children:v.jsx(wi,{to:"/forgot-password",className:"text-sm text-primary hover:underline",children:"Forgot Password?"})})]}),v.jsx("button",{type:"submit",className:"btn btn-primary w-full",disabled:i,children:i?v.jsxs(v.Fragment,{children:[v.jsx(jC,{className:"h-5 w-5 animate-spin"}),"Loading..."]}):"Sign in"})]}),v.jsx("div",{className:"text-center",children:v.jsxs("p",{className:"text-base-content/60",children:["Don't have an account?"," ",v.jsx(wi,{to:"/signup",className:"link link-primary",children:"Create account"})]})})]})}),v.jsx(wU,{title:"Welcome back!",subtitle:"Sign in to continue your conversations and catch up with your messages."})]})},F$e=zf(t=>({theme:localStorage.getItem("chat-theme")||"coffee",setTheme:e=>{localStorage.setItem("chat-theme",e),t({theme:e})}})),P$e=F.lazy(()=>qt(()=>import("./SetupProfilePage-B03Q8h4S.js"),__vite__mapDeps([0,1]))),L$e=F.lazy(()=>qt(()=>import("./SettingsPage-DpqDgbfE.js"),__vite__mapDeps([2,3,4]))),M$e=F.lazy(()=>qt(()=>import("./ChangePasswordPage-Bn2iGbGw.js"),__vite__mapDeps([5,3]))),B$e=F.lazy(()=>qt(()=>import("./ProfilePage-C0xgFaob.js"),__vite__mapDeps([6,4,7]))),z$e=F.lazy(()=>qt(()=>import("./PublicProfilePage-Das_6U-f.js"),__vite__mapDeps([8,9,4,10]))),V$e=F.lazy(()=>qt(()=>import("./StrangerChatPage-DjKAFyi4.js"),__vite__mapDeps([11,12,10]))),j$e=F.lazy(()=>qt(()=>import("./AdminDashboard-M4gMXi8B.js"),__vite__mapDeps([13,9,7,12,3,14,1,15]))),U$e=F.lazy(()=>qt(()=>import("./DiscoverPage-yrmb0oUe.js"),__vite__mapDeps([16,9,10,14]))),W$e=F.lazy(()=>qt(()=>import("./SuspendedPage-WLHN0bQD.js"),[])),oD=F.lazy(()=>qt(()=>import("./GoodbyePage-Bs3Xjel-.js"),[])),G$e=F.lazy(()=>qt(()=>import("./ForgotPassword-D3CTJaW_.js"),__vite__mapDeps([17,7]))),H$e=F.lazy(()=>qt(()=>import("./ResetPassword-DTpw0j40.js"),[])),q$e=({senderName:t,senderAvatar:e,messageText:n,theme:s})=>{yt.custom(r=>v.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl shadow-lg transition-all duration-300
    ${s==="dark"?"bg-gray-800 text-white":"bg-white text-gray-900"}
    ${r.visible?"opacity-100":"opacity-0"}
    `,children:[v.jsx("img",{src:e,alt:t,className:"w-10 h-10 rounded-full object-cover border border-gray-300"}),v.jsxs("div",{className:"flex flex-col max-w-[200px]",children:[v.jsx("span",{className:"font-semibold truncate",children:t}),v.jsx("span",{className:"text-sm opacity-80 truncate",children:n})]})]}),{id:`msg-${Date.now()}`,duration:4e3})},K$e=()=>{const{authUser:t,checkAuth:e,isCheckingAuth:n,socket:s,setAuthUser:r}=Wt(),{theme:i}=F$e(),o=qr(f=>f.addPendingReceived),a=qr(f=>f.fetchFriendData),l=Of(),c=xu(),u=F.useCallback((f,p="/login")=>{r(null),yt.error(f),l(p)},[l,r]);if(F.useEffect(()=>{e()},[]),F.useEffect(()=>{t!=null&&t._id&&a()},[t==null?void 0:t._id,a]),F.useEffect(()=>{t!=null&&t.isSuspended&&window.location.pathname!=="/suspended"&&l("/suspended")},[t,l]),F.useEffect(()=>{if(!(!s||!(t!=null&&t._id)))return s.emit("register-user",t._id),s.on("user-action",({type:f,reason:p,until:m})=>{switch(f){case"suspended":u(` Suspended until ${new Date(m).toLocaleString()}. Reason: ${p}`,"/suspended");break;case"unsuspended":yt.success(" Suspension lifted. Please log in again."),l("/login");break;case"blocked":u(" You have been blocked by admin.","/blocked");break;case"unblocked":yt.success(" Youve been unblocked. Please log in again."),l("/login");break;case"deleted":u(" Your account has been deleted.","/goodbye");break}}),s.on("message-received",({sender:f,text:p})=>{(f==null?void 0:f._id)!==(t==null?void 0:t._id)&&q$e({senderName:(f==null?void 0:f.name)||"Unknown",senderAvatar:(f==null?void 0:f.profilePic)||"/default-avatar.png",messageText:p||"",theme:i})}),s.on("friendRequest:received",f=>{o(f)}),s.on("friendRequest:accepted",({user:f,message:p})=>{yt.success(p||`${f.nickname||f.username} accepted your friend request!`),qr.getState().fetchFriendData()}),s.on("friendRequest:rejected",({message:f})=>{yt.error(f||"Your friend request was declined"),qr.getState().fetchFriendData()}),s.on("admin-notification",f=>{yt(f.message,{icon:f.type==="success"?"":f.type==="error"?"":f.type==="warning"?"":"",duration:5e3});const{addNotification:p}=Fh.getState();p({type:"admin",title:f.title,message:f.message,color:f.color,notificationType:f.type,createdAt:f.createdAt,id:f._id||f.id,dbId:f._id||f.id,_id:f._id||f.id})}),s.on("admin-broadcast",f=>{yt(f.message,{icon:f.type==="success"?"":f.type==="error"?"":f.type==="warning"?"":"",duration:5e3});const{addNotification:p}=Fh.getState();p({type:"admin_broadcast",title:f.title,message:f.message,color:f.color,notificationType:f.type,createdAt:f.createdAt,id:f._id||f.id,dbId:f._id||f.id,_id:f._id||f.id})}),s.on("verification-approved",({message:f})=>{yt.success(f||"Your verification request has been approved!");const p={...t,isVerified:!0,verificationRequest:{...t.verificationRequest,status:"approved",reviewedAt:new Date}};r(p),localStorage.setItem("authUser",JSON.stringify(p))}),s.on("verification-rejected",({message:f,reason:p})=>{yt.error(f||"Your verification request has been rejected"),p&&yt.error(`Reason: ${p}`,{duration:5e3});const m={...t,isVerified:!1,verificationRequest:{...t.verificationRequest,status:"rejected",adminNote:p||"Does not meet verification criteria",reviewedAt:new Date}};r(m),localStorage.setItem("authUser",JSON.stringify(m))}),s.on("report-status-updated",({title:f,message:p,status:m,actionTaken:g,reportedUser:y})=>{m==="action_taken"?yt.success(`${f}: ${p}`,{duration:6e3}):yt(p,{icon:"",duration:5e3});const{addNotification:x}=Fh.getState();x({type:"report_update",title:f,message:p,status:m,actionTaken:g,reportedUser:y})}),()=>{s.off("user-action"),s.off("message-received"),s.off("friendRequest:received"),s.off("friendRequest:accepted"),s.off("friendRequest:rejected"),s.off("verification-approved"),s.off("verification-rejected"),s.off("report-status-updated"),s.off("admin-notification"),s.off("admin-broadcast")}},[s,t,l,u,i,o]),n)return v.jsxs("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#1a1a1a"},children:[v.jsx("div",{className:"spinner",style:{width:"50px",height:"50px",border:"3px solid rgba(255, 153, 51, 0.2)",borderTopColor:"#FF9933",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),v.jsx("style",{children:`
					@keyframes spin {
						to { transform: rotate(360deg); }
					}
				`})]});const d=t==null?void 0:t.hasCompletedProfile,h=()=>v.jsx("div",{className:"flex items-center justify-center h-screen",children:v.jsx("span",{className:"loading loading-spinner loading-lg text-primary"})});return v.jsxs("div",{"data-theme":i,className:"pt-14 md:pt-16",children:[v.jsx(IY,{}),v.jsx(NY,{}),t&&d&&v.jsx(TY,{}),d&&window.location.pathname!=="/stranger"&&v.jsx(kY,{}),v.jsx(V8,{mode:"wait",children:v.jsx(F.Suspense,{fallback:v.jsx(h,{}),children:v.jsxs(B6,{location:c,children:[v.jsx(jn,{path:"/signup",element:t?v.jsx(Pt,{to:"/"}):v.jsx(ji,{children:v.jsx(D$e,{})})}),v.jsx(jn,{path:"/login",element:t?v.jsx(Pt,{to:"/"}):v.jsx(ji,{children:v.jsx(O$e,{})})}),v.jsx(jn,{path:"/forgot-password",element:t?v.jsx(Pt,{to:"/"}):v.jsx(ji,{children:v.jsx(G$e,{})})}),v.jsx(jn,{path:"/reset-password/:token",element:t?v.jsx(Pt,{to:"/"}):v.jsx(ji,{children:v.jsx(H$e,{})})}),v.jsx(jn,{path:"/setup-profile",element:t?d?v.jsx(Pt,{to:"/"}):v.jsx(P$e,{}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/",element:t?d?v.jsx(ji,{children:v.jsx(_$e,{})}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/settings",element:t?d?v.jsx(ji,{children:v.jsx(L$e,{})}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/change-password",element:t?d?v.jsx(ji,{children:v.jsx(M$e,{})}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/profile/:username",element:t?d?v.jsx(ji,{children:v.jsx(z$e,{})}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/profile",element:t?d?v.jsx(ji,{children:v.jsx(B$e,{})}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/admin",element:t?d?t.isAdmin?v.jsx(j$e,{}):v.jsx(Pt,{to:"/"}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/discover",element:t?d?v.jsx(U$e,{}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/stranger",element:t?d?v.jsx(V$e,{}):v.jsx(Pt,{to:"/setup-profile"}):v.jsx(Pt,{to:"/login"})}),v.jsx(jn,{path:"/suspended",element:v.jsx(W$e,{})}),v.jsx(jn,{path:"/goodbye",element:v.jsx(oD,{})}),v.jsx(jn,{path:"/blocked",element:v.jsx(oD,{})})]},c.pathname)})}),v.jsx(B5,{position:"top-center"})]})};setTimeout(()=>{qt(()=>Promise.resolve({}),__vite__mapDeps([18])),qt(()=>Promise.resolve({}),__vite__mapDeps([19])),qt(()=>Promise.resolve({}),__vite__mapDeps([20]))},0);vF(document.getElementById("root")).render(v.jsx(F.StrictMode,{children:v.jsx(H6,{children:v.jsx(K$e,{})})}));export{oY as A,lY as B,gA as C,cY as D,XL as E,yt as F,Fh as G,mn as H,qt as I,jC as L,Lc as M,ZL as P,MU as R,e3 as S,xA as T,UC as U,Jc as V,SY as W,bl as X,ve as _,Of as a,St as b,Ke as c,F$e as d,wi as e,JL as f,hY as g,YL as h,nS as i,v as j,aY as k,yA as l,X$e as m,qr as n,Na as o,QL as p,WJ as q,F as r,F3 as s,iEe as t,Wt as u,lD as v,XG as w,n3 as x,s3 as y,eh as z};
